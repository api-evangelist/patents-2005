---

title: Nonvolatile memory
abstract: The memory device according to an embodiment of the invention prepares a reference field (reference value range) corresponding to each logical value and if the threshold value of the cell is within that field, the cell is determined to be defective and the data of the defective cell is stored in a redundant cell. Therefore, if the threshold value drops because the cell charge leaks over time, the data which is stored can be rescued. As a background operation of a normal operating, memory device performs the memory cell check and memory cell substitution in accordance with the internal addresses generated independently than external addresses. Therefore, a defective cell can be rescued without causing delay in the normal operations of memory device.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07394688&OS=07394688&RS=07394688
owner: NEC Electronics Corporation
number: 07394688
owner_city: Kanagawa
owner_country: JP
publication_date: 20050606
---
The present invention relates to a nonvolatile memory and more particularly to a nonvolatile memory which stores data from a memory cell in which an error is detected in a redundant cell reserved cell .

Nonvolatile semiconductor memory such as EEPROM and flash memory can be electrically erased or written over and because the data is not deleted even though the power is turned off these devices are used in many applications such as portable phones digital cameras and personal computer BIOS memory or the like. With this type of nonvolatile semiconductor memory device a charge is accumulated in a memory cell floating gate and data is stored by changing the cell threshold value. In order to read the data a current is supplied to the cell and the data stored in the memory cell can be read by detecting the current value or threshold value thereof .

When memory cells become smaller in conjunction with miniaturization the amount of charge generally the number of electrons accumulated in the floating gate is reduced. The number of electrons accumulated at the floating gate can simply be expressed by the following equation. If only VFG is changed by the influx efflux of electrons by the electric potential of the floating gate the number of influx efflux electrons of the floating gate is expressed by the following equation. 1 

In this equation CFG is the capacity of the floating gate and has a proportional relationship to the floating gate electrode size L W. CFG L W

In conjunction with miniaturization CFG is reduced and the width of VFG which is used for the logical determination become smaller by reducing the voltage and making multi valued. Prior to use particularly when using as ROM the number of electrons in the floating gate will be reduced and if a threshold voltage flag that is used for a specific logical determination is exceeded wrong information will be stored. Therefore when this cell is read the mistaken data will be read and a software error will occur. It is thought that this type of phenomenon will become more marked in multi value cells where the threshold value which makes a prescribed logical determination is narrow.

Methods to rescue data from defective cells are known where the defective cells are rescued by so called redundancy circuits which are performed prior to shipping the product. However software errors caused by the reduction in the number of electrons at the floating gate during use as described above can not generally be detected prior to shipping the product. Furthermore methods to determine defective cells using ECC Error Check Correct process and then to restore the properties of the cell are widely known. However ECC process requires a fair amount of process time so normal operation of the memory device is delayed. Furthermore an ECC circuit must be added in order to perform ECC process which leads to increased chip area.

On the other hand a change in the threshold voltage because of a change in the number of electrons of the aforementioned floating gate was highlighted in patent literature 1. In nonvolatile memory a change in the data can occur during use because of data leak where an electric charge passes slowly through an oxide film. Therefore nonvolatile memory which better prevents storage data conversion by shifting the threshold value of the transistor has been proposed in Japanese Patent Application Laid open No. H9 320289.

These proposed semiconductor nonvolatile memory devices in order to read the data determine whether or not a pre charged bit line voltage VBL is between a reference level VL and a middle level VM or between a reference level VH and a middle level VM and rewrite 1 or 0 in the memory cell where the data was read. Therefore problems with inverting of stored data can be prevented beforehand by a shift in the cell transistor threshold value.

It has now been discovered that with the aforementioned conventional semiconductor nonvolatile memory changing of the stored data caused by a reduction in the number of electrons at the floating gate can be prevented. However there is variation in the degree of the reduction of the number of electrons at the floating gate depending on the cell. Generally cells which have a large reduction in the number of electrons will again have a large reduction in the number of electrons after the data is rewritten. Therefore the inefficient rewriting of the data to the same cell must be repeatedly performed.

Furthermore with this conventional technique cell checking and rewriting is performed while the CPU is not accessing the EEPROM such as when the power is turned on or when the system is shut down. Therefore the frequency of cell check is limited and there are cases where each cell cannot be inspected at the necessary frequency.

According to an aspect of the invention there is provided a nonvolatile memory comprising a memory cell array storing data and accessed with an external address an internal address generation circuit generating an internal address different from an external address a check circuit performing a check process comprising detection and determination of state of a cell selected with an internal address during an access cycle from an external circuit to the memory cell array and a redundant cell storing data of the selected cell if the check circuit determines that the cell state is within a predetermined range.

Since the check circuit performs a check process comprising detection and determination of state of a cell selected with an internal address during an access cycle from an external circuit to the memory cell array software errors caused by cell state changes in the nonvolatile memory can be prevented without degrading the performance of the nonvolatile memory.

With the flash memory of this embodiment cells with defective charge retention are detected and the defective cells or the data stored in the defective cells are rescued by storing data stored in the defective cells in redundant cells reserved cells . First the method of the present embodiment for determining retention defective cells will be described referring to . Note hereinafter an example where four pieces of data are stored in each multi value cell will be described. shows a reference value VTM k for determining each logical value and a threshold value distribution transistor threshold voltage for a 4 value cell in a flash memory. similarly shows a reference value VTM k for determining each logical value and a threshold value distribution for a 4 value cell in the flash memory of the present embodiment. The Y axis in each of the figures shows the cell threshold value and the X axis shows the number of cells. The threshold value of the cells which correspond to the logical values has a variance.

With reference to the logical value of each cell can be determined by comparing the threshold value of each cell and a reference value VTM. For instance in the example of VTM VTM is determined to have a logical value of 00 VTM VTM VTM a logical value of 01 VTM VTM VTM a logical value of 10 and VTM VTM a logical value of 11 .

In this case the cell charge will leak over time such that the threshold value of the retention defective cell will shift to the threshold value designated by a b or c in . The threshold value of the cell with a logical value of 00 can be presumed to change to a the threshold value of the cell with the logical value of 01 to change to b and the threshold value of the cell with the logical value of 10 to change to c . The memory device of this embodiment compares the threshold value of each cell to a reference value and cells which have a threshold value within a specific range are determined to bed efective cells and the data is then stored in a redundant cell.

As shown in the determination of defective cells can be made using six reference values. The six reference values consists of three reference value pairs with different values VTM k L VTM k U and a cell which have a threshold value between a specific reference value pair is determined to be defective cell with a logical value which correspond to the specific reference value pair. Specifically If VTMU VTM VTML the cell is determined to be a defective cell with a logical value of 00 if VTMU VTM VTML the cell is determined to be a defective cell with a logical value of 01 and if VTMU VTM VTML the cell is determined to be defective cell with a logical value of 10 .

Thus the memory device of the present embodiment prepares a reference field reference value range corresponding to each logical value and if the threshold value of the cell is within that field the cell is determined to be defective and the data of the defective cell is stored in a redundant cell. Therefore if the threshold value drops because the cell charge leaks over time the data which is stored can be rescued. Next several configurations will be described referring to the drawings.

Memory cell array comprises a plurality of sectors 4 sectors are shown in as an example . In the read write process of memory cell array Memory cell array is accessed on a sector to sector basis. In the writing process data deletion and data programming are performed in the sector selected by the sector switching circuit during the E Erase W Write process.

The memory cell check is performed on each sector selected by the sector switching circuit during Vt threshold value check. In this embodiment during the write cycle cell check is performed in a different sector than the sector where writing is being performed. Furthermore check is performed during each write cycle. During Vt checking the sector switching circuit selects the sector to be checked based on a control signal from a threshold value voltage measurement control circuit . The threshold value voltage measurement control circuit determines if write access is being carried out based on external commands and if writing process is being performed the defective cell check process will be performed. Furthermore the threshold value voltage measurement control circuit acquires the writing process address data from the outside and determines the sector to be subject to the check based on that address. Sectors to be checked are selected from sectors different than the sector being accessed in the writing process in order to prevent conflicts with normal operations.

The memory cell check is preferably performed on all of the memory cells in one or a plurality of sectors during a single write cycle. Therefore error cell check and data substitution can efficiently be performed for the memory device which is accessed by each sector. The threshold voltage measurement control circuit comprises a sector flag and records the last check completed sector or a sector which should be checked next . In the next check the check sector will be selected and decided by the sector ID recorded in the sector flag .

Sectors and memory cells in each sector will be uniformly checked in the memory cell array check. Specifically each sector can be uniformly checked by successively checking the memory cells of each sector according to the sector ID recorded in the sector flag . The threshold voltage measurement control circuit comprises an address counter and the address of the cell to be checked is sequentially designated by this address counter . The checked cells are accessed in accordance with the internal addresses generated separately from the external addresses for normal operation.

The memory cell threshold voltage measurement and error cell determination are performed by the threshold voltage measurement and determination circuit . The threshold voltage measurement and determination circuit measures the threshold voltage of the checked cell and determines if the measured threshold value is within a predetermined reference voltage range by comparing to a reference value. If the checked cell falls within the predetermined reference voltage range the cell will be determined to be an error cell. The determination method for the threshold voltage measurement and determination circuit is as described above with reference to B. Furthermore the threshold value voltage can be determined by measuring this cell current. This point will be described later on. The threshold voltage measurement and determination circuit measures the threshold voltage of the memory cell and determines if the memory cell is a defective cell using the address acquired from the threshold voltage measurement control circuit .

If the memory cell is determined to be a defective cell by the threshold voltage measurement and determination circuit the data stored in the defective cell will be recorded in a redundant cell of the redundant cell group . The threshold voltage measurement and determination circuit determines the proper logical value of the defective cell and outputs to the redundant cell read write circuit an internal address which designates the address of the redundant cell and the logical data. The redundant cell read write circuit writes the logical value data to the designated address. Each redundant cell of the redundant cell group preferably stores one bit of data. Therefore the occurrence of defective cells in the redundant cells can be limited. In this example four values were recorded in one memory cell. Therefore the redundant cell group can record the logical value of each memory cell by recording two bit data in one address.

If the data of memory cell array is substituted into redundant cell group the external address which designates the memory cell in the read operation must be replaced with a redundant cell address substitution address which designates the redundant cell. A substitution address setting and selection circuit acquires an external address and corresponding substitution address from the threshold value voltage measurement and determination circuit and sets up the address. Furthermore if a read access is made for the defective cell the external address will be changed to the corresponding substitution address.

The substitution address which was converted by the substitution address setting and selection circuit is input to the redundant cell read write circuit . The redundant cell read write circuit reads the requested data from the redundant cell group in accordance with the input substitution address that was input and outputs to the data bus not shown in the drawings . The data is externally output through an input output circuit not shown in the drawings . The logical value of the memory cell can be changed by data writing so the substitution address setting and selection circuit clears or resets the substitution address if data delete and data programming in the sector are performed.

Note with flash memory the check process is preferably performed during the writing process cycle which accompanies the data deletion but it is also possible to perform the check during the read process.

The threshold voltage measurement and determination circuit can check the memory cell array in a predetermined address order and resume the check processing from an address next to a checkcompleted address if the check processing is suspended.

Memory device comprises a command counter . The command counter counts the number of read commands and write commands issued number of command acquisitions to the memory cell array . The counted data is input to the threshold voltage measurement control circuit . The threshold voltage measurement control circuit has predetermined values for both the number of read commands and write commands. If either one of the read commands or write commands reaches this predetermined value the threshold voltage measurement control circuit will performs checking for defective cells in the memory cell array .

If the memory device is primarily used for reading data such as with ROM or if data writing is performed frequently the use of various different forms is possible. By inspecting based on the number of both read and write commands inspecting for defective cells can be performed within a designated period of time for memory devices which can be used in a variety of applications. Other than the above construction designs which are essentially the same as memory device will be described while referring to .

The check operation for the memory device will be described while referring to the flowchart of . Note first a normal external read or write command is input S . The command counter increases the count by 1 depending on the input command S The threshold voltage measurement control circuit acquires a process command and determines whether or not the process is a writing process S . If the process is a read process rather than a writing process the read process will be executed for the memory cell array S . If the process is a writing process normal writing will be performed. Data deletion and data programming are performed at a designated field S . Furthermore a verify process may be performed if necessary S .

In parallel with a normal writing process the check for defective cells is performed as a background process. The threshold voltage measurement control circuit acquires the counted number from the command counter and determines whether the number of read commands or write command is at the predetermined value N S . If the level of N is not met the check process will not be performed and the system waits for the next command input. If the number of read commands or write commands is at the predetermined value N the threshold voltage measurement control circuit sets the memory cell address check address to be inspected by the threshold voltage measurement and determination circuit S . The threshold voltage measurement and determination circuit measures the memory cell threshold value of the check address S . Furthermore the defective cell determination is performed by comparing to a reference value S .

If the cell is determined to not be defective the inspected sector is recorded by the sector flag S . If a cell is determined to be defective the inspected sector is recorded by the sector flag S and the data from the defective cell is recorded to a designated address in a redundant cell group by the redundant cell read write circuit S . Furthermore the substitution address of the redundant cell group which corresponds to the memory cell address is set by a substitution address setting and selection circuit S . Next a decision is made of whether or not the check in the specified sector is complete S and if not complete the next address will be set S and the check continued but if completed the checked process will terminate.

Note the memory device of the present embodiment 20 counts the number of read commands and write commands and if either one reaches a predetermined value the defective cell checked will be performed but it is also possible to count only one of the read or write commands and to perform the defective cell check based on that count. The predetermined values for the different commands can be identical or different values.

In the above embodiment the defective cell check process is performed depending on the number of acquired commands. However depending on the memory device access to the memory cell array may be extremely limited. In these cases a situation can be imagined where the memory cell array check is not carried out within the necessary time period. The memory device of this embodiment inspects the main cell array when the memory device is powered on or when the memory device is selected and activated by a control signal after it is turned on. Therefore the memory cell threshold value can be prevented from changing to a different logical value range.

The memory device comprises a power voltage detection circuit . The power voltage detection circuit detects whether or not the power voltage of the memory device is above a reference value and if the power is detected to be ON the threshold voltage measurement control circuit will receive a control signal. If the power voltage detection circuit detects that the power is on the threshold voltage measurement control circuit will start inspecting the memory cell array depending on the signal from the power voltage detection circuit . Check of the memory cell array is identical to the other aforementioned embodiments so the description will be omitted. When the power is ON the defective cell check will be performed on the cells of a designated sector number or on all of the sectors of the memory cell array .

In the present embodiment the threshold voltage measurement control circuit also performs check based on a chip select signal. Specifically when the chip select signal is selected and the memory device is detected to be activated the threshold voltage measurement control circuit begins the memory cell array check similar to when the power is turned ON. The check method is the same as when the power is turned ON. Note the memory device may also perform check of the memory cell array either when the power is turned ON or when activated. Alternatively the structure of the present embodiment may also be a combination of other embodiment structures. The check timing and frequency can be selected to be optimal for the memory device in accordance with the design.

The detailed structure of a preferred embodiment of a memory device of the present invention will be described. The detailed structure of an embodiment corresponding to the memory device described in Embodiment 1 will be described below. A sector SECO of the memory cell array is displayed in . The sector comprises a main cell field MCO which comprises multiple memory cells. Furthermore the sector also comprises the redundant cell field RCO which stores the data from the defective cell of the main cell field .

Reading and writing data to themain cell field is performed through a read write circuit SWO . The read write circuit accesses the main cell field in accordance with addresses specified by an X decoder XDEC a Y decoder YDEC a Y selector YSEL and a sector decoder SDEC .

Furthermore data read write to the redundant cell field is performed through a redundant cell read write circuit RSA RWC . The redundant cell read write circuit accesses the redundant cell field in accordance with addresses specified by a redundant cell X decoder RXDEC a redundant cell Y decoder RYDEC a redundant cell Y selector RYSEL and a sector decoder SDEC . Each of the decoders and the read write circuit are supplied with a high voltage from a high voltage generating circuit PUMP in order to delete and write data.

First the structure relating to the defective cell check and the defective cell data substitution during the write cycle will be described. Address data and control data are input to the memory device from the outside. In the double lines show an input output terminal for external data. The address data A A is buffered in an address buffer ADB ADB . Furthermore the control data from the outside is buffered in a control input buffer CTB . A chip select signal CE a write enable signal WE an output enable signal OE and a reset signal Reset or the like are shown as examples of control signals from the outside.

The command decoder CDEC acquires the control data from the control input buffer and determines whether or not the access is a writing process delete program . If determined to be a writing process the command decoder sets the output signal ER to level H. The output signal ER is input to a redundant cell control circuit REDCON . The redundant cell control circuit determines whether or not the checked sector matches the access sector using an external address. The redundant cell control circuit records the sector ID which internally specifies the next sector to be inspected and thereby makes a determination.

The redundant cell control circuit sets the sect signal to level H if the sectors do not match. Furthermore the redundant cell control circuit also generates and outputs an internal address adi adi which specifies a checked cell. A background read is performed in order to inspect for defective cells in accordance with this internal address. On the other hand if the sectors do not match the redundant cell control circuit sets the sect signal to level L. Furthermore an internal address is not generated and background reading is prohibited.

The sect signal and the internal address adi adi are input to the external address ade internal address adi switching circuit X X . The external address internal address switching circuit switches the addresses depending on the sect signal and outputs an address ad ad . If the sect signal is at level H and a background read directive is made the external address internal address switching circuit selects and outputs an interval address. Note during normal operation the external address internal address switching circuit selects and outputs an external address.

When the inspecting process is performed the selectively output internal address ad ad is input to the main cell field decoders and the memory cell of the designated address is selected. A read determination circuit COMO which reads the signal from the selected cell determines the cell state of the selected cell. Specifically the read determination circuit COMO measures the threshold voltage of the cell by detecting the cell current and by comparing to a reference value and determines whether or not the threshold value is at one of the levels a b or c which were described in reference to .

If the threshold value of the inspected cell is in any of the aforementioned ranges the cell is determined to be a defective cell and a redundant cell activation control circuit REDA outputs a READACT signal in accordance with control signals CP CP from the read determination circuit . If the cell is determined to be defective the READACT signal is set to level H. Fuses F F record the internal address internal address which is the address of the main cell field in accordance with the READACT signal. Furthermore the data of this address is recovered by a data recovery circuit RDI . The data recovery circuit performs data recovery in accordance with the signal UF UF UF from the read determination circuit . The data is then written to the designated address of redundant cell field by the redundant cell read write circuit .

Note the fuse is set by the output signal FREST of the fuse reset circuit FRST and clears the recorded data before the field which includes the address being recorded is deleted.

Next components for reading the substituted data in the redundant cell field will be described. In read mode when the external addresses ade ade are input the RXDEC access circuit ROX and the RYDEC access circuit ROY compare and determined whether or not the address recorded by the fuse matches the external address. If the addresses do not match normal reading will be performed from the main cell field .

If the addresses do match the redundant cell X decoder and the redundant cell Y decoder will be activated in accordance with the respective control signals ACTRX and ACTRY from the RXDEC access circuit and the RYDEC access circuit . The redundant cell read write circuit reads the data from the specific redundant cell selected by the control signals ACTREX ACTRY and outputs the data to a redundant cell internal bus DBR DBR . A redundant cell access circuit RC outputs a control signal ROUT in accordance with the respective control signals ACTRX ACTRY from the RXDEC access circuit and the RYDEC access circuit .

A bus switching circuit SW switches the output to an input output data bus DB DB . If the data from the main cell field has been read the main cell input output data bus DBM DBM will be selected. If the data from the designated address of the redundant cell field is read as described above the bus switching circuit will select the redundant cell internal bus based on the control signal ROUT from the redundant cell access circuit .

The detailed structure of several of the component elements of the memory device described while referring to will be described below.

The internal address counter successively increments and outputs an internal address which specifies the checked cell based on the ER signal. The internal address is output to the other circuit components and recorded in the register . The determination circuit unit compares the address ade which designates a sector in the external address with the internal address adir which is output from the register and determines whether or not the two sectors match. The determination circuit unit outputs L if the sectors match or H if the sectors do not match as the control signal sect. If the sector flags are all 1 the internal addresses will all be reset.

The encoder circuit comprises encoder circuit units EC EC which are assigned to each I O field. During reading each encoder circuit unit encodes the output from the read circuit and outputs to the main cell internal bus . During writing the data from the main cell internal bus is provided to a write circuit. For example EC encodes the outputs of SA during reading and outputs data to the buses DBM and DBM and during writing the data from DBM and DBM is output to W. Note PP represents the high voltage signal supplied from the high voltage generating circuit .

The cell read circuit comprises a reference circuit REF . The memory cell MC is a 4 value cell so the reference circuit comprises three reference circuit units Ref with different threshold values. Each of the reference circuit units comprises three reference cells MR with different threshold values and the threshold value of each cell is set to VTM VTM or VTM in order. The reference circuit unit has the same construction as the memory cell and the circuit components connected thereto and comprises transistors MRY and transistors for data writing MRD . A power source voltage CC is input to the gate of the transistor and a write input signal DiR is input to the gate of the transistor . The high voltage signal PP is input to each of the reference cells through the transistor .

The read circuit comprises a BIOS circuit which provides BIOS support at startup for memory cell . The BIOS circuit comprises a resistor RL a transistor MS which is vertically connected to resistor and an inverter IS which is connected between the source and gate of the transistor . A BIOS circuit of the same construction is connected to each of the reference circuit units .

The read signal from the memory cell and each of the reference cells is input to comparator detectors DIFF through the BIOS circuits . Each of the comparator detectors DIFF compare the read signal SA with each of the read signals RA from the reference cell . Each of the comparator detectors outputs a signal S S based on the comparison results.

During the threshold voltage check of memory cell the read signal SA from the memory cell is input to a read determination circuit . The read determination circuit determines whether or not the read signal SA from the memory cell is within a specified range by comparing the read signal SA with a reference value. shows the circuit components of the read determination circuit . In this embodiment 16 bits eight cells of data are designated by one address so the read determination circuit comprises eight read determination circuit units COMPQ with identical circuit components for each cell. The details of one of these read determination circuit units COMP will be described below. The read determination circuit unit comprises a reference circuit REF comparator detectors DIFFC and an encoder ECC .

As described in reference to read determination circuit unit compares the read signal SA with reference values. Therefore the reference circuit comprises six reference circuit units Ref C corresponding to each reference value. The basic configuration of the reference circuit unit is essentially similar to the reference circuit unit of the cell read circuit and comprises reference cells MR transistors MRY write transistors MRD and a BIOS circuit .

The reference cells are each set to have different threshold values and are set to VTMU VTML VTMU VTML VTMU and VTML in order. The power supply voltage CC is input to the gate of each of the transistors . During data write the high voltage signal PP is input to each of the reference cells through a write transistor which is controlled by the data write input signal DiR. The construction of a BIOS circuit is identical to the BIOS circuit described with reference to and has a function to provide BIOS support during start up.

The comparator detectors each compare the read signals RAC from the reference cell with the read signal SA. Specifically each of the comparator detectors successively and respectively compares signal SA and signal RAC and outputs signal SC compares signal SA and signal RAC and outputs signal SC compares signal SA and signal RAC and outputs signal SC compares signal SA and signal RAC and outputs signal SC compares signal SA and signal RAC and outputs signal SC and compares signal SA and signal RAC and outputs signal SC.

Each of the output signals SC SC from the comparator detector is input to the encoder . The encoder determines the cell state of the memory cell from the output signals SC SC . show the circuit configuration of the encoder and the relationship between the output signal of the comparator detector and the cell state of memory cell . As shown in the table of the cell state of the memory cell can be specified by the combination of the logical level of the six output signals SC SC . The encoder generates a signal which shows the cell state from the output signal of the comparator detector .

The specific circuit structure of the encoder is shown in . Encoder comprises 12 two input AND circuits AND . Signal SC and signal SCO from inverter are input to the AND1 circuit . Signal SCO from inverter and signal SC from inverter are input to the AND2 circuit . Signal SC from inverter and signal SC from inverter are input to the AND3 circuit

Signal SC and signal SC are input to AND4 circuit . Signal SC and signal SC and signal SC from inverter are input to AND5 circuit . Signal SC from inverter and signal SC from inverter are input to AND6 circuit

Signal SC and signal SC are input to AND 7 circuit . Signal SC and signal SC are input to AND8 circuit . Signal SC and signal SC from inverter are input to AND9 circuit

Signal SC and signal SC from inverter are input to the AND10 circuit . Signal SC and signal SC from inverter are input to AND11 circuit . Signal SC and signal SC from inverter are input to AND12 circuit .

The outputs from AND circuits are input to NAND1 circuit . Furthermore the output signal from NAND1 circuit is output as signal UF through inverter . The outputs from AND circuits are input to an NAND2 circuit . Furthermore the output signal from NAND2 circuit is output as signal UF through inverter . The output of AND circuits are input to a NAND3 circuit . Furthermore the output signal from NAND3 circuit is output as signal UF through inverter . The output from AND circuits are input to a NOR1 circuit . Furthermore the output signal from NOR1 circuit is output as signal CP through inverter

Signal CP shows whether the memory cell state is defective or not. If the cell state is at any of a b or c the signal CP will be at level H. If the cell state is normal signal CP will be at level L. On the other hand signals UF UF show the defect details of the cell state. For instance if the memory cell has an a state denoting a 00 defect UF UF UF will be at levels H L L . If the memory cell has an b state denoting a 01 defect UF UF UF will be at levels L H L . If the memory cell has an c state denoting a defect UF UF UF will be at levels L L H .

The defective cell detection signals CP CP from the read determination circuit are input to the redundant cell activation control circuit REDA . The redundant cell activation control circuit determines whether or not the inspected cell is a defective cell using the signals CP CP shows the circuit structure of the redundant cell activation control circuit . The redundant cell activation control circuit has four OR circuits OR . Each OR circuit is a two input circuit and signals CP CP are input.

Specifically signals CP and CP are input to the AND21 circuit . Signals CP and CPO are input to the AND22 circuit . Signals CP and CP are input to the AND23 circuit . Signals CP and CP are input to the AND24 circuit . The outputs of each AND circuit are input to the NOR21 circuit and output through inverter IVC as the READACT signal.

The defective state designating signals UF UF from the read determination circuit are input to a data recovery circuit RDI . The data recovery circuit generates the original logical value data from the input signal. shows the circuit configuration of the data recovery circuit . The data recovery circuit comprises eight recovery circuit units RDI RDI corresponding to eight cells of data. Each of the recovery circuit units has the same structure and the structure of recovery circuit units RDI will be described.

The memory cell is a four value cell so the recovery circuit unit outputs bit data DBR DBR based on the defective state designating signals UF UF . Note DBR designates the redundant cell internal data bus but in order to simplify the description DBR will be used to represent the data output from the bus. In the recovery circuit unit each of the signal lines of the 2 bit data is connected to the power source potential CC and the GND potential through a transistor. Each transistor is controlled by a defective state designating signal UF UF and the electric potential based on the defective state designating signal UF UF is supplied to each of the signal lines of the 2 bit data.

Specifically the signal line of the signal DBR is connected to the GND potential through N type transistor MRD and P type transistor MRD to the power source potential CC through N type transistor MRD and P type transistor MRD and to the GND potential through N type transistor MRD and P type transistor MRD 

The N type transistor and the P type transistor are controlled by the signal UF the signal UF is input to the gate of the N transistor and the inverse signal NUF of the signal UF is input to the P type transistor through an inverter INVRD 

The N type transistor and the P type transistor are controlled by the signal UF the signal UF is input to the gate of the N type transistor and the inverse signal NUF of the signal UF is input to the P type transistor through an inverter INVRD 

The N type transistor and the P type transistor are controlled by the signal UF the signal UF is input to the gate of the N transistor and the inverse signal NUF of the signal UF is input to the P type transistor through an inverter INVRD . On the other hand the signal line of the signal DBR is connected to the GND potential through N type transistor MRD and P type transistor MRD to the GND potential through N type transistor MRD and P type transistor MRD and to the power source potential CC through N type transistor MRD and the P type transistor MRD 

The N type transistor and the P type transistor are controlled by the signal UF the signal UF is input to the gate of the N transistor and the inverse signal NUF of the signal UF is input to the P type transistor through an inverter INVRD 

The N type transistor and the P type transistor are controlled by the signal UF the signal UF is input to the gate of the N transistor and the inverse signal NUF of the signal UF is input to the P type transistor through an inverter INVRD 

The N type transistor and the P type transistor are controlled by the signal UF the signal UF is input to the gate of the N transistor and the inverse signal NUF of the signal UF is input to the P type transistor through an inverter INVRD 

If the memory cell state is a signifying a 00 defect then UF UF UF will be H L L so DBR DBR will be 0 0 . If the memory cell state is b signifying a defect then UF UF UF will be L H L so DBR DBR will be 0 1 . If the memory cell state is c signifying a 10 defect then UF UF UF will be L L H so DBR DBR will be 1 0 .

The corrected data which is output to the redundant cell internal bus is recorded by the redundant cell read write circuit RSA RWC in the redundant cell field . is a block diagram showing an outline of the circuit configuration of the redundant cell read write circuit . The redundant cell read write circuit comprises read circuits SAR and write circuits WR WR corresponding to each of the 16 bits. The read circuits SAR k and the write circuits WR k are connected to the redundant cell internal bus DBR k .

The data read from redundant cell field is transferred by the redundant cell internal bus and output externally through the bus switching circuit SW . shows the circuit configuration of bus switching circuit . Bus switching circuit switches the bus which is connected to the input output data bus DB according to a control signal ROUT. If the control signal ROUT is H the data of the redundant cell internal bus will be output to the input output data bus . If the control signal ROUT is L the data from the main cell internal bus will be output to the input output data bus .

In reference to each bus of the input output data bus is connected to each bus of the redundant cell internal bus and each bus of the main cell internal bus . By controlling the transistor using the control signal ROUT the bus connected to the input output data bus can be selected. An embodiment of the input output data bus DB will be described. The input output data bus DB is connected to the redundant cell internal bus DBR through an N type transistor MSW and a P type transistor MSW and is connected to the main cell internal bus DBM through an N type transistor MSW and a P type transistor MSW 

The control signal ROUT is input to the gates of the N type transistor and the P type transistor and the control signal NROUT which is inverted by an inverter circuit INVSW is input to the gates of the P type transistor and a N type transistor . Therefore when control signal NROUT is H the data from the redundant cell internal bus DBR will be carried on the input output data bus DB . The other buses are identical.

It is apparent that the present invention is not limited to the above embodiment that may be modified and changed without departing from the scope and spirit of the invention. For example the present invention is described above using a flash memory embodiment but for instance the present invention can also be applied to other types of memory devices such as FeRAM or the like. For instance with FeRAM polarization characteristics will be measured in place of the threshold value of the flash memory in order to determine a defective cell.

