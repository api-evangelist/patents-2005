---

title: Authentication of a principal in a federation
abstract: Methods, systems, and computer program products are disclosed that give entities flexibility to implement custom authentication methods of other entities for authentication of a principal in a federation by authenticating the principal by an identity provider according to a service provider's authentication policy and recording in session data of the identity provider an authentication credential satisfying the service provider's authentication policy. Authentication of a principal in a federation is also carried out by authenticating the principal by the identity provider according to an identity provider's authentication policy. Authentication of a principal in a federation is further carried out by receiving in the identity provider an authentication request from the service provider, the authentication request specifying the service provider's authentication policy.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08418234&OS=08418234&RS=08418234
owner: International Business Machines Corporation
number: 08418234
owner_city: Armonk
owner_country: US
publication_date: 20051215
---
The field of the invention is data processing or more specifically methods systems and products for authentication of a principal in a federation.

A federation is a collection of administered security spaces. A federation may implement single sign on functionality in which an access manager in one federated security space relies on an access manager in another security space for authentication services. The authentication process of federated access managers currently is limited to off the shelf authentication methods and custom authentication methods known to or installed upon a particular access manager. A change in authorization requirements for a principal during a single sign on session such as for example a step up requirement may readily be accomplished with off the shelf authentication methods because an access manager typically knows how to utilize the off the shelf authentication methods. Support for multiple custom methods of other security domains within a federated environment however is not easily accomplished because an access manager in the current art is not equipped to carry out authentication according to custom requirements of entities in another security space or domain. Approaches by current access managers are not flexible enough to implement custom authentication methods of other entities involved in the authentication process.

Methods systems and computer program products are disclosed that provide additional flexibility for authentication of a principal in a federation by authenticating the principal by an identity provider according to a service provider s authentication policy and recording in session data of the identity provider an authentication credential satisfying the service provider s authentication policy. Authentication of a principal in a federation is also carried out by authenticating the principal by the identity provider according to an identity provider s authentication policy. Authentication of a principal in a federation is further carried out by receiving in the identity provider an authentication request from the service provider the authentication request specifying the service provider s authentication policy.

Authentication of a principal in a federation is still further carried out by receiving in the service provider a request of the principal for access to a resource of the service provider determining by the service provider that an authentication credential of the request does not satisfy the service provider s authentication policy and sending by the service provider to the identity provider an authentication request specifying the service provider s authentication policy. Authentication of a principal in a federation is also carried out by receiving an authentication response by the service provider from the identity provider the authentication response including the authentication credential satisfying the service provider s authentication policy and recording in session data of the service provider the authentication credential.

Authentication of a principal in a federation includes authenticating the principal by an access manager of the identity provider. Authentication of a principal in a federation also includes authenticating the principal by an authentication proxy of the identity provider.

The foregoing and other objects features and advantages of the invention will be apparent from the following more particular descriptions of exemplary embodiments of the invention as illustrated in the accompanying drawings wherein like reference numbers generally represent like parts of exemplary embodiments of the invention.

Exemplary methods systems and products for authentication of a principal in a federation according to embodiments of the present invention are described with reference to the accompanying drawings beginning with . sets forth a network diagram illustrating an exemplary system for authentication of a principal in a federation according to embodiments of the present invention. The system of operates generally to authenticate a principal in a federation according to embodiments of the present invention by authenticating a principal by an identity provider according to a service provider s authentication policy and recording in session data of the identity provider an authentication credential satisfying the service provider s authentication policy.

A federation is a collection of administered security spaces in which a source and a target of a resource request can determine and agree whether particular sets of security information from a source satisfy a relevant security policy of a target. In the example of an administered security space of federation is divided by logical boundary into principal identity provider and service provider each capable of being a source or a target of a request. Whether a target s security policy is satisfied by the source s security information may be determined by an entity other than the source or target of a resource request. For example with regard to a source of a resource request may be principal a target of the request may be service provider and identity provider may determine whether service provider s security policy is satisfied by the principal s security information.

A principal is any entity that can be granted security rights or that makes assertions about security or identity. A principal may be for example a person that provides a username and password through a web browser to access banking services on a web server. Entities capable of acting as principals are not restricted to people. Entities capable of acting as principals may also be other entities such as for example a web service client that provides an X.509 certificate to access a resource on another web service. In the example of principal makes assertions about security or identity for authentication by identity provider .

Authentication is a process of validating an identity asserted by an entity requesting access to a protected resource. Validation of an entity s identity occurs by verifying security information provided by the entity. Security information is the information provided by an entity that distinguishes the identity of an entity providing security information from the identity of other entities. Security information may include for example a name a social security number a username and password a Kerberos ticket an X.509 certificate and so on. In the example of identity provider validates the identity of principal by verifying security information provided by principal when attempting to access a resource on service provider or identity provider .

Security information of an entity may be used to create authentication credentials for an entity. An authentication credential represents the security privileges of an entity in a security space of a federation. Authentication credentials describe an entity for a specific session and are valid for the lifetime of that session. Authentication credentials may include for example an entity name any group memberships the type of security information used to authenticate a principal and any other security attributes.

A service provider is an entity that provides a principal access to a resource. Service provider of is capable of receiving a request of a principal for access to a resource of a service provider determining that an authentication credential of the request does not satisfy the service provider s authentication policy sending to an identity provider an authentication request specifying a service provider s authentication policy receiving an authentication response from an identity provider that includes the authentication credential satisfying a service provider s authentication policy and recording in session data of the service provider the authentication credential. A service provider may for example be an investment company providing access to retirement account information an airline providing flight and ticketing data a university providing curriculum information or any other service provider as will occur to those of skill in the art.

An identity provider is an entity that maintains a principal s identity information and verifies security information provided by a principal to a service provider in a single sign on environment. Identity provider of is capable of authenticating a principal according to an identity provider s authentication policy receiving an authentication request from service provider that specifies a service provider s authentication policy in a single sign on environment authenticating a principal according to a service provider s authentication policy and recording in session data of an identity provider an authentication credential satisfying the service provider s authentication policy. Identity provider may for example be an employer a university a business entity or a government agency or any other identity provider as will occur to those of skill in the art.

Single sign on is an authentication sequence that removes the burden of repeating actions that are placed on a principal. Single sign on allows an identity provider having authenticated a principal based on security information to present authentication credentials of a principal to a service provider as proof of authentication. A service provider uses authentication credentials supplied by an identity provider to authenticate a principal and build a locally valid session for a principal without having to prompt a principal for previously supplied security information. Consider for example an employee acting as a principal an employer serving as an identity provider and an investment company acting as a service provider where an employee attempts to access a 401K at the investment company through the employer s website and where the employer s website has authenticated the employee through a username and a password. In a non single sign on environment the employee must authenticate twice. The employee first authenticates when accessing the employer s website by providing a username and password. The second authentication occurs when the investment company requires the employee to again enter the username and password before the investment company authorizes the employee to access the employee s 401K. In a single sign on environment however the employee only authenticates once by providing a username and password to the employer because the investment company may authorize the employee to access the 401K based on the employee s initial authentication with the employer. The employee might be required to provide additional security information if the investment company requires a method of authentication other than providing a username and password such as for example a Kerberos ticket or an X.509 certificate. The employee however would not be required to again provide the employee s username and password in a single sign on environment.

The system of includes a wide area network WAN a WAN and a WAN that interconnect through network connections and . The network connection aspect of the architecture of is only for explanation not for limitation. In fact systems for authentication of a principal in a federation may be connected as LANs WANs intranets internets the Internet webs the World Wide Web itself or other connections as will occur to those of skill in the art. Such networks are media that may be used to provide data communications connections between various devices and computers connected together within an overall data processing system.

In the example of servers and implement a gateway router or bridge between WANs and . In the example of several exemplary devices including a server and a server are connected to the WAN . Server connects to the network through a wireline connection and server connects to the network through a wireline connection .

In the example of several exemplary devices including a server and a server are connected to the WAN . Server connects to the network through a wireline connection and server connects to the network through a wireline connection .

In the example of several exemplary devices including a server computer workstation a PDA a laptop a network enabled mobile phone and a personal computer are connected to the WAN . Server connects to the network through wireline connection computer workstation connects to the network through a wireline connection PDA connects to the network through a wireless link network enabled mobile phone connects to the network through a wireless link laptop connects to the network through a wireless link and personal computer connects to network through wireline connection .

In the system of each of the exemplary devices includes a computer processor and computer memory coupled for data transfer to the processor. The computer memory of each of the computers and of identity provider of and the computer memory of each of the computer and of service provider of has disposed within it computer program instructions comprising an authentication proxy. The authentication proxy is capable generally of authentication of a principal in a federation by authenticating the principal by an identity provider according to a service provider s authentication policy and recording in session data of the identity provider an authentication credential satisfying the service provider s authentication policy.

The authentication proxy is also capable generally of authentication of a principal in a federation by authenticating the principal by the identity provider according to an identity provider s authentication policy. The authentication proxy is also capable generally of receiving in the identity provider an authentication request from the service provider the authentication request specifying the service provider s authentication policy. The authentication proxy is also capable generally of receiving in the service provider a request of the principal for access to a resource of the service provider determining by the service provider that an authentication credential of the request does not satisfy the service provider s authentication policy and sending by the service provider to the identity provider an authentication request specifying the service provider s authentication policy. The authentication proxy is also capable generally of receiving an authentication response by the service provider from the identity provider the authentication response including the authentication credential satisfying the service provider s authentication policy and recording in session data of the service provider the authentication credential.

The arrangement of servers and other devices making up the exemplary system illustrated in are for explanation not for limitation. Data processing systems useful according to various embodiments of the present invention may include additional servers routers other devices and peer to peer architectures not shown in as will occur to those of skill in the art. Networks in such data processing systems may support many data communications protocols including for example TCP Transmission Control Protocol IP Internet Protocol HTTP HyperText Transfer Protocol WAP Wireless Access Protocol HDTP Handheld Device Transport Protocol and others as will occur to those of skill in the art. Various embodiments of the present invention may be implemented on a variety of hardware platforms in addition to those illustrated in .

For further explanation sets forth a block diagram of an exemplary system for authentication of a principal in a federation according to embodiments of the present invention. Federation of includes principal identity provider and service provider . Federation of implements a single sign on environment.

In the example of principal may be represented by person operating web browser . A web browser is a software application that displays documents hosted by web servers or held in a file system and formatted in for example the Hyper Text Markup Language HTML or the Handheld Device Markup Language HDML . Web browser of is capable of supporting redirects and automatic forwarding of requests and communicates with identity provider or service provider using a communications protocol such as for example the Hyper Text Transfer Protocol HTTP or the Wireless Application Protocol WAP . Web browsers useful in authentication of a principal in a federation according to embodiments of the present invention include for example Microsoft Internet Explorer Mozilla Firefox Opera Netscape Navigator Safari and any other web browser as will occur to those of skill in the art.

Principal of may also be represented by web service . A web service is a software application that supports interoperable machine to machine interaction over a network. Web service has a public interface that is described in a machine processable format such as for example Web Services Description Language WSDL . A WSDL description of a web service specifies the message format and communications methods for interacting with the web service. The most common message format for interacting with a web service is SOAP which is based on the eXtensible Markup Language XML while HTTP is the most common communication method. Other message formats for interacting with a web service include the Java Application Programming Interface for XML based Remote Procedure Calls JAX RPC XML Remote Procedure Calls XML RPC or any other messaging format as will occur to those of skill in the art. Other communication methods for interacting with a web service include the File Transfer Protocol FTP Simple Mail Transfer Protocol SMTP eXtensible Messaging and Presence Protocol XMPP and any other communication method as will occur to those of skill in the art.

A web service communicates with other webs services by using web service messages. A web service message is a self contained unit of data exchanged between web services that conforms to a message format specified in a WSDL description. Web service messages typically include XML and other web related content such as for example Multipurpose Internet Mail Extensions MIME parts enclosed in a SOAP envelope.

In the example of identity provider includes computer resource and service provider includes computer resource . Computer resources and are any aggregation of information any computer system for accessing such aggregations of information or any program process or thread of execution that provides data processing services or calculations on such a system. The most common kind of computer resource is a file but such resources may also include dynamically generated query results as well such as the output of CGI Common Gateway Interface scripts Java servlets dynamic server pages Active Server Pages Java Server Pages documents available in several languages and so on. In effect such resources are somewhat similar to files but more general in nature. Computer resources and represented by files include static web pages graphic image files video clip files audio clip files and so on. Computer resources and represented by computer systems include any component of computers or networks such as disk drives printers displays memory computer processors or any other components as will occur to those of skill in the art. Computer resources and represented by programs processes or threads of execution include web services.

Identity provider in the example of includes access manager . Access manager is a web service that controls access to computer resource and single sign on services of identity manager by providing authentication services session management services and authorization services to principal requesting access to resource or single sign on services of identity provider . Access manager authenticates a principal based on security information provided by the principal and creates authentication credentials for the principal s session with the access manager . Access manager authorizes a principal to access resource of identity provider or to participate in single sign on with identity manager based on authentication credentials of the principal s session. An example of an access manager that may be improved for authentication of a principal in a federation according to embodiments of the present invention is the IBM Tivoli Access Manager. Other access managers as will occur to those of skill in the art also may be improved for authentication of a principal in a federation according to the present invention.

In the example of access manager includes session manager . Session manager may be represented by a web service that manages session data by performing tasks such as session creation session destruction activity timeouts updating session data and so on. A session is a lasting connection between software applications involving an exchange of data between each application during the establishment maintenance and release of the connection. A session may contain connection information describing the session such as for example a session identifier session participants a session key authentication credentials authorization privileges and so on. Sessions may be maintained using a structure defined in the data being exchanged. For example an HTTP exchange between web browser and access manager may include an HTTP cookie that stores for example a unique session identifier that identifies session data such as for example the principal s preferences or authentication credentials to access manager . In the example of a session is represented by a data structure created and stored for its duration in the identity provider . In the example of the session manager manages session data of a session between principal and identity provider .

An access manager of also includes authentication manager . Authentication manager may be represented by a web service that authenticates principal according to an identity provider s authentication policy when principal accesses resource of the identity provider or when principal participates in the single sign on services of identity manager . The authentication manager compares security information provided by a principal with identity related information stored in user registry and records authentication credentials in the principal s session data through session manager . Authentication manager of may require different types of authentication depending on which principal requests a resource a type of resource requested or an authentication policy of a service provider participating in single sign on. For example authentication manager may require a username and password for authentication when principal accesses resource such as email or may require an X.509 certificate when principal accesses a service provider for investment banking services in a single sign on environment.

Identity provider of includes user registry . User registry is a database that stores identity related information of principal that may include for example a principal identifier a principal name email address physical mailing address office location system preferences security groups to which a principal belongs security privileges a principal s asymmetric public cryptographic key a principal s symmetric cryptographic key other identity related information and so on. In the example of user registry of identity provider is accessible by authentication manager authentication proxy and identity manager . In the example of an authentication manager an authentication proxy or an identity manager may access user registry using a directory access protocol such as for example the Lightweight Directory Access Protocol LDAP .

Identity provider of also includes identity manager . The identity manager may be represented by a web service that performs single sign on services for a principal authorized to participate in single sign on by access manager or authentication proxy . The identity manager may implement single sign on services in identity provider by exchanging web service messages with service provider and principal . In the example of identity manager receives an authentication request specifying a service provider s authentication policy from service provider requesting single sign on authentication of principal . Identity manager of creates an authentication response that includes the authentication credentials of the principal s session with the identity provider for service provider requesting single sign on authentication of principal . Identity manager may access authentication credentials of a principal s current session with an identity provider by exchanging a web service message with access manager . In addition identity manager obtains other identity related information of a principal from user registry . An example of an identity manager that may be improved for authentication of a principal in a federation according to embodiments of the present invention is the IBM Tivoli Identity Manager. Other identity managers as will occur to those of skill in the art also may be improved for authentication of a principal in a federation according to the present invention.

In the example of identity provider includes authentication proxy . The authentication proxy may be represented by a web service that authenticates an identity of principal to identity manager according to a service provider s authentication policy and records in session data of an identity provider an authentication credential satisfying the service provider s authentication policy. Authentication proxy determines whether authentication credentials of a principal s current session with identity provider satisfy a service provider s authentication policy by accessing the principal s session data through access manager . If the service provider s authentication policy is satisfied authentication proxy notifies identity manager through a web service message. If the service provider s authentication policy is not satisfied by the authentication credentials of a principal s current session with identity provider authentication proxy prompts the principal to provide additional security information for the session verifies the additional security information using identity related information of the principal stored in user registry records the additional authentication credentials satisfying the service provider s authentication policy in the principal s session data through the access manager and notifies the identity manager through a web services message that the service provider s authentication policy is satisfied. Authentication proxy of is implemented separately from access manager in the example of . Implementing authentication proxy in a separate module in this example is for explanation and not for limitation of the present invention. Authentication proxy of may for example be implemented as a module inside access manager inside authentication manager or inside any other module of identity provider as will occur to those of skill in the art.

In the example of service provider includes access manager and user registry . Access manager of includes session manager and authentication manager . In the example of access manager of service provider session manager of service provider authentication manager of service provider and user registry of service provider all have structure and operate in a manner similar to access manager of identity provider session manager of identity provider authentication manager of identity provider and user registry of identity provider .

Service provider of also includes an identity manager . Identity manager may be represented by a web service that performs single sign on services for principal authorized to participate in single sign on by access manager . Identity manager implements single sign on services in identity provider by exchanging security messages with identity provider and principal . In the example of identity manager receives a request of the principal for access to a resource of the service provider and determines whether an authentication credential of the request satisfies the service provider s authentication policy by accesses a principal s identity related information from user registry . The identity manager of sends an authentication request specifying the service provider s authentication policy to an identity provider if the principal s authentication credential of the request does not satisfy the service provider s authentication policy. Identity manager also receives an authentication response from identity provider that includes an authentication credential satisfying the service provider s authentication policy and records in the service provider s session data for the principal the authentication credential. An example of an identity manager that may be improved for authentication of a principal in a federation according to embodiments of the present invention is the IBM Tivoli Identity Manager. Other identity managers as will occur to those of skill in the art also may be improved for authentication of a principal in a federation according to the present invention.

Authentication of a principal in a federation in accordance with embodiments of the present invention is generally implemented with computers that is with automated computing machinery. In the system of for example all the nodes servers and communications devices are implemented to some extent at least as computers. For further explanation therefore sets forth a block diagram of automated computing machinery comprising an exemplary computer useful in authentication of a principal in a federation according to embodiments of the present invention. The computer of includes at least one computer processor or CPU as well as random access memory RAM which is connected through a system bus to processor and to other components of the computer.

Stored in RAM is an authentication proxy computer program instructions for authenticating a principal by an identity provider according to a service provider s authentication policy and recording in session data of an identity provider an authentication credential satisfying a service provider s authentication policy. Also stored in RAM is an access manager computer program instructions for authenticating a principal by an identity provider according to an identity provider s authentication policy. Also stored in RAM is an identity provider s identity manager computer program instructions for receiving in the identity provider an authentication request from the service provider the authentication request specifying the service provider s authentication policy. Also stored in RAM is a service provider s identity manager computer program instructions for receiving in the service provider a request of the principal for access to a resource of the service provider determining by the service provider that an authentication credential of the request does not satisfy the service provider s authentication policy sending by the service provider to the identity provider an authentication request specifying the service provider s authentication policy receiving an authentication response by the service provider from the identity provider the authentication response including the authentication credential satisfying the service provider s authentication policy and recording in session data of the service provider the authentication credential.

Also stored in RAM is an operating system . Operating systems useful in computers according to embodiments of the present invention include UNIX Linux Microsoft XP AIX IBM s i5 OS and others as will occur to those of skill in the art. Operating system authentication proxy access manager identity provider s identity manager and service provider s identity manager in the example of are shown in RAM but many components of such software typically are stored in non volatile memory also.

Computer of includes non volatile computer memory coupled through a system bus to processor and to other components of the computer . Non volatile computer memory may be implemented as a hard disk drive optical disk drive electrically erasable programmable read only memory space so called EEPROM or Flash memory RAM drives not shown or as any other kind of computer memory as will occur to those of skill in the art.

The example computer of includes one or more input output interface adapters . Input output interface adapters in computers implement user oriented input output through for example software drivers and computer hardware for controlling output to display devices such as computer display screens as well as user input from user input devices such as keyboards and mice.

The exemplary computer of includes a communications adapter for implementing data communications with other computers . Such data communications may be carried out serially through RS 232 connections through external buses such as USB through data communications networks such as IP networks and in other ways as will occur to those of skill in the art. Communications adapters implement the hardware level of data communications through which one computer sends data communications to another computer directly or through a network. Examples of communications adapters useful for determining availability of a destination according to embodiments of the present invention include modems for wired dial up communications Ethernet IEEE 802.3 adapters for wired network communications and 802.11b adapters for wireless network communications.

For further explanation sets forth a flow chart illustrating an exemplary method for authentication of a principal in a federation according to embodiments of the present invention. The method of implements a single sign on authentication sequence based on a push based protocol. Push based single sign on is an implementation of single sign on authentication that redirects a principal having authenticated with an identity provider to a service provider when the principal accesses a service provider s resource through an identity provider s domain such as for example through a portal webpage of an identity provider. When a principal is a web service client an identity provider may provide an authentication credential of the principal to a service provider by sending a web service message to the service provider through the principal using an HTTP redirect. When a principal is a person using a web browser an identity provider may provide an authentication credential of the principal to a service provider by including a pointer to a Security Association Markup Language SAML assertion in an HTTP redirect to a service provider. SAML is a standard of the Oasis Standards Organization. SAML consists of two distinct pieces of functionality an assertion and a protocol. A SAML assertion is used to transfer information about a principal while the SAML protocol is a means of exchanging a SAML assertion.

The method of includes authenticating a principal by an identity provider according to an identity provider s authentication policy and receiving in an identity provider an authentication request from a service provider that specifies a service provider s authentication policy. The identity provider s authentication policy in the example of is a set of claims and related security information required by an identity provider to authenticate a principal requesting access to a resource or participating in single sign on with an identity provider. An identity provider s authentication policy may require a principal to provide security information such as for example a username and password a symmetric cryptographic key an X.509 certification a Kerberos ticket or any other security related information as will occur to those of skill in the art. An identity provider uses security information provided by a principal to create authentication credentials that satisfy an identity provider s authentication policy.

In the method of authenticating a principal by an identity provider according to an identity provider s authentication policy includes receiving security information from a principal according to an identity provider s authentication policy . When a principal is represented by a person or a thread or process representing a person receiving security information from a principal satisfying an identity provider s authentication policy according to the method of may include an access manager s prompting a principal for security information through a user interface such as for example a computer screen or speech synthesizer. When a principal is represented by a web service client receiving security information according the method of may also include an access manager s specifying an identity provider s authentication policy in a web service message such as for example an XML representation of the identity provider s authentication policy enclosed in a SOAP envelope and transmitting the web service message by an access manager to the principal using a network protocol such as for example HTTP.

In the method of authenticating a principal by an identity provider according to an identity provider s authentication policy also includes verifying security information of a principal with identity related information stored in user registry . User registry is a database that stores identity related information of a principal that may include for example a principal identifier a principal name email address physical mailing address office location system preferences security groups to which a principal belongs security privileges a principal s asymmetric public cryptographic key a principal s symmetric cryptographic key other identity related information and so on. Verifying security information may include for example hashing a password provided by a principal in an authentication sequence and comparing to the hashed password to a hash of the principal s password previously stored in the user registry . Verifying security information may also include for example decrypting a message using a principal s asymmetric public cryptographic key stored in user registry where the message was digitally signed using a principal s asymmetric private encryption key. If a principal s security information is not verified an access manager of a identity provider can return a HTTP response indicating that access to the identity provider has been refused based on the principal s security information.

The method of also includes recording in session data of an identity provider an authentication credential satisfying the identity provider s authentication policy if a principal s security information is verified. Recording in session data of an identity provider an authentication credential may be carried out by creating an authentication credential from identity related data in user registry such as for example a principal identifier security groups to which the principal belongs security attributes and so on. Because the method of implements an initial authentication sequence of a principal with an identity provider no previous session existed for the principal with the identity provider.

Recording in session data of an identity provider an authentication credential according to the method of therefore may include creating a session of a principal with an identity provider. In the method of recording in session data of an identity provider an authentication credential may also include storing an authentication credential in session data of a principal with an identity provider. Session data of a principal with an identity provider is represented in this example as a data structure that associates a session identifier with a principal identifier and an authentication credential for the session. The authentication credential represents a principal s security privileges for the duration of a session.

In a push based single sign on environment according to the method of where authentication is carried out according to a service provider s authentication policy a service provider may require different authentication credentials to authenticate a principal than the authentication credentials provided by the identity provider. Rather than prompting a principal for additional security information directly a service provider requests authentication credentials from an identity provider satisfying the service provider s authentication policy.

The method of also includes receiving in an identity provider an authentication request from a service provider that specifies the service provider s authentication policy . Receiving in an identity provider an authentication request from a service provider may be carried out by receiving an authentication request in an identity manager of an identity provider at a web services endpoint described in a WSDL description of the identity manager. An authentication request from a service provider that specifies the service provider s authentication policy may be a web service message that includes an XML representation of the service provider s authentication policy placed in a SOAP envelope.

For further explanation sets forth a flow chart illustrating a further exemplary method for authentication of a principal in a federation according to embodiments of the present invention that includes receiving in an identity provider an authentication request from a service provider that specifies the service provider s authentication policy authenticating a principal by an identity provider according to a service provider s authentication policy and recording in session data of the identity provider an authentication credential satisfying the service provider s authentication policy.

The method of includes receiving in an identity provider an authentication request from a service provider that specifies the service provider s authentication policy . Receiving in an identity provider an authentication request from a service provider may be carried out by receiving an authentication request in an identity manager of an identity provider at a web services endpoint described in a WSDL description of the identity manager. An authentication request from a service provider that specifies the service provider s authentication policy may be a web service message that includes an XML representation of the service provider s authentication policy placed in a SOAP envelope.

Receiving in an identity provider an authentication request from a service provider that specifies the service provider s authentication policy according to the method of may occur when a principal participates in push based single sign on as discussed above with reference to . Receiving in an identity provider an authentication request from a service provider that specifies the service provider s authentication policy according to the method of may also occur when a principal participates in pull based single sign on. Pull based single sign on is an implementation of single sign on authentication that redirects a principal to an identity provider for single sign on when the principal attempts to access a resource on a service provider directly for example by typing in the URL of the service provider or by using a bookmark in a web browser. That is the principal does not access a service provider s resource through an identity provider such as for example through a webpage portal on a web server of the identity provider. In a pull based single sign on environment a service provider will request authentication credentials from an identity provider when a principal requests access to a resource of the service provider. The request of specifies a service provider s authentication policy .

In the method of authenticating the principal by an identity provider according to a service provider s authentication policy may be carried out by determining whether the service provider s authentication policy is satisfied by a current authentication credential in session data of a principal with an identity provider. Session data of a principal with an identity provider is represented in this example as a data structure that associates a session identifier with a principal identifier and an authentication credential for the session. The authentication credential represents a principal s security privileges for the duration of a session. Whether the service provider s authentication policy is satisfied by a current authentication credential in session data of a principal with an identity provider may be determined by an identity provider s identity manager. Session data may be obtained by an identity provider s identity manager from an identity provider s access manager.

If the service provider s authentication policy is satisfied by a current authentication credential in session data of a principal with an identity provider authenticating the principal by an identity provider according to a service provider s authentication policy according to the example of includes sending by an identity provider to a service provider an authentication response that includes an authentication credential satisfying the service provider s authentication policy. Sending by an identity provider to a service provider an authentication response according to the example of may include reading an authentication credential from session data of a principal with an identity provider. Sending by an identity provider to a service provider an authentication response according to the example of may include transmitting a web service message from an identity provider s identity manager to a service provider through a principal using an HTTP redirect.

Authentication response in the example of includes authentication credentials satisfying a service provider s authentication policy. Authentication response may be represented by a XML based web service message enclosed in a SOAP envelope. Authentication credential in the example of represents a principal s security privileges for the duration of a single sign on session with an identity provider. Authentication credential associates a user identifier with a session identifier a user group identifier and authorization attributes identifier . Authentication credentials of may be represented by a security token such as for example those security tokens described in the web services specification entitled Web Services Security WS Security developed by IBM Microsoft and VeriSign or the web services specification entitled Web Services Trust Language WS Trust developed by IBM Microsoft VeriSign OpenNetworks Layer 7 Computer Associates BEA Oblix Reactivity RSA Security Ping Identity and Actional.

If the service provider s authentication policy is not satisfied by a current authentication credential in session data of a principal with an identity provider authenticating the principal by an identity provider according to a service provider s authentication policy according to the example of includes either authenticating a principal by an access manager of an identity provider or authenticating a principal by an authentication proxy of an identity provider. In the method of authenticating a principal by an authentication proxy of an identity provider may be carried out by receiving security information satisfying a service provider s authentication policy. When a principal is a person or a thread or process representing a person receiving security information from a principal satisfying an identity provider s authentication policy according to the method of may include an access manager s prompting a principal for security information through a user interface such as for example a computer screen or speech synthesizer. When a principal is a web services client receiving security information according the method of may also include an access manager s specifying an identity provider s authentication policy in a web service message such as for example an XML representation of the identity provider s authentication policy enclosed in a SOAP envelope and transmitting the web service message by an access manager to the principal using a network protocol such as for example HTTP.

Authenticating a principal by an authentication proxy of an identity provider according to the method of may also be carried out by verifying security information of a principal with identity related information stored in a user registry. Verifying security information may include for example hashing a password provided by a principal in an authentication sequence and comparing to the hashed password to a hash of the principal s password previously stored in a user registry. Verifying security information may also include for example decrypting a message using a principal s public asymmetric cryptographic key stored in a user registry where the message was digitally signed using a principal s private asymmetric encryption key.

Authenticating a principal by an access manager of an identity provider according to the method of operates in a manner similar to authenticating a principal by an authentication proxy of an identity provider. In the method of authenticating a principal by an access manager of an identity provider may also be carried out by receiving security information satisfying a service provider s authentication policy and verifying security information of a principal with identity related information stored in a user registry.

The method of continues by recording in session data of an identity provider an authentication credential satisfying a service provider s authentication policy if the service provider s authentication policy is not satisfied by a current authentication credential in session data of a principal with an identity provider. Because no previous session may have existed for the principal with the identity provider the method of may occur during an initial authentication sequence of a principal with an identity provider. Recording in session data of an identity provider an authentication credential satisfying a service provider s authentication policy according to the method of may therefore include creating a session of a principal with an identity provider. In the method of recording in session data of an identity provider an authentication credential satisfying a service provider s authentication policy may also include storing an authentication credential in session data of a principal with an identity provider as a current authentication credential . Session data of a principal with an identity provider is represented in this example as a data structure that associates a session identifier with a principal identifier and an authentication credential for the session. The authentication credential represents a principal s security privileges for the duration of a session.

The method of continues with authenticating a principal by an identity provider according to a service provider s authentication policy by sending by an identity provider to a service provider an authentication response that includes an authentication credential satisfying the service provider s authentication policy. Sending by an identity provider to a service provider an authentication response operates a similar manner as described above with reference to .

For further explanation sets forth a flow chart illustrating a further exemplary method for authentication of a principal in a federation according to embodiments of the present invention that includes receiving in a service provider a request of a principal for access to a resource of the service provider determining by a service provider that an authentication credential of a request does not satisfy the service provider s authentication policy sending by a service provider to an identity provider an authentication request specifying the service provider s authentication policy receiving an authentication response by a service provider from an identity provider an authentication response including an authentication credential satisfying the service provider s authentication policy and recording in session data of a service provider a authentication credential.

The method of includes receiving in a service provider a request of a principal for access to a resource of the service provider. When a principal is represented by a web service client receiving in a service provider a request of a principal for access to a resource of the service provider according to the method of may be carried out by receiving security information in a web service message to an access manager of a service provider at a web services endpoint described in a WSDL description of the access manager. When a principal is represented by a person operating a web browser receiving in a service provider a request of a principal for access to a resource of the service provider according to the method of may be carried out by prompting a principal for security information through a user interface such as for example a computer screen or speech synthesizer.

After receiving security information from either a web service client or a person operating a web browser receiving in a service provider a request of a principal for access to a resource of the service provider according to the method of may also be carried out by creating an authentication credential from identity related data in a user registry. Such identity related data may include for example a principal identifier security groups to which the principal belongs security attributes and the like. Receiving in a service provider a request of a principal for access to a resource of the service provider according to the method of may further be carried out by an access manager s transmitting a principal s resource request to an identity manager of the service provider the request including an authentication credential of the principal.

A request of a principal for access to a resource of the service provider in the example of includes an authentication credential of a principal. The resource request may be represented by a XML based web service message enclosed in a SOAP envelope. The authentication credential represents a principal s security privileges for the duration of a principal s session with an identity provider. Authentication credentials of may be represented by a security token such as for example those security tokens described in the web services specification entitled WS Security and WS Trust. 

The method of includes determining by a service provider that an authentication credential of a request does not satisfy a service provider s authentication policy . Determining by a service provider that an authentication credential of a request does not satisfy a service provider s authentication policy according to the method of may be carried out by comparing a type of security information used in authenticating a principal as specified an authentication credential of a request with a the type of security information required by a service provider s authentication policy as specified in a WSDL description of a web service. In the method of whether an authentication credential of a request satisfies the service provider s authentication policy may be determined by an identity manager in the service provider.

The service provider s authentication policy in the example of is a set of claims and related security information required by a service provider to authenticate a principal requesting access to a resource or participating in single sign on with an identity provider. A service provider s authentication policy may require a principal to provide security information such as for example a username and password a symmetric cryptographic key an X.509 certification a Kerberos ticket or any other security related information as will occur to those of skill in the art. A service provider uses security information provided by a principal to create authentication credentials that satisfy a service provider s authentication policy.

The method of includes sending by the service provider to the identity provider an authentication request specifying the service provider s authentication policy if an authentication credential of a request does not satisfy a service provider s authentication policy . Sending by the service provider to the identity provider an authentication request specifying the service provider s authentication policy according to the method of may be carried out by creating a web service message in an identity manager of the service provider. Sending by the service provider to the identity provider an authentication request specifying the service provider s authentication policy according to the method of may further be carried out by transmitting a web service message from an identity provider s identity manager to a service provider through a principal using an HTTP redirect.

Authentication request in the example of specifies a service provider s authentication policy . Authentication response may be represented by a XML based web service message enclosed in a SOAP envelope. A specified service provider s authentication policy in the example of is a set of claims and related security information required by a service provider to authenticate a principal requesting access to a resource or participating in single sign on with an identity provider. A service provider s authentication policy may require a principal to provide security information such as for example a username and password a symmetric cryptographic key an X.509 certification a Kerberos ticket or any other security related information as will occur to those of skill in the art. A service provider uses security information provided by a principal to create authentication credentials that satisfy a service provider s authentication policy.

The method of includes receiving an authentication response by a service provider from an identity provider the authentication response including the authentication credential satisfying the service provider s authentication policy if an authentication credential of a request does not satisfy a service provider s authentication policy . Receiving an authentication response by a service provider from an identity provider may be carried out by receiving a web service message in an identity manager of a service provider at a web services endpoint described in a WSDL description of the identity manager.

Authentication response in the example of includes authentication credentials satisfying a service provider s authentication policy. Authentication response may be represented by a XML based web service message enclosed in a SOAP envelope. Authentication credential in the example of represents a principal s security privileges for the duration of a single sign on session with an identity provider. Authentication credentials of may be represented by a security token such as for example those security tokens described in the web services specification entitled WS Security or WS Trust. 

The method of includes recording in session data of the service provider the authentication credential . Because no previous session may have existed for the principal with the identity provider the method of may occur during an initial authentication sequence of a principal with a service provider. Recording in session data of the service provider the authentication credential may therefore include creating a session of a principal with a service provider. In the method of recording in session data of the service provider the authentication credential may also include storing an authentication credential in session data of a principal with a service provider. Session data of a principal with a service provider is represented in this example as a data structure that associates a session identifier with a principal identifier and an authentication credential for the session. The authentication credential represents a principal s security privileges for the duration of a session.

For further explanation set forth a calling sequence diagram illustrating an exemplary method for authenticating a principal in a federation according to embodiments of the present invention. is a continuation of the calling sequence diagram beginning in . In the example of authenticating a principal in a federation according to embodiments of the present invention includes principal identity provider and service provider . The principal in the example of is represented as a person operating a web browser in a pull based single sign on environment. The identity provider in the example of includes access manager identity manager and authentication proxy . The service provider in the example of includes access manager identity manager and computer resource . Access manager provides authorization services for resource .

In the example of principal sends resource request to access manager of service provider . Resource request is request to access resource . Resource request according to the example of may be represented by an HTTP request for a particular Uniform Resource Locator URL . A URL is a standardized address name layout for resources such as for example documents or images. An HTTP request according to embodiments of the present invention may include for example http www.serviceprovider.com resource. 

In the example of access manager authorizes a principal to participate in single sign on. Not all principals may be authorized to participate in single sign on with service provider . Access manager according to the example of therefore determines whether to authorize a principal to participate in single sign on based on identity related information provided by the principal or accessed in a user registry. Consider for example an employee accessing a 401K at the website of an investment company where the employer acts as an identity provider. The investment company may issue the employee s employer a unique website for single sign on of the employer s employees. An individual accessing the webpage of the investment company unique to the employer asserts that the individual is an employee authorized to participate in single sign on.

In the method of access manager sends single sign on request to principal . Single sign on request is a request by access manager to an identity manager to provide single sign on services for principal . Single sign on request may be represented by an XML based web service message containing identity related information of principal .

Principal in the example of sends single sign on request to identity manager . Single sign on request is an HTTP redirect of single sign on request . An HTTP redirect is an HTTP response with a status code of that induces a web browser to temporarily go to another location to retrieve a web resource.

After receiving single sign on request in the example of identity manager locates an identity provider to provide single sign on for principal . The identity manager may locate an identity provider of a principal for the first time by prompting the principal to select an identity provider from a list. The service provider may then store a cookie with the principal to facilitate automatic selection of an identity provider . The identity manager may also locate a principal s identity provider by looking up the identity provider in a database containing identity providers that have established a relationship with service provider .

In the example of the identity manager also selects a service provider s authentication policy. Selecting a service provider s authentication policy may be carried out by selecting an authentication policy based on the identity provider providing authentication credentials for a principal. An identity manager of a service provider may require different authentication policies for different identity providers because a service provider may trust some identity providers more than other identity providers. The identity manager may obtain an authentication policy required for a particular service provider from a database containing identity providers that have established a relationship with service provider .

A service provider s authentication policy is a set of claims and related security information required by a service provider to authenticate a principal requesting access to a resource or participating in single sign on with an identity provider. A service provider s authentication policy may require a principal to provide security information such as for example a username and password a symmetric cryptographic key an X.509 certification a Kerberos ticket or any other security related information as will occur to those of skill in the art. A service provider uses security information provided by a principal to create authentication credentials that satisfy a service provider s authentication policy.

In the method of the identity manager creates an authentication request specifying a service provider s authentication policy. Creating an authentication request specifying a service provider s authentication policy according to the example of may include encoding an XML representation of the service provider s authentication policy in a web service message according to the web services specification entitled Web Services Policy Framework WS Policy jointly authored by VeriSign Microsoft Sonic Software IBM and SAP or the web services specification entitled Web Services Security Policy Language WS SecurityPolicy jointly authored by Microsoft VeriSign IBM and RSA Security.

Identity manager in the example of sends authentication request to principal . Authentication request specifies a service provider s authentication policy. Principal sends authentication request to identity manager . Authentication request in the example of is an HTTP redirect of authentication request . Each authentication request may be represented by an XML based web service message enclosed in a SOAP envelope.

After receiving authentication request in the method of identity manager validates an authentication request and extracts a service provider s authentication policy. Validating an authentication request may be implemented by verifying that a digital signature of the authentication request is the digital signature of identity manager of service provider . Identity manager may verify a digital signature of an authentication request by decrypting the signature using the public asymmetric encryption key of identity manager . A service provider s authentication policy may be extracted according to the example of by reading an XML representation of the authentication policy from a web service message.

In the example of identity manager transmits service provider s authentication policy to a principal . Principal sends service provider s authentication policy to authentication proxy . The service provider s authentication policy is an HTTP redirection of a service provider s authentication policy . Service provider s authentication policy and may be represented by a web service message with an XML representation of the authentication policy enclosed in a SOAP envelope.

In the method of authentication proxy sends a request for security information to principal . The request for security information may be represented by a prompt for a person operating a web browser to provide additional security information not previously provided in a single sign on environment. Security information requested may include for example a username a password a social security number a Kerberos ticket an X.509 certification and so on.

Now with reference to Principal sends security information response to authentication proxy . The security information response may be sent using a secure connection between principal and authentication proxy such as for example the Secure Socket Layer SSL protocol or the Transport Layer Security TLS protocol.

In the example of authentication proxy validates a security information response . Validation may occur by comparing the security information provided by principal with identity related data stored in a user registry. For example a principal may be validated if a hashed version of a password provided to the authentication proxy matches a hashed version of the principal s password previously stored in a user registry.

Authentication proxy in the method of sends an authentication success response to principal . The authentication success response indicates that the authentication proxy validated the security information provided by principal . Principal sends authentication success response to identity manager . Authentication success response is an HTTP redirect of authentication success response . Authentication success response and in the example of may be represented by a web service message containing the identity of the principal and security related information.

In the method of identity manager creates an authentication response that includes authentication credentials. Creating authentication response may occur by embedding authentication credentials in a web service message. Authentication credentials may be created based on the security information provided by a principal and identity related information stored in a user registry such as for example a principal identifier a principal s authorization attributes groups to which a principal belongs the type of security information used to authenticate a user and so on.

Identity manager in the example of transmits authentication response to access manager . The authentication response may be represented by an XML based web service message. Authentication credentials may be implemented in authentication response as a security token such as for example those security tokens described in the web services specification entitled WS Security and WS Trust and enclosed in a SOAP envelope. In the example of identity manager sends authentication response to access manager of identity provider .

In the method of access manager creates a local session of the principal with the identity provider and records authentication credentials of the authentication response in the session data of the principal with the identity provider .

Access manager in the example of sends authentication response to principal . Authentication response is a forward of authentication response from identity manager to access manager . Principal sends authentication response to identity manager in the method of . Authentication response of is an HTTP redirect of authentication response .

In the example of identity manager validates authentication response . Validating an authentication response may be implemented by verifying that a digital signature of the authentication request is the digital signature of identity manager the originator of the authentication response. Identity manager may verify a digital signature of an authentication request by decrypting the signature using the public asymmetric encryption key of identity manager .

In the method of identity manager creates local authentication credentials that define a principal s privileges during the principal s session with a service provider . Identity manager creates local authentication credentials based on the authentication credentials included in the authentication response . The identity manager extracts the authentication credentials of the response by reading the XML representations of the authentication credentials enclosed in a SOAP envelope.

In the example of identity manager sends a single sign on response to access manager in response to single sign on request of . Single sign on response may be represented by an XML based web service message. Single sign on response in the example of includes local authentication credentials such as for example a principal name security attributes the type of security information used to authenticate a principal and so on.

The access manager in the example of creates a session of principal with service provider . Principal s session with service provider is represented as a data structure in service provider . The access manager stores local authentication credentials in session data of principal with service provider . Access manager authorizes principal to access resource based on the local authentication credentials stored in session data.

In the method of access manager sends resource request to principal . Resource request is a copy of the resource request intercepted by access manager in for single sign on processing. Principal sends resource request to resource . Resource request is an HTTP redirect of resource request from principal to resource .

Resource in the example of responds to resource request by sending resource response to principal . Resource response is the response paired with a principal s resource request of . In the call sequence of a principal is represented by a person operating a web browser. Resource response may therefore be represented by static or dynamic web content using HTML JSP CGI scripts and so on. Implementing a principal in the call sequence of is for explanation and not for limitation. A principal according to the call sequence of may be represented by a web service. In such a case resource response may also be represented by the result of data processing provided by programs processes or threads of execution.

Exemplary embodiments of the present invention are described largely in the context of a fully functional computer system for authentication of a principal in a federation. Readers of skill in the art will recognize however that the present invention also may be embodied in a computer program product disposed on recordable media for machine readable information including magnetic media optical media or other suitable media. Examples of recordable media include magnetic disks in hard drives or diskettes compact disks for optical drives magnetic tape and others as will occur to those of skill in the art. Persons skilled in the art will immediately recognize that any computer system having suitable programming means will be capable of executing the steps of the method of the invention as embodied in a program product. Persons skilled in the art will recognize immediately that although some of the exemplary embodiments described in this specification are oriented to software installed and executing on computer hardware nevertheless alternative embodiments implemented as firmware or as hardware are well within the scope of the present invention.

It will be understood from the foregoing description that modifications and changes may be made in various embodiments of the present invention without departing from its true spirit. The descriptions in this specification are for purposes of illustration only and are not to be construed in a limiting sense. The scope of the present invention is limited only by the language of the following claims.

