---

title: System and method for detecting an unlicensed mobile alliance (UMA) service in GSM wireless communication networks
abstract: Techniques are provided for scanning for access points with a wireless communication device including a baseband processor and a WLAN processor. A data download command which defines a preferred network list can be sent from the baseband processor to the WLAN processor. In addition, a first scan command can be sent from the baseband processor which triggers the WLAN processor to independently begin periodically scanning a number channels.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07965675&OS=07965675&RS=07965675
owner: Motorola Mobility, Inc.
number: 07965675
owner_city: Libertyville
owner_country: US
publication_date: 20050822
---
The present disclosure relates generally to wireless communications and more particularly to the rapid detection of UMA services by wireless communications devices WCDs capable of operating in different communications systems for example in cellular communications networks like GSM and in broadband WLANs like 802.11 SIP protocols IMS protocols and methods therefor.

Hybrid wireless cellular communications devices WCDs are capable of communicating on both cellular networks and in broadband wireless networks such as 802.11 protocol based or WLAN based networks. As the WCD moves physically and or the fading channel changes due to subtle variations in the complexity of the physical surroundings the WCD supports a specific set of logical decision making capabilities which determine how a cell and or network will be selected. Generally a hybrid WCD may detect and select one network or the other or both.

Broadband wireless communication protocols support radio resource management techniques for detecting one or more operating frequencies and access points. A cellular system such as Global System for Mobile telecommunication GSM however has little in common with alternate radio access interfaces for example a standardized WLAN like 802.11 or other wireless technologies capable of meeting the requirements for operation in unlicensed spectrum. The differences in radio behavior result primarily from differences in operating bandwidth power limitations for unlicensed operation Medium Access Control MAC protocol either reservation based or contention based designed to handle different predominant traffic types frequency range of operation and accordingly the resulting difference in radio propagation characteristics and the interference environment for licensed unlicensed operation.

When a dual mode WCD moves from a cell where it is communicating with a Mobile Switching Center MSC of a GSM network to another cell where a UMA network is the preferred network the WCD operates in a UMA preferred mode. The WCD will attempt to handover to an Unlicensed Network Controller UNC that operates over unlicensed IP spectrum. When a WCD is in a UMA preferred mode of operation at power up the WCD scans for access points within a UMA network. According to some specifications when a WCD is operating in a UMA preferred mode of operation the WCD should be capable of discovering or detecting an access point of the UMA network within a short time e.g. 15 seconds after entering into it and associating with the UMA network within another short time e.g. 15 to 30 seconds after detecting the access point.

According to one approach the WCD continuously scans for access points to discover its preferred networks. The host baseband processor of the WCD wakes up every predetermined scanning interval to continuously scan for access points. The host baseband processor then goes to sleep after initiating the scan until the next scanning interval when the host processor is awoken to scan again. Scan results are returned to the host baseband processor if an access point is detected. However executing this entire scan procedure at such short time intervals e.g. every 15 20 seconds can in many cases unnecessarily wakeup the host baseband processor to process scan information for access points that may not be available for association. The two processor blocks and their associated software blocks are awakened or activated during each scanning interval. This requires a large number of commands and a great deal of communication between the various sub modules of the host baseband processor which in turn results in a significant amount of communication overhead being passed between the various modules. Using this approach to detect an access point within a UMA network can consume substantial current and battery power.

The various aspects features and advantages of the disclosure will become more fully apparent to those having ordinary skill in the art upon careful consideration of the following Detailed Description thereof with the accompanying drawings described below.

Aspects of the following description relate to techniques for optimizing the use of WLAN hardware and reducing overhead typically associated with continuous WLAN scanning protocols. In contrast to continuous scanning private scanning techniques are provided which only activate WLAN firmware in the WLAN chipset to execute a more precise or low power scanning based on SSIDs or BSSIDs. The low power scanning technique is more precise and faster since only a fixed number of channels e.g. 11 or 13 channels need to be scanned during each scanning interval e.g. approximately every 30 seconds . Moreover the other software modules in the baseband processor remain in deep sleep mode DSM and are not activated during this low power scanning technique. As such a significant amount of battery power can be saved since these modules do not need to be activated and therefore do not consume current resources.

When an AP is not detected on a first attempt all of the blocks in the baseband processsor go into a deep sleep mode. At this point only the WLAN device specifically WLAN IC hardware firmware is activated signaled or triggered to start scanning at a periodic interval e.g. every 25 to 30 seconds .

In one implementation the baseband processor sends a user s preferred list of SSIDs or BSSIDs of APs which should be scanned for. This lets the WCD enter preferred mode allowing the user to select the specific APs BSSIDs . This information is passed to the WLAN device. Next all other blocks in the baseband processor enter deep sleep mode and remain in deep sleep mode until a BSSID of a preferred network selected by the user is detected or matched during WLAN scanning Significantly the only module which is active during this low power scanning is the WLAN firmware and only single command is required to initiate this low power scanning technique. When a BSSID of a preferred network selected by the user is matched and the WLAN scanning result is returned then a GPIO General Purpose Input Output is triggered which activates or wakes up the host baseband processor and lets the host baseband processor know that it must send an appropriate scan command.

In the exemplary second system is a broadband wireless communications network for example a wireless local area network WLAN . Alternatively the broadband wireless communications network may be a canopy or other fixed wireless network. The broadband wireless network may be proprietary or standardized protocol for example an 802.11 protocol network or some other wireless technology capable of meeting the requirements of operation in unlicensed spectrum. In other embodiments more generally the second system may be some other network which is generally isolated relative to the cellular network.

The baseband processor BP generates a data download command DDC comprising a preferred network list PNL and a private scan command PSC . The preferred network list PNL defines a list of preferred identifiers SSIDs BSSIDs and determines scanning criteria for use by the WLAN processor WP . The baseband processor BP generates the private scan command PSC when the baseband processor BP enters deep sleep mode. In deepsleep mode the processor core frequency is scaled down to reduce current consumption as the processor is only required to maintain its state and not to process any application. The baseband processor BP can also generate a configure wake up command CWUC which defines the conditions as to when the WLAN processor WP should generate a wake up command WUC to be sent to the baseband processor BP to awaken it from DSM. In one implementation the configure wake up command CWUC specifies that the baseband processor BP is to be awoke when one of the detected identifier SSID BSSID matches one of the preferred identifiers SSIDs BSSIDs .

The WLAN processor WP receives the data download command DDC and the private scan command PSC from the baseband processor BP . The private scan command PSC informs the WLAN processor WP that the baseband processor BP is entering deep sleep mode and triggers the WLAN processor WP to independently begin periodically scanning a number of channels. In one implementation the WLAN processor WP responsive to the private scan command PSC begins periodically scanning a number of channels for each preferred identifier SSID BSSID at a defined scanning interval. During intervals between the defined scanning interval the baseband processor BP enters into a low power mode LPM . In the low power mode the WLAN processor sends active probes for each SSID and processes some data for example only data that takes less then 20 msec per channel. The processor then goes to deep sleep mode instead of passive scan mode where WLAN processor will be on for the entire 100 msec beacon period for each channel. As the WLAN processor WP detects identifiers SSIDs BSSIDs it compares each detected identifier SSID BSSID to the list of preferred identifiers SSIDs BSSIDs to determine whether the detected identifiers SSIDs BSSIDs match one of the preferred identifiers SSIDs BSSIDs . The WLAN processor WP ignores or discards detected identifiers SSIDs BSSIDs which do not match a preferred identifier.

Using the configure wake up command CWUC criteria the WLAN processor WP knows when it should generate a wake up command WUC to be sent to the baseband processor BP . For example if the WLAN processor WP finds a match between one of the detected identifiers SSIDs BSSIDs and one of the preferred identifiers SSIDs BSSIDs then the WLAN processor WP can generate and send the wake up command WUC to the baseband processor BP .

At step S a data download command DDC a private scan command PSC and optionally a configure wake up command CWUC are sent from the baseband processor BP to the WLAN processor WP . At step S the baseband processor BP enters deep sleep mode DSM and informs the WLAN processor WP that the baseband processor BP is entering deep sleep mode DSM . At step S the WLAN processor WP independently begins periodically scanning a number channels for each preferred identifier SSID BSSID at a defined scanning interval without waiting for a second scan command from the baseband processor BP . The baseband processor BP enters into a low power mode LPM during intervals between the defined scanning interval. At step S the WLAN processor WP detects identifiers SSIDs BSSIDs . At step S the WLAN processor WP compares each detected identifier SSID BSSID to the preferred identifiers SSIDs BSSIDs to determine whether one of the detected identifiers SSIDs BSSIDs matches one of the preferred identifiers SSIDs BSSIDs . At step S detected identifiers SSIDs BSSIDs which do not match one of the preferred identifiers SSIDs BSSIDs are ignored. At step S if the WLAN processor WP finds a match between one of the detected identifiers SSIDs BSSIDs and one of the preferred identifiers SSIDs BSSIDs a wake up command WUC is sent to the baseband processor BP to awaken the baseband processor BP .

The WCD of comprises a UMA Radio Resource Controller URR User Interface UI Hardware HW button Wireless Service Provider WSP Wireless Power Management module WPrM Wireless Connection Management module WCM Wireless Local Area Network WLAN Driver module UMA Application Client UAC Deep Sleep Module DSM and WLAN Power Management Driver module WPrM Driver API . The part of Radio Resource Controller URR is shared in the baseband processor BP whereas all other modules are part of the WLAN processor WP . Normally when continuous scanning is implemented all of the blocks in would need to be awakened each time a scan takes place.

The Radio Resource Controller URR among other functions controls GSM or WiFi handover and also determines whether the WCD should be in GSM mode or WiFi mode. The Radio Resource Controller URR also generates the data download command DDC the private scan command PSC and optionally a configure wake up command CWUC . These commands or application programming interfaces APIs can be used by the application processor to implement private scanning which is independent of host interaction within WLAN processor . In this description the terms command API and Ioctl are used interchangeably to refer to protocols used to communicate between two software modules. The API commands described below are merely exemplary formats but other alternative formats can also be used.

When the baseband processor enters deep sleep mode a private scan command can be sent to firmware in the WLAN processor to inform the WLAN processor that the baseband processor is entering deep sleep mode and that the WLAN processor should automatically and independently begin private scanning a pre determined number e.g. 11 or 13 channels at a pre defined or user defined scanning interval without waiting for a scan command from the host baseband processor . In other words the WLAN processor should start scanning independent of the host processor . The private scan command may have the following format 

Here the field TSCAN allows the user to set the scanning interval. In between scanning intervals the whole chipset should go into a low power mode. In low power mode the WLAN processor scans the pre determined number e.g. 11 or 13 channels and then enters into IEEE Psave mode. The number of channels to be scanned depends upon the type of WLAN or UMA network. For example in North America or Europe and other locations where WLANs which comply with 802.11 b and 802.11 g WLAN standards the number of channels would be 11 whereas in WLANs which comply with Japanese WLAN standards the number of channels would be 13.

The data download command comprises user selected preferred SSID BSSID information corresponding to the preferred network list and defines scanning criteria to be used by the WLAN processor . The preferred network list can be a series of preferred networks from a host. The data download command may take the following format 

In response to the private scan command the WLAN processor scans 11 channels and for each SSID BSSID the WLAN processor detects the WLAN processor compares it to the preferred SSID BSSID information selected by the user. Typically many of the detected SSIDs BSSIDs will not be on the preferred list and these are ignored by the WLAN processor . However if the WLAN processor finds a match between the detected SSID BSSID and one of the preferred SSIDs BSSIDs then the WLAN processor awakens the host baseband processor . In the format above for example if any of the preferred networks for example the Data SSIDs is matched with the result of private scan command then the WLAN processor should set Host Wakeup Criteria true.

The host wake up configure command typically defines the criteria specifying when the host baseband processor should be awakened. In this implementation the host wake up configure command has been modified to specify that the host baseband processor should be awoke when the wake up host data SSID matches the private scan command. Alternatively the function of this implementation could be a new command that performs a similar functionality. This command can be implemented for example using the following format 

The Wireless Power Management module WPrM and the WLAN Power Management Driver module WPrM Driver API cooperate to make WLAN power management decisions. The Wireless Connection Management module WCM connects to all audio codecs and voice applications. The WLAN Driver module provides an interface which connects to baseband processor.

The Wireless Service Provider WSP receives the preferred network selected by the user and decides whether or not the WCD should handover or start scanning based on the user input. Once the baseband processor goes into DSM the Wireless Service Provider WSP uses the data download command to pass the preferred network scanning information from the host baseband processor to the WLAN processor along with the host wake up configure command for the WLAN chipset to awaken the baseband processor only if the WLAN chipset detects a preferred network SSID BSSID and should handover to a VoIP network.

The WLAN driver is connected to a WLAN firmware module which is connected to a WLAN RF module . The WLAN firmware module and the WLAN RF module reside on the WLAN processor . Host independent scanning is done in WLAN firmware module which also decides if the scanned SSIDs match one of the SSIDs on the preferred list.

The following exemplary WCD scanning techniques describe four user selectable modes of WCD operation. These four modes are referred to as GSM only mode GSM preferred mode UMA preferred mode and UMA only mode. In GSM only mode the WCD scans for a GSM network a UMA network is not required. In GSM preferred mode at power up the WCD scans for a GSM network and if it cannot find a GSM network then it will scan for a UMA network. In UMA preferred mode at power up the WCD starts scanning for access points of the UMA network and if it cannot find a UMA network then it will scan for a GSM network. In UMA only mode the WCD only scans for access points associated with the UMA network.

In the following description two exemplary WCD scanning techniques will be discussed. One of the exemplary WCD scanning techniques applies in situations where the WCD operates in either the GSM preferred or GSM only modes. The other exemplary WCD scanning techniques apply in situations where the WCD operates in either the UMA preferred and UMA only modes.

When the WCD is in GSM environment and no UMA service is available the following can be the criteria used for WLAN status. In GSM preferred and GSM only modes the WLAN chipset will be in deep sleep mode and no automatic passive or active scanning of WLAN UMA network will be supported. In either mode if a user wants to scan for WLAN UMA network the user manually presses the WLAN button Hardware HW button or goes through User Interface UI to select a scanning option.

At step S the User Interface UI module will send SCAN command to the Wireless Service Provider WSP together with the Radio Resource Controller URR . At step S the Wireless Service Provider WSP sends a request from the Wireless Power Management module WPrM to the Wireless Connection Management module WCM to the Wireless Local Area Network WLAN Driver module . At step S the driver of the baseband processor sends DEEPSLEEP Exit ioctl either through a power up interrupt command through SD interface to wake up WLAN device or it can send an interrupt command through GPIO21 Host Wake WLAN to wake up WLAN firmware. At step S when the WLAN firmware receives this interrupt it sends a Host Awake event to the baseband processor. At step S the baseband processor responds to the Host Awake by sending a Wakeup confirm. At step S the Wireless Local Area Network WLAN Driver module returns scan results to the Wireless Service Provider WSP where a comparison of scan results is done. The UAC provides the association thresholds to the Wireless Service Provider WSP .

At step S once the policy is met and based on scan result SNR Link Quality meets the threshold requirements the connection request is initiated from DSM to the Wireless Service Provider WSP . At step S the Wireless Service Provider WSP replies to DSM with a connection confirm response. At step SA if the scan command does not return satisfactory results required for the comparison policy in the Wireless Service Provider WSP after doing scan a predetermined number of times e.g. three times then the Wireless Local Area Network WLAN Driver module sends DEEPSLEEP Enter ioctl command and WLAN firmware puts WLAN hardware into deep sleep mode until user wakes it up again via the User Interface UI Hardware HW button . In this mode battery life is dominated by GSM talk time and GSM standby time unless GSM coverage is so poor that a user is forced to use UMA.

In at step SB if the scan command does not return satisfactory results required for comparison policy in WSP after doing scan a predetermined number of times e.g. three times the Wireless Local Area Network WLAN Driver module sends WLAN Priv Scan ioctl command together with preferred network command and based on these commands the WLAN processor scans after predetermined time e.g. 30 seconds without any host support. At step S the baseband processor can sleep after it sends wake up criteria for the baseband processor . At step S if the WLAN processor matches preferred network at any time during scanning then wake up criteria for the baseband processor is set to true and the WLAN processor wakes up the baseband processor for association and authentication to start. In this mode battery life is dominated by the scan interval e.g. 30 seconds but a user may want to scan less frequently e.g. every 5 10 minutes if GSM coverage is good.

Thus according to one aspect of this disclosure techniques are provided for host independent scanning on a dual mode WCD s preferred BSSIDs or SSIDs. The scanning functionality can be shifted from a main host baseband processor to a secondary WLAN processor. API s are provided which allow for private scanning of preferred networks without disturbing the WCD application processor which otherwise consumes a lot of current. Additional or enhanced software commands are provided which the host baseband processor can send to start host independent scanning based on previous knowledge of host wakeup criteria and host preferred WLAN networks. One exemplary command enables periodic WLAN scans without waking up the host baseband processor based on scanning time intervals and SSID information received from WLAN access points. The host can save several profiles and based on this information a WLAN will only wake up host if it detects preferred profile. Consequently if the WCD does not enter a UMA preferred network profile then the WCD can allow host baseband processor to enter a deep sleep mode in which the host baseband processor is deactivated thereby saving and helping optimize battery life. By contrast if the WCD does enter a UMA preferred network then the WCD will detect it and try to associate to it since the WLAN chipset will be doing low power background scans.

While the present disclosure and what are presently considered to be the best modes thereof have been described in a manner establishing possession by the inventors and enabling those of ordinary skill in the art to make and use the same it will be understood and appreciated that there are many equivalents to the exemplary embodiments disclosed herein and that modifications and variations may be made thereto without departing from the scope and spirit of the inventions which are to be limited not by the exemplary embodiments but by the appended claims.

