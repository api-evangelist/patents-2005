---

title: Request linked digital watermarking
abstract: A method for digitally signing information in real-time, based on a user request for the information. In one embodiment, the method is useful in a Web server, and can be implemented using a server-side API filter. One embodiment of the method includes receiving a data request from a user and determining whether the data requested should be marked. If the data should be marked, the method includes marking the data with a signature identifying at least one component of the user request; and storing information identifying the user with the request and the at least one component. Multiple types of marking techniques can be used on a single data file.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08032755&OS=08032755&RS=08032755
owner: Microsoft Corporation
number: 08032755
owner_city: Redmond
owner_country: US
publication_date: 20051205
---
Currently many businesses have intellectual property IP in the form of images binary files and source code stored on internal secure servers. This data is available through various mechanisms. One common form of availability is an internal Website which makes such information available for download as either stand alone content or supporting content for Web pages. Other mechanisms include FTP servers and file sharing servers. It is generally difficult to track the source of any images which are improperly distributed outside of the business especially where FTP and Web servers are the source of the information. As a result the intellectual property rights of the company may be compromised if the information is released outside of the company. Other than the images appearing in the public realm businesses have no way of tracking the image or other data back to the source of the leak.

A number of digital watermarking techniques are currently in use to identify the source of digital information such as stock photographs. It is relatively common to see a copyright notice superimposed on an image in order to prevent users from improperly using the image. Currently most standard image watermarking technologies require that images be watermarked prior to their being requested. This is done generally with a visible watermark on the image i.e. a semi transparent over lay of the company logo or with a non visible watermark typically identifying the image as being the property of the company.

In most applications of digital watermarking only one method of digital watermarking is employed making the means to defeat the image watermarking technology much more feasible to achieve. By focusing only on a single method for digital watermarking prior art processes are limited in providing long term protection of the digital data.

The invention roughly described includes a method for digitally signing information in real time based on a user request for the information. The information can be in any number of digital data formats. By watermarking the data in a manner which associates the watermark with the request transaction the data can be tracked back to the initial requester. In one embodiment the method is useful in a Web server and can be implemented using a server side API filter.

One embodiment of the method includes a method implemented at least in part by a computing device. The method includes receiving a data request from a user and determining whether the data requested should be marked. If the data should be marked the method includes marking the data with a signature identifying at least one component of the user request and storing information identifying the user with the request and the at least one component.

In another embodiment a watermarking method is implemented at least in part by a computing device and includes receiving a data request from a user and logging the data request with the user identity. Once the computing device retrieves the data the method includes determining whether the data is an image. If the data is an image the method includes marking the image with at least a first digital watermark identifying information about the user request. The method then returns the image with the digital watermark to the user. Additional watermarking methods may be used and multiple methods used on one file.

Yet another embodiment includes a computer readable medium having computer executable components. A data distribution component responds to requests for data from a user and a data marking component receives a request for data from a user and marks requested data with a digital signature created to identify the user request.

This Summary is provided to introduce a selection of concepts in a simplified form that are further described below in the Detailed Description. This Summary is not intended to identify key features or essential features of the claimed subject matter nor is it intended to be used as an aid in determining the scope of the claimed subject matter.

A method for digitally signing or watermarking information in real time based on a specific user request for the information is provided. The information can be in a digital format and can include any number of digital data types including an executable file a binary data file a text file an image data file or the like. By watermarking the information in a manner which associates the watermark with the request transaction information can be tracked back to the initial requester. The method allows one to select from one or more watermarking schemes for the data allowing both the scheme and the type to data to be watermarked to be configured by the corporate administrator.

In one embodiment the method is useful in a Web server and can be implemented using a server side API filter that would allow for a variety of watermarking methods as well as configurable watermarking data sets to be imbedded in the data such as the authenticated requester s user name. When implemented in a Web server the method may be implemented using a plug in architecture providing developers with the ability to choose the type of data watermarked through a configuration process. The configuration may identify the data by type image executable by source by subject by requesting username by machine name by user ID or any number of discernable categories. The protection scheme may be implemented by watermarking the data returned in real time at the time of a user request for the data and the watermark can be uniquely identified with the user the request or both.

The data distribution server may comprise for example a file sharing server such as a Microsoft Windows 2003 server Unix operating system server or Linux operating system server all including a file sharing service an FTP server a Web server or any authenticated data distribution service. In general when a user seeks information from the data distribution server a request will be generated by the user and the information returned to the user. A specific example of a Web server providing the data distribution function is shown with respect to .

The data distribution server includes a data store including proprietary information or information which an administrator of the secure environment may wish to track an authentication engine which evaluates a request from a user for access to proprietary information and a distribution service providing the information in response to the request all running on the data distribution server . Also shown on data distribution server is a request based watermarking security engine . The security engine acts in concert with the distribution service to determine whether information requested from for example the proprietary information store should be subjected to a watermarking process. If so the engine generates and applies a watermark that allows the administrator of the secure environment to link the distributed data back to the data request from user .

The Web server also includes a transaction log wherein the request response handler keeps a log of all requests and responses made of the Web server . In this embodiment the watermarking method may be implemented by a request based watermarking security plug in . Most Web servers such as Microsoft s Internet Information Server provide a plug in architecture with well defined application programming interfaces APIs allowing programmers to develop Web based applications which are tightly integrated with the Web server. When a request for information received at the request response handler includes a request for proprietary information in the information store the request based watermarking security plug in will generate a request specific watermark for the data to be returned and apply the mark prior to the data being returned to a user .

The watermarking security plug in may also maintain a separate transaction store which includes user and other request specific information. The information in the transaction store may be used alone or in concert with the information provided by the Web servers own Web log to generate a request specific watermark for data . As a result if the secure information is transmitted outside the secure environment to another user this information can be identified and associated with the request made by user .

Either of the servers shown in may be implemented by a suitable computing system. illustrates an example of a suitable computing system environment on which the invention may be implemented. The computing system environment is only one example of a suitable computing environment and is not intended to suggest any limitation as to the scope of use or functionality of the invention. Neither should the computing environment be interpreted as having any dependency or requirement relating to any one or combination of components illustrated in the exemplary operating environment .

The invention is operational with numerous other general purpose or special purpose computing system environments or configurations. Examples of well known computing systems environments and or configurations that may be suitable for use with the invention include but are not limited to personal computers server computers hand held or laptop devices multiprocessor systems microprocessor based systems set top boxes programmable consumer electronics network PCs minicomputers mainframe computers distributed computing environments that include any of the above systems or devices and the like.

The invention may be described in the general context of computer executable instructions such as program modules being executed by a computer. Generally program modules include routines programs objects components data structures etc. that perform particular tasks or implement particular abstract data types. The invention may also be practiced in distributed computing environments where tasks are performed by remote processing devices that are linked through a communications network. In a distributed computing environment program modules may be located in both local and remote computer storage media including memory storage devices.

With reference to an exemplary system for implementing the invention includes a general purpose computing device in the form of a computer . Components of computer may include but are not limited to a processing unit a system memory and a system bus that couples various system components including the system memory to the processing unit . The system bus may be any of several types of bus structures including a memory bus or memory controller a peripheral bus and a local bus using any of a variety of bus architectures. By way of example and not limitation such architectures include Industry Standard Architecture ISA bus Micro Channel Architecture MCA bus Enhanced ISA EISA bus Video Electronics Standards Association VESA local bus and Peripheral Component Interconnect PCI bus also known as Mezzanine bus.

Computer typically includes a variety of computer readable media. Computer readable media can be any available media that can be accessed by computer and includes both volatile and nonvolatile media removable and non removable media. By way of example and not limitation computer readable media may comprise computer storage media and communication media. Computer storage media includes both volatile and nonvolatile removable and non removable media implemented in any method or technology for storage of information such as computer readable instructions data structures program modules or other data. Computer storage media includes but is not limited to RAM ROM EEPROM flash memory or other memory technology CD ROM digital versatile disks DVD or other optical disk storage magnetic cassettes magnetic tape magnetic disk storage or other magnetic storage devices or any other medium which can be used to store the desired information and which can accessed by computer . Communication media typically embodies computer readable instructions data structures program modules or other data in a modulated data signal such as a carrier wave or other transport mechanism and includes any information delivery media. The term modulated data signal means a signal that has one or more of its characteristics set or changed in such a manner as to encode information in the signal. By way of example and not limitation communication media includes wired media such as a wired network or direct wired connection and wireless media such as acoustic RF infrared and other wireless media. Combinations of the any of the above should also be included within the scope of computer readable media.

The system memory includes computer storage media in the form of volatile and or nonvolatile memory such as read only memory ROM and random access memory RAM . A basic input output system BIOS containing the basic routines that help to transfer information between elements within computer such as during start up is typically stored in ROM . RAM typically contains data and or program modules that are immediately accessible to and or presently being operated on by processing unit . By way of example and not limitation illustrates operating system application programs other program modules and program data .

The computer may also include other removable non removable volatile nonvolatile computer storage media. By way of example only illustrates a hard disk drive that reads from or writes to non removable nonvolatile magnetic media a magnetic disk drive that reads from or writes to a removable nonvolatile magnetic disk and an optical disk drive that reads from or writes to a removable nonvolatile optical disk such as a CD ROM or other optical media. Other removable non removable volatile nonvolatile computer storage media that can be used in the exemplary operating environment include but are not limited to magnetic tape cassettes flash memory cards digital versatile disks digital video tape solid state RAM solid state ROM and the like. The hard disk drive is typically connected to the system bus through a non removable memory interface such as interface and magnetic disk drive and optical disk drive are typically connected to the system bus by a removable memory interface such as interface .

The drives and their associated computer storage media discussed above and illustrated in provide storage of computer readable instructions data structures program modules and other data for the computer . In for example hard disk drive is illustrated as storing operating system application programs other program modules and program data . Note that these components can either be the same as or different from operating system application programs other program modules and program data . Operating system application programs other program modules and program data are given different numbers here to illustrate that at a minimum they are different copies. A user may enter commands and information into the computer through input devices such as a keyboard and pointing device commonly referred to as a mouse trackball or touch pad. Other input devices not shown may include a microphone joystick game pad satellite dish scanner or the like. These and other input devices are often connected to the processing unit through a user input interface that is coupled to the system bus but may be connected by other interface and bus structures such as a parallel port game port or a universal serial bus USB . A monitor or other type of display device is also connected to the system bus via an interface such as a video interface . In addition to the monitor computers may also include other peripheral output devices such as speakers and printer which may be connected through an output peripheral interface .

The computer may operate in a networked environment using logical connections to one or more remote computers such as a remote computer . The remote computer may be a personal computer a server a router a network PC a peer device or other common network node and typically includes many or all of the elements described above relative to the computer although only a memory storage device has been illustrated in . The logical connections depicted in include a local area network LAN and a wide area network WAN but may also include other networks. Such networking environments are commonplace in offices enterprise wide computer networks intranets and the Internet.

When used in a LAN networking environment the computer is connected to the LAN through a network interface or adapter . When used in a WAN networking environment the computer typically includes a modem or other means for establishing communications over the WAN such as the Internet. The modem which may be internal or external may be connected to the system bus via the user input interface or other appropriate mechanism. In a networked environment program modules depicted relative to the computer or portions thereof may be stored in the remote memory storage device. By way of example and not limitation illustrates remote application programs as residing on memory device . It will be appreciated that the network connections shown are exemplary and other means of establishing a communications link between the computers may be used.

At step an authenticated user issues a request to access data from the distribution server s data store. In order to authenticate as noted above the user will provide a user name and other information such as a password. Once the data distribution server receives an authenticated request at step the watermarking process intercepts the access request and stores the user information for the request in a record . This user information may include the user s log in I.D. source IP a machine ID the type of request the information requested the manner of the request whether over a secure network or via a public network via secure mechanism the time and date of the request in a timestamp or other format and other such information. Record is held for use in creating a watermark on the information at a later point in time. Next at step the request is forwarded to the data service for processing. In the data distribution server this would include handing the request off to the file sharing service or the FTP service. At step the data distribution service will retrieve the information and attempt to return it to the user.

When the data distribution service returns the information the return is intercepted at step and a determination is made at step as to whether or not the information is to be marked. In accordance with the method the type and content of information which may be subject to being marked may be configured by an administrator of the secure environment . For example the administrator may determine that certain types of information such as any binary file any source code file any image or the like needs to include a watermark if distributed. The configuration may be specific to types of content about particularly sensitive subject or types of files such as images or even specific subdirectories or URLs in the data distribution server.

If the method determines at step that the information is not information which needs to be marked the requested information is returned to the user at . If the information should be marked at step then at step a digital watermark is created a using the information recorded at and the data marked prior to being sent to the user at step . The watermarking engine stores a log of the watermarking transaction information for later use. This information can be used to identify a file in possession of an unauthorized user which has been transmitted to a user outside of the secure environment at a later time.

Various methods of watermarking the information are contemplated for use with the method. The watermark may include information in the mark which specifically identifies the request including the time date and user making the request. Alternatively the mark may include information sufficient to determine the user from information about the watermarking transaction stored at step . Variations on the type of methods which may be used are discussed with respect to and . Various combinations of more than one watermarking technique may be used as discussed below.

In the watermarking step places an identifier of the user in the actual watermark. In some cases this may not be desirable as companies may not wish to expose their user information in a manner which may be determined by an outside source. The advantage of the method of is that all information concerning the image is maintained within the secure environment.

Additional configuration options include allowing different types of watermarks to be generated using different techniques at each of steps and . That is for each type of request or each different request or different types of data a different digital signature technique may be utilized. Alternatively the digital technique marking different pieces of data may be randomized or provided by for particular category. For example images may be marked using one technique while executable binaries are marked is using a different technique. In addition multiple techniques of watermarking including visible and invisible watermarks can be utilized on a single piece of material.

A key advantage to the technique is that it can be implemented in Web servers used in internal intranets via the plug in architecture standard in all Web server systems.

Although the subject matter has been described in language specific to structural features and or methodological acts it is to be understood that the subject matter defined in the appended claims is not necessarily limited to the specific features or acts described above. Rather the specific features and acts described above are disclosed as example forms of implementing the claims.

