---

title: Determining a surface geometry of an object
abstract: Methods for determining a surface geometry of an object, including determining a first projection matrix based on a first imaging device, determining a second projection matrix based on a second imaging device, obtaining at least one first two-dimensional (2D) image of the object using the first imaging device, obtaining at least one second 2D image of the object using the second imaging device, determining a contour of the object in the first 2D image and the second 2D image, and, based on the at least two contours, the first projection matrix, and the second projection matrix, reconstructing 3D data associated with the surface of the object. In one embodiment, the object can be a heart.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07471973&OS=07471973&RS=07471973
owner: Case Western Reserve University
number: 07471973
owner_city: Cleveland
owner_country: US
publication_date: 20050421
---
This application is a division of U.S. application Ser. No. 10 317 953 filed Dec. 12 2002 now U.S. Pat. No. 6 975 900 which is continuation in part to U.S. application Ser. No. 10 264 572 filed Oct. 4 2002 now U.S. Pat. No. 7 016 719 which claims the benefit of U.S. Provisional Application No. 60 327 419 filed on Oct. 4 2001 and which is also a continuation in part of U.S. application Ser. No. 10 037 603 filed on Oct. 19 2001 now U.S. Pat. No. 6 772 004 which is a continuation of U.S. application Ser. No. 09 463 428 filed Mar. 29 2000 abandoned which is the National Stage of International Application No. PCT US98 15927 filed Jul. 29 1998 which claims the benefit of U.S. Provisional Application No. 60 054 342 filed Jul. 31 1997 and aforementioned U.S. application Ser. No. 10 317 953 is also a continuation in part of U.S. application Ser. No. 10 037 603 now U.S. Pat. No. 6 772 004. The contents of all aforementioned applications are incorporated herein by reference in their entireties.

The contents of this disclosure were supported by NIH NHLBI Grant R37 HL 33343 and R01 HL 49054 Y.R. .

The disclosed methods and systems relate generally to electrocardiographic imaging and more particularly to methods and systems for modeling a surface geometry for use in for example electrocardiographic imaging.

Imaging and diagnosing cardiac electrical activity can be problematic because the electrical activity is time dependent and spatially distributed throughout the myocardium. Electrocardiographic techniques that include for example electrocardiograms ECG and vectorcardiography VCG can be limited in their ability to provide information and or data on regional electrocardiac activity. These methods can also fail to localize bioelectric events in the heart.

Simultaneous recordings of potentials at tens or hundreds of locations on the torso for example can provide body surface potential maps BSPMs over the torso surface. Although the BSPMs can indicate regional cardiac electrical activity in a manner that may be different from conventional ECG techniques these BSPM techniques generally provide a comparatively low resolution smoothed projection of cardiac electrical activity that does not facilitate visual detection or identification of cardiac event locations e.g. sites of initiation of cardiac arrhythmias and details of regional activity e.g. number and location of arrythmogenic foci in the heart .

In comparison potential distributions measured on and over the epicardial surface of the heart can provide comparatively more accurate and higher resolution data that reflects electrical events within the myocardium. Accordingly the study of cardiac excitation and arrhythmogenesis for example often rely upon the mapping of potentials directly from the epicardium.

With an increasing use of nonpharmacological anti arrhythmic interventions e.g. ablation comparatively rapid and accurate localization of electrocardiac events can be beneficial. Electrocardiographic imaging ECGI is a noninvasive imaging modality for cardiac electrophysiology EP and arrhythmias that can be used to reconstruct epicardial potentials and to provide electrograms and isochrones from for example BSPMs and or other electrocardiographic body surface potentials.

The disclosed methods and systems can be used to determine a surface geometry of an object where the methods and systems include determining a first projection matrix based on a first imaging device determining a second projection matrix based on a second imaging device obtaining at least one first two dimensional 2D image of the object using the first imaging device obtaining at least one second 2D image of the object using the second imaging device determining a contour of the object in the first 2D image and the second 2D image and based on the at least two contours the first projection matrix and the second projection matrix reconstructing 3D data associated with the surface of the object. The first imaging device and the second imaging device may be the same imaging device however in one embodiment the first and second imaging devices can include X ray such as biplanar or multiplanar fluoroscopy digital camera s and or other devices from which a 2D image of the object can be obtained.

In one embodiment the first projection matrix can be associated with the first imaging device and the first projection matrix can thus be determined by providing at least one calibration object that includes at least six markers employing a 3D digitizing instrument to associate 3D data with the at least six markers providing a first calibration image using the first imaging device determining the image coordinates of a first at least six of the at least six markers based on the first calibration image and computing the first projection matrix based on the 3D data and the first calibration image coordinates. In one embodiment the at least one calibration object can include a calibration object that can be V shaped and a planar board where the calibration object and the planar board can include identifiable markers. In some embodiments the V shaped calibration object can be placed on a first side of the object and the planar board can be placed on a second side of the object.

Accordingly the second projection matrix which can be associated with the second imaging device can be determined by providing a second calibration image using the second imaging device determining the image coordinates of a second at least six of the at least six markers based on the second calibration image where the first at least six markers are the same as correlated with or otherwise associated with the second at least six markers and computing the second projection matrix based on the 3D data and the second calibration image coordinates. The first calibration image and the second calibration image can include image data based on the same markers. In such an embodiment the methods and systems can include computing the 3D coordinates of the at least six markers based on the first projection matrix the second projection matrix the first image calibration coordinates of the at least six markers and the second calibration image of the at least six markers and comparing the computed 3D coordinates to the 3D data associated with the at least six markers. In one example the comparison can be further compared to a threshold. Based on the comparison the aforementioned process of computing the first and or second projection matrices can be re performed in part or in whole by repeating the process from the use of 3D digitizing instrument to associate 3D data with the at least six markers from the taking or otherwise obtaining a first calibration image using the first imaging device from the taking or otherwise obtaining a second calibration image using the second imaging device from the determining the image coordinates of the at least six markers based on the first calibration image and or from the determining the image coordinates of the at least six markers based on the second calibration image. The process of computing the first and second projection matrices otherwise referred to as a calibration process can be repeated based on the embodiment to provide an accuracy or other measure relative to a threshold.

The methods and systems can include obtaining at least one first and or second 2D image using the first imaging device and the second imaging device where the first imaging device and the second imaging device can include X ray fluoroscopy multiplanar fluoroscopy including biplanar fluoroscopy a digital camera and other digital imaging devices and or means. The obtaining of a first and or second 2D image can also include selecting a 2D image based on a comparatively enlarged projection of the object. For example when the object is a heart the first and second 2D images can be selected to correspond to a time when the heart is enlarged to a comparatively largest size during a cardiac cycle. In some embodiments the first and second 2D images can be obtained simultaneously to provide two views of the object at the same time however in some embodiments the first and second 2D images can be collected sequentially.

The disclosed methods and systems also include determining a contour based on the first 2D image s and the second 2D image s where the contour can be based on a user provided designation and or an automatic computation. Determining a contour can thus include providing a number of points to include in the contour extrapolating to provide a contour having a designated number of points and or displaying the contour in at least one of the first 2D image and the second 2D image. The number of points in the contour can be provided by a user or another and thus can be variable or fixed.

The reconstructing of 3D data can thereby include generating matching contour point pairs based on points in the contour the first projection matrix and the second projection matrix. The matching contour point pairs can be computed based on a fundamental matrix where the fundamental matrix can be based on the first projection matrix and the second projection matrix. The matching contour point pairs can also be based on determining a smallest eigenvalue of the fundamental matrix.

The 3D reconstruction can include weighting reconstructed points from a matching contour point pair where the weights can be based on a distance from a line defined by a first focal point associated with the first imaging device and a second focal point associated with the second imaging device. Weights can be based on a distance from a centroid for example. In one embodiment the weights can include a weight of 0.1 for a reconstructed point furthest from the line and a weight of 0.3 otherwise.

The 3D reconstruction can also include forming a meshed surface based on the first projection matrix the second projection matrix and at least one matching contour point pair based on the at least two contours. The 3D data reconstruction can include creating splines e.g. b splines based on 3D points reconstructed from the first projection matrix the second projection matrix and at least one matching contour point pair based on the at least two contours. In one embodiment the spline data can be converted to spherical coordinates. In some embodiments the spline can be extrapolated and or fitted where the fitting can be based on a bicubic spline least squares fit although other least squares and or other fitting techniques can be used. In some embodiments the 3D data can be converted to Cartesian coordinates.

The methods and systems include projecting the 3D points onto a unit sphere centered at the centroid of the 3D points computing a convex hull extracting connectivity data from the convex hull and forming a meshed surface based on the 3D points and the connectivity data where the meshed surface can be associated with the surface geometry of the object. The meshed surface can thus be registered to with a second object surface and a boundary element method can be employed to determine the geometry between the object surface and the second object surface.

In one embodiment the object surface is a heart surface and the second object surface is an electrode vest surface. In such an embodiment the methods and systems can be employed to determine a geometrical relationship between the outer surface of the heart e.g. epicardial surface and the electrode vest. Such embodiment can be used in ECGI applications.

Accordingly also disclosed are methods and systems for computing epicardial surface electric potentials based on measured body surface electric potentials where the methods and systems include generating a multidimensional matrix the matrix representing at least one geometric relationship between at least one body surface electric potential measuring system and the epicardial surface the multidimensional matrix being based on at least one first two dimensional 2D image of the epicardium using a first imaging device at least one second 2D image of the epicardium using a second imaging device a first projection matrix associated with the first imaging device a second projection matrix associated with the second imaging device a computed contour of the outer surface of the heart formed from contours identified in the at least one first 2D image and the at least one second 2D image a computed contour of the electric potential measuring system and a boundary element method based on the computed contour of the outer surface of the heart and the computed contour of the electric potential measuring system. The method and system can also include using a Generalized Minimum Residual GMRes method to estimate an inverse of the multidimensional matrix and based on the inverse matrix and the measured body surface potentials determining the epicardial surface electric potentials.

The methods and systems can thus include measuring the position of the at least one body surface electric potential measuring system and determining a number of iterations for the GMRes method which can also include providing a maximum number of iterations for the GMRes method and based on the data from the maximum number of iterations determining a number of iterations for the GMRes method. Determining a number of iterations can include comparing residual error to a Hessenberg matrix condition and computing at least one of a corner of a condition L curve and a maximum curvature of a condition L curve. Determining a number of iterations can include determining a number of iterations based a corner of a condition L curve a corner of an L curve an increase in spatial frequency of a reconstructed potential map and or an increase in amplitude of a solution norm.

The GMRes method can include providing an initial condition of zero and or providing an initial condition based on a Tikhonov regularization of the multidimensional matrix.

Other objects and advantages will become apparent hereinafter in view of the specification and drawings.

To provide an overall understanding certain illustrative embodiments will now be described however it will be understood by one of ordinary skill in the art that the systems and methods described herein can be adapted and modified to provide systems and methods for other suitable applications and that other additions and modifications can be made without departing from the scope of the systems and methods described herein.

Unless otherwise specified the illustrated embodiments can be understood as providing exemplary features of varying detail of certain embodiments and therefore unless otherwise specified features components modules and or aspects of the illustrations can be otherwise combined separated interchanged and or rearranged without departing from the disclosed systems or methods. Additionally the shapes and sizes of components are also exemplary and unless otherwise specified can be altered without affecting the disclosed systems or methods.

The disclosed methods and systems can be used to determine a surface geometry such as a heart surface geometry which can be thereafter used to determine a geometrical relationship between the surface of the heart organ and positions of electrodes that can be placed on the body surface of a subject for which electrocardiographic imaging data is collected. In one example the determined geometric relationship facilitates the reconstruction of epicardial electrical potentials based on electrocardiographic image ECGI data where the ECGI data is derived from body surface potential maps BSPMs . The reconstructed epicardial potentials can be used to provide electrograms and isochrones. Those of ordinary skill in the art will recognize however that the methods and systems are not limited to BSPMs and or can employ electrocardiographic data vectorcardiogram data or combinations thereof and although the disclosed methods and systems present electrograms and isochrones other and or additional data representations can be implemented.

In an embodiment the system can be an online and or integrated channel system that can be a stand alone and portable unit with data acquisition and data processing capabilities. Further in one embodiment the illustrated vest can include approximately two hundred forty silver silver chloride Ag AgCl electrodes for acquiring electrocardiograph ECG signals from a body surface such as a torso. Those of ordinary skill will recognize that the vest can include other numbers of electrodes including for example in the range from approximately one hundred twenty to two hundred fifty although fewer or more electrodes can be used depending upon the application. Further although the use of silver silver chloride electrodes allows the electrodes to be used without gel and thus may decrease the number of electrodes that may short circuit and may allow for rapid application of the electrodes to the patient other systems that utilize gel and or other non gel systems can be used.

The illustrated vest may also provide two dimensional stability to the electrode array so that electrode spacing can be maintained substantially constant and electrode positions can be determined as provided herein. The vest connector and or device can further include comparatively high input resistance amplifiers e.g. on the order of 10ohm and driven shield electrode cables to provide increased common mode rejection. For example in one embodiment driven shield cables can be coaxial cables that can be optically coupled to avoid shock to the patient while other types of electrode arrangements and or methods and systems to obtain body surface potentials may be used. Those of ordinary skill will thus understand the vest connector and device to more generally be a body surface potential measurement system and or device that provides or otherwise communicates e.g. via wired or wireless network direct communications etc. body surface potential data to the processor where such data can be in a format that is compatible for receipt by the processor . In an embodiment the illustrated body surface potential measurement system can be employed for body surface mapping epicardial mapping e.g. using epicardial electrodes endocardial mapping and or intracavitary mapping using a multi electrode probe.

Referring again to the geometry determining device can be a system and or device for providing geometric data for an anatomical part s such as the heart and accordingly the device can include a system that provides x ray ultrasound computed tomography CT and or magnetic resonance imaging MRI data. For example as shown in the geometry determining device can be a fluoroscopy device . In an embodiment according to the illustrated fluoroscopy device can generate data which can be image data to determine torso geometry and consequently body surface electrode positions. The device can also provide data associated with an epicardial envelope surrounding the heart where those of ordinary skill understand that the epicardial envelope can provide an estimate of the epicardial surface. Further locating the epicardial envelope or surface can include determining or otherwise providing data to be associated with the location of the heart. In an exemplary system that utilizes a fluoroscopy device the scanner can provide slice thickness between one and eight millimeters and can have adjustable kVp and mAs settings to perform different types of CT scans of different parts of a patient s body.

Referring again to electric potentials measured on the torso surface can be input to or otherwise provided to the processor from the vest or other device that provides electrical potentials where in the embodiment the processor can store such electrical potentials. The processor can then cause epicardial potentials to be determined based on the aforementioned electrical potentials and matrix of coefficients A. As provided previously herein based on the epicardial potentials electrograms and isochrone maps can be generated for display and evaluation .

Those of ordinary skill will recognize that the modules and or components of are merely illustrative for explanatory purposes and such modules can be otherwise combined and or dispersed amongst one or more processors. Accordingly includes an embodiment according to where data from a geometry determining device and electrical potential data from a body surface measuring device can provide input to the processor . As indicates the input data and other data can be conditionally processed and provided to a boundary element module . Forward computations or computing torso potentials from known epicardial potentials and or inverse computations or computing epicardial surface potentials based on measured torso potentials as provided herein can employ data from the boundary element module . Those of ordinary skill will recognize that in clinical applications inverse computations are computed. Once the forward and or reverse computations are performed output and or post processing can be performed and optionally output files can be generated.

Accordingly epicardial surface potentials or the electrical potentials on the surface of the heart can be determined based on the stored body surface potentials and the matrix of coefficients that relates the potentials from the body surface to the epicardial surface. Electrograms and isochrones for example and other data representations can be generated based on the epicardial surface potentials and optionally output to a device .

Those of ordinary skill will recognize that computing torso potentials based on measured epicardial potentials the Forward Problem includes solving Laplace s equation which entails the discretization of Laplace s equation using Green s second theorem as described in far example Jackson J D Classical electrodynamics John Wiley and Sons New York 1975 in the volume between the epicardial surface and the body surface. A known boundary element method BEM e.g. Brebbia C A Telles J C F Wrobel L C Boundary element techniques. Theory and applications in engineering Springer Verlag Berlin 1984 or Brebbia et al. Boundary Elements An Introductory Course McGraw Hill New York 1989 can be employed.

Accordingly a relationship between the epicardial surface potentials and the torso potentials can be expressed as the following linear matrix relationship V AV 0 where Vis the vector of epicardial potentials Vis the vector of torso potentials and A is the N Nof transfer matrix of influence coefficients between the heart or epicardial envelope and the torso or electrode positions . The A matrix is thus based on the geometry and the conductivities of the media in the volume between the heart and torso. Although the torso can be understood to be homogeneous i.e. uniform conductivity between the epicardial surface and the body surface the A matrix can be modified to account for torso inhomogeneities e.g. lungs etc. . Accordingly Equation 0 represents the forward problem of electrocardiography for computing body surface potentials from epicardial potentials.

One of ordinary skill can thus recognize that the A matrix is based on the geometrical relationship between the epicardial surface or envelope and the torso and accordingly the A matrix is based on node positions corresponding to electrode positions on the torso and node positions on the epicardium.

The disclosed methods and systems can be employed to determine the values of the A matrix where the disclosed methods and systems can employ projective geometry epipolar geometry point reconstruction surface interpolation and visualization techniques. provides one block diagram for deriving such geometrical relationships based on biplane fluoroscopy although those of ordinary skill will recognize that the disclosed methods and systems can be applied to other image data including data acquired using a digital camera for example.

In one embodiment the disclosed methods and systems can include a calibration that can be a single view calibration. Although the calibration procedure can be performed using various objects and or procedures in one exemplary process the calibration procedure can include a calibration object and a planar board where the calibration object and the planar board can be positioned to facilitate a calibration process such as the calibration process provided herein. For example the calibration object and planar board can be configured with lead markers and the calibration object and planar board can be composed of an X ray transparent material such as acrylic although other materials may be used. Further an exemplary calibration object can be V shaped and can include a number of markers where in one embodiment approximately twenty markers can be use. Similarly a planar board can be used to include a number of markers where in one embodiment no less than approximately fifty markers may be included in the planar board. In some embodiments where the object for which surface geometry is desired is accessible markers can be placed on the object. For the illustrated embodiments that include determining a surface geometry of an object such as a heart organ that may not be accessible the aforementioned calibration objects e.g V shaped planar board can be used.

In an illustrative V shaped embodiment of a calibration object such shape can provide that at least six non coplanar markers can be detected or otherwise viewed from anterior lateral and oblique fluoroscopic views. As will be provided herein views and or detection of at least six non coplanar lead markers can facilitate single view calibration.

In one embodiment and with reference to and one embodiment providing additional detail in a three dimensional 3D digitizing instrument such as for example the Microscribe G2L system by Immersion Corporation can be used to provide 3D data based on the relative positions of the markers on the calibration object and similarly on the planar board . A subject can be presented in a supine position on a mattress with the calibration object placed on or otherwise supported by and or over the subject s torso and the planar board can be positioned below the subject s back including for example under the mattress. Those of ordinary skill will recognize that such supine positioning is merely illustrative and other positions can be used. With such aforementioned supine positioning the 3D digitizing instrument can be employed to obtain 3D data indicating the relative positions of the calibration object and the planar board e.g. the planar board can have markers that are accessible while placed under mattress and other marker locations can be based on the accessible markers and previously obtained relative marker data. . Further biplane fluoroscopy data acquired at for example a rate of thirty frames per second can be acquired to enable data acquisition of at least six markers. The two fluoroscopic views may not and need not reveal the same calibration object markers.

It can be recognized that a camera or X ray system such as a fluoroscopy system can be described by a central projection model known as the basic pinhole model which provides a linear method to map real world coordinates of an object or a three dimensional 3D scene e.g. the scene can include the subject having the calibration object and planar board positioned as provided herein to two dimensional 2D image coordinates. The mapping from real world or scene coordinates to image coordinates can be via a projection matrix P.

The principal axis can be understood as the line through C or C and perpendicular to the retinal plane which intersects the image plane at the projection of the camera X ray center where such point is known as the principal point. Accordingly a 3D Euclidean point M x y Z can be mapped or otherwise transformed to a 2D image point m or m u fX z v fy z which one of ordinary skill will understand is not defined where z 0. This non linear relationship between M and m or m can be linearly described using homogeneous coordinates for m or m and M 

where x y z 1 and u v 1 are the projective and or homogenous coordinates of real world or scene point M and its respective image point m or m . Equation 1a can also be rewritten in a form shown in Equation 1b sm PM 1b where m u v 1 e.g. mor m can represent the homogeneous coordinates vector of the image point m M x y z 1 can represent the homogeneous coordinates vector of the object point M s represents a scaling factor and P is the aforementioned projection matrix describing the projection. In the aforementioned example P is a 3 4 matrix.

Accordingly Equations 1a and represent a simplified expression for a projection matrix in a central projection where the camera X ray source coordinate system is aligned with the 3D world or scene coordinate system and the image points are referenced to the principal point. Because this alignment between the two images is generally not encountered the projection matrix can be represented by the form 2a where K represents the internal parameters of the camera X ray focal length principal point coordinates and R t represents external parameters rotation and translation between the 3D scene and camera X ray coordinate systems . When applying Equation 2a to Equation 1b Equation 1b can be expressed as 2b Single view calibration techniques accordingly seek to determine a projection matrix P given a set of points in a scene with known 3D coordinates M and corresponding 2D image points m or m . For a given view for each point in the scene M and the corresponding image point m Equation 2b provides sm PM 3 Expanding Equation 3 using homogeneous coordinates provides 

Expanding the matrix multiplication and substituting for s in the first two equations of Equation 4 provides . . 5 When six or more points in the scene are provided Equation 5 can be expressed as 

Accordingly the projection vector p p . . . p and hence the projection matrix P for a given view can be determined through the eigenvalue decomposition of the Equation 6 matrix and selecting the eigenvector associated with the minimum eigenvalue.

As those of ordinary skill in the art will recognize and as provided in in embodiments that employ biplane fluoroscopy and or stereovision the 3D scene can be imaged from two views simultaneously or sequentially e.g. a moving camera around the scene . The geometry relating the two views can be described by an epipolar constraint that can be independent of the scene and can be based on the camera s X ray s intrinsic parameters and a relative relationship between the two fluoroscopic views. accordingly represents the epipolar geometry of two fluoroscopic views described by projection matrices Pand Prespectively. With reference to image points mand mcan be referred to as corresponding image points as they represent the same scene object point M in two different images fluoroscopy views . These two points mand m are constrained by the epipolar geometry and as such a given image point in the first view e.g. m corresponds to an epipolar line in the second view on which the corresponding image point e.g. m lies. Epipolar lines in the second view intersect at the epipole e that corresponds to the image of the camera center X ray source for the first view f . Similarly epipolar lines in the first view intersect at the epipole not shown corresponding to the image of the camera center or X ray source for the second view. The epipolar geometry can thus be represented by a 3 3 matrix that can be known as the fundamental matrix F which relates homogenous coordinates of corresponding image points from two views such that for 1 and 1 then mFm 0 7 

Accordingly the fundamental matrix F can be determined from a set of corresponding image points e.g. m m without prior knowledge of the scene or the projection matrices however when the projection matrices for the first and second matrices are known F can be derived from the projection matrices and the epipole in the second view e 8 where Prepresents the projection matrix for the first view P represents the pseudo inverse of the projection matrix for the second view and e represents the skew matrix formed from the epipole in the second image. The homogeneous coordinates of the epipole ecan accordingly be determined by solving equation Fe 0 and determining the eigenvector corresponding to the smallest eigenvalue of F.

Given Euclidean calibrated projection matrices Pand Pfor the first and second views respectively and also given a pair of corresponding image points m u v 1 and m u v 1 of an object point M x y z t in the scene the 3D coordinates of point M can be recovered by triangulation. The following relationships can be applied to the first and second views 

Accordingly referring back to based on two images views of the aforementioned calibration object and planar board scene e.g. subject in supine position that can be obtained through fluoroscopy digital camera or other imaging means image coordinates can be determined for at least six selected markers in the views V and V where such markers can be on the calibration object and or the planar board and where such markers appear in both views. Using Equation 6 provided herein respective projection matrices Pand P describing the internal matrices of the camera X ray or other imaging device can be computed based on the image coordinates from the respective single views V and V. Equation 11 provided herein can be employed to compute 3D coordinates for the corresponding markers based on the computed projection matrices P P . The markers for which the 3D coordinates are computed may include the six or more markers from which the projection matrices were computed and or other markers. It can thus be recognized that 3D coordinates can be computed for one or more markers where as provided herein 3D computations for a comparatively greater number of markers may allow a comparatively better evaluation of the accuracy of the projection matrices. Accordingly the computed 3D marker coordinates can be compared against the digitized 3D marker coordinates and such comparison can be further related to an accuracy criteria such as one or more thresholds . Based on the threshold the calibration process may be deemed complete or may be performed again. For example in one embodiment statistics such as a mean error and or standard deviation can be derived based on comparisons between computed 3D coordinates and digitized coordinates e.g. for the various marker s for which 3D coordinates were computed where such statistics and or comparison can provide an accuracy measure of the projection matrices. In one embodiment based on the statistics and or the comparison the calibration procedure can be re performed based on a re selection of markers where markers that may be considered better known may be re selected while those that may not be as well known may be avoided or otherwise de selected. In an embodiment re performing calibration can include restarting from the obtaining of the 3D digitized data and or the obtaining of the 2D images . In one example the aforementioned threshold can include five millimeters e.g. difference between computed 3D coordinates and digitized coordinates although such example is provided for illustration and not limitation.

Returning again to in one embodiment a user can perform contour designation by viewing multiframe animated images of the heart based on biplane fluoroscopic projections for the two views. The views can include the entirety of the object surface for which a geometry is desired which in the illustrated embodiments is the heart. Accordingly a user can identify a frame for each view that can be associated with an outer boundary of the beating heart. For example ECGI images can be obtained during cardiac activation and therefore heart contours corresponding to end diastole can be identified when a comparatively enlarged projection of the heart may be obtained. In some embodiments a dye or other substance may be injected into the subject human or otherwise to facilitate identification of the outer boundary of the heart.

In one embodiment a user or another can utilize a computer mouse or other designation scheme joystick stylus etc. to select designate determine or otherwise delineate data points along an outer contour for each of the two views where the selections can be made from a display of the two views. In some embodiments a contour and or boundary can additionally and or optionally be automatically generated determined and or detected using image processing techniques. Accordingly a processor program associated with the displayed data can receive the user provided contour data points and interpolate such user designated data and or otherwise process the data e.g. automatic boundary contour detection to create a contour of the outer boundary. In one embodiment the user or another can specify a number of points to include in the contour. For example a user may provide that one hundred points be included in the contour. In an embodiment such as provided by and the heart contour created by the processor program based on the user delineated points can be visually displayed e.g. such that the contour may be superimposed upon the displayed image data.

Referring now to and that provide two identified views e.g. images using biplanar fluoroscopy as provided herein previously a point m u v 1 on the heart contour can define an epipolar line in the second view where the epipolar line can be expressed as l Fm where F is the fundamental matrix F relating the two views as derived from the projection matrices Pand Pand based further on Equation 8 . The intersection of the epipolar line l with the heart contour in the second image view can be associated with the corresponding matching contour point m . Similarly m defines an epipolar line in the first view not shown that can be expressed as l Fm .

For example a point m e.g. image coordinate can be selected where mcan be on or otherwise associated with the designated contour in the first view. Based on the fundamental matrix e.g. the projection matrices a first epipolar line can be computed as provided herein and also determined can be the intersection of the first epipolar line with the contour in the second view. Such intersection can provide two matching contour points in the second view both of which can be associated with a second epipolar line. Accordingly based on either one of the two matching points from the second view and the fundamental matrix the second epipolar line can be computed and the intersection of the second epipolar line with the first view image can be determined to identify mand a second point along the designated contour in the first view. Those of ordinary skill will recognize that based on the point m three additional points can be computed e.g. two matching point pairs and such computations can be computed for a number of points along the designated contour in the first view. It may be understood that the designations of first view and second view as described herein are merely arbitrary and the disclosed methods and systems could identify matching points based initially on points derived from a designated contour in the second view.

Returning again to and also shown is a frontier point i.e. intersection of two contour generators and the corresponding epipolar line which is tangent to the heart contour.

Accordingly returning again to for a designated or otherwise selected e.g. via a user or another number of data points along the aforementioned selected and or designated contour matching points as provided herein can be computed and for a pair of matching contour points e.g. m u v m u v point reconstruction can be performed to determine or otherwise reconstruct 3D coordinates e.g. M x y z corresponding to the object or real world point based on the projection matrices and Equation 11 .

As indicates four points and or sets of 3D coordinates can be reconstructed from a pair of matching contour points although those of ordinary skill will recognize that a pair of matching and or corresponding frontier points reconstructs a single object point.

Referring again to focal point ffor the first view can be determined by solving the homogeneous equation Pf 0 while focal point fcan be similarly determined for the second view . As indicates focal points fand fcan define a line and the reconstructed points can be weighted based on a distance of the reconstructed 3D points from the line . In the illustrated example a reconstructed point associated with a comparatively greatest distance can be assigned a weight of 0.1 while the other reconstructed points can be assigned weights of 0.3. Those of ordinary skill in the art will recognize that such weight assignments are merely illustrative of one weighting scheme and other weighting schemes e.g. uniform weights weights inversely proportional to the distance from the centroid etc. can be used without limiting the scope of the disclosed methods and systems.

Referring to and the four weighted 3D points thus can be understood to approximate a b spline where the point farthest from line may have the smallest effect on the shape of the b spline whereas the three points closer to the line can have a comparatively greater influence.

The matching of contour points point reconstruction and b spline approximation can be repeated for a specified number of points along the contour e.g. one hundred to provide a set e.g. one hundred of 3D b splines. Referring again to the 3D spline data can be converted to spherical coordinates and in some embodiments can optionally be interpolated and or fitted to a surface where in one embodiment the fit can be based on a bicubic spline least squares fit. As also indicates the fitted interpolated data can be converted to or otherwise projected to Cartesian coordinates . Further the fitted interpolated data can be projected onto a unit sphere where the unit sphere has a center based on the centroid of the 3D b spline data. The Cartesian data can be combined with connectivity information based on a convex hull of the aforementioned unit sphere to triangulate the Cartesian data based on the connectivity information to form a meshed surface that approximates the heart boundary .

Those of ordinary skill will recognize variations in the illustrated methods and systems which can include for example systems and methods that may not generate b splines but may cluster the 3D data four reconstructed points from matching pairs of contour points and may compute a volume that can be fitted to a surface. In a variation of the methods and systems those of ordinary skill will recognize that connectivity data can be extracted without projecting data to a unit sphere and computing a convex hull.

As also indicates 3D digitized data from the torso vest electrode positions x y z coordinates can be meshed to form the torso surface associated with the torso geometry. Those of ordinary skill in the art will recognize that the meshing of the torso vest electrodes can be performed as outlined previously with respect to the outer boundary of the heart. Accordingly the torso nodes or vest electrode positions can be projected onto a unit sphere centered at the centroid of the torso nodes a convex hull can be computed and using connectivity information from the convex hull the torso nodes can be meshed. In some embodiments conversion to spherical coordinates fitting and or interpolation can optionally be performed.

The meshed surfaces of the torso and the heart can be associated e.g. registered and provided to a boundary element method module which can compute the relationships between the meshed surfaces and thus provide the geometry or A matrix provided in Equation 0 .

The disclosed methods and systems for determining heart geometry were applied to a realistic plastic heart model that was imaged using biplane fluoroscopy at various dual angles Anterior Posterior AP 0 Left Anterior Oblique LAO 70 Right Anterior Oblique RAO 10 LAO 70 RAO 20 LAO 70 RAO 30 LAO 60 RAO 40 LAO 50 RAO 50 LAO 40 . The heart was reconstructed from each pair of biplane angles. Additionally the phantom heart geometry was acquired using a CT scanner at a sampling interval of 3.2 mm and a pitch of 0.5. The heart boundary in each CT slice was segmented using deformable model segmentation. The segmented cross sectional contours were then meshed and the resulting surface used as gold standard for validation of the fluoroscopy reconstructed heart.

As provided herein accurate localization of the recording electrodes on the body surface can be crucial for increased accuracy and a mannequin with ninety two visible markers simulating actual electrodes on the anterior surface was employed. A V shaped calibration object was placed over the mannequin. Eight markers on the calibration object and six markers on the mannequin were digitized using a mechanical digitizer e.g. MicroScribe G2L Immersion Corporation and used for single camera calibration of each picture in stereo photographs. A total of three pairs of stereoscopic photographs were taken with a digital camera SONY DSC S85 . Taken in pairs the photographs were calibrated and the 3D coordinates of corresponding markers were determined using point reconstruction as provided herein relative to . These were compared to the actual coordinates digitized using the mechanical digitizer MicroScribe G2L Immersion Corporation .

The fluoroscopy based algorithm for reconstructing the heart geometry was validated in a human subject. The subject s heart was imaged using biplane fluoroscopy RAO 40 LAO 50 with the subject in a supine position while the marker board was situated under the subject with the calibration object supported by over the torso chest. The markers were digitized using a mechanical digitizer e.g. MicroScribe G2L Immersion Corporation and used to calibrate the fluoroscopic views. Because of the low quality of the fluoroscopic images the manually segmented heart contour was enlarged by 10 to ensure that the reconstructed envelope surrounded the heart surface. The fluoroscopy reconstructed heart was validated in comparison with the CT heart imaged using ECG gated axial CT scanning Phillips Mx8000 at a resolution of 0.6 mm and a pitch of 1.

Signed positive implies outside negative implies inside distance measure quantified the differences between the fluoroscopy reconstructed heart and the gold standard CT heart. The distance error was computed as follows 

Noninvasive Electrocardiographic Imaging ECGI was performed in a human subject during normal heart rhythm. Body surface potentials were acquired from 224 ECG electrodes using a previously described mapping system and an electrode vest. See for example Rudy Y Burnes J E. Noninvasive electrocardiographic imaging. 1999 4 340 59. incorporated herein by reference in its entirety . Recorded electrocardiograms were amplified and band pass filtered between 0.5 and 500 Hz. The heart was imaged using CT and biplane fluoroscopy. The fluoroscopy based method and system was employed to reconstruct an envelope around the subject s heart. The heart geometry was also computed based on the CT slices. The locations of the body surface electrodes were digitized using a 3D mechanical digitizer e.g. MicroScribe G2L Immersion Corporation . Consequently two data sets described the subject s geometry 1 CT constructed heart with digitized body surface electrodes and 2 Fluoroscopy reconstructed heart envelope with digitized body surface electrodes. Using a boundary element method the transfer matrices relating epicardial for CT or heart envelope for fluoroscopy to body surface potentials was derived.

The recorded body surface potentials were employed to compute potentials on the CT constructed epicardium and the fluoroscopy reconstructed envelope during normal cardiac electrical activation. Imaged potentials on these two surfaces were compared to evaluate the accuracy of the ECGI fluoroscopy approach relative to the ECGI CT approach.

Table 1 summarizes the results for the fluoroscopy reconstructed phantom heart. For pairs of biplane angles minimum maximum mean and standard deviation of the absolute distance errors relative to the CT heart were computed. In all cases the mean distance error is approximately 4 mm. provides results for selected biplane angles AP LAO 70 left column RAO 20 LAO 70 middle column and RAO 30 LAO 60 right column . The reference CT heart as segmented and constructed from the CT slices is shown in the top left panel. The middle row shows the fluoroscopy reconstructed heart with signed distance error maps. Negative values indicate that the region of the fluoroscopy reconstructed heart is interior to the CT heart and positive values indicate that it is exterior. The last row overlays the CT heart on the signed distance error map.

In addition to biplane fluoroscopy the disclosed methods and systems for determining the heart geometry can be extended to multiple plane fluoroscopy. shows the fluoroscopy reconstructed heart from four views AP LAO 70 and RAO 30 LAO 60 in comparison to CT. Two sets of 3D splines are reconstructed from pairs of biplane angles and the convex hull of the splines is obtained and meshed. Comparatively improved distance errors mean decreased to 3.8 mm suggest that incorporation of four views can improve the reconstructed heart geometry. The last row of Table 1 summarizes the results for the four views case.

In one embodiment point reconstruction techniques were employed to reconstruct the electrode positions from stereo photographs . The electrode markers x affixed on the anterior surface of a mannequin were identified in the images and matched. The projection matrices were obtained for the respective photographs using single view camera calibration as provided previously herein. The reconstructed electrode positions were compared to the actual digitized coordinates from the scene. shows the signed distance error map for the reconstructed electrodes on the anterior surface of the mannequin. The mean absolute distance error was 1 mm.

Accordingly returning to Equation 0 which is based on the aforementioned A matrix that provides the geometrical relationship between the torso and the epicardial surface of the heart Equation 0 can be rearranged to express the epicardial potentials in terms of the body surface potentials and the inverse of the A matrix V AV 12 

The problem of determining the inverse of the A matrix is ill posed as small perturbations in the data e.g. measurement noise or geometrical errors can cause large unbounded errors which accordingly can require regularization of the solution to Equation 12 . In one embodiment Tikhonov regularization See Tikhonov A N Arsenin V Y Solutions of ill posed problems trans from Russian Wiley NY 1977 or Tikhonov et al. Solutions of ill posed problems 27 94 V H Winston Sons Washington D.C. 1977 which are hereby incorporated herein by reference can be used to stabilize the solution to Equation 12 by imposing constraints on the magnitudes or derivatives of the computed epicardial potentials which includes determining an epicardial solution V that minimizes the following objective function Minimize over V AV V t LV 13 

The first term in Equation 13 represents the least square solution of Equation 12 while the second term in Equation 13 is a regularization term that imposes bounds on the amplitude of the solution to Equation 12 . Those of ordinary skill recognize that the regularization parameter t controls the degree of the imposed constraint and provides a balance between the accuracy and stability of the solution while L is a regularization operator e.g. unity gradient or Laplacian . In one example the regularization parameter t can be determined using the CRESO Composite Residual and Smoothing Operator method. See for example Colli Franzone P Guerri L Tentoni S Viganotti C Baruffi S Spaggiari S Taccardi B Mathematical procedure for solving the inverse problem of electrocardiography Math Biosci 77 353 96 1985 and Colli Franzone et al. Finite element approximation of regularized solutions of the inverse problem of electrocardiography and applications to experimental data Calcolo 1985 22 91 186 which are incorporated herein by reference and has been found to perform comparably to the optimal t that provides the minimum RMS error between the computed Vand the measured V e.g. experimental studies . See Messinger Rapport B J Rudy Y Computational issues of importance to the inverse recovery of epicardial potentials in a realistic heart torso geometry published erratum appears in Match Biosci 1990 April 99 1 141 Math Biosci 97 85 120 1989 which is incorporated herein by reference. The CRESO regularization parameter t depends on the vector Vand the matrix A. Accordingly computing the epicardial potentials V is based on non invasively obtained data that includes the torso surface electric potentials V e.g. torso vest electrode data and geometry data e.g. CT bi plane X ray etc. to develop the A matrix .

As provided herein Tikhonov regularization imposes constraints on the magnitudes or derivatives of the computed epicardial potentials to provide a solution. Applying these constraints requires some a priori knowledge of the solutions properties which in the illustrated embodiments can cause a spatial smoothing of epicardial potentials that may reduce spatial resolution and diagnostically meaningful data or information. The Tikhonov regularization also requires an accurate determination of the aforementioned regularization parameter t which determines the constraint level. The aforementioned methods to determine the regularization parameter e.g. Composite Residual and Smoothing operator CRESO L curve and Zero crossing may not perform consistently and can be sensitive to the noise level of the data. In some cases a priori information and manual adjustment may be required to choose an optimal regularization parameter. For example a priori knowledge of the number of ectopic foci sites from which excitation is initiated may influence the level of regularization applied.

A complementary approach to solving Equation 12 includes the Generalized Minimal Residual GMRes method which unlike the Tikhonov regularization is not based on imposing constraints and therefore does not include a priori data or information about the solution or determination of a regularization parameter. Referring again to Equation 12 GMRes is thus an iterative method of computing Vfrom Vwithout imposing constraints on the solution.

As in known in the art the GMRes method belongs to the class of Krylov subspace iterative methods. Generally for the linear problem Ax b where A is a matrix and x is a vector see e.g. Equation 0 the Krylov space of A is the subspace spanned by x Ax Ax etc. Accordingly if M is a preconditioner such that MA I identity matrix then for M Ax b e as e approaches zero Mapproaches an approximation of A. Hence an iteration can be constructed as x x M Ax b where the error at an iteration k can be expressed as M Ax b . Those of ordinary skill will recognize that GMRes is one approach for reducing the error to provide an approximation for M i.e. A which uses an orthogonal Arnoldi decomposition of the A matrix.

Accordingly with specific reference to Equations 0 and 12 given a vector VT and the matrix A an n dimensional Krylov subspace K n can be based on a set of linear combinations of the vectors V AV AV . . . AV. At the nGMRes iteration the A matrix inverse can be approximated by a projection of A p A onto K n . Accordingly based on Equation 12 epicardial potentials V can be approximated by p A V.

The GMRes method proceeds by constructing at the nth iteration an orthonormal basis for the Krylov subspace K n . Because the A matrix is generally non square e.g. number of torso electrodes is generally not equal to number of reconstruction points on the epicardium the disclosed methods and systems can be understood to include multiplying both sides of Equation 0 by Vand applying a GMRes method to the solution of AAV AV AA is a square matrix . Since the Krylov subspaces form a nested sequence the norm of the residual error AV V decreases as n increases. A solution with reduced contamination from noise components can be achieved by stopping the iterations of the GMRes method.

As provided herein at the nGMRes iteration the matrix Acan be approximated by the projection of A p A onto the Krylov subspace K n . It is understood in the art that such projection subspace K n can be represented as an upper triangular Hessenberg matrix H n . Further the number of iterations e.g. the value of n can be based on the observation that as n increases the condition number of H n increases i.e. H n can become ill conditioned while the norm of the residual error AV V decreases. A plot of the condition number of H n versus the norm of the nth residual error illustrates the effect of GMRes iterations on these two quantities and is shown as .

As indicates for a method and system that utilize GMRes to compute a solution to Equation 12 and hence can be based on a number of iterations as the iteration number increases the condition of an associated Hessenberg matrix can be accompanied by a decrease in the norm of the residual error AV V . As indicates this decrease can be comparatively significant during the first iterations when compared to subsequent iterations. Accordingly one of skill in the art will recognize that the incremental decrease in residual error AV V for additional iterations may be insignificant after a given number of iterations while the condition number of the Hessenberg matrix continues to increase.

Based on one compromise between number of iterations decreased residual error and Hessenberg matrix condition can include selecting a number of iterations for the GMRes method that is associated with or otherwise based upon a representation of residual error versus condition number and where such number of iterations can be a compromise between residual error decrease and condition number increase. For the embodiment for example a selected or chosen number of iterations can be associated with the elbow of a curve that represents residual error norm based on condition number of the Hessenberg matrix. Those of ordinary skill will recognize to represent a condition L curve which has a corner that can otherwise be understood to be an elbow. In one embodiment a corner of a condition L curve can be selected by a curvature detection module that computes curvature along a condition L curve. In one example a selected number of iterations can be a number of iterations associated with a comparative maximum curvature of a condition L curve. In an embodiment a selected number of iterations can be determined from a corner of a L curve compare to condition L curve that can plot or otherwise represent residual error norm and e.g. versus solution norm. Accordingly in such an embodiment a number of iterations can be based on the corner of a L curve which can be based on a comparative maximum curvature although other methods can be used.

In some embodiments a selected number of GMRes iterations can be determined based on an increase in spatial frequency of a reconstructed potential map where such evaluation can be performed after an iteration of the GMRes technique and can be based on a Fourier transform or other frequency representation of a potential map. Further a selected number of GMRes iterations can be based on comparative amplitudes of a solution norm that is computed at an iteration where a comparatively increased amplitude in a solution norm at a selected iteration can be a basis for selecting an iteration number. The aforementioned four techniques for selecting a GMRes iteration number are shown in and those of ordinary skill in the art will recognize that other techniques can be used.

Based on a system and method according to if a manual computation of a number of iterations for approximating the A matrix inverse is selected data from the GMRes module corresponding to the number of iterations can be employed to compute an approximation of the A matrix inverse whereupon epicardial surface potentials V can also be computed based on the approximation and the body surface electric potentials V. Also if an automatic number of iterations is selected or otherwise designated an iteration module can be employed to determine a number of iterations upon which an approximation of the A matrix inverse can be computed i.e. based on corresponding data from the GMRes module and epicardial surface potentials V can be computed based on the approximation and the body surface electric potentials V.

As indicated by the illustrative iteration module one or more techniques can be used to determine a number of iterations from which to base the approximation of the A matrix inverse where such techniques were previously described herein. Such automatic determination can be based on the GMRes module data where as provided herein a plot or other comparison of residual error and Hessenberg matrix condition can be computed to determine a corner of a condition L curve. One or more of the illustrated techniques and other methods can be used and compared for example to provide an iteration number. Data associated with the iteration number e.g. Hessenberg matrix etc. can be retrieved from the GMRes module or other location to compute an approximation to the A matrix inverse.

Several experiments were conducted using isolated canine hearts in a human shaped torso tank where a Langendorff perfused dog heart was suspended in an approximate anatomic position in a human shaped torso tank to facilitate simultaneous recording of body surface and epicardial potentials for single and dual pacing from various sites.

For the single pacing embodiment body surface and epicardial potentials were simultaneously recorded during pacing from a single anterior epicardial site to provide a data set for simulating an arrhythmogenic ectopic focus and providing data for evaluating the aforementioned GMRes systems and methods for localizing initiation sites of arrhythmic activity and other comparatively highly localized electrophysiological events.

For the dual pacing embodiment epicardial potentials were recorded for simultaneous pacing from pacing sites distanced by 2.5 centimeters. The recorded potentials were used to compute body surface potentials in a computer model of the human torso that included the thoracic inhomogeneities of lungs muscle bone and fluid layers. The computed body surface potentials were used to reconstruct epicardial potentials in a homogeneous torso of the same geometry. The dual pacing data set allowed an evaluation of the reconstruction accuracy of GMRes while assuming a homogeneous torso an approximation that greatly simplifies the clinical application of ECGI and an evaluation of the accuracy and spatial resolution of GMRes in localizing two closely spaced pacing sites.

Additionally open chest canine experiments were performed by measuring epicardial potentials from hearts of open chest dogs i.e. exposed by sternotomy using a multi electrode epicardial sock. The open chest data was used to compute body surface potentials in a homogeneous or inhomogeneous computer model of the human torso. Measurement noise e.g. 50 V peak to peak Gaussian and geometrical errors e.g. 1 mm Gaussian were added to the body surface potentials and electrode positions respectively to simulate experimental or clinical measurements. These contaminated body surface potentials were then used to reconstruct epicardial potentials using the ECGI methodology.

Epicardial potentials during right atrial pacing i.e. simulating normal sinus rhythm were recorded from a 490 electrode sock. A region of infarcted tissue was created by the ligation of the left anterior descending coronary artery LAD and ethanol injection. This data set allowed an evaluation of the GMRes methods and systems to reconstruct abnormal electrophysiological properties of an infarct substrate.

Infarction was produced in a canine heart through ligation of the LAD. After four days of infarct formation in a closed chest the chest was opened again and a 490 electrode sock pulled over the heart to record potentials. Monomorphic Ventricular Tachycardia VT due to double loop epicardial reentry was induced through programmed stimulation and recorded. This data set was used to evaluate the GMRes methods and systems for reconstructing the reentry pathway and its various electrophysiological components.

Abnormal and heterogeneous repolarization is understood to be an underlying mechanism of many arrhythmias. Localized epicardial cooling was applied to prolong action potential duration in a region of the LV and consequently increase dispersion of repolarization. Epicardial potentials were recorded during RA pacing and QRST integral maps were computed to reflect local repolarization properties.

For the data sets presented herein epicardial potentials were reconstructed using the GMRes method and the results were validated by direct comparison to measured epicardial potentials which served as the gold standard. A zero initial value was used as a starting point for the GMRes iterations. The GMRes results were also compared with corresponding Tikhonov reconstructions. A hybrid method Tik GMRes method was also developed and evaluated. In the hybrid method GMRes solutions were computed with the Tikhonov solution rather than zero as the starting point for the iterative scheme.

Epicardial potential maps were reconstructed which depict the spatial distributions of potentials on an epicardial envelope of the heart. Although an epicardial potential map depicts one instant of time epicardial potential maps were computed at intervals of one millisecond during an entire cardiac cycle. Electrograms were also reconstructed depicting the variation of potential with respect to time at a single point on the epicardium. The reconstructed electrograms were generally computed at approximately two hundred to five hundred sites or points around the epicardial envelope. Further isochrone maps were reconstructed which depict the sequence of epicardial activation based on local activation time taken as the point of maximum negative derivative dV dtmax of each electrogram.

Results were based on visual comparison and when possible included statistical measures in the form of relative errors and correlation coefficients.

Based on in certain embodiments a method and system that employs GMRes can resolve multiple electrophysiological events e.g. initial activation sites with higher spatial resolution than a constraint based Tikhonov approach.

The sensitivity of the GMRes method to potential noise and geometry errors was also evaluated using the data set of . Various combinations of potential noise either 50 microvolt or 100 microvolt Gaussian and geometrical errors in torso electrode positions either one two or three millimeter Gaussian were added to the input data. The quality of the GMRes solution was comparable to the solution obtained with original data without the added noise.

Further the hybrid method which included starting with the Tikhonov solution rather than an initial value of zero for GMRes improved the patterns and localization accuracy of the reconstruction of two pacing sites . For other data sets some improvement in accuracy was observed when using the hybrid method.

What has thus been described are methods and systems for computing epicardial surface electric potentials based on measured body surface electric potentials where the methods and systems include representing at least one geometric relationship between at least one body surface electric potential measuring system and the epicardial surface as a multidimensional matrix estimating an inverse of the multidimensional matrix based on a Generalized Minimum Residual GMRes method and based on the inverse matrix and the measured body surface potentials determining the epicardial surface electric potentials. Also disclosed is a method for determining the geometric relationship by employing 2D image data to reconstruct a 3D surface using epipolar geometry.

The methods and systems described herein are not limited to a particular hardware or software configuration and may find applicability in many computing or processing environments. The methods and systems can be implemented in hardware or software or a combination of hardware and software. The methods and systems can be implemented in one or more computer programs where a computer program can be understood to include one or more processor executable instructions. The computer program s can execute on one or more programmable processors and can be stored on one or more storage medium readable by the processor including volatile and non volatile memory and or storage elements one or more input devices and or one or more output devices. The processor thus can access one or more input devices to obtain input data and can access one or more output devices to communicate output data. The input and or output devices can include one or more of the following Random Access Memory RAM Redundant Array of Independent Disks RAID floppy drive CD DVD magnetic disk internal hard drive external hard drive memory stick or other storage device capable of being accessed by a processor as provided herein where such aforementioned examples are not exhaustive and are for illustration and not limitation.

The computer program s is preferably implemented using one or more high level procedural or object oriented programming languages to communicate with a computer system however the program s can be implemented in assembly or machine language if desired. The language can be compiled or interpreted.

As provided herein the processor s can thus be embedded in one or more devices that can be operated independently or together in a networked environment where the network can include for example a Local Area Network LAN wide area network WAN and or can include an intranet and or the internet and or another network. The network s can be wired or wireless or a combination thereof and can use one or more communications protocols to facilitate communications between the different processors. The processors can be configured for distributed processing and can utilize in some embodiments a client server model as needed. Accordingly the methods and systems can utilize multiple processors and or processor devices and the processor instructions can be divided amongst such single or multiple processor devices.

The device s or computer systems that integrate with the processor s can include for example a personal computer s workstation e.g. Sun HP personal digital assistant PDA handheld device such as cellular telephone laptop handheld or another device capable of being integrated with a processor s that can operate as provided herein. Accordingly the devices provided herein are not exhaustive and are provided for illustration and not limitation.

References to a processor or the processor can be understood to include one or more processors that can communicate in a stand alone and or a distributed environment s and can thus can be configured to communicate via wired or wireless communications with other processors where such one or more processor can be configured to operate on one or more processor controlled devices that can be similar or different devices. Furthermore references to memory unless otherwise specified can include one or more processor readable and accessible memory elements and or components that can be internal to the processor controlled device external to the processor controlled device and can be accessed via a wired or wireless network using a variety of communications protocols and unless otherwise specified can be arranged to include a combination of external and internal memory devices where such memory can be contiguous and or partitioned based on the application.

Although the methods and systems have been described relative to a specific embodiment thereof they are not so limited. Obviously many modifications and variations may become apparent in light of the above teachings. For example although the methods and system can be applied to cardiac applications those of ordinary skill will recognize that other anatomical parts can be imaged accordingly. Further although the reconstructed data was employed to generate images electrograms and isochrones other data representations can be employed. Although the methods and systems refer to image data received from bi plane fluoroscopy multi planar fluoroscopy may also be employed.

Many additional changes in the details materials and arrangement of parts herein described and illustrated can be made by those skilled in the art. Accordingly it will be understood that the following claims are not to be limited to the embodiments disclosed herein can include practices otherwise than specifically described and are to be interpreted as broadly as allowed under the law.

