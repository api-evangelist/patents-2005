---

title: Document processing apparatus, method and program
abstract: In order to import a document file in which security information is set into a document file to be edited with the security information being included in the document file, a document processing apparatus which imports a specified first document file in which security information is set into a second document file includes an import controller that causes the first document file to be held in the second document file with security information being contained in the first document file to generate a third document file, if the security information is added to the first document file.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07761433&OS=07761433&RS=07761433
owner: Canon Kabushiki Kaisha
number: 07761433
owner_city: Tokyo
owner_country: JP
publication_date: 20050607
---
The present invention relates to a document processing apparatus a document processing method and a document processing program for providing an edit function that imports a document file in which security information is set into a document file to be edited together with the security information settings included in the document file in a system including an information processing device such as a personal computer and a printer.

Conventional electronic document processing systems simply prevent an electronic document file to which such security information that prohibits edit print or copy of the document is attached from being imported into another electronic document file being edited according to the security information. Also a mechanism is known that circumvents security by invalidating security information attached to an electronic document file when one tries to import the electronic document into an electronic document file to be edited.

There are techniques that differentiate between printable and unprintable pages in an electronic document such as the one disclosed in Japanese Patent Application Laid Open No. 2003 162404.

The conventional electronic document processing systems have a problem that because they prevent an electronic document file in which security information for preventing edit print or copy is set from being imported into another electronic document file on the basis of the security information those files must be maintained separately for editing and thus their usability is degraded.

Another mechanism is known that circumvents security by invalidating security information attached to an electronic document file imported into another electronic document file to be edited.

In light of the background of the art an object of the present invention is to provide an electronic document processing technique that enables an electronic document file for which security information is set to be imported into an electronic document file to be edited.

To achieve the object a document processing apparatus method and program have the following main configurations.

More specifically a document processing apparatus for importing a specified first document file into a second document file to be edited comprises an import controller that causes the first document file to be held in the second document file with security information being contained in the first document file to generate a third document file if the security information is added to the first document file.

Moreover a document processing method for importing a first specified document file into a second document file to be edited comprises an import control step of causing the first document file to be held in the second document file with security information being contained in the first document file to generate a third document file if security information is added to the first document file.

Moreover a document processing program which causes a computer to perform a document processing method for importing a specified first document file into a second document file to be edited comprises a program code for an import control step of causing the first document file to be held in the second document file with security information being contained in the first document file to generate a third document file if security information is added to the first document file.

Other features and advantages of the present invention will be apparent from the following descriptions taken in conjunction with the accompanying drawings in which like reference characters designate the same or similar parts throughout the figures thereof.

Embodiments of the present invention will be described below with reference to the accompanying drawings.

Reference numeral denotes a communication controller which controls input and output data at a communication port . Signals outputted through the communication port are provided to a communication port of another device on the network through a communication line . Reference numeral denotes another electronic document processing apparatus connected through the communication line . Electronic document files are sent and received to and from a printer shared on the network or other electronic document processing apparatuses on the network through the communication controller .

While the present embodiment is described with respect to a network such as a LAN the spirit of the present invention is not so limited. The present invention can be applied to a case where other communication means such as a public network is used as a communication port or communication line connected to the communication controller.

Reference numeral denotes a digital camera and denotes an image input output controller. Reference numerals and denote printers. Image data read from the digital camera is loaded in the PMEM through the image input output controller then loaded in a VRAM and displayed on a display through a display output controller . Image data read from the digital camera may be outputted to the printers and through the image input output controller .

Reference numeral denotes an input controller to which input devices such as a keyboard and a pointing device hereinafter also referred to as the PD such as a mouse are connected. An operator can operate the keyboard to provide instructions to the system. The keyboard and the PD can be used to select image information text data or numerical data contained in an electronic document file displayed on the display and specify edit operations or to perform operations for setting print parameters. A mouse cursor on the display can be moved in the X and Y directions as appropriate to select and edit a menu option image data graphic data text data numerical data or a print parameter.

Reference numeral denotes a video image memory hereinafter referred to as the VRAM and denotes a display output controller. Data to be displayed on the DISPLAY is loaded on the VRAM as bitmap data. For example graphic data is loaded a graphic pattern is loaded according to information about its position and rendering attributes.

Reference numerals and denote disks for data files for recording image data graphic data text data or numerical data. For example the disk may be a hard disk hereinafter referred to as the HD and the disk may be a flexible disk hereinafter referred to the FD . An external storage controller controls store and read of data to and fro the HD and the FD .

In the present embodiment the HD stores programs providing functions such as an archive function for integrating a number of files into one file and a function for printing electronic document files. These programs may be stored in recording media such as a ROM a flexible disk a CD ROM a memory card or a magneto optical disk.

The present invention can be implemented in an electronic document processing apparatus in which programs are recorded on an HD and in addition the present invention can be implemented in other system or electronic document processing apparatus by providing a recording medium on which a program that implements the present invention is recorded to that system or apparatus and reading and executing program codes stored on the recording medium by a system of that system or apparatus.

For example the present invention can be implemented by other electronic document processing apparatus by placing an FD on which a program having functions such as a archive function for integrating multiple files into one file and a function for printing electronic document files in an FD drive of the electronic document processing apparatus loading the program onto a hard disk and executing the loaded program.

While the PDF file format is used as an example in the following description of a specific importing process shown in the spirit of the present invention is not limited to that file format. It will be understood that the present invention can be applied to any file format that allows security information to be added to an electronic document file. While only one print file is shown in a print file set may be formed by a number of print files.

Reference numeral denotes a printer information file containing information specific to individual printers which may be DEVMODE structure information in Windows for example. By recording DEVMODE information which was set in a printer driver during the previous printing of the electronic document file the same information set in the printer driver can be set when the file is reprinted. Reference numeral denotes edit information containing information required for editing the electronic document file such as the scaling factor with which the electronic document file was displayed the number of page that was displayed during the previous editing. Editing of electronic document files does not pertain to the present invention and therefore detailed description of which is omitted.

Reference numeral denotes a variable editing information file containing information for performing variable printing of the electronic document file variable printing is printing that allows a portion of a document such as a customer name portion to be changed on a copy by copy basis when multiple copies of the document are printed . Contained in the variable information file is such information that indicates which page of the electronic document file should be changed and in what manner. Variable printing does not pertain to the present invention and therefore detailed description of which is omitted.

Reference numeral denotes a variable database file which is print data used for variable printing. Print data to be changed on a copy by copy basis may be text image or any other data. Reference numeral denotes a search keyword information file containing information indicating what kind of keyword should be registered in a database when the electronic document file is stored in the database for searching for the document. Reference numeral denotes a print job data file which is a job file for printing generated by a printer driver when the electronic document file was printed and which is to be used when next time the electronic document file is printed on the same printer. The electronic document file may be stored in any database. Storing electronic document files in a database does not pertain to the present invention and therefore the description of which is omitted.

Reference numeral denotes the file name which is assigned to each file when it is retrieved from the archive electronic document file. Reference numeral denotes the file size which indicates the size of the area in the archive electronic document file that is occupied by the file. In particular the size varies depending on whether the file is compressed or not. Reference numeral denotes the offset to the body of the file which is the offset of the area in the archive electronic document file occupied by the file from the starting point of the file. Reference numeral denotes a compression flag which indicates whether the file stored in the archive electronic document file is compressed or not. Reference numeral denotes a compression method such as MMR which serves only when the compression flag indicates that the file is compressed.

The description of details of compression methods is omitted. Reference numeral denotes a file attribute. This field contains a file attribute such as Read Only which originally belongs to the file and will be given to the file when it is unarchived by an unarchiving function. Reference numeral denotes the offset to the next file information area which is the offset from the starting point of the archive electronic document file. While information about the remaining files is omitted from items to for the files are recorded in the same pattern.

Reference numeral denotes a total file number filed which indicates the number of the files constituting the electronic document file. The print procedure file through the print job data file shown in are the constituent files and therefore the number of files is in this example. Reference numeral denotes the offset to the first file information area in which the first file information is recorded from the starting point of the electronic document management file. Recorded in the fields to is information about each of the files constituting the electronic document file. Filed is a file name field which indicates the name of each of the files constituting the electronic document file. This may be the name of a file such as the print procedure description file for example. Field is a file size field in which the size of the print procedure description file for example is recorded. Field contains a path to the file which indicates the directory in which the file is created. Filed is a file group type field in which the type of a file such as the print procedure description file through the print job data file can be recorded. If there are multiple print procedure description files for example this filed the files to be of the same time. Filed contains the offset to the next file information area which indicates the offset from the starting point of the electronic document management file. While information about the remaining files are omitted from items to for the remaining N files are recorded in the same pattern.

Reference numeral denotes the previous display scaling factor which is the scaling factor with which the electronic document file was previously displayed. Reference numeral denotes the previous display page number which indicates the number of page of the electronic document file that was displayed. Reference numeral denotes the previous window display position which indicates the position in which a window for editing the electronic document file was displayed. Reference numeral denotes the window display size which indicates the size of a window for editing the electronic document file.

First at step S an electronic document file is selected by using a keyboard or PD . Then at step S a CPU determines whether or not an instruction to print the electronic document file selected at step S has been issued. If not S NO step S is repeated. If such an instruction has been issued S YES the process proceeds to step S.

At step S a printer on which the file is to be printed is selected by using the keyboard or PD and the number of page to be printed the number of copies a scaling factor and a print mode are set.

Then at step S the CPU determines whether or not an instruction to start printing has been issued. If not S NO step S is repeated if such an instruction has been issued S YES the process proceeds to step S.

At step S print job data is generated and printing is performed according to the settings made at step S and descriptions in a print procedure description file . In doing so a copy of the print job data generated by a printer drover is generated. The print job data copied at step S is stored in the electronic document file as a print job data file at step S. Saving this file means that print data consisting of data such as a PDL is already generated when the electronic document file is printed and therefore the print data can be sent to a printer or a print server quickly compared with a case where print data is generated from application data.

It is assumed here that files to be imported import file include a print file in a format such as the BMP format TIFF format or PDF format PDF is a registered trademark of ADOBE Systems Incorporated an electronic document file and a document file which is not limited to the configuration shown in . Import of a document file will be described below in detail with respect to an example in which the import file is print file see .

The term edit prohibition is described first. The term edit prohibition refers to prohibition of operations such as modifications or additions to or changes of layout of text or graphics in a document file such as a print file and reordering of pages in a document.

The term print prohibition refers to prohibition of printing of a document file such as a print file or prohibiting print out in high resolutions and permitting print out in a low resolution for example 72 dpi .

The copy prohibition refers to prohibition of copying any page in a document file such as a print file or text or graphics in any page of a document file. Copy prohibition security information may be included in edit prohibition security information.

It will be understood that embodiments of the present invention are not limited to the security information described above.

It is assumed in the present embodiment that security information is recorded in a document file such as a print file and is not applied to files in the electronic document file other than the print file for example. It is also assumed that the security information can be set page by page of a document file such as a print file.

Reference numeral denotes the entire print file reference numeral denotes the total number of pages constituting the print file reference numeral denotes the size of the print file and reference numeral denotes an offset indicting a content information area constituting the first page of the print file .

Reference numerals and denote content information constituting the Mth page of the print file and reference numeral denotes security information that is set for the Mth page. Various types of security information such as edit prohibition print prohibition or copy prohibition can be assigned to the Mth page on the basis of information set in the security information . Reference numeral denotes an information field containing text data constituting the Mth page and reference numeral denotes an information area containing graphic data constituting the Mth page and reference numeral denotes an information field containing image data constituting the Mth page. Reference numeral denotes an offset indicating a content information area constituting the next page.

While an electronic document file is shown as the import to document file into which the print file is imported in import to document files include image files in the BMP format TIFF format or PDF format PDF is a registered trademark of Adobe Systems Incorporated and document files which are not limited to the file structure shown in . The present embodiment can be applied to those files.

The management table contains information for identifying the relationship between each page and the file. For example information indicating which page number of which print file corresponds to the first page of the electronic document file can be recorded in field and information indicating which page number of which print file corresponds to the Nth page of the electronic document file can be recorded in field . In this way correspondences between all print files and recorded in the electronic document file and the electronic document file can be established.

Column contains the page numbers of the electronic document file . Each page is associated with the print file the print file and the corresponding page of the print file . Column contains flags indicating whether security information is attached to the pages of each file. The flags in column correspond to security information described with respect to . Any information may be set in column that reflects security information. Column contains a hierarchy of the chapter numbers of the electronic document file which are associated with sections of the files recorded in the electronic document file. This allows each page of print file and print file recorded in the electronic document file to be edited or printed chapter by chapter of the electronic document file .

For a file such as print file to which security information is applied security settings such as edit prohibition or copy prohibition can be made within a hierarchy level of a chapter that is within an imported print file. The CPU can identify the association between the chapters and the pages contained in the chapters in a hierarchical manner.

The CPU may refer to the security information column in the management table shown in and cause the pages for which at least one flag is in the ON state 1 to be displayed as the portion . Of course the table that can be referred to by the CPU is not limited to the one shown in . For example security information may be provide on a file by file basis rather than on a page by page basis as shown in and the CPU may refer to the table in and cause the file for which at least one flag is in the ON state to be display as the portion .

In while Chapter 3 is provided with security information the other components Chapters 1 and 2 of the document are not affected by the security information and therefore edits and printing of graphics and text in any pages or reordering and copying of any pages of in those components not prohibited. The CPU can associate pages in the electronic document file with print file while maintaining security information for imported print file according to the management table in the electronic document management file .

At step S a document file such as print file to be imported and a document file such as an electronic document file into which the file is to be imported are specified through user operations on an input device such as a keyboard or a PD . Then at step S the CPU of the electronic document processing apparatus determines whether an instruction to start import is inputted through the keyboard or the PD . If not S NO the CPU repeats step S while waiting for an import start instruction.

On the other hand if an import instruction is inputted at step S S YES then the process proceeds to step S. At step S the CPU determines the file format that is set in the import document file specified at step S. In the present embodiment the CPU checks an extension of a print file . If an API Application Programming Interface for determining security information for the file is provided as in the case of a PDF file PDF is a registered trademark of Adobe Systems Incorporated the CPU uses the API to determine whether certain security information such as edit prohibition security information is set or not. If no API is provided for the file the CPU determines from a file property contained in the electronic document file for indicating whether security information is set or not whether certain security information such as edit prohibition is set or not. If the format of the file is open to the public the electronic document processing apparatus itself performs a process for obtaining security information on the basis of the format information which will not be described in the present embodiment.

If the CPU determines at step S that security information such as edit prohibition is not set S NO then the process proceeds to step S where a conventional process for importing the document file is performed for example the two files are merged into a print file . Description of the conventional import process will be omitted in the present embodiment.

On the other hand if the CPU determines at step S that security information such as edit prohibition is added to the import document file S YES the process proceeds to step S where the CPU places the document file for which edit prohibition security information is set into the import to electronic document file and holds records as a separate file without merging it in the electronic document file. shows the state of the electronic document file in which the print file is held as a separate file for which security information such as edit prohibition is set.

Then the process proceeds to step S where the display output controller displays the print file on the display according to the structure of the import to electronic document file A and B so that a user can identify it as pages for which security information such as edit prohibition is set see .

The usability of the electronic document file for the user can be further improved by displaying restrictions along with the electronic document file that indicate what kinds of operations on the imported print file can be permitted or prohibited at any timing through the display output controller in response to the import of the print file with security information into the electronic document file through step S. Furthermore the usability can be further improved by displaying different appropriate restrictions according to the type of security information attached to the imported print file.

The restrictions may be displayed in conjunction with the display at step S in or when the mouse cursor is placed on an indicator for example Chapter 3 in indicating that security information is set.

The description of the restrictions displayed may be that edits to the print file cannot be made to the imported print file if edit prohibition security information is attached to the print file or that the pages of the imported print file can be moved within the electronic document file only in the entirety of the print file.

Also the description of the restriction displayed may be that the electronic document file containing the print file can be printed but the pages corresponding to the print file is printed in a low resolution for example 72 dpi if print prohibition security information is attached to the imported print file that the pages corresponding to the print file are labeled with a given mark such as the name of the author of the file.

In this way according to the present embodiment an electronic document file can be created while maintaining security information added to a print file rather than simply prohibiting the print file with the security information from being imported. Further because the pages of the print file with security information are permitted to be replaced in the entirety of the file within the electronic document file as shown in an electronic document file edit environment with a certain minimum degree of freedom for a user can be provided.

The initial state of the process is one in which a print file has been imported in an electronic file as shown in .

First at step S the CPU determines whether or not a move start instruction is issued through a keyboard or a PD . If not S NO then the CPU repeats step S while waiting for an input.

On the other hand at step S if an instruction to move is issued S YES the process proceeds to step S where pages pages 4 6 in the example in to be moved is specified through the use of the keyboard or PD . At step S the CPU determines whether a position to which the pages should be moved has been specified or not. The pages to be moved can be specified by operating a pointer that moves with the PD to indicate the pages and depressing an operation button of the PD which is not shown on the document organization dialog shown in . Similarly the position to which the pages are to be moved can be specified by operating the pointer that moves with the PD .

In the present embodiment if an instruction is provided that specifies page 4 as the page to be moved in the document organization dialog shown in and instructs to move the page 4 to the position immediately subsequent to page 9 S YES the process proceeds to step S where the CPU moves the page according to the information specified S . The result of the movement is shown in . Because edit prohibition security information is set for the page page 4 specified to be moved at step S the entire print file for which the edit prohibition security information is set is moved.

Referring to an embodiment will be described below in which when an electronic document file for which security information is set is imported in an electronic document file the security information of the print file affects the entire electronic document file. This embodiment is useful in applications where security information for a print file can be applied to an entire electronic document file so that the management of the electronic document file can be facilitated.

If the CPU determines at step S that an imported document file such as a print file is provided with certain security information such as edit prohibition S YES the process proceeds to step S where the CPU writes the security information the edit prohibition security information in this example set for the imported document file for example the print file in the security information field in the electronic document file header information to update the electronic document file header information . The display output controller displays on the display an indication that updated edit prohibition security information is set for the entire electronic document file into which the print file was imported see .

If the CPU determines at step S that security setting is set for the imported document file such as the print file S YES the process proceeds to step S where the display output controller displays on the display the dialog box to allow the user to chose whether to apply the security information to the entire electronic document file into which the file is imported. Then the process proceeds to step S where the CPU determines whether an instruction to continue the importing has been inputted or not. If an instruction to continue the importing is issued S YES the process proceeds to step S. The operations at step and the subsequent steps are the same as those in . On the other hand if an instruction abort the importing is issued S NO the process ends without performing the import.

While the present embodiment has been described with respect to a case where edit prohibition security information is set the spirit of the present invention is not limited to such security information. The present invention can equally applied to cases where other security information such as print prohibition or copy prohibition or a combination thereof is used.

Also while the present embodiment has been described with respect to a case where predetermined security information is set to the print source file of the import source on a page by page basis cases where security information is set for the entire file as a unit or on a content by content basis can be treated in the same way described above that is as if security information were set for all imported pages.

As has been described according to the present embodiment an electronic document file for which security information is set can be imported into an electronic document file to be edited with the security information being maintained. Thus the present embodiment facilitates management and editing of the electronic document file.

Furthermore the CPU in the electronic document processing apparatus allows such additional information as a watermark stored in an edit information file to be added to pages corresponding to a file for which security information is set during editing the imported document file for example the print file . The image input output controller can control printing in which such additional information is added to a print file .

When a document file for example a print file including a security information is exported from an electronic document file the CPU refers to a management table containing information that identifies the association of each page with a file to determine which pages correspond to the specified document to be exported and exports the identified print file from the electronic document file . If additional information such as a watermark is added to the print file to be exported the CPU can exclude the additional information added in editing and export the print file .

According to the present invention a document file for which security information is set can be into a document file to be edited with the security information being contained in the document file.

Thus security information such as edit prohibition print prohibition or copy prohibition set for the import document file can affects the document file into which it is imported.

Furthermore the present invention can be applied to a system including a number of devices for example a host computer interface devices readers and printers as well as an apparatus formed by a single device such as a copying machine a printer or a facsimile machine . Moreover the object of the present invention can also be achieved by a computer or a CPU or an MPU of a system or an apparatus reading and executing software program codes stored on a storage medium that implement the functions of the embodiments described above. In that case the program codes read from the storage medium implement the functions of the embodiments described above and the storage medium on which the program codes are stored constitutes the present invention.

The storage medium for supplying the program codes may be a flexible disk hard disk optical disk magneto optical disk CD ROM CD R magnetic tape non volatile memory card ROM or the like.

As mentioned above the functions of the embodiments can be implemented by a computer reading and executing the program codes. In addition the function of the embodiments described above may be implemented by an OS Operating System running on the computer and performing part or all of the actual processing. Such an implementation is also falls within the scope of the present invention.

Moreover the present invention includes an implementation in which the program codes read from the recording medium is written in a memory in a function expansion board inserted into a computer or a function expansion unit connected to a computer and then a CPU or the like provided in the function expansion board or unit performs part or all of the actual processing which implements the functions of the embodiments described above.

As many apparently widely different embodiments of the present invention can be made without departing from the spirit and scope thereof it is to be understood that the invention is not limited to the specific embodiments thereof except as defined in the claims.

This application claims priority from Japanese Patent Application No. 2004 177339 filed on Jun. 15 2004 which is hereby incorporated by reference herein.

