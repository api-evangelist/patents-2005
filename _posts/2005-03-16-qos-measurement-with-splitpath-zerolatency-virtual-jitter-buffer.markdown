---

title: QoS measurement with split-path zero-latency virtual jitter buffer
abstract: An apparatus that includes a packet data ingress, a packet data egress, and a packet data switching matrix configured to switch packet data from the packet data ingress to the packet data egress. The apparatus may further include a packet data jitter buffer and a packet data splitter, wherein the packet data splitter interposes the packet data ingress and the packet data switching matrix and is configured to multicast the packet data to the packet data switching matrix and the jitter buffer.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07965627&OS=07965627&RS=07965627
owner: Genband US LLC
number: 07965627
owner_city: Plano
owner_country: US
publication_date: 20050316
---
This application claims the benefit of U.S. Provisional Application No. 60 611 221 entitled MEDIA GATEWAY FOR MULTIPLE WIRELINE AND WIRELESS FORMATS COMPONENTS THEREOF AND PROCESSES PERFORMED THEREIN filed on Sep. 18 2004 the entirety of which is hereby incorporated herein.

Voice over Internet Protocol VOIP is used in IP telephony to send voice information in digital form in discrete packets rather than in the traditional circuit committed protocols of the public switched telephone network PSTN . In addition to IP VoIP uses real time transport protocol RTP to help ensure that packets get delivered in a timely manner. RTP combines its data transport with a real time control protocol RTCP to for example monitor data delivery. Such monitoring allows the receiver to detect if there is any packet loss and to compensate for any delay jitter.

RTP works independently of underlying transport and network layer protocols. Information in the RTP header tells the receiver how to reconstruct the data and describes how the codec bit streams are packetized. RTP components include a sequence number used to detect lost packets payload identification to describe media encoding frame indication to mark the beginning and end of each frame source identification to identify the originator of the frame and intramedia synchronization to detect and compensate for different delay jitter within a single stream.

RTCP also works independently of underlying transport and network layer protocols. RTCP components include quality of service QoS feedback which includes the numbers of lost packets round trip time and jitter so that the sources can adjust their data rates accordingly.

Jitter buffering is often necessary to measure the quality of service QoS metrics of a voice over Internet Protocol VoIP session. For example packet loss must be calculated after buffering and re ordering received real time transport protocol RTP packets. Without jitter buffering the calculations of packet loss is inaccurate and tends to derive much higher loss than actual loss. This is also true for other QoS measurements such as round trip time.

However jitter buffering introduces bearer path latency. Such latency in the nearer path is necessary in some case but unnecessary in some scenarios such as when both endpoints in a VoIP to VoIP session use the same codec and thus do not require any media transcoding functions. Inserting a jitter buffer in such transcoding free VoIP to VoIP session can introduce unnecessary latency into the media path which can negatively impact voice quality.

It is to be understood that the following disclosure provides many different embodiments or examples for implementing different features of various embodiments. Specific examples of components and arrangements are described below to simplify the present disclosure. These are of course merely examples and are not intended to be limiting. In addition the present disclosure may repeat reference numerals and or letters in the various examples. This repetition is for the purpose of simplicity and clarity and does not in itself dictate a relationship between the various embodiments and or configurations discussed.

The following is at least a partial list of the acronyms that appear in the present disclosure. Those skilled in the art will readily recognize that the terms corresponding to each of the acronyms listed below may vary within the art within the embodiments explicitly described herein and within other embodiments within the scope of the present disclosure. Those skilled in the art will also understand that aspects of the present disclosure are not limited to applications pertaining specifically to any one or more of the following acronyms. Acronyms not listed below but otherwise mentioned or discussed herein should be recognized and understood by those skilled in the pertinent art within the context of the present disclosure. In the event that an acronym is employed in the present disclosure in a manner inconsistent with its usage in the art the scope of the present disclosure is intended to include both the ordinary usage in the art and the specific usage herein.

Referring to illustrated is a schematic view of at least a portion of one embodiment of an apparatus according to aspects of the present disclosure. The apparatus may include be or be employed with a media gateway and or a software switch softswitch . Although not limited within the scope of the present disclosure the media gateway may include be or be employed with one or more switches and or other switching fabric components IP gateways and or other gateways channel banks and or other devices. The media gateway may convert data from a format protocol and or type required for one network to another format protocol and or type required for another network and or otherwise convert data from a first type of data on a first transmission link to a second type of data on a second transmission link. The media gateway may terminate channels from a circuit switched network and pass streaming media for a packet switched network such as RTP streams in an IP network. Input data for the media gateway may include audio video and or T.120 real time multi point communications among others which the media gateway may handle simultaneously or otherwise.

The media gateway may be deployed in conjunction with a media gateway controller which is sometimes referred to as a softswitch. In some embodiments the softswitch may include be or be employed with software for open application interface API also possibly referred to as application program interface or application programming interface .

As employed herein a network may refer to an entire network or to a network portion a network application and or network apparatus. To that end one or more instances of the media gateway and or softswitch or components thereof may be singularly or collectively employed to bridge two or more networks including those of PSTNs and VoP networks among others. PSTN networks may employ TDM among other non packet formats and or protocols. VoP networks may employ ATM VoIP VoDSL other formats and or protocols and or combinations thereof. VoP networks may also employ wireless formats and or protocols such as UMTS CDMA such as CDMA2000 and or W CDMA and or combinations thereof among others.

The apparatus includes a packet data ingress a data path splitter a switch fabric and a packet data egress . A jitter buffer a QoS metrics module and a QoS monitor module are also depicted in . One or more of the jitter buffer the QoS metrics module and the QoS monitor module may be integral to or otherwise included in or associated with the apparatus or may be a discrete component coupled to the apparatus by for example a data transmission link. One or more of the jitter buffer the QoS metrics module and the QoS monitor modules among other possible components may form a QoS measurement module.

The ingress may be or include the physical interface or port at which data to be switched by the switch fabric may be received by the apparatus or one of several such ports. For example the ingress may be include and or support a variety of known and future developed physical interfaces including channelized and un channelized interfaces. Thus in some embodiments the ingress may be include and or support T1 E1 T2 OC 3 STM 1 and or OC 12 STM 4 channelized interfaces among others as well as T1 E1 OC 3c STM 1c and OC 12c STM 4c and GigE un channelized interfaces among others. The ingress may also include and or support a variety of known and future developed logical interfaces. For example in one embodiment the ingress supports logical packet interfaces for SIP SIP T MGCP and MEGACO among others.

The ingress may also be one of a plurality of interfaces between the switch fabric and packet and or non packet networks to which the apparatus is coupled. Such interfaces may include packet data interfaces such as one or more of the ingress as well as non packet data interfaces. Such non packet data interfaces may be include and or support for example logical TDM and other non packet interfaces for SS7 C7 PRI CAS MF and Nb interfaces over ATM or IP among others.

The ingress may receive one or more of each of the following types of packet data UMTS CDMA2000 Iu UP AAL2 ATM possibly including AAL1 and or AAL2 VoIP and VoDSL. Such packet data may be multiplexed or non multiplexed as known in the art. In one embodiment the apparatus includes a plurality of ingresses each corresponding to a specific one of such data types. For example a first ingress may receive UMTS data only a second ingress may receive ATM data only and a third ingress may receive VoIP data only.

The egress may be substantially similar to the ingress as described above although the egress is configured to send switched data away from the switch fabric instead of to the switch fabric . However in one embodiment described more fully below one or both of the ingress and the egress may physically and or logically be two way interfaces configured to send and receive data. Thus in the schematic shown in the ingress and the egress may be substantially similar interface components or even identical interface components except with regard to the direction of data flow therethrough during a specific telephony session. In such embodiments the apparatus may include more than one splitter and or the splitter may physically and or logically interpose the switch fabric and more than one of the ingress and the egress .

The switch fabric may be configured to among other functions switch data between the ingress and the egress . The data switched by the switch fabric may be limited to packet data such as VoIP data VoDSL data other VoP data and or ATM data among others. Such packet data may alternatively or additionally include wireless packet data such as UMTS data CDMA2000 data and Iu UP AAL2 data among others. However the switch fabric may also be configured to switch non packet data such as TDM data and or other PSTN data among others.

The switch fabric may be or include one or more switching matrices. For example in one embodiment the switch fabric includes one or more packet data switching matrices and in another embodiment the switch fabric also includes one or more non packet data switching matrices. In one embodiment the function and or construction of the switch fabric may be according to aspects provided in U.S. Provisional Application No. 60 611 221 entitled MEDIA GATEWAY FOR MULTIPLE WIRELINE AND WIRELESS FORMATS COMPONENTS THEREOF AND PROCESSES PERFORMED THEREIN filed on Sep. 18 2004.

The splitter transmits the packet data received via the ingress to the switch fabric and also transmits at least a portion of the received packet data to the jitter buffer . Thus in addition to the primary path from the ingress to the switch fabric the splitter establishes a second path from the ingress to the jitter buffer and the QoS metrics module . Consequently packet data can be sent to the switch fabric and also be analyzed for QoS measurement without such analysis introducing latency.

In one embodiment the splitter transmits all packet data received via the ingress to both the switch fabric and the jitter buffer . In other embodiments the splitter transmits all packet data received via the ingress to the switch fabric but only transmits a portion of the received packet data to the jitter buffer . For example the splitter may only transmit to the jitter buffer those portions of the received packet data that have session endpoints using different codecs or otherwise requiring one or more media transcoding functions.

The splitter may be of conventional and or future developed design. For example the splitter be substantially similar to or include an ATM switch or switching means configured to perform 1 to N multicasting. The splitter may alternatively or additionally be substantially similar to or include an IP hub bridge and or router configured to perform multicasting and or broadcasting. The splutter may alternative or additionally be substantially similar to or include software configured to relay incoming packets to multiple output queues.

The jitter buffer may be substantially similar or identical in function construction and or other aspects to conventional and or future developed digital data buffers including without limitation conventional jitter buffers and other packet data buffers among others. The jitter buffer may queue up to a predetermined number of packets where the predetermined number may be configurable based on network conditions needs and or demands. However the scope of the present disclosure is not limited to any particular buffer size or buffer sizing factors. The jitter buffer may be a first in first out FIFO buffer a last in last out LILO buffer and a random buffer.

The QoS metrics module may be substantially similar or identical in function construction and or other aspects to conventional and or future developed QoS data collection and or measurement apparatus and may be implemented as software executed by a dedicated processor or integral to other processing means within the apparatus . The QoS metrics module may be configured to collect metrics employed to assess transmission rates error rates average delay variation in delay among one or more groups of packets or cells packet or cell losses and or other characteristics. The QoS metrics module may additionally be configured to perform QoS assessment based on the collected metrics although such assessment may also or alternatively be performed by another component internal or external to the apparatus .

For example the QoS monitor module may be configured to perform QoS assessment based on metrics collected by the QoS metrics module and or QoS assessments performed by the QoS metrics module . Thus in some embodiments the QoS monitor module may be configured to merely query the QoS metrics module for data to include in QoS reports while in other embodiments the QoS monitor module may be configured to query the QoS metrics module for QoS metrics and or assessments and subsequently perform its own QoS assessments for inclusion in QoS reports.

The QoS monitor module may be integral to the apparatus . For example the QoS monitor module may share a backplane bus or substrate with another component in the apparatus or may be contained within the same housing packaging or cabinet as another component in the apparatus . However in other embodiments the QoS monitor module may be a discrete component separate from the apparatus and coupled to the apparatus by a transmission link for example. Consequently the QoS monitor module may be located central to or remote from the remainder of the apparatus .

In some embodiments the functions of the jitter buffer the QoS metrics module and the QoS monitor module may vary from those described above. In general the combination of the jitter buffer and the QoS metrics module and possibly the QoS monitor module may be configured to reorder the received packets e.g. in the jitter buffer and subsequently measure QoS metrics e.g. by the QoS metrics module and or the QoS monitor module . Such QoS metrics may include packet loss jitter and round trip time among others. These functions may be performed by or in an RTP packet processor which may be integral to or composed from at least a portion of the jitter buffer and or the QoS metrics module .

These functions can be performed by employing a copy of the packet data received by the splitter from the ingress possibly substantially simultaneously with the propagation of the original packet data along the primary path through the switch fabric . Thus at least in some embodiments the QoS functions of the apparatus may not introduce latency into the primary data path. Depending on the particular arrangement employed for the splitter some latency may be attributable to the path splitting operation in some embodiments. Nonetheless in embodiments in which the splitter introduces any noticeable latency such latency may be substantially less than assessing QoS for packet data prior to switching the packet data.

Referring to illustrated is a schematic view of at least a portion of another embodiment of the apparatus shown in herein designated by the reference numeral . The apparatus may be substantially similar to the apparatus although the apparatus includes multiple instances of the above described components of the apparatus . For example the apparatus includes ingresses which may each be substantially similar to the ingress . Similarly the apparatus includes splitters egresses jitter buffers QoS metric modules and QoS monitor modules each of which may be substantially similar to corresponding components of the apparatus described above. Of course although the apparatus is illustrated as including two instances of the ingresses the splitters the egresses the jitter buffers the QoS metric modules and the QoS monitor modules the apparatus may include more than two of any of these components.

In one embodiment the apparatus may be substantially similar to an apparatus including two instances of the apparatus shown in where the two apparatus may be employed with or share common switching means such as a switch fabric . The switch fabric may be substantially similar to the switch fabric but may also be configured to receive data from more than one splitter for switching to more than one egress although the switch fabric may be similarly configured . The additional number of like components e.g. the ingress employed in addition to the ingress may be employed as redundant components to increase bandwidth or both.

Referring to illustrated is a schematic view of at least a portion of another embodiment of the apparatus shown in herein designated by the reference numeral . The apparatus may be substantially similar to the apparatus although the apparatus includes or is connected to a common QoS monitor module . The QoS monitor module may be substantially similar to the QoS monitor module shown in but may also be configured to communicate with multiple QoS metrics modules . The apparatus may include one or more QoS monitor modules and or one or more QoS monitor modules where each QoS monitor module and or may be configured to communicate with all or a corresponding one or more QoS metric modules 

Referring to illustrated is a schematic view of at least a portion of another embodiment of the apparatus shown in herein designated by the reference numeral . The apparatus may be substantially similar to the apparatus although the apparatus includes or is connected to a common QoS metrics module . The QoS metrics module may be substantially similar to the QoS metrics module shown in but may also be configured to communicate with multiple QoS monitor modules and or and or multiple jitter buffers . The apparatus may include one or more QoS metrics modules and or one or more QoS metrics modules where each QoS metrics module and or may be configured to communicate with all or a corresponding one or more QoS monitor modules and or and all or a corresponding one or more jitter buffers 

Referring to illustrated is a schematic view of at least a portion of another embodiment of the apparatus shown in herein designated by the reference numeral . The apparatus may be substantially similar to the apparatus although the apparatus includes or is connected to a common jitter buffer . The jitter buffer may be substantially similar to the jitter buffer shown in but may also be configured to communicate with multiple QoS metrics modules and or and or multiple splitters . The apparatus may include one or more jitter buffers and or one or more jitter buffers where each jitter buffer and or may be configured to communicate with all or a corresponding one or more QoS metrics modules and or and all or a corresponding one or more splitters 

Referring to illustrated is a schematic view of at least a portion of another embodiment of the apparatus shown in herein designated by the reference numeral . The apparatus may be substantially similar to the apparatus although the apparatus includes or is connected to a common splitter . The splitter may be substantially similar to the splitter shown in but may also be configured to communicate with multiple ingresses multiple jitter buffers and or and or multiple switch fabrics and or . The apparatus may include one or more jitter buffers and or one or more jitter buffers where each jitter buffer and or may be configured to communicate with all or a corresponding one or more ingresses all or a corresponding one or more switch fabrics and or and all or a corresponding one or more jitter buffers and or .

Referring to illustrated is a schematic view of at least a portion of another embodiment of the apparatus shown in herein designated by the reference numeral . The apparatus may be substantially similar to the apparatus and includes a switch fabric which may be substantially similar to the switch fabric shown in .

The switch fabric includes a packet switching matrix and a non packet switching matrix and may also include a multi service module interposing the matrices or otherwise located within the switch fabric . Additional details regarding the components interconnection and operation of the switch fabric are included in U.S. Provisional Application No. 60 611 221 entitled MEDIA GATEWAY FOR MULTIPLE WIRELINE AND WIRELESS FORMATS COMPONENTS THEREOF AND PROCESSES PERFORMED THEREIN filed on Sep. 1 8 2004.

The apparatus may also include additional ingresses which may transfer non packet data to the switch fabric such as to the non packet switching matrix although the ingresses may also transmit packet data to the switch fabric . The apparatus may also include additional egresses which may transfer non packet data from the switch fabric such as from the non packet switching matrix although the egresses may also transmit packet data from the switch fabric . In one embodiment one or more of the ingresses and or and the egresses and or may be two directional configured for both ingress and egress operation.

The apparatus may also includes a control module configured for one way and or two way communication with the switching matrices and the multi service module or other components of the switch fabric such as for the control of such components. The control module may also be configured to control or otherwise communicate with other components included in or connected to the apparatus such as the splitter the jitter buffer the QoS metrics module and or the QoS monitor module .

Referring to illustrated is a schematic view of at least a portion of another embodiment of the apparatus shown in herein designated by the reference numeral . The apparatus may be substantially similar to an embodiment of the apparatus which includes two directional ingress egress components each of which may be configured to send and receive packet data and or non packet data and may otherwise be substantially similar to the ingress and or the egress shown in . Moreover the illustrated embodiment of the apparatus may permit data travel directly between the ingress egress components and the switch fabric or otherwise bypassing the splitters . For example non packet data received by the apparatus at one of the ingress egress components may be transmitted directly to the switch fabric in contrast to packet data received at one of the ingress egress components which is transmitted to the switch fabric via one of the splitters . The switch fabric may also transmit non packet and or packet data directly to the ingress egress components or such data may be directed back through one of the splitters prior to arriving at one of the ingress egress components 

Referring to illustrated is a schematic view of at least a portion of one embodiment of the apparatus after being retrofitted according to aspects of the present disclosure herein designated by the reference numeral . The apparatus includes an apparatus which may be substantially similar or identical to one or more of the apparatus and or described above. For example the apparatus includes a jitter buffer interposing a splitter and a QoS metrics module each of which may be substantially similar or identical to those shown in . The apparatus is retrofitted to the apparatus by physically and or logically locating the splitter between the ingress and the switch fabric . Consequently packet data transmitted from the ingress to the switch fabric may also be transmitted to the jitter buffer and employed by the QoS metrics module to assess QoS. Of course retrofit embodiments within the scope of the present disclosure are not limited to the embodiment shown in . The apparatus may also include or be connected to a QoS monitor module configured to cooperate with the QoS metrics module to generate QoS reports or otherwise support QoS activities.

Referring to illustrated is a schematic view of at least a portion of another embodiment of the apparatus after being retrofitted according to aspects of the present disclosure herein designated by the reference numeral . The apparatus is substantially similar to the apparatus although the apparatus retrofitted to the apparatus is physically and or logically located upstream of the apparatus instead of being at least partially integrated into the apparatus

Referring to illustrated is a schematic diagram of at least a portion of one embodiment of a network according to aspects of the present disclosure. The network may include several networks and or portions thereof.

The network or portions thereof is one environment in which the above described apparatus and or may be implemented according to aspects of the present disclosure. For example the network includes apparatus each of which may be substantially similar to the apparatus and or . The apparatus are each configured according to their particular role in the network including the configuration of the number and type of interfaces e.g. ingresses and or egresses for example.

The apparatus is connected by a plurality of loops to one or more PSTN access networks that may include a plurality of residential telephones and or business exchanges PBX . In one embodiment the telephones may be grouped by digital loop carriers and or other aggregators which possibly in addition to one or more PBX may be included in one or more of the PSTN access networks or may otherwise be configured to communicate with the apparatus through a PSTN network . The loops may include digital loops and or analog loops and may be configured to transmit TDM and other PSTN data VoIP data DSL data VoDSL data and or ATM data among others. Thus the apparatus may be or may be employed as a central office switch or a Class 5 switch. Accordingly any PSTN access network connected to the apparatus may communicate with another PSTN access network connected to the apparatus

The apparatus is also connected to the apparatus by a trunk or other transmission line . The apparatus is in turn connected to a plurality of residential telephones business PBXs digital loop carriers and or PSTN access networks hereafter collectively referred to as PSTN access networks although merely for the sake of simplicity by a corresponding plurality of loops which may each be substantially similar to one or more of the loops . Thus any of the PSTN access networks may communicate with any of the PSTN access networks via the apparatus and the trunk and corresponding ones of the loops .

The apparatus is also connected to a tower or tower controller by one or more copper and or fiber cables . The tower may be a base station e.g. in a 2G wireless network and or a radio network station e.g. an RNS in a radio access network RAN or 3G wireless network . The tower controller may be a base station controller e.g. a BSC in a 2G wireless network and or a radio network controller e.g. an RNC in an RAN or 3G wireless network at least in part. Consequently any PSTN access network may communicate with a wireless phone e.g. a cellular or radio phone within range of the tower via the apparatus a corresponding one of the loops the cable the tower controller the tower and a wireless radio signal between the tower and wireless phone .

The apparatus is also configured to support wireless communications and may otherwise be substantially similar to the apparatus and or the apparatus except that the apparatus is not connected to any PSTN access networks. Nonetheless a PSTN access network e.g. network and or network may still communicate with the apparatus although such communications may first be transmitted through the apparatus and or the apparatus . Consequently the apparatus may still cooperate with a wireless portion of the network .

A PSTN access network may also allow communication between other telephones wireless or otherwise via connection through an additional switch and or network. For example the apparatus is connected to the apparatus and or similar apparatus. In one embodiment the apparatus is a tandem switch or gateway such as may be connected to another network which may be or include an IP ATM or other packet based network and or a PSTN or other non packet based network. Thus in some embodiments the apparatus and or are primarily connected to switching apparatus and other network components configured to perform switching functions. In one embodiment the apparatus and are each connected only to instances of the apparatus . Thus the apparatus and or may each be or may each be employed as an interoffice switch tandem or a Class 4 switch primarily passing voice and other data transmissions between other switches. In any of such intermediary roles the apparatus may be configured to not include interfaces with transmission links that are directly connected to a PSTN access network. For example the apparatus may be configured to only include interfaces with other ones of the apparatus 

In view of all of the above it should be understood that the present disclosure introduces an apparatus that includes a packet data ingress a packet data egress and a packet data switching matrix configured to switch first packet data from the packet data ingress to the packet data egress. Such an apparatus may further include a packet data jitter buffer and a packet data splitter wherein the packet data splitter interposes the packet data ingress and the packet data switching matrix and is configured to multicast the packet data to the packet data switching matrix and the jitter buffer.

The present disclosure also provides an apparatus comprising 1 a plurality of interfaces including a plurality of packet data interfaces 2 a packet data switching fabric 3 a jitter based quality of service QoS measurement module and 4 a data path splitter configured to direct data from a first data path to each of second and third data paths. The first data path includes the data path splitter and one of the plurality of packet data interfaces. The second data path includes the data path splitter the packet data switching fabric and one of the plurality of interfaces. The third path includes the data path splitter and the jitter based QoS measurement module.

A method introduced in the present disclosure includes in one embodiment receiving packet data transmitting the packet data to each of a switching fabric and a QoS measurement module and switching the packet data received by the switching fabric. QoS characteristics of the packet data received by the QoS measurement module may this be detected measured and or reported by the QoS measurement module.

The foregoing has outlined features of several embodiments so that those skilled in the art may better understand the aspects of the present disclosure. Those skilled in the art should appreciate that they may readily use the present disclosure as a basis for designing or modifying other processes and structures for carrying out the same purposes and or achieving the same advantages of the embodiments introduced herein. Those skilled in the art should also realize that such equivalent constructions do not depart from the spirit and scope of the present disclosure and that they may make various changes substitutions and alterations herein without departing from the spirit and scope of the present disclosure.

