---

title: System and method for searching secure electronic messages
abstract: Systems and methods for searching secure electronic messages. An input search is received for use in searching content of electronic messages. The search includes searching content of secure electronic messages. The results of the search are provided.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08667603&OS=08667603&RS=08667603
owner: BlackBerry Limited
number: 08667603
owner_city: Waterloo, Ontario
owner_country: CA
publication_date: 20050429
---
This application claims the benefit of and priority to and incorporates by reference in its entirety for all purposes commonly assigned U.S. Provisional Application Ser. No. 60 567 134 filed on Apr. 30 2004 entitled SYSTEM AND METHOD FOR SEARCHING SECURE ELECTRONIC MESSAGES. 

The present invention relates generally to the field of communications and in particular to handling secure electronic messages on mobile wireless communications devices.

Most applications handling electronic messages e.g. e mail messages allow a user to not only view a message but to also search for messages that contain desired text. Unfortunately this search capability does not work in the case of secure e mail. For example the Outlook e mail program from Microsoft does not allow a user to search S MIME messages.

An e mail sender system may for example be connected to an ISP Internet Service Provider on which a user of the system has an account located within a company possibly connected to a local area network LAN and connected to the Internet or connected to the Internet through a large ASP application service provider such as America Online AOL . Those skilled in the art will appreciate that the systems shown in may instead be connected to a wide area network WAN other than the Internet although e mail transfers are commonly accomplished through Internet connected arrangements as shown in .

The message server may be implemented for example on a network computer within the firewall of a corporation a computer within an ISP or ASP system or the like and acts as the main interface for e mail exchange over the Internet . Although other messaging systems might not require a message server system a mobile device configured for receiving and possibly sending e mail will normally be associated with an account on a message server. Perhaps the two most common message servers are Microsoft Exchange and Lotus Domino . These products are often used in conjunction with Internet mail routers that route and deliver mail. These intermediate components are not shown in as they do not directly play a role in the secure message processing described below. Message servers such as server typically extend beyond just e mail sending and receiving they also include dynamic database storage engines that have predefined database formats for data like calendars to do lists task lists e mail and documentation.

The wireless gateway and infrastructure provide a link between the Internet and wireless network . The wireless infrastructure determines the most likely network for locating a given user and tracks the user as they roam between countries or networks. A message is then delivered to the mobile device via wireless transmission typically at a radio frequency RF from a base station in the wireless network to the mobile device . The particular network may be virtually any wireless network over which messages may be exchanged with a mobile communication device.

As shown in a composed e mail message is sent by the e mail sender located somewhere on the Internet . This message is normally fully in the clear and uses traditional Simple Mail Transfer Protocol SMTP RFC822 headers and Multipurpose Internet Mail Extension MIME body parts to define the format of the mail message. These techniques are all well known to those skilled in the art. The message arrives at the message server and is normally stored in a message store. Most known messaging systems support a so called pull message access scheme wherein the mobile device must request that stored messages be forwarded by the message server to the mobile device . Some systems provide for automatic routing of such messages which are addressed using a specific e mail address associated with the mobile device . In a preferred embodiment described in further detail below messages addressed to a message server account associated with a host system such as a home computer or office computer which belongs to the user of a mobile device are redirected from the message server to the mobile device as they are received.

Regardless of the specific mechanism controlling the forwarding of messages to the mobile device the message or possibly a translated or reformatted version thereof is sent to the wireless gateway . The wireless infrastructure includes a series of connections to wireless network . These connections could be Integrated Services Digital Network ISDN Frame Relay or T1 connections using the TCP IP protocol used throughout the Internet. As used herein the term wireless network is intended to include three different types of networks those being 1 data centric wireless networks 2 voice centric wireless networks and 3 dual mode networks that can support both voice and data communications over the same physical base stations. Combined dual mode networks include but are not limited to 1 Code Division Multiple Access CDMA networks 2 the Groupe Special Mobile or the Global System for Mobile Communications GSM and the General Packet Radio Service GPRS networks and 3 future third generation 3G networks like Enhanced Data rates for Global Evolution EDGE and Universal Mobile Telecommunications Systems UMTS . Some older examples of data centric network include the Mobitex Radio Network and the DataTAC Radio Network. Examples of older voice centric data networks include Personal Communication Systems PCS networks like GSM and TDMA systems.

The central host system will typically be a corporate office or other LAN but may instead be a home office computer or some other private system where mail messages are being exchanged. Within the host system is the message server running on some computer within the firewall of the host system that acts as the main interface for the host system to exchange e mail with the Internet . In the system of the redirection program enables redirection of data items from the server to a mobile communication device . Although the redirection program is shown to reside on the same machine as the message server for ease of presentation there is no requirement that it must reside on the message server. The redirection program and the message server are designed to co operate and interact to allow the pushing of information to mobile devices . In this installation the redirection program takes confidential and non confidential corporate information for a specific user and redirects it out through the corporate firewall to mobile devices . A more detailed description of the redirection software may be found in the commonly assigned U.S. Pat. No. 6 219 694 the 694 patent entitled System and Method for Pushing Information From A Host System To A Mobile Data Communication Device Having A Shared Electronic Address and issued to the assignee of the instant application on Apr. 17 2001 which is hereby incorporated into the present application by reference. This push technique may use a wireless friendly encoding compression and encryption technique to deliver all information to a mobile device thus effectively extending the security firewall to include each mobile device associated with the host system .

As shown in there may be many alternative paths for getting information to the mobile device . One method for loading information onto the mobile device is through a port designated using a device cradle . This method tends to be useful for bulk information updates often performed at initialization of a mobile device with the host system or a computer within the system . The other main method for data exchange is over the air using wireless networks to deliver the information. As shown in this may be accomplished through a wireless VPN router or through a traditional Internet connection to a wireless gateway and a wireless infrastructure as described above. The concept of a wireless VPN router is new in the wireless industry and implies that a VPN connection could be established directly through a specific wireless network to a mobile device . The possibility of using a wireless VPN router has only recently been available and could be used when the new Internet Protocol IP Version 6 IPV6 arrives into IP based wireless networks. This new protocol will provide enough IP addresses to dedicate an IP address to every mobile device and thus make it possible to push information to a mobile device at any time. A principal advantage of using this wireless VPN router is that it could be an off the shelf VPN component thus it would not require a separate wireless gateway and wireless infrastructure to be used. A VPN connection would preferably be a Transmission Control Protocol TCP IP or User Datagram Protocol UDP IP connection to deliver the messages directly to the mobile device . If a wireless VPN is not available then a link to the Internet is the most common connection mechanism available and has been described above.

In the automatic redirection system of a composed e mail message leaving the e mail sender arrives at the message server and is redirected by the redirection program to the mobile device . As this redirection takes place the message is re enveloped as indicated at and a possibly proprietary compression and encryption algorithm can then be applied to the original message . In this way messages being read on the mobile device are no less secure than if they were read on a desktop workstation such as within the firewall. All messages exchanged between the redirection program and the mobile device preferably use this message repackaging technique. Another goal of this outer envelope is to maintain the addressing information of the original message except the sender s and the receiver s address. This allows reply messages to reach the appropriate destination and also allows the from field to reflect the mobile user s desktop address. Using the user s e mail address from the mobile device allows the received message to appear as though the message originated from the user s desktop system rather than the mobile device .

With reference back to the port and cradle connectivity to the mobile device this connection path offers many advantages for enabling one time data exchange of large items. For those skilled in the art of personal digital assistants PDAs and synchronization the most common data exchanged over this link is Personal Information Management PIM data . When exchanged for the first time this data tends to be large in quantity bulky in nature and requires a large bandwidth to get loaded onto the mobile device where it can be used on the road. This serial link may also be used for other purposes including setting up a private security key such as an S MIME or PGP specific private key the Certificate Cert of the user and their Certificate Revocation Lists CRLs . The private key is preferably exchanged so that the desktop and mobile device share one personality and one method for accessing all mail. The Cert and CRLs are normally exchanged over such a link because they represent a large amount of the data that is required by the device for S MIME PGP and other public key security methods.

The secure message searcher allows the searching of e mail content that has been secured such as through encryption to determine whether it matches the input search . As shown on the messages that match the input search are made available as search results . The format of the search results can vary greatly. For example the search results may provide a list of the messages including any secure messages that satisfy the input search or some other format that satisfies the needs of the search requester.

Messages can be secured in a number of different ways. depicts the secure message searcher searching messages that have only been digitally signed. In such situations the secure message searcher causes the suppression of any user interface messages to the user that would have been generated as a result of processing a digitally signed messages. As an illustration the secure message searcher may instruct underlying mobile device cryptographic APIs for S MIME and PGP for example to not display user interface messages during the search such as digital signature verification status messages.

As another example of a secure message type depicts the secure message searcher searching messages that have been encrypted via a public key e.g. the message recipient s public key . On the mobile device the corresponding private key can be stored in a data store such as a key store . As an example the secure message searcher can retrieve the private key from the key store for use in decrypting a secure message. Once decrypted the body of a secure message can be examined to determine whether the secure message matches the input search . In some key store implementations retrieving or using the private key may cause the user to be prompted to enter a password that protects the key store or the private key.

As another example in accessing keys the secure message searcher could also request authorization from the key store to have continued access to a required private key. This authorization may be in the form of an authorization ticket that is issued to the secure message searcher allowing it to access a particular private key stored in the key store possibly for an extended period of time. The user would have to enter their password only once to access the private key at which point the authorization ticket is issued to the secure message searcher . After the private key has been retrieved and the authorization ticket issued the user will not be continuously prompted for a password when that private key is needed to decrypt the secure messages. While the search is occurring the secure message searcher has the authorization ticket for the private key so that it can silently open and search messages e.g. without user interface messages being generated that have been encrypted via the public key corresponding to the private key for which the ticket was issued. If some messages have been encrypted via different public keys the user will be prompted to grant access to each of the corresponding private keys.

In an alternate embodiment the user could be prompted once to grant authorization for the message searcher to access all contents of the key store including all private keys contained therein. In this alternate embodiment the user will be prompted only once to grant access to the key store and the secure message searcher will be able to silently open and search messages e.g. without user interface messages being generated that have been encrypted via the public key corresponding to any of the private keys stored in the key store .

As another example to access passwords a mobile device may have a password keeper software program that caches all passwords used on the mobile device. The secure message searcher requests an authorization ticket for full access to the password keeper software program and the cached contents. This may require the user to enter their password prior to issuance of the authorization ticket. However the user will only be prompted once per search for the password. When the secure message searcher encounters a message encrypted with a password the secure message searcher can use the password keeper software program to request the appropriate password. If it finds it then the message can be decrypted and searched otherwise the message is skipped by the secure message searcher .

To perform step in this operational scenario the secure message searcher can search signed only messages messages that are encrypted via a public key as well as messages that are encrypted via a password. The secure message searcher includes functionality to search for all of these types of secure messages but it could be configured to only search for fewer than all of these types of secure messages. It is noted that the secure message searcher can search messages that have been both signed and encrypted in some way. The e mail messages that match the search input are returned as search results to the requester. Processing for this operational scenario terminates at end block .

It should be understood that similar to the other processing flows described herein the steps and the order of the steps in the flowchart described herein may be altered modified and or augmented and still achieve the desired outcome. For example while the search is being performed upon the e mail messages the secure message searcher can search through secure e mail messages. It is noted that during the searching the user may be prompted for a password in order to search a secured e mail messages. However the secure message searcher minimizes the number of times the user is prompted for a password when searching secure messages.

The systems and methods disclosed herein are presented only by way of example and are not meant to limit the scope of the invention. Other variations of the systems and methods described above will be apparent to those skilled in the art and as such are considered to be within the scope of the invention. For example as shown in the requester of the search can vary depending upon the situation at hand. For example a requester may be a user of the mobile device. The user can utilize a user interface of the mobile device in order to provide the input search and to view the search results on the user interface . As shown on the requester may also be a software program operating on the mobile device. The application can utilize an API to communicate the input search to the e mail searching program and to receive the search results.

As another example the systems and methods disclosed herein may be configured in various ways. As an illustration of a system and method an input search is received for use in searching content of electronic messages. The search includes searching content of secure electronic messages. The results of the search are provided. A method and system can also be configured wherein the secure electronic message is a message encrypted using a public key. The corresponding private key can be retrieved from a key data store and used to decrypt the secure electronic message.

A method and system can be configured wherein a prompt is provided to a user for each private key that is needed to decrypt a secure electronic message whose content is to be searched. A prompt can also be provided to a user in order to grant access to all private keys stored in a key data store wherein the private keys that are accessed from the key data store are used to decrypt content of secure messages. If the secure electronic message is a digitally signed message the signed message can be processed such that no or only one user prompt is generated that is required to search the signed message.

If the secure electronic message is a message encrypted using a password the password can be retrieved from a data store and used to decrypt the secure electronic message in order to perform a search of the message s content. Also if the secure electronic message is a message encrypted using a first password the user can be prompted once for a second password that is associated with a password keeper data store or application. The second password provided through the prompting of the user is used to access the first password that was used to encrypt the secure electronic message. The accessed first password is used to decrypt the secure electronic message in order to perform a search of the message s content. The second password provided through the prompting of the user can also be used to access passwords of other secure electronic messages whose contents are to be searched based upon the input search.

As another example an apparatus can be provided with a search input mechanism. The search input mechanism receives an input search from a requester. A secure message searcher searches through content of secure electronic messages based upon the input search. A result is provided to the requester based upon the electronic message searching.

The systems and methods disclosed herein may be used with many different computers and devices such as a wireless mobile communications device shown in . With reference to the mobile device is a dual mode mobile device and includes a transceiver a microprocessor a display non volatile memory random access memory RAM one or more auxiliary input output I O devices a serial port a keyboard a speaker a microphone a short range wireless communications sub system and other device sub systems .

The transceiver includes a receiver a transmitter antennas and one or more local oscillators and a digital signal processor DSP . The antennas and may be antenna elements of a multiple element antenna and are preferably embedded antennas. However the systems and methods described herein are in no way restricted to a particular type of antenna or even to wireless communication devices.

The mobile device is preferably a two way communication device having voice and data communication capabilities. Thus for example the mobile device may communicate over a voice network such as any of the analog or digital cellular networks and may also communicate over a data network. The voice and data networks are depicted in by the communication tower . These voice and data networks may be separate communication networks using separate infrastructure such as base stations network controllers etc. or they may be integrated into a single wireless network.

The transceiver is used to communicate with the network and includes the receiver the transmitter the one or more local oscillators and the DSP . The DSP is used to send and receive signals to and from the transceivers and and also provides control information to the receiver and the transmitter . If the voice and data communications occur at a single frequency or closely spaced sets of frequencies then a single local oscillator may be used in conjunction with the receiver and the transmitter . Alternatively if different frequencies are utilized for voice communications versus data communications for example then a plurality of local oscillators can be used to generate a plurality of frequencies corresponding to the voice and data networks . Information which includes both voice and data information is communicated to and from the transceiver via a link between the DSP and the microprocessor .

The detailed design of the transceiver such as frequency band component selection power level etc. will be dependent upon the communication network in which the mobile device is intended to operate. For example a mobile device intended to operate in a North American market may include a transceiver designed to operate with any of a variety of voice communication networks such as the Mobitex or DataTAC mobile data communication networks AMPS TDMA CDMA PCS etc. whereas a mobile device intended for use in Europe may be configured to operate with the GPRS data communication network and the GSM voice communication network. Other types of data and voice networks both separate and integrated may also be utilized with a mobile device .

Depending upon the type of network or networks the access requirements for the mobile device may also vary. For example in the Mobitex and DataTAC data networks mobile devices are registered on the network using a unique identification number associated with each mobile device. In GPRS data networks however network access is associated with a subscriber or user of a mobile device. A GPRS device typically requires a subscriber identity module SIM which is required in order to operate a mobile device on a GPRS network. Local or non network communication functions if any may be operable without the SIM device but a mobile device will be unable to carry out any functions involving communications over the data network other than any legally required operations such as 911 emergency calling.

After any required network registration or activation procedures have been completed the mobile device may the send and receive communication signals including both voice and data signals over the networks . Signals received by the antenna from the communication network are routed to the receiver which provides for signal amplification frequency down conversion filtering channel selection etc. and may also provide analog to digital conversion. Analog to digital conversion of the received signal allows more complex communication functions such as digital demodulation and decoding to be performed using the DSP . In a similar manner signals to be transmitted to the network are processed including modulation and encoding for example by the DSP and are then provided to the transmitter for digital to analog conversion frequency up conversion filtering amplification and transmission to the communication network via the antenna .

In addition to processing the communication signals the DSP also provides for transceiver control. For example the gain levels applied to communication signals in the receiver and the transmitter may be adaptively controlled through automatic gain control algorithms implemented in the DSP . Other transceiver control algorithms could also be implemented in the DSP in order to provide more sophisticated control of the transceiver .

The microprocessor preferably manages and controls the overall operation of the mobile device . Many types of microprocessors or microcontrollers could be used here or alternatively a single DSP could be used to carry out the functions of the microprocessor . Low level communication functions including at least data and voice communications are performed through the DSP in the transceiver . Other high level communication applications such as a voice communication application A and a data communication application B may be stored in the non volatile memory for execution by the microprocessor . For example the voice communication module A may provide a high level user interface operable to transmit and receive voice calls between the mobile device and a plurality of other voice or dual mode devices via the network . Similarly the data communication module B may provide a high level user interface operable for sending and receiving data such as e mail messages files organizer information short text messages etc. between the mobile device and a plurality of other data devices via the networks .

The microprocessor also interacts with other device subsystems such as the display the RAM the auxiliary input output I O subsystems the serial port the keyboard the speaker the microphone the short range communications subsystem and any other device subsystems generally designated as .

Some of the subsystems shown in perform communication related functions whereas other subsystems may provide resident or on device functions. Notably some subsystems such as the keyboard and the display may be used for both communication related functions such as entering a text message for transmission over a data communication network and device resident functions such as a calculator or task list or other PDA type functions.

Operating system software used by the microprocessor is preferably stored in a persistent store such as non volatile memory . The non volatile memory may be implemented for example as a Flash memory component or as battery backed up RAM. In addition to the operating system which controls low level functions of the mobile device the non volatile memory includes a plurality of software modules A N that can be executed by the microprocessor and or the DSP including a voice communication module A a data communication module B and a plurality of other operational modules N for carrying out a plurality of other functions. These modules are executed by the microprocessor and provide a high level interface between a user and the mobile device . This interface typically includes a graphical component provided through the display and an input output component provided through the auxiliary I O keyboard speaker and microphone . The operating system specific device applications or modules or parts thereof may be temporarily loaded into a volatile store such as RAM for faster operation. Moreover received communication signals may also be temporarily stored to RAM before permanently writing them to a file system located in a persistent store such as the Flash memory .

An exemplary application module N that may be loaded onto the mobile device is a personal information manager PIM application providing PDA functionality such as calendar events appointments and task items. This module N may also interact with the voice communication module A for managing phone calls voice mails etc. and may also interact with the data communication module for managing e mail communications and other data transmissions. Alternatively all of the functionality of the voice communication module A and the data communication module B may be integrated into the PIM module.

The non volatile memory preferably also provides a file system to facilitate storage of PIM data items on the device. The PIM application preferably includes the ability to send and receive data items either by itself or in conjunction with the voice and data communication modules A B via the wireless networks . The PIM data items are preferably seamlessly integrated synchronized and updated via the wireless networks with a corresponding set of data items stored or associated with a host computer system thereby creating a mirrored system for data items associated with a particular user.

Context objects representing at least partially decoded data items as well as fully decoded data items are preferably stored on the mobile device in a volatile and non persistent store such as the RAM . Such information may instead be stored in the non volatile memory for example when storage intervals are relatively short such that the information is removed from memory soon after it is stored. However storage of this information in the RAM or another volatile and non persistent store is preferred in order to ensure that the information is erased from memory when the mobile device loses power. This prevents an unauthorized party from obtaining any stored decoded or partially decoded information by removing a memory chip from the mobile device for example.

The mobile device may be manually synchronized with a host system by placing the device in an interface cradle which couples the serial port of the mobile device to the serial port of a computer system or device. The serial port may also be used to enable a user to set preferences through an external device or software application or to download other application modules N for installation. This wired download path may be used to load an encryption key onto the device which is a more secure method than exchanging encryption information via the wireless network . Interfaces for other wired download paths may be provided in the mobile device in addition to or instead of the serial port . For example a USB port would provide an interface to a similarly equipped personal computer.

Additional application modules N may be loaded onto the mobile device through the networks through an auxiliary I O subsystem through the serial port through the short range communications subsystem or through any other suitable subsystem and installed by a user in the non volatile memory or RAM . Such flexibility in application installation increases the functionality of the mobile device and may provide enhanced on device functions communication related functions or both. For example secure communication applications may enable electronic commerce functions and other such financial transactions to be performed using the mobile device .

When the mobile device is operating in a data communication mode a received signal such as a text message or a web page download is processed by the transceiver module and provided to the microprocessor which preferably further processes the received signal in multiple stages as described above for eventual output to the display or alternatively to an auxiliary I O device . A user of mobile device may also compose data items such as e mail messages using the keyboard which is preferably a complete alphanumeric keyboard laid out in the QWERTY style although other styles of complete alphanumeric keyboards such as the known DVORAK style may also be used. User input to the mobile device is further enhanced with a plurality of auxiliary I O devices which may include a thumbwheel input device a touchpad a variety of switches a rocker input switch etc. The composed data items input by the user may then be transmitted over the communication networks via the transceiver module .

When the mobile device is operating in a voice communication mode the overall operation of the mobile device is substantially similar to the data mode except that received signals are preferably be output to the speaker and voice signals for transmission are generated by a microphone . Alternative voice or audio I O subsystems such as a voice message recording subsystem may also be implemented on the mobile device . Although voice or audio signal output is preferably accomplished primarily through the speaker the display may also be used to provide an indication of the identity of a calling party the duration of a voice call or other voice call related information. For example the microprocessor in conjunction with the voice communication module and the operating system software may detect the caller identification information of an incoming voice call and display it on the display .

A short range communications subsystem is also included in the mobile device . The subsystem may include an infrared device and associated circuits and components or a short range RF communication module such as a Bluetooth module or an 802.11 module for example to provide for communication with similarly enabled systems and devices. Those skilled in the art will appreciate that Bluetooth and 802.11 refer to sets of specifications available from the Institute of Electrical and Electronics Engineers relating to wireless personal area networks and wireless local area networks respectively.

The systems and methods data may be stored in one or more data stores. The data stores can be of many different types of storage devices and programming constructs such as RAM ROM Flash memory programming data structures programming variables etc. It is noted that data structures describe formats for use in organizing and storing data in databases programs memory or other computer readable media for use by a computer program.

The systems and methods may be provided on many different types of computer readable media including computer storage mechanisms e.g. CD ROM diskette RAM flash memory computer s hard drive etc. that contain instructions for use in execution by a processor to perform the methods operations and implement the systems described herein.

The computer components software modules functions and data structures described herein may be connected directly or indirectly to each other in order to allow the flow of data needed for their operations. It is also noted that a module or processor includes but is not limited to a unit of code that performs a software operation and can be implemented for example as a subroutine unit of code or as a software function unit of code or as an object as in an object oriented paradigm or as an applet or in a computer script language or as another type of computer code.

