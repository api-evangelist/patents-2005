---

title: Flexible licensing architecture in content rights management systems
abstract: A license is issued to a user as decryption and authorization portions. The decryption portion is accessible only by such user and has a decryption key (KD) for decrypting corresponding encrypted digital content and validating information including an identification of a root trust authority. The authorization portion sets forth rights granted in connection with the digital content and conditions that must be satisfied to exercise the rights granted, and has a digital signature that is validated according to the identified root trust authority in the decryption portion. The user issued accesses the decryption portion and employs the validation information therein to validate the digital signature of the authorization portion. If the conditions in the authorization portion so allow, the rights in the authorization portion are exercised by decrypting the encrypted content with the decryption key (KD) from the decryption portion and rendering the decrypted content.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07860802&OS=07860802&RS=07860802
owner: Microsoft Corporation
number: 07860802
owner_city: Redmond
owner_country: US
publication_date: 20050201
---
The present invention relates to a rights management RM system whereby access to digital content is provided only in accordance with a corresponding digital license. More particularly the invention relates to a particular licensing architecture employed in connection with such RM system whereby each license may be tied to one or more root trust authorities and each license may actually comprise a plurality of license documents.

Rights management and enforcement is highly desirable in connection with digital content such as digital audio digital video digital text digital data digital multimedia etc. where such digital content is to be distributed to one or more users. Digital content could be static such as a text document for example or it could be streamed such as the streamed audio video of a live event. Typical modes of distribution include tangible devices such as a magnetic floppy disk a magnetic tape an optical compact disk CD etc. and intangible media such as an electronic bulletin board an electronic network the Internet etc. Upon being received by the user such user renders the digital content with the aid of appropriate rendering software such as an audio player a text displayer etc. on a personal computer or other hardware.

In one scenario a content owner or rights owner such as an author a publisher a broadcaster etc. wishes to distribute such digital content to each of many users or recipients in exchange for a license fee or some other consideration. In such scenario then the content may be an audio recording a multimedia presentation etc. and the purpose of the distribution is to generate the license fee. Such content owner given the choice would likely wish to restrict what the user can do with such distributed digital content. For example the content owner would like to restrict the user from copying and re distributing such content to a second user at least in a manner that denies the content owner a license fee from such second user.

In addition the content owner may wish to provide the user with the flexibility to purchase different types of use licenses at different license fees while at the same time holding the user to the terms of whatever type of license is in fact purchased. For example the content owner may wish to allow distributed digital content to be rendered only a limited number of times only for a certain total time only on a certain type of machine only on a certain type of rendering platform only by a certain type of user etc.

In another scenario a content developer such as an employee in or member of an organization wishes to distribute such digital content to one or more other employees or members in the organization or to other individuals outside the organization but would like to keep others from rendering the content. Here the distribution of the content is more akin to organization based content sharing in a confidential or restricted manner as opposed to broad based distribution in exchange for a license fee or some other consideration.

In such scenario then the content may be a document presentation spreadsheet database email or the like such as may be exchanged within an office setting and the content developer may wish to ensure that the content stays within the organization or office setting and is not rendered by non authorized individuals such as for example competitors or adversaries. Again such content developer wishes to restrict what a recipient can do with such distributed digital content. For example the content owner would like to restrict the user from copying and re distributing such content to a second user at least in a manner that exposes the content outside the bounds of individuals who should be allowed to render the content.

In addition the content developer may wish to provide various recipients with different levels of rendering rights. For example the content developer may wish to allow protected digital content to be viewable and not printable with respect to one class of individual and viewable and printable with respect to another class of individual.

However and in either scenario after distribution has occurred such content owner developer has very little if any control over the digital content. This is especially problematic in view of the fact that practically every personal computer includes the software and hardware necessary to make an exact digital copy of such digital content and to download such exact digital copy to a write able magnetic or optical disk or to send such exact digital copy over a network such as the Internet to any destination.

Of course as part of a transaction wherein the content is distributed the content owner developer may require the user recipient of the digital content to promise not to re distribute such digital content in an unwelcome manner. However such a promise is easily made and easily broken. A content owner developer may attempt to prevent such re distribution through any of several known security devices usually involving encryption and decryption. However there is likely very little that prevents a mildly determined user from decrypting encrypted digital content saving such digital content in an un encrypted form and then re distributing same.

RM and enforcement architectures and methods have thus been provided to allow the controlled rendering of arbitrary forms of digital content where such control is flexible and definable by the content owner developer of such digital content. Such architectures allow and facilitate such controlled rendering in either scenario as set forth above.

Typically a digital license is tied to a global or near global root trust authority for example by way of a chain of digital certificates and thus any entity that wishes to authenticate verify such license must be in possession of appropriate information relating to such root trust authority. However and as should be appreciated situations can occur where an entity through no fault of its own is not in fact in possession of such appropriate information and therefore cannot so authenticate verify the license. For one example the information may have changed since the entity received a copy. For another example the root trust authority may have changed.

In either example it should be evident that having the entity rely on any particular root trust authority without regard for any other root trust authority is fraught with danger. In essence the entity always relies on the particular root trust authority and the information thereof even when other root trust authorities exist are come into existence and even if the particular root trust authority goes out of existence.

Accordingly a need exists for a more flexible architecture for defining digital licenses and the operation thereof. In particular a need exists for such an architecture that allows for multiple root trust authorities and that allows a license to itself specify each root trust authority that can be employed to authenticate verify same. Moreover to effectuate such architecture a need exists for a new type of license that comprises a plurality of license documents.

The aforementioned needs are satisfied at least in part by the present invention in which a digital license authorizes rendering of a corresponding piece of digital content on a computing device where the content is in an encrypted form and is decryptable according to a decryption key KD . The license is issued to a user and has a decryption portion and an authorization portion.

The decryption portion is accessible only by the user to whom the license is issued and has the decryption key KD and validating information including an identification of a root trust authority. The authorization portion sets forth rights granted in connection with the digital content and conditions that must be satisfied to exercise the rights granted and has a digital signature that is validated according to the identified root trust authority in the decryption portion.

The user to whom the license is issued accesses the decryption portion and employs the validation information therein to validate the digital signature of the authorization portion. Such user exercises the rights in the authorization portion only if the conditions in the authorization portion so allow. The rights are exercised by decrypting the encrypted content with the decryption key KD from the decryption portion and rendering the decrypted content. Significantly the license need not be tied to any particular root trust authority.

Although not required the invention can be implemented via an application programming interface API for use by a developer and or included within the network browsing software which will be described in the general context of computer executable instructions such as program modules being executed by one or more computers such as client workstations servers or other devices. Generally program modules include routines programs objects components data structures and the like that perform particular tasks or implement particular abstract data types. Typically the functionality of the program modules may be combined or distributed as desired in various embodiments. Moreover those skilled in the art will appreciate that the invention may be practiced with other computer system configurations. Other well known computing systems environments and or configurations that may be suitable for use with the invention include but are not limited to personal computers PCs automated teller machines server computers hand held or laptop devices multi processor systems microprocessor based systems programmable consumer electronics network PCs minicomputers mainframe computers and the like. The invention may also be practiced in distributed computing environments where tasks are performed by remote processing devices that are linked through a communications network or other data transmission medium. In a distributed computing environment program modules may be located in both local and remote computer storage media including memory storage devices.

With reference to an exemplary system for implementing the invention includes a general purpose computing device in the form of a computer . Components of computer may include but are not limited to a processing unit a system memory and a system bus that couples various system components including the system memory to the processing unit . The system bus may be any of several types of bus structures including a memory bus or memory controller a peripheral bus and a local bus using any of a variety of bus architectures. By way of example and not limitation such architectures include Industry Standard Architecture ISA bus Micro Channel Architecture MCA bus Enhanced ISA EISA bus Video Electronics Standards Association VESA local bus and Peripheral Component Interconnect PCI bus also known as Mezzanine bus .

Computer typically includes a variety of computer readable media. Computer readable media can be any available media that can be accessed by computer and includes both volatile and nonvolatile media removable and non removable media. By way of example and not limitation computer readable media may comprise computer storage media and communication media. Computer storage media includes both volatile and nonvolatile removable and non removable media implemented in any method or technology for storage of information such as computer readable instructions data structures program modules or other data. Computer storage media includes but is not limited to RAM ROM EEPROM flash memory or other memory technology CDROM digital versatile disks DVD or other optical disk storage magnetic cassettes magnetic tape magnetic disk storage or other magnetic storage devices or any other medium which can be used to store the desired information and which can be accessed by computer . Communication media typically embodies computer readable instructions data structures program modules or other data in a modulated data signal such as a carrier wave or other transport mechanism and includes any information delivery media. The term modulated data signal means a signal that has one or more of its characteristics set or changed in such a manner as to encode information in the signal. By way of example and not limitation communication media includes wired media such as a wired network or direct wired connection and wireless media such as acoustic RF infrared and other wireless media. Combinations of any of the above should also be included within the scope of computer readable media.

The system memory includes computer storage media in the form of volatile and or nonvolatile memory such as read only memory ROM and random access memory RAM . A basic input output system BIOS containing the basic routines that help to transfer information between elements within computer such as during start up is typically stored in ROM . RAM typically contains data and or program modules that are immediately accessible to and or presently being operated on by processing unit . By way of example and not limitation illustrates operating system application programs other program modules and program data .

The computer may also include other removable non removable volatile nonvolatile computer storage media. By way of example only illustrates a hard disk drive that reads from or writes to non removable nonvolatile magnetic media a magnetic disk drive that reads from or writes to a removable nonvolatile magnetic disk and an optical disk drive that reads from or writes to a removable nonvolatile optical disk such as a CD ROM or other optical media. Other removable non removable volatile nonvolatile computer storage media that can be used in the exemplary operating environment include but are not limited to magnetic tape cassettes flash memory cards digital versatile disks digital video tape solid state RAM solid state ROM and the like. The hard disk drive is typically connected to the system bus through a non removable memory interface such as interface and magnetic disk drive and optical disk drive are typically connected to the system bus by a removable memory interface such as interface .

The drives and their associated computer storage media discussed above and illustrated in provide storage of computer readable instructions data structures program modules and other data for the computer . In for example hard disk drive is illustrated as storing operating system application programs other program modules and program data . Note that these components can either be the same as or different from operating system application programs other program modules and program data . Operating system application programs other program modules and program data are given different numbers here to illustrate that at a minimum they are different copies. A user may enter commands and information into the computer through input devices such as a keyboard and pointing device commonly referred to as a mouse trackball or touch pad. Other input devices not shown may include a microphone joystick game pad satellite dish scanner or the like. These and other input devices are often connected to the processing unit through a user input interface that is coupled to the system bus but may be connected by other interface and bus structures such as a parallel port game port or a universal serial bus USB .

A monitor or other type of display device is also connected to the system bus via an interface such as a video interface . A graphics interface such as Northbridge may also be connected to the system bus . Northbridge is a chipset that communicates with the CPU or host processing unit and assumes responsibility for accelerated graphics port AGP communications. One or more graphics processing units GPUs may communicate with graphics interface . In this regard GPUs generally include on chip memory storage such as register storage and GPUs communicate with a video memory . GPUs however are but one example of a coprocessor and thus a variety of co processing devices may be included in computer . A monitor or other type of display device is also connected to the system bus via an interface such as a video interface which may in turn communicate with video memory . In addition to monitor computers may also include other peripheral output devices such as speakers and printer which may be connected through an output peripheral interface .

The computer may operate in a networked environment using logical connections to one or more remote computers such as a remote computer . The remote computer may be a personal computer a server a router a network PC a peer device or other common network node and typically includes many or all of the elements described above relative to the computer although only a memory storage device has been illustrated in . The logical connections depicted in include a local area network LAN and a wide area network WAN but may also include other networks. Such networking environments are commonplace in offices enterprise wide computer networks intranets and the Internet.

When used in a LAN networking environment the computer is connected to the LAN through a network interface or adapter . When used in a WAN networking environment the computer typically includes a modem or other means for establishing communications over the WAN such as the Internet. The modem which may be internal or external may be connected to the system bus via the user input interface or other appropriate mechanism. In a networked environment program modules depicted relative to the computer or portions thereof may be stored in the remote memory storage device. By way of example and not limitation illustrates remote application programs as residing on memory device . It will be appreciated that the network connections shown are exemplary and other means of establishing a communications link between the computers may be used.

One of ordinary skill in the art can appreciate that a computer or other client device can be deployed as part of a computer network. In this regard the present invention pertains to any computer system having any number of memory or storage units and any number of applications and processes occurring across any number of storage units or volumes. The present invention may apply to an environment with server computers and client computers deployed in a network environment having remote or local storage. The present invention may also apply to a standalone computing device having programming language functionality interpretation and execution capabilities.

Distributed computing facilitates sharing of computer resources and services by direct exchange between computing devices and systems. These resources and services include the exchange of information cache storage and disk storage for files. Distributed computing takes advantage of network connectivity allowing clients to leverage their collective power to benefit the entire enterprise. In this regard a variety of devices may have applications objects or resources that may interact to implicate authentication techniques of the present invention for trusted graphics pipeline s .

It can also be appreciated that an object such as may be hosted on another computing device or . Thus although the physical environment depicted may show the connected devices as computers such illustration is merely exemplary and the physical environment may alternatively be depicted or described comprising various digital devices such as PDAs televisions MP3 players etc. software objects such as interfaces COM objects and the like.

There are a variety of systems components and network configurations that support distributed computing environments. For example computing systems may be connected together by wireline or wireless systems by local networks or widely distributed networks. Currently many of the networks are coupled to the Internet which provides the infrastructure for widely distributed computing and encompasses many different networks.

In home networking environments there are at least four disparate network transport media that may each support a unique protocol such as Power line data both wireless and wired voice e.g. telephone and entertainment media. Most home control devices such as light switches and appliances may use power line for connectivity. Data Services may enter the home as broadband e.g. either DSL or Cable modem and are accessible within the home using either wireless e.g. HomeRF or 802.11b or wired e.g. Home PNA Cat 5 even power line connectivity. Voice traffic may enter the home either as wired e.g. Cat 3 or wireless e.g. cell phones and may be distributed within the home using Cat 3 wiring. Entertainment media may enter the home either through satellite or cable and is typically distributed in the home using coaxial cable. IEEE 1394 and DVI are also emerging as digital interconnects for clusters of media devices. All of these network environments and others that may emerge as protocol standards may be interconnected to form an intranet that may be connected to the outside world by way of the Internet. In short a variety of disparate sources exist for the storage and transmission of data and consequently moving forward computing devices will require ways of protecting content at all portions of the data processing pipeline.

The Internet commonly refers to the collection of networks and gateways that utilize the TCP IP suite of protocols which are well known in the art of computer networking. TCP IP is an acronym for Transport Control Protocol Interface Program. The Internet can be described as a system of geographically distributed remote computer networks interconnected by computers executing networking protocols that allow users to interact and share information over the networks. Because of such wide spread information sharing remote networks such as the Internet have thus far generally evolved into an open system for which developers can design software applications for performing specialized operations or services essentially without restriction.

Thus the network infrastructure enables a host of network topologies such as client server peer to peer or hybrid architectures. The client is a member of a class or group that uses the services of another class or group to which it is not related. Thus in computing a client is a process i.e. roughly a set of instructions or tasks that requests a service provided by another program. The client process utilizes the requested service without having to know any working details about the other program or the service itself. In a client server architecture particularly a networked system a client is usually a computer that accesses shared network resources provided by another computer e.g. a server. In the example of computers etc. can be thought of as clients and computer etc. can be thought of as the server where server etc. maintains the data that is then replicated in the client computers etc.

A server is typically a remote computer system accessible over a remote network such as the Internet. The client process may be active in a first computer system and the server process may be active in a second computer system communicating with one another over a communications medium thus providing distributed functionality and allowing multiple clients to take advantage of the information gathering capabilities of the server.

Client and server communicate with one another utilizing the functionality provided by a protocol layer. For example Hypertext Transfer Protocol HTTP is a common protocol that is used in conjunction with the World Wide Web WWW . Typically a computer network address such as a Universal Resource Locator URL or an Internet Protocol IP address is used to identify the server or client computers to each other. The network address can be referred to as a Universal Resource Locator address. For example communication can be provided over a communications medium. In particular the client and server may be coupled to one another via TCP IP connections for high capacity communication.

Thus illustrates an exemplary networked or distributed environment with a server in communication with client computers via a network bus in which the present invention may be employed. In more detail a number of servers etc. are interconnected via a communications network bus which may be a LAN WAN intranet the Internet etc. with a number of client or remote computing devices etc. such as a portable computer handheld computer thin client networked appliance or other device such as a VCR TV oven light heater and the like in accordance with the present invention. It is thus contemplated that the present invention may apply to any computing device in connection with which it is desirable to process store or render secure content from a trusted source.

In a network environment in which the communications network bus is the Internet for example the servers can be Web servers with which the clients etc. communicate via any of a number of known protocols such as HTTP. Servers may also serve as clients as may be characteristic of a distributed computing environment. Communications may be wired or wireless where appropriate. Client devices may or may not communicate via communications network bus and may have independent communications associated therewith. For example in the case of a TV or VCR there may or may not be a networked aspect to the control thereof. Each client computer and server computer may be equipped with various application program modules or objects and with connections or access to various types of storage elements or objects across which files may be stored or to which portion s of files may be downloaded or migrated. Thus the present invention can be utilized in a computer network environment having client computers etc. that can access and interact with a computer network bus and server computers etc. that may interact with client computers etc. and other devices and databases .

As is known and referring now to rights management RM and enforcement is highly desirable in connection with digital content such as digital audio digital video digital text digital data digital multimedia etc. where such digital content is to be distributed to users. Upon being received by the user such user renders the digital content with the aid of an appropriate rendering device such as a media player text displayer etc. on a personal computer or the like.

Typically a content owner or developer hereinafter owner distributing such digital content wishes to restrict what the user can do with such distributed digital content . For example the content owner may wish to restrict the user from copying and re distributing such content to a second user or may wish to allow distributed digital content to be rendered only a limited number of times only for a certain total time only on a certain type of machine only on a certain type of rendering platform only by a certain type of user etc.

However after distribution has occurred such content owner has very little if any control over the digital content . An RM system then allows the controlled rendering of arbitrary forms of digital content where such control is flexible and definable by the content owner of such digital content. Typically content is distributed to the user in the form of a package by way of any appropriate distribution channel. The digital content package as distributed may include the digital content encrypted with a symmetric encryption decryption key KD i.e. KD CONTENT as well as other information identifying the content how to acquire a license for such content etc.

The trust based RM system allows an owner of digital content to specify license rules that must be satisfied before such digital content is allowed to be rendered on a user s computing device . Such license rules can include the aforementioned temporal requirement and may be embodied within a digital license or use document hereinafter license that the user user s computing device hereinafter such terms are interchangeable unless circumstances require otherwise must obtain from the content owner or an agent thereof. Such license also includes the decryption key KD for decrypting the digital content perhaps encrypted according to a key decryptable by the user s computing device . As seen in such encrypting key is a public key of the user s computing device PU BB and the user s computing device presumably has the corresponding private key PR BB by which PU BB KD may be decrypted.

The content owner for a piece of digital content must trust that the user s computing device will abide by the rules and requirements specified by such content owner in the license i.e. that the digital content will not be rendered unless the rules and requirements within the license are satisfied. Preferably then the user s computing device is provided with a trusted component or mechanism that will not render the digital content except according to the license rules embodied in the license associated with the digital content and obtained by the user.

The trusted component typically has a license evaluator that determines whether the license is valid reviews the license rules and requirements in such valid license and determines based on the reviewed license rules and requirements whether the requesting user has the right to render the requested digital content in the manner sought among other things. As should be understood the license evaluator is trusted in the RM system to carry out the wishes of the owner of the digital content according to the rules and requirements in the license and the user should not be able to easily alter such trusted element for any purpose nefarious or otherwise.

As should be understood the rules and requirements in the license can specify whether the user has rights to render the digital content based on any of several factors including who the user is where the user is located what type of computing device the user is using what rendering application is calling the RM system the date the time etc. In addition the rules and requirements of the license may limit the license to a pre determined number of renderings or pre determined rendering time for example. Thus the trusted component may need to refer to a clock on the computing device .

The rules and requirements may be specified in the license according to any appropriate language and syntax. For example the language may simply specify attributes and values that must be satisfied DATE must be later than X e.g. or may require the performance of functions according to a specified script IF DATE greater than X THEN DO . . . e.g. .

Upon the license evaluator determining that the license is valid and that the user satisfies the rules and requirements therein the digital content can then be rendered. In particular to render the content the decryption key KD is obtained from the license and is applied to KD CONTENT from the content package to result in the actual content and the actual content is then in fact rendered.

As set forth above the license with PU BB KD in effect authorizes an entity in possession of PR BB to access KD and thereby access the content encrypted according to such KD presuming of course that the entity abides by all conditions as set forth in the license . As should be appreciated though other types of licenses may exists within the RM system .

For example it may be appreciated that in one scenario the author or publisher of the content may authorize a particular licensor to issue a license for corresponding content by providing the licensor with a publishing license . As may be appreciated such publishing license is similar to the license in that such publishing license likely includes the decryption key KD for decrypting the digital content here encrypted according to a public key of the licensor PU BB . Likewise the publishing license likely includes the rules and requirements for rendering the content . Here however such rules and requirements are to be inserted into the license as issued by the licensor and are not especially applicable to such licensor .

Note though that the publishing license may indeed include other rules and requirements that are indeed applicable to the licensor . Accordingly the licensor should include a trusted component with a license evaluator in a manner akin to the user s computing device .

Significantly each type of license etc. as proffered typically includes a digital signature for authentication verification purposes and each digital signature is validated with reference to a digital certificate from a root trust authority or a series of such certificates leading back to such a root trust authority. Notably each certificate includes a digital signature for authentication verification purposes and each signature is constructed based on a private key and validated according to a corresponding public key.

As may be appreciated in a chain of certificates leading from a root trust authority to a particular license etc. the root digital certificate from the root trust authority is signed based on a private key from the root trust authority and is validated based on a corresponding public key which is presumed to be available to the verifying entity. For each other digital certificate in the chain and for the license etc. at the end of the chain such other certificate or license etc. is signed based on a particular private key and is validated based on a corresponding public key as obtained from the next certificate in the chain toward the root trust authority.

Accordingly to validate a license etc. a corresponding chain of certificates back to a root trust authority is found a corresponding public key of such root trust authority is found and the found public key of the root trust authority is employed to validate the root certificate and assuming such validation succeeds a public key is located in the root certificate and employed to validate the next certificate in the chain. The process repeats until the last certificate in the chain at which point a public key is found therein and employed to validate the license etc. Of course if any validation fails the process ends and the license etc. is not validated. Typically unless validated a RM system will not honor a license etc.

As should now be appreciated validating a license etc. hereinafter license requires that a validating entity such as the trusted component already be in possession of the public key of the root trust authority that corresponds to such license as defined by the chain of certificates thereof. However and as was previously pointed out situations can occur where an entity through no fault of its own is not in fact in possession of such public key for any of several reasons. Of course all certificate chains could lead back to a single global or near global root trust authority but such reliance on one or a few roots of authority unnecessarily centralizes such root trust and is problematic should the centralized root trust become compromised or otherwise fails.

Accordingly in one embodiment of the present invention a license may define any particular root trust authority by including therewith a public key corresponding thereto whereby the public key is then employed to start off validating a chain of certificates attached to such license . As a result any validating entity need not already be in possession of any particular public key of any particular root trust authority but instead can obtain such public key based on the corresponding license that ultimately is to be validated based on such public key. Thus such validating entity is not tied to any particular root trust authority but instead can validate most any license that is tied through a corresponding chain of certificates to any designated root trust authority.

Note though that including the public key of a root trust authority with a license that is to be validated thereby in essence makes the license self validating which as should be appreciated is not usually acceptable as a security practice. Accordingly in one embodiment of the present and as seen in the license is separated into at least two portions including a decryption portion and an authorization portion each of which must be possessed by a user attempting to employ such license to render corresponding content . Significantly the decryption portion should be accessible only by the user for whom the license is issued while the authorization portion can be accessible by others but has a signature that is validated with information in the decryption portion . Thus with such portions the authorization portion is not self validating. Note that the license may have other portions without departing from the spirit and scope of the present invention.

In one embodiment of the present invention and still referring to the authorization portion of a license identifies the issuer of the license includes a specific grant of rights such as for example to render a piece of content in one or more particular manners to issue a type of license etc. and may include an identification of the relevant content . In addition the authorization portion may specify one or more particular users or types of users that can use the authorization portion of the license and for each specified user type of user conditions that must be satisfied in connection with use of the license .

Significantly the authorization portion includes a digital signature based on at least a portion of the aforementioned items where the signature leads back to a particular root trust authority having a particular public private key pair PU ROOT PR ROOT . That is and as should be appreciated the signature S PR ROOT may be based on PR ROOT or may include a chain of certificates leading back to a last certificate with a signature based on PR ROOT. In any case and as should also be appreciated the signature S PR ROOT may be validated based on appropriate application of PU ROOT either directly or by way of the chain of certificates whichever the case may be.

Note though that the authorization portion does not itself contain such PU ROOT . Instead in one embodiment of the present invention the decryption portion contains the root key PU ROOT along with the decryption key KD for decrypting the corresponding content . In addition the decryption portion may include other rights and conditions in addition to the rights and conditions set forth in the authorization portion . Most significantly the decryption portion should express as a right condition that the decryption key KD therein cannot be employed unless the root key PU ROOT therein is employed to validate the signature on the corresponding authorization portion

The decryption portion likely is not digitally signed although such a digital signature may be provided without departing from the spirit and scope of the present invention. As may be appreciated if signed such signature likely would have to be validated based on PU ROOT assuming the validating root key should not be tied to the user s computing device . However and again including PU ROOT within the decryption portion where such decryption portion is validated based on such PU ROOT makes the decryption portion self validating which as should be appreciated is not usually acceptable as a security practice.

Instead in one embodiment of the present invention the decryption portion is encrypted to protect the keys therein where the encrypting key is selected such that the corresponding decrypting key is available to the user s computing device . As may be appreciated doing so has the benefit that the decrypting portion is tied to the user s computing device by way of such decrypting key. As may also be appreciated doing so has the additional benefit that the decrypting key may be any of several keys as long as such decrypting key is available to the user s computing device .

For example in one embodiment of the present invention the decrypting key is a private key corresponding to a public key that is employed as the encrypting key as is shown in . Thus the user s computing device may itself have such a public private key pair or may have access to a public private key pair of the user itself or the trusted component on the user s computing device may have such a public private key pair. In any such situation the public key is provided to the constructor of the license and in particular of the decryption portion for use in encrypting same while the private key is held in confidence for decrypting the decryption portion

Alternatively the decrypting key and the encrypting key may be the same in which case such constructor and the user s computing device may establish a shared secret for generating such a symmetric key not shown . Of course the user s computing device would then have to securely store such a symmetric key for future retrieval.

Turning now to with the arrangement thus far set forth above and in connection with rendering content on a user s computing device is achieved in the following manner. Preliminarily based on some appropriate identification within the content the user s computing device and the trusted component thereon are directed to a license server such as the licensor of that can issue a license corresponding to the content and a request is issued to such license server for such license step . Typically such a request includes a certificate or the like that identifies either the user the user s computing device the trusted component or the like where the certificate includes therein a public key PU USER . Based on the request including the certificate then the license server decides whether to issue a license in response. As may be appreciated such decision may be based on any appropriate factors without departing from the spirit and scope of the present invention.

Presuming that the license server in fact decides to issue the license step such license server constructs the decryption portion and the authorization portion in the form set forth above step signs the authorization portion based on the root key PU ROOT in the decryption portion step and encrypts the decryption portion based on the public key PU USER of the certificate with the request step . Note here that each request as at step includes a differing public key PU USER where such PU USER is employed to encrypt the decryption portion of the requested license and accordingly each decryption portion correspondingly differs. However the authorization portion likely does not likewise differ in that such authorization portion should be signed to be validated based on the same root key PU ROOT . Accordingly it may in fact be the case that a differing decryption portion is constructed as at step and encrypted as at step in response to each request but that only a single common authorization portion is constructed as at step and signed as at step and the single authorization portion is applicable to all requests.

At any rate the license server in response to the request from the user s computing device returns thereto the license including the authorization portion and the decryption portion step . Note though that the authorization portion need not necessarily be specific to any particular license and accordingly may in fact be common to multiple licenses . Accordingly it may in fact be the case that a decryption portion is constructed as at step in response to each request but that an authorization portion is constructed as at step only if the requestor does not already possess such authorization portion . Correspondingly if the requestor does in fact already possess such authorization portion the license server need not construct same as at step and need not return same as at step .

Turning now to it is seen that a user s computing device in possession of a decryption portion and an authorization portion of a license corresponding to encrypted content decrypts and renders such content in the following manner.

Preliminarily based on the content the user s computing device locates the license or at least the decryption portion thereof step . Thus the user s computing device decrypts same according to whatever encryption scheme has been employed to encrypt such decryption portion step . For example for example if the decryption portion or a portion thereof is encrypted based on the public key of the user PU USER then the user s computing device applies the corresponding private key PR USER to reveal such decryption portion or a portion thereof.

In addition the user s computing device reviews the rights conditions set forth in the decryption portion and determines whether such rights allow rendering of the content in the manner sought and that such conditions are satisfied step . Significantly such determination includes ensuring that the decryption key KD in the decryption portion is not employed unless the root key PU ROOT therein is employed to validate the signature on the corresponding authorization portion . Note that if it is the case that the rights conditions are not encrypted within the decryption portion step may take place before step and step may be avoided in the case where such rights conditions do not allow rendering of the content in the manner sought. Note too that if the rights conditions or any other part of the decryption portion are not encrypted such parts should at least be the basis for a digital signature and such digital signature should be verified to ensure against tampering.

Presuming that the rights conditions in the decryption portion allow rendering of the content in the manner sought the user s computing device obtains the root key PU ROOT and the decryption key KD for decrypting the corresponding content from the decryption portion step locates the authorization portion step and then employs such PU ROOT to validate the digital signature S PR ROOT of the authorization portion step . Such validating may be performed in any appropriate manner without departing from the spirit and scope of the present invention. Such validation is known or should be apparent to the relevant public and therefore need not be set forth herein in any detail.

Presuming that the validation succeeds the user s computing device then may review the rights conditions set forth in the authorization portion and determine whether such rights allow rendering of the content in the manner sought and that such conditions are satisfied step . Note that step may take place before step and step may be avoided in the case where such rights conditions do not allow rendering of the content in the manner sought.

Presuming that the rights conditions in the authorization portion allow rendering of the content in the manner sought the user s computing device employs the decryption key KD as obtained at step to in fact decrypt the encrypted content step and then renders such decrypted content step .

The programming necessary to effectuate the processes performed in connection with the present invention is relatively straight forward and should be apparent to the relevant programming public. Accordingly such programming is not attached hereto. Any particular programming then may be employed to effectuate the present invention without departing from the spirit and scope thereof.

In the present invention a flexible architecture is provided to define a digital license and the operation thereof. The architecture allows for multiple root trust authorities and allows a license to itself specify each root trust authority that can be employed to authenticate verify same. To effectuate such architecture the license includes a decryption portion encrypted in a manner accessible only by a particular user or group of users and an authorization portion that must be validated based on a key obtained from the decryption portion

It should be appreciated that changes could be made to the embodiments described above without departing from the inventive concepts thereof. It should be understood therefore that this invention is not limited to the particular embodiments disclosed but it is intended to cover modifications within the spirit and scope of the present invention as defined by the appended claims.

