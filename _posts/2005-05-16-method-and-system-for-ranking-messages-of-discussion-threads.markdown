---

title: Method and system for ranking messages of discussion threads
abstract: A method and system for ranking messages of discussion threads based on relationships between messages and authors is provided. The ranking system defines an equation for attributes of a message and an author. The equations define the attribute values and are based on relationships between the attribute and the attributes associated with the same type of object, and different types of objects. The ranking system iteratively calculates the attribute values for the objects using the equations until the attribute values converge on a solution. The ranking system then ranks the messages based on attribute values.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07437382&OS=07437382&RS=07437382
owner: Microsoft Corporation
number: 07437382
owner_city: Redmond
owner_country: US
publication_date: 20050516
---
This application is a continuation in part of U.S. patent application Ser. No. 10 957 329 filed on Oct. 1 2004 and entitled Method and System for Identifying Questions Within a Discussion Thread and U.S. patent application Ser. No. 10 846 835 filed on May 14 2004 now U.S. Pat. No. 7 346 621 and entitled Method and System for Ranking Objects Based on Intra Type and Inter Type Relationships which are hereby incorporated by reference.

Discussion threads are a popular way for people to communicate using the Internet. A discussion thread such as a newsgroup allows people to participate in a discussion about a specific topic. A discussion thread is typically initiated when a person creates an initial message directed to a topic and posts the message as a new discussion thread. Other persons can read the initial message and post response or reply messages to the discussion thread. For example the initial message may pose a question such as Has anyone encountered a situation where the Acme software product aborts with error number 456 Persons who want to participate in the discussion can post response messages such as It happens to me all the time or I fixed the problem by reinstalling the software. Discussion threads typically take the form of a tree structure as sequences of messages branch off into different paths. For example three different persons can post a response message to the initial message starting three branches and other persons can post response messages to any one of those response messages to extend those branches.

In general discussion threads include questions and their answers. For example a customer support group within a company that sells a certain software product may provide a mechanism for its customers to create and participate in discussion threads relating to the software product. For example a customer may initiate a discussion thread by posting an initial message that poses a question such as the one mentioned above. That question may be answered by the posting of a response message by another customer or a customer service representative. The corpus of discussion threads of the company may provide a vast amount of knowledge related to problems and concerns that customers may encounter along with appropriate responses e.g. answers to questions posed .

When a customer wants an answer to a question the customer may either initiate a new discussion thread or search messages of existing discussion threads that may provide an answer to the customer s question. When searching for an answer within the message of a corpus of discussion threads a customer may submit a short query using keywords of the question. For example the customer may submit the query error 456 in hopes of finding an answer to the question mentioned above. A search engine may be used to identify those messages that contain keywords matching the query. The search engine may rank messages based on a relevance score that indicates how relevant each message is to the query based on closeness of each match date of message e.g. recent messages being more relevant length of message and so on. The ranking may be based primarily on attributes of the messages themselves.

The relevance score however may fail to factor in attributes that are not directly related to messages. For example the relevance of a message might more accurately be determined when the expertise of the author is factored in. A response message posted by a customer service representative may be more authoritative or important and thus more relevant than a response message posted by a customer. It would be desirable to have a technique for calculating importance of messages of a discussion thread based on attributes not directly related to the message.

A method and system for ranking messages of a discussion thread based on relationships with other messages and with authors is provided. The ranking system ranks messages based in part on relationships between and attributes of messages and authors. A message may have an importance attribute and an author may have an expertise attribute. The importance of a message may be based on importance of related messages and the expertise of its author. The expertise of an author may be based on the importance of the messages posted by the author. The ranking system calculates the value of the importance attribute for the messages and may rank the messages based on their importance.

A method and system for ranking message objects messages of a discussion thread based on relationships with other messages and with other types of objects is provided. In one embodiment the ranking system ranks messages based in part on relationships between and attributes of authors and messages. A message may have an importance attribute and an author may have an expertise attribute. The importance of a message may be based on the importance of related messages e.g. reply messages and the expertise of its author. The expertise of an author may be based on the importance of the messages posted by the author. Thus the importance of a message and the expertise of its author are defined recursively. The ranking system calculates the value of the importance attribute for the messages and may rank the messages based on their importance.

The ranking system determines various relationships between objects of the same type referred to as intra type relationships and between objects of different types referred to as inter type relationships. The intra type relationships messages may include replied to relationships between messages. For example if a message is a reply to another message then that message has a replied to relationship to the replied to message. The intra type relationship of authors may include a self relationship that is each author is only related to itself. The inter type relationships between messages and authors may be based on authored by and author of relationships. A message has an authored by relationship to its author and an author has an author of relationship to the authored message. The ranking system uses the replied to relationships and the authored by and author of relationships to derive the importance of messages and the expertise of authors.

In one embodiment the ranking system represents the relationships and attributes using a set of equations such as linear equations. The ranking system represents the importance of messages and expertise of authors using a linear equation that may be defined recursively. Because the linear equations may be defined recursively the ranking system solves the linear equations by iteratively calculating the values of each linear equation until the values converge on a solution. After solving the linear equations the ranking system may rank the messages based on their importance.

The ranking system represents the attribute values for objects based on the intra type and inter type relationships of the objects. The value of an attribute may be represented by the following equation where Frepresents the attribute value associated with object i Rrepresents the intra type relationships between objects of the type of the object i and Rrepresents the inter type relationships between objects of the type of the object i and other types j. If there are two types of objects x x x . . . x representing messages and y y y . . . y representing authors then the intra type replied to relationship for messages can be represented as Rand the intra type self relationship for authors can be represented as Rand their inter type authored by relationship represented as Rand inter type author of relationship represented as R. The ranking system uses adjacency matrices to represent the relationship information. Land Lrepresent the adjacency matrices of the intra type relationships for messages and authors respectively. Land Lrepresent the adjacency matrix of inter type authored by relationships from messages to authors and the adjacency matrix of inter type author of relationships from authors to messages respectively. The ranking system represents the adjacency matrix by the following 

Because mutually reinforcing relationships between objects may give undue attribute values to objects the ranking system may normalize the binary adjacency matrices in such a way that if an object is related to n other objects in one adjacency matrix then each related to object gets 1 nof its attribute value. The ranking system may also introduce the random surfer model of PageRank to simulate random relationships and thus avoid sink nodes during computation as described below. In addition since attributes from different types may have different importance to each other attribute the ranking system may use weights for each combination of types. Thus the ranking system may factor in the normalization the random surfer model and the weights to represent the attribute values by the following equation 

When M and N are heterogeneous data spaces the ranking system uses a random relationship to represent no relationship. When an object in M has no relationship to any objects in N then the sub matrix L will be zero and will represent a sink node to which the calculations may assign all the attribute value. To prevent this the ranking system sets all the elements in the corresponding row of the sub matrix L to 1 n where n is the total number of objects in data space N. Alternatively the ranking system can set the corresponding weights to 0 for undesired intra type and inter type relationships. However if is greater than 0 then may need to be greater than 0 if the iterative calculations are to converge. Thus if the relationship of L is undesired the ranking system sets to a very small positive weight to reduce the effect of L .

By constructing a unified matrix using all the adjacency matrices the ranking system constructs a unified data space which contains different types of objects. Thus previous inter type relationships can be considered as intra type relationships in the unified space and the ranking system effectively results in link analysis in a single data space.

The computing device on which the ranking system is implemented may include a central processing unit storage memory input devices e.g. keyboard and pointing devices output devices e.g. display devices and computer readable storage mediums e.g. disk drives . The memory and storage devices are computer readable media that may contain instructions that implement the ranking system. Various communications links may be used such as the Internet a local area network a wide area network or a point to point dial up connection.

The ranking system may be implemented in various operating environments. Various well known computing systems environments and configurations that may be suitable for use include personal computers server computers hand held or laptop devices multiprocessor systems microprocessor based systems programmable consumer electronics network PCs minicomputers mainframe computers distributed computing environments that include any of the above systems or devices and the like.

The ranking system may be described in the general context of computer executable instructions such as program modules executed by one or more computers or other devices. Generally program modules include routines programs objects components data structures and so on that perform particular tasks or implement particular abstract data types. Typically the functionality of the program modules may be combined or distributed as desired in various embodiments.

One skilled in the art will appreciate that although specific embodiments of the ranking system have been described herein for purposes of illustration various modifications may be made without deviating from the spirit and scope of the invention. For example one skilled in the art will appreciate that non linear equations may be used to represent attribute values. One skilled in the art will also appreciate that different attributes objects other than authors and relationships can be used to determine the authority or importance of messages. For example the expertise or importance of an author may be based on the relationship between the author and various organizations e.g. customer service department of a company or number of times a message has been accessed. One skilled in the art will appreciate that the ranking system can be used to rank any collection of messages of discussion threads. For example a collection of messages can be identified based on the techniques of U.S. patent application Ser. No. 10 957 329 filed on Oct. 1 2004 and entitled Method and System for Identifying Questions Within a Discussion Thread. Accordingly the invention is not limited except as by the appended claims.

