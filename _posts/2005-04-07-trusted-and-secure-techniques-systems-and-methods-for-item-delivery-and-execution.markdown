---

title: Trusted and secure techniques, systems and methods for item delivery and execution
abstract: Documents and other items can be delivered electronically from sender to recipient with a level of trustedness approaching or exceeding that provided by a personal document courier. A trusted electronic go-between can validate, witness and/or archive transactions while, in some cases, actively participating in or directing the transaction. Printed or imaged documents can be marked using handwritten signature images, seal images, electronic fingerprinting, watermarking, and/or steganography. Electronic commercial transactions and transmissions take place in a reliable, “trusted” virtual distribution environment that provides significant efficiency and cost savings benefits to users in addition to providing an extremely high degree of confidence and trustedness. The systems and techniques have many uses including but not limited to secure document delivery, execution of legal documents, and electronic data interchange (EDI).
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07392395&OS=07392395&RS=07392395
owner: Intertrust Technologies Corp.
number: 07392395
owner_city: Sunnyvale
owner_country: US
publication_date: 20050407
---
This is a division of application Ser. No. 09 632 944 filed Aug. 4 2000 pending which is a continuation of application Ser. No. 09 221 479 filed Dec. 28 1998 now U.S. Pat. No. 6 185 683 which is a continuation of application Ser. No. 08 699 711 filed Aug. 12 1996 now abandoned which is a continuation in part of application Ser. No. 08 388 107 filed Feb. 13 1995 now abandoned all of which are incorporated herein by reference.

This application is related to concurrently filed commonly assigned copending application Ser. No. 08 699 712 of Ginter et al. entitled Trusted Infrastructure Support Systems Methods and Techniques Commerce Process Control and Automation Distributed Computing and Rights Management hereafter referred to as Shear et al to avoid confusion with the Ginter et al reference in the paragraph above . The entire disclosure including the drawings of this related Shear et al. patent application is incorporated by reference into this specification as if expressly set forth in this specification.

These inventions relate to secure and trusted delivery of digital information. More specifically these inventions pertain to techniques methods and systems for providing reliable trusted verifiable delivery handling creation and or execution of digital items such as documents executable code e.g. Java applets and or any other information capable of being represented in digital form. The present invention also relates to commercial and other electronic activities involving a trusted third party electronic go between such as a computer controlled process to audit validate and or direct electronic transactions executions and or delivery and or to archive information representing and or at least in part comprising securely communicated digital information.

There is a great need for convenient cost effective techniques to securely handle and deliver documents and other items. Existing methods such as express and personal couriers registered mail facsimile and electronic mail fulfill some of these needs but these techniques each have their problems and are deficient in important ways.

Perhaps the ultimate in secure document handling is the personal trusted courier. Many of us have seen spy films showing a trusted courier delivering documents containing state secrets. In such scenarios the document sender places the document or other item into a lockable attach case. The sender seals and locks the case with a key or combination that only he and the recipient have. The courier handcuffs the case to his or her wrist boards an airplane and flies to the required destination all the while carefully guarding the attach case and its contents. Upon arriving at the destination the courier personally delivers the case to the intended recipient. The recipient unlocks the case and retrieves its contents all the while having a high degree of assurance that the contents have been kept secret.

The confidentiality security and reliability provided by a personal trusted document courier has never really been matched by any other form of document delivery. Even though we sometimes might want or need the services of a personal trusted document courier it is likely that practical reasons such as cost and availability require us to use less trusted forms of delivery for even our most important and confidential documents or other items. Moreover even the trusted courier technique does not provide a reliable means of later providing how and when the information was used by the recipient and or subsequently handled by others to whom the recipient may pass the information and what information was actually sent. This approach also cannot provide the degree of interactivity between the sender and the recipient possible in a world of near instantaneous communications including seamlessly supporting processes related to rights management and document creation and dissemination.

As discussed below existing alternatives to the trusted courier are more practical and less expensive and some offer advantages such as instantaneous communications and interactivity but all suffer from various disadvantages.

Federal Express and other express courier services provide rapid for example overnight delivery services at a relatively high degree of trustedness.

In the typical case the sender places the items to be delivered into a special tear resistant sealed envelope and fills out an air bill that lists the sender s name address and telephone number and the intended recipient s name address and telephone number. The air bill also lists options such as for example the type of delivery service required i.e. delivery next business morning next business afternoon or second business day whether the sender requires Federal Express to obtain the recipient s signature the payment method and a unique tracking number used to uniquely identify the package.

Once the package is complete and ready to send the sender may provide it to Federal Express through a number of different methods 

Federal Express maintains a fleet of aircraft that shuttle most packages to a central sorting and routing facility for subsequent dispatch to various destinations across the United States and the world. A fleet of delivery trucks deliver the packages from local airports to each recipient. At the sender s option a delivery person may obtain a recipient s signature at the time she delivers the package providing documentation that may later be used to prove the package was in fact received by the intended recipient or someone at his or her home or office.

Federal Express uses automated computer tracking and package handling equipment to route individual packages to their destinations. Delivery information is put into the tracking computer to allow customers and service people to automatically retrieve information about when and to whom particular packages were actually delivered or where the package happens to be at the moment.

Federal Express and other similar document delivery services have been highly successful because they cost effectively ensure reliable delivery of original documents and other items. Nevertheless they do have some significant disadvantages and limitations. For example 

These problems are exacerbated when several individuals and or organizations in different geographical locations are all parties to a transaction a complex multiparty contract for example and all must sign or otherwise process and or execute one or more related documents.

A relatively more secure delivery technique is registered mail. Registered mail correspondents can have a high degree of confidence that their packages will arrive at their required destinations but may not like the time delays and additional expense associated with this special form of mail handling.

To use registered mail the sender places her document or other items into a sealed envelope or package and takes her package to the nearest Post Office. For security the Post Office may prohibit the use of resealable tape and mailing labels and instead require the package to be sealed with paper tape and the address to be written directly on the package. These safeguards help to ensure that any attempts to tamper with the package or its contents will be detected.

The Post Office securely transports the registered mail package to the recipient requiring each postal employee who accepts custody of the package along its journey to sign and time stamp a custody record. The postal carrier at the recipient s end personally delivers the package to the recipient who also has to sign for it and may be asked to produce proof of identification. The custody record establishes a chain of custody listing every person who has had custody of the package on its journey from sender to recipient.

As discussed above registered mail is relatively secure and confidential but delivery takes a long time and is very labor and infrastructure intensive.

Facsimile is an electronic based technology that provides virtually instantaneous document delivery. A facsimile machine typically includes a document scanner a document printer and electronic circuits that convert document images to and from a form in which they can be sent over a telephone line. Facsimile requires each of the sender and the intended recipient to have a facsimile machine. The sender typically places the document to be sent into a document feeder attached to a facsimile machine. The sender then typically keys in the telephone number of the intended recipient s facsimile machine and presses a start button. The sender s facsimile machine automatically dials and establishes contact with the recipient s facsimile machine.

Once a good connection is established the sender s facsimile machine begins to optically scan the document one page at a time and convert it into digital information bits. The sender s facsimile machine converts the digital bits into a form that can be transmitted over a telephone line and sends the bits to the intended recipient s facsimile machine. The sender s facsimile machine may also send as part of the document a header on the top of each page stating the sender s identity the page number of the transmission and the transmission time. However these headers can be changed at will by the sender and therefore cannot be trusted.

Since the recipient s facsimile machine receives the transmitted information at the same time the sender s facsimile machine is sending it delivery is virtually instantaneous. However sending a document to an unattended facsimile machine in an insecure location may result in the document falling into the wrong hands. Another common scenario is that the facsimile machine operator through human error dials the wrong telephone number and ends up delivering a confidential document to the wrong person for example the local grocery store down the street or in some unfortunate cases the opposing side of a negotiation legal proceeding or other pitched battle . Thousands of faxes are lost every day in a black hole never arriving at their desired destinations but possibly arriving at completely different destinations instead.

More and more people are using electronic mail to send documents messages and or other digital items. The Internet explosion has connected millions of new users to the Internet. Whereas Internet electronic mail was previously restricted primarily to the academic world most corporations and computer savvy individuals can now correspond regularly over the Internet.

Currently Internet electronic mail provides great advantages in terms of timeliness nearly instantaneous delivery and flexibility any type of digital information can be sent but suffers from an inherent lack of security and trustedness. Internet messages must typically pass through a number of different computers to get from sender to recipient regardless of whether these computers are located within a single company on an Intranet for example or on Internet attached computers belonging to a multitude of organizations. Unfortunately any one of those computers can potentially intercept the message and or keep a copy of it. Moreover even though some of these systems have limited return receipt capabilities the message carrying the receipt suffers from the same security and reliability problems as the original message.

Cryptography a special mathematical based technique for keeping messages secret and authenticating messages is now beginning to be used to prevent eavesdroppers from reading intercepted messages but the widespread use of such cryptography techniques alone will not solve electronic mail s inherent lack of trustedness. These electronic mail messages documents and other items e.g. executable computer programs or program fragments that might have been sent with them as attachments remain vulnerable to tampering and other unauthorized operations and uses once decrypted and while delivery may be reported actual use can not be demonstrated. Some people have tried to develop privacy enhanced electronic mail but prior systems have only provided limited improvements in reliability efficiency and or security.

As discussed above a wide variety of techniques are currently being used to provide secure trusted confidential delivery of documents and other items. Unfortunately none of these previously existing mechanisms provide truly trusted virtually instantaneous delivery on a cost effective convenient basis and none provide rights management and auditing through persistent secure digital information protection.

In contrast the present inventions provide the trustedness confidentiality and security of a personal trusted courier on a virtually instantaneous and highly cost effective basis. They provide techniques systems and methods that can bring to any form of electronic communications including but not limited to Internet and internal company electronic mail an extremely high degree of trustedness confidence and security approaching or exceeding that provided by a trusted personal courier. They also provide a wide variety of benefits that flow from rights management and secure chain of handling and control.

The present inventions preferred embodiment make use of a digital Virtual Distribution Environment VDE as a major portion of its operating foundation providing unique powerful capabilities instrumental to the development of secure distributed transaction based electronic commerce and digital content handling distribution processing and usage management. This Virtual Distribution Environment technology can flexibly enable a wide variety of new business models and business practices while also supporting existing business models and practices.

The Virtual Distribution Environment provides comprehensive overall systems and wide arrays of methods techniques structures and arrangements that enable secure efficient electronic commerce and rights management on the Internet and other information superhighways and on internal corporate networks such as Intranets . The present inventions use and in some cases build upon and enhances this fundamental Virtual Distribution Environment technology to provide still additional flexibility capabilities features and advantages. The present invention in its preferred embodiment is intended to be used in combination a broad array of the features described in Ginter et al including any combination of the following 

For example parties using the Virtual Distribution Environment can participate in commerce and other transactions in accordance with a persistent set of rules they electronically define. Such techniques systems and arrangements bring about an unparalleled degree of security reliability efficiency and flexibility to electronic commerce electronic rights management and other important business models. The present inventions make use of these persistent electronic rules to provide secure automated cost effective electronic control for electronic document and other digital item handling and or delivery and for the electronic formation and negotiation of legal contracts and other documents.

By way of non exhaustive summary these present inventions provide a highly secure and trusted item delivery and agreement execution services providing the following features and functions 

Transactions may be one or more component transactions of any distributed chain of handling and control process including Electronic Data Interchange EDI system electronic trading system document workflow sequence and banking and other financial communication sequences etc.

The entire disclosure of the above referenced Ginter et al. patent specification is incorporated by reference in connection with .

Item might be a document such as a handwritten or typed letter or it could be a legal document such as a contract. It could have both text and pictures just text or just pictures. It could be a sound recording a multimedia presentation or a visual work such as a film or television program. Item could be any item or information capable of being represented in digital form. The item can be initially presented to the appliance in electronic form for example on a diskette or the appliance can convert it from some other form into electronic form.

Electronic delivery person receives item in digital form and places it into a secure electronic container thus forming a digital object . A digital object may in this case be for example as shown in and may include one or more containers containing item . illustrates secure electronic container as an attach case handcuffed to the secure delivery person s wrist. Once again container is shown as a physical thing for purposes of illustration only in the example it is preferably electronic rather than physical and comprises digital information having a well defined structure see . Special mathematical techniques known as cryptography can be used to make electronic container secure so that only intended recipient can open the container and access the electronic document or other item it contains.

In this example sender sends item by supplying the document to an electronic appliance A. In this example electronic appliance A is an intelligent electronic walk up kiosk that may be located in a public place or on private property such as the offices or work areas of a firm. Appliance A in this example has a document slot into which sender can feed item . Electronic appliance A can automatically optically scan the item and convert it into digital information for sending over an electronic connection or network such as for example electronic highway shown in . The item can be sent to one or many recipients specified by sender .

Referring to the example kiosk appliance A can include a computer screen for displaying informational messages and user operable controls such as push buttons for allowing sender to select between delivery options. Appliance in this example may also include a card reader for reading a credit card or other kind of card provided by the sender . Additionally if desired electronic appliance A may include a telephone receiver and telephone dialing keypad or other input devices to allow sender to get information and assistance or give additional instructions. Electronic appliance A may optionally include a keyboard for entering textual and other information not shown .

Also as shown in electronic appliance A may optionally include a video camera and may display remote video in a window on screen or on an optionally separate screen not shown . Camera allows appliance to take a photograph of sender and or recipient . It may also allow sender and recipient to see each other in order to simultaneously authenticate each other s identity visually and to have a teleconference discussion about item or other matters. The electronic appliance may also have a microphone speaker perhaps to coordinate details of the pending transaction. Appliance A might also include a media reader to read from a floppy diskette smart card or other digital storage device. The appliance can include in addition a document shredder destroyer .

Also as shown in appliance A in this example has a secure processing unit SPU see . SPU provides a tamper resistant protected processing environment PPE in which processes and transactions can take place securely and in a trusted fashion.

Electronic appliance A may also ask the user to identify intended recipient step B . Sender may select different ways to identify recipient based on the confidentiality of the document and the level of security the sender is willing to pay for. In one example sender might require the recipient s appliance B to require recipient to prove that he is who he says he is. This secure authentication function might be met by for example requiring recipient to input a password present digital proof of identity using for example 

Sender may also specify the electronic address of recipient or it might let system automatically securely and confidentially locate the recipient using a secure directory service as described in the copending Shear et al. application.

Once sender has selected the service options she desires appliance may next display a message on computer screen asking sender to insert item into document slot for electronic scanning. When the sender inserts the document or other item block C electronic appliance. may if necessary automatically optically scan item to create an electronic digital form of the document using conventional optical scanning and optical character recognition technology for example . During this scanning process appliance might display a message on computer screen such as I am scanning your document now . . . Instead of feeding in a document the sender might provide the document or other item in digital form by inserting a floppy diskette or smart card into reader or by connecting a portable computer up to port and having the portable computer upload the document into appliance .

The item to be sent need not be a document but could be any type of item capable of being transformed into digital form such as for example 

After appliance has scanned or otherwise received the entirety of document or other item appliance may calculate and display a total price on computer screen and ask sender to pay for the service block D . The calculated price may for example depend in part on the size and or number of items to be securely delivered. The appliance may then ask sender to confirm she wishes to send the document to the recipient block E . Upon receiving that confirmation y exit to decision block E appliance may request sender to pay for example by inserting her credit card into card reader as a form of payment or it might use other payment arrangements A block F . Appliance may then package the digital form of document into secure electronic container and send it over electronic network for secure delivery to recipient block F . Because system uses the secure virtual distribution environment sender can have a high degree of confidence and trust that item will be usable only by intended recipient s and to no one else.

There are advantages to using multiple authentication techniques in combination. For example a well made certificate is essentially unforgeable which is to say it would be easier to fabricate a electronic fingerprint carrying device for example than a well made certificate barring unforeseen advances in mathematics but the trouble with certificates is the weakness of correlation between physical access e.g. holding the card or sitting at the appliance and permission to use. Passwords are a weak form of authentication that is establishing this correlation. Biometric techniques particularly iris and retinal scans are stronger forms of authentication. It is possible for biometric information to be encoded in a field of a certificate and for the software controlling the card to confirm that the biometric input is consistent with the field in the certificate prior to authorizing use of the certificate or the card in general. This authentication may be limited in time e.g. using an inactivity time out each time the card is inserted etc. In addition a transaction might require this authentication to occur simultaneous with use rather than for an entire session even if the card only requires one authentication per session .

After payment has been arranged block C electronic delivery person will open secure container and give recipient a printed and or electronic copy of item only once he is satisfied to the degree required by sender that the recipient is the correct person.

Electronic delivery person may also note various information about the delivery illustrated here by having him write the information down on a clipboard but implemented in practice by electronically storing an audit trail . System may based on the particular receipt options sender requested provide the sender with an electronic and or paper receipt of the type shown in for example step D . Such an example receipt might specify for example 

The sender s electronic appliance A and the recipient s electronic appliance B can report their respective audit trails periodically or upon completion of delivery or some other event. They can report the audit information to a support facility such as information utility usage analyst C see . Usage analyst C can work with report creator D to issue a written or electronic report to sender . Alternatively since electronic appliances A B are secure the electronic appliances can maintain copies of the audit trail s and produce them in secure form on demand at a later date to evidence or prove that the document was sent and delivered for example so sender can t deny she sent the item and recipient can t deny he received the item . The appliances A B could store an entire copy of the item or they could instead store a message digest that could later be used to securely prove which item was sent.

As mentioned above the kiosk appliances shown in are just one example of electronic appliances that can be used for secure document delivery.

Secure electronic delivery can also be from one personal computer to another. show that system can be used to deliver documents securely between various different kinds of electronic appliances personal computers for example.

Secure delivery can also be from one personal computer to another. shows a sender inputting item into an optical scanner connected to a personal computer . Electronic delivery person can deliver the electronic version of item within secure container attach case from personal computer to another personal computer operated by recipient .

System supports simultaneous as well as non simultaneous contract or other document execution among contracting parties . Simultaneous completion allows multiple parties located in physically different locations to directly and simultaneously participate in the execution of legal documents and or other transactions that require authorizations.

Currently businesses often prefer simultaneous execution of documents at what is called a closing. Such closings for important documents frequently require the presence of all participants at the same location to simultaneously sign all necessary legal documents. Business executives are often reluctant to sign a set of documents and then send them to the next party to sign since special legal language may be required to release the first or early signing party if the documents are not quickly signed by other participants and since certain liabilities may exist during this interim period.

One relatively weak form of authentication is physical possession of the card . Nonetheless if some form of weak authentication is used and biometric information is gathered in real time by sensor it may be correlated with some trusted record stored elsewhere and or delivered along with the item . If biometric information is codelivered with the item and it is ever actually used it must be correlated with a trusted record this trusted record could for example be generated by the person providing biometric data in the presence of a trusted party if the validity of a transaction is called into question at the sacrifice of significant automation and commercial confidence benefits . The ability to establish trust as the transaction occurs rather than having some degree of nonrepudiation later imagine if the transaction were fraudulent and a user relied on the person showing up to give a retinal scan is one significant benefit of example system .

If the parties are simultaneously at their respective electronic appliances they may verify each other s identity using video cameras and screens built into the kiosk. Such simultaneous execution has the advantage of allowing multiple parties at different physical locations to negotiate a deal in real time and then simultaneously reliably execute and receive final signed agreement copies that are valid and legally binding.

Trusted delivery mechanism may send messages such as offers A and acceptances B between the two electronic appliances A B. These messages may be packaged within secure electronic containers . Some of these may be human readable others may be automated as in . If they are human readable and operator managed during negotiation they may represent a user interface aspect of control structures e.g. see load module DTD description in connection with and pop up user interface usage in connection with .

Once the parties A B agree on the terms of the contract they may securely indicate their agreement and system can generate an electronic and or paper contract document that evidences and memorializes the agreement. As will be discussed below contract document may have special attributes such as seals hand written signatures and or visual or hidden electronic fingerprint information . Such seals signatures and electronic fingerprints can be used to establish the authenticity of the document for example preventing a signatory from repudiating it and to allowing it to be admitted as evidence in a court of law .

System can electronically pass contract along a chain from one party to the next Round Robin collecting signatures as it travels along. System can also allow each party A F to communicate with any other party. One copy of contract could be passed along from party to party and iteratively signed at the respective signers locations. The last signer could then broadcast final signed copies of contract to all parties. The electronic containers can specify who the next recipient of contract is forming a trusted chain of handling and control for contract .

In one example all of the parties may be required to hit an I Agree button e.g. by placing a finger onto a biometric sender shown in clicking on a displayed I agree icon etc. before this transaction is actually carried out. Then barring a system failure the execution is effectively simultaneous since it isn t initiated until everyone has indicated their approval and won t be completed unless each system performs correctly.

The drawings show the trusted go between as a person for purposes of illustration only. In the preferred example trusted go between may be a computer that performs its functions electronically in a highly automatic and efficient way. In one example the computer s capabilities may be augmented by human participation.

In one example trusted electronic go between can also act as a mediator to resolve disputes between the contracting parties A B and can help negotiate the contract. At the conclusion of the contracting process trusted electronic go between may affix its own seal A to the executed contract document . This seal A may provide a guarantee or assurance that all of the steps required by trusted electronic go between were fulfilled before the contract was executed and that the contracting parties A B are who they say they are and had authorization to execute the contract.

It is extremely useful to have trusted go between monitoring this activity to order the application of signatures if required and to allow a roll back if the system fails before applying all of the signatures. The role of go between may in some circumstances be played by one of the participant s SPU s PPEs since SPU PPE behavior is not under the user s control but rather can be under the control of rules and controls provided by one or more other parties other than the user although in many instances the user can contribute his or her own controls to operate in combination with controls contributed by other parties . In another example the go between role may comprise a virtual go between comprised of a one a combination of plural or all nodes of participants in a collective or other group. Governance can be shared through the interaction of rules and controls of the various node PPEs producing a go between control role. Upon the completion of a go between managed transaction transaction audit information for archive billing security and or administrative purposes may be securely transmitted directly or through one or more other participating in the virtual go between.

In this example organization A user nodes A . . . A N each have an instance of a virtual distribution environment protected processing environment and can communicate with one another over Intranet A via secure electronic containers . Similarly organization A user nodes B . . . B N each have an instance of a virtual distribution environment protected processing environment and can communicate with one another over Intranet B via secure electronic containers . In addition organization A and organization B can communicate with one another over Internet via secure electronic containers .

Organization A s private trusted go between A may be used for facilitating organization A s internal communications and processes. Private trusted go between A might be used for example to carefully track documents and other items sent from one user to another within organization A. The public go between C meanwhile can be used to coordinate between organization A and organization B without for example revealing confidential information of either organization to the other organization. Below are more detailed examples of how the arrangement might be advantageously used to conduct business transactions.

In this example secure container may contain a digital image I of a document or other item to be delivered from one party to another. This image may include one or more seals one or more hand written signatures and one or more electronic fingerprints . The item may be multiple pages long or it may be a single page. The item may contain text pictures or graphical information computer instructions audio data computer data or any combination of these for example. Image I may be represented in a so called universal format to allow it to be created and displayed and or printed by any standard software application capable of processing items in the appropriate universal format. If desired image I may include cover sheets virtual stick on notes and or the like. Secure container may contain any number of different .

Container may also contain another data version D of the item . This data version D might for example comprise one or more word processing files corresponding to a text document for example.

The container may also contain one or more tools for using image I and or data D. Tools might be used to allow the intended recipient to manipulate or view the image I and or the data D. Tools might be computer programs in one example as mentioned above item can also be a computer program such as a program being sold to the recipient .

Secure container may also contain an electronic digital control structure . This control structure which could also be delivered independently in another container different from the one carrying the image I and or the data D may contain important information controlling use of container . For example controls may specify who can open container and under what conditions the container can be opened. Controls might also specify who if anyone object can be passed on to. As another example controls might specify restrictions on how the image I and or data D can be used e.g. to allow the recipient to view but not change the image and or data as one example . The detailed nature of control structure is described in connection for example with and .

Secure container may also include one or more routing slips and one or more audit trails . Routing slip and audit trail are data structures defined by and or associated with electronic controls and may be integrated as part of these electronic controls see for example . Routing slip might be used to electronically route the object to the intended recipient s and to specify other information associated with how the object is to be delivered and or handled. Audit trail records may be used to gather and recover all sorts of information about what has happened to object and its contents e.g. where container has been how image I has been used etc. . Audit trail may be used for example to generate a return receipt as shown in . Routing slip and or audit trail records and associated controls don t have to be delivered within the same container that contains the image I and or the data they can be delivered independently in another container if desired.

System in this example can accommodate any or all of these conventions by imprinting various graphics and or symbols on printed item . In the example item bears a hand written signature a seal and a electronic fingerprint that in one example may comprise a hidden signature .

Hand written signature may be a graphical image of the signer s own hand written signature. System can obtain this hand written signature image in a number of ways. For example system may require the signer to sign his or her signature at the time item is created. In this example once the document is finalized sender or contracting party can sign his or her signature using a magnetic or pressure sensitive signature capture device for example. Such conventional signature capture devices electronically capture the image of a person s signature and store it in a memory. System can then once it securely obtains the authorization of the signer with a very high degree of trustedness and sureness e.g. by requesting a password biometric test etc. place hand written signature onto an appropriate part of item .

Alternatively the signer may carry his or her hand written signature on a portable storage medium such as for example a magnetic smart or memory card. The portable storage unit may employ rules and controls for budgeting the number of times and or class and or other circumstances of a transaction that a signature can be employed or before the device needs to re connect to a remote authority as disclosed in the above referenced Shear et al. patent. The signer can present this storage medium to system as a source for the signature image shown in . Once system runs certain checks to ensure that the signer is in fact the one who has presented the signature card the system can securely read the signer s hand written signature from the medium and place it on to item .

In still another example system may securely maintain hand written signature files for a number of different users in a secure archive or secure directory services as disclosed in the above referenced Shear et al. patent disclosure. At a user s request system may call up the signature file pertaining to that user and impress the corresponding signature onto item . If an image representation of a signature is stored on portable media or in a directory service the image may be stored in an electronic container . Such a container permits the owner of the signature to specify control information that governs how the signature image may be used. In addition or alternatively the signature image may be stored in or securely associated with a field of a digital certificate that may for example also incorporate other identifying information .

System also is capable of imprinting special seals onto item . show example seals . Seal A shown in may be the type of seal one expects from a Governmental document bearing an official seal. While it is possible for system to provide an embosser creating a raised seal A in a preferred embodiment system prints seals A using a conventional monochrome or color printer at high resolution so that the seal image is flat. shows an example rectangular seal B in the center of the left margin of an item and another circular seal C for example of the type that might be used in Japan in the lower left hand corner of the document. shows an item bearing two circular seals one seal D in the lower left hand corner of the page and another circular seal E in the lower right hand corner. are merely illustrative examples any desired quantity shape or configuration of seals or other visual machine readable codes can be used depending upon the prevailing legal climate the country and aesthetic considerations.

In this example outer portion is used for encoding digital information. shows an example template seal before this additional encoding information is added. shows an example of a completed seal in which many small lines have been added to at least portions of the outer ring of the seal . Appliance could complete the template seal to create a completed seal shown in based on one or more electronic controls . also shows a close up view illustrating that the line pattern can have variations that encode digital bits of information. In this particular example lines radiating outwardly from center portion may encode a digital 1 value while lines radiating inwardly from border may encode a digital 0 value. As another example the selective use of large dots small dots and no dots could encode digital values. Any kind of information e.g. numerical text graphics sound or any combination of these may be encoded into the image of seal using this technique. The particular line images shown in are illustrative only other visual patterns and or steganographic techniques may be used to encode digital information into the seal s image.

System can recover the encoded information by scanning and analyzing an image of item in either digital or printed form. In one embodiment system can create electronic controls based at least in part on this information it obtains from seal .

The hash function may operate on a document in its image form or its text equivalent producing two different hash values . In addition the text version of a document may be pre processed before operation of the hash function to simplify verification of a document if it must be rekeyed into a verification system e.g. in the case where all electronic copies of a document have been lost . Since cryptographically strong hash functions are extremely sensitive to the slightest change in data yielding different values if for example a tab character is keyed as a series of spaces this pre processing may normalize the document by for example discarding all font and formatting information and or reducing each occurrence of whitespace e.g. spaces tabs carriage returns etc. into a single space. If the same pre processing is applied to a retyped version of the document before the hash function is applied it will have a much higher likelihood of yielding the same hash value if the documents are substantively the same.

System may later recover this information by digitally and or optically scanning the image of item and analyzing the pattern of seal to recover digital signature . System may then apply the public key corresponding to the private key used to encrypt the information thereby recovering the hash time and digital certificate while at the same time authenticating the information as having been encrypted with the relevant private key s . In this example System also has the original document image available to it and may therefore duplicate the one way hash process and compare the hash value it gets with the hash value encoded within seal . Mismatches indicate that the seal may have been copied from another document and does not apply to the document currently being analyzed.

Other types of digital identifying information that system might affix to the document include for example 

Electronic appliance may be any type of electronic device such as a personal computer intelligent kiosk set top box or dedicated stand alone communications appliance just to name a few examples. Processor is connected to

A document handler destroyer may be provided to feed multi page documents into document reader scanner and in one embodiment to destroy documents to ensure that only one original exists at a time. Such controlled document destruction might for example be useful in allowing sender to deliver an original stock certificate to a transfer agent. The sender could insert the original certificate into appliance which may scan the original to convert it to digital information e.g. through use of OCR technology confirm delivery and then destroy the original paper version. Secure controls could be used to ensure that only a single original ever exists on paper.

Processor is also connected to secure and or insecure digital or other storage such as for example magnetic disks random access memory optical disks etc. and to a communications device permitting the processor to communicate electronically with other processors or devices via an electronic network . In one example appliance may be provided with additional and or different components such as shown in and .

Once the appliance has been properly initialized the first step in a send process may be to authenticate the identity of sender block . This authentication step may be performed in a variety of ways such as for example 

In this particular example the authentication step may involve an application program executing on appliance requesting authentication support from protected processing environment for example sending to the protected processing environment an authentication event requesting the protected processing environment to authenticate the sender and providing authentication information to the protected processing environment block as a basis for the authentication.

In this particular example the protected processing environment may examine the authentication information provided to it e.g. the output of biometric sensors password information information read from an identity card etc. and determine based on methods provided in one or more electronic control sets whether it has sufficient basis to conclude with a requisite specified degree of assurance that the sender is who she says she is decision block A . Processes identified within the control sets operating within the PPE may perform these functions using resources provided by the PPE providing an important degree of programmable general purpose behavior.

The nature and characteristics of this sender authentication test performed by PPE may vary depending on the particular electronic control set being used as dictated by particular applications. As discussed above in situations that have legal significance in which non repudiation is very important PPE may impose a relatively stringent authentication test. Other more routine situations may use control sets that impose less stringent authenticity checks.

The PPE may abort the process if it decides there is insufficient information to form a trusted belief of authenticity and or if it determines that the sender is not who she says she is block B . PPE may indicate authorize that the process may continue if the authenticity check is successful Y exit to decision block .

The sender s appliance may next need to identify or register the intended recipient s block . In this particular example the step of registering the intended recipient s involves generating a register recipient event and sending this event to protected processing environment . Upon receiving this register recipient event protected processing environment may based on one or more methods within a corresponding electronic control set perform certain steps required to coordinate its activities with the intended recipient s electronic appliance including for example contacting the intended recipient. Example steps are shown in .

Why might the sender s PPE need to contact the recipient before sending the item The answer is that it may be necessary or desirable for the sender and the recipient to negotiate and or agree as to the appropriate electronic controls that should apply. In an item transmission scenario for example such an agreement might work out who is going to pay for the delivery service which recipient appliance home or office the document is to be delivered to what kind of return receipt is acceptable to both parties etc.

The PPE s register recipient event processing may for example allow the proposed recipient to deliver a set of controls to the sender s system that defines the parameters of receipt. Some general purpose systems may use the default settings in the kiosk or other transmission station. The address itself may provide an indication to the transmitting station as to whether it may or must request a set of control information from the recipient prior to transmission.

More complicated scenarios may require further coordination. For example an option to destroy the original item at the send end and recreate it at the recipient s end e.g. in the case of the stock certificate mentioned earlier is both a send option and a receipt option. Similarly options pertaining to procedures for electronic contract execution typically will require pre agreement from both the sender and the recipient i.e. from all parties to the contract . In these cases there should be some menu options that are driven by the address of the proposed recipient and there may be an electronic or humanly driven negotiation to resolve conflicts.

The PPE s register recipient processing may also require input or other interaction from the user. show a relatively straightforward menu based user interface that may be used to elicit information from sender . In a more advanced example DTDs see and following associated with one or more load modules may be used to control user interfaces e.g. the pop up as shown in . In this model the user interface does not contain any specific visual elements e.g. menus buttons data entry fields etc. . Instead the pop up contains application framework code. The framework code in this style of user interface uses a structured input stream DTD from the PPE to create the visual elements of the interface and optionally the allowed values of certain fields. This structured data stream may like other control structure DTDs be based on SGML for example.

This dynamic user interface approach allows control structures to be more self describing in the sense that application programs do not need to know ahead of time i.e. when they are written all of the fields values etc. for the structures. This gives structure designers more freedom in how their controls are designed. Given a rich enough grammar in the DTD designers needn t concern themselves with whether application programs will have the ability to manage the interaction with a user regarding their structures. This capability can also be used to create controls that support the electronic negotiation process shown for example in .

The PPE then may determine whether it needs to request and obtain a control set from the recipient to proceed decision block A . The PPE may have obtained the required control set s during a previous transaction the sender may supply the required control set or the PPE may in some cases be able to use a default control set it already has so that no additional control set might be required N exit to decision block A FIG. and send processing may proceed to the next step.

On the other hand if PPE must get a recipient s control set Y exit to decision block A the PPE may contact the intended recipient s electronic appliance and or a control set archive block B over network for example. PPE may employ secure directory name services as shown in and or as described in the above reference Shear et al. patent disclosure to obtain sufficient information for sending and addressing the item to the intended recipient s .

Once PPE determines how to contact the recipient it may construct an administrative object see requesting the appropriate recipient controls block C and send the administrative object to the recipient s PPE or other appropriate VDE node that can supply the information block D .

The PPE within the recipient s electronic appliance or other responding VDE node may process administrative object upon receiving it block E constructing a response e.g. a responsive administrative object containing the requested or require control sets block G and sending it to the sender s PPE .

The sender s PPE may register the received controls block H upon receiving them from the recipient s PPE . The sender s PPE may then determine based on the received controls whether it can continue decision block I . If there is a problem with the controls e.g. they are for some reason unacceptable to the sender they are not valid etc. the sender s PPE determines whether the problem is critical decision block J . If the problem is critical PPE aborts the whole process Y exit to decision block J .

If the problem is not critical N exit to decision block J PPE performs an exception process decision block L to handle the problem and then waits for the next event which in this particular example may be a generate secure object event see block . shows example steps the PPE may perform in response to this create secure object event based on the control sets registered in accordance with step for example.

Referring to the PPE may use the dynamic user interaction techniques described above to request sender to select between send options and to otherwise specify the type and level of service he or she desires block A see block A . Generally sender may be required to select between various options each option may carry with it a certain price. The following are example options the sender may select from 

In the dynamic user interface model for example the user options associated with a contract offer which are used to create electronic controls associated with the electronic transaction might relate to a suggested addition modification deletion etc. to an existing item . If the VDE aware applications used by the participants included word processing capabilities given that the negotiation has a text based portion for example the VDE protected content in the offer could be represented as a redline or revision marking. The controls could further include aspects that manage modification of content in a controlled way e.g. see and . A more complex example might include several of these modifications insertions deletions etc. in a single offer to represent a horse trading offer indicating a willingness to make a series of changes at once for example a willingness to pay more money in exchange for removing a restrictive clause.

The options and associated controls associated with a contractual offer may also permit the offerer and or the recipient to add comments to the offer before it is sent and or accepted. These comments and or some or all of the negotiation history may be recorded and managed using the audit capabilities of VDE and or one or more repositories for VDE objects.

In this example the PPE checks the user input for validity decision block B based on applicable controls and may abort the process or provide other suitable exception handling if the input is not valid.

PPE may next specify any audit and routine controls based on the user input it has received and or the recipient controls it has registered block C . As mentioned above object may include one or more control sets contained in one or more PERCs for example that specify the type of routing and auditing to be performed in connection with sending an item and also providing one or more control methods for use in auditing and or routing. Step C typically also involve creating electronic controls specifying permissions and or restrictions relating to the use of item . In fact the electronic control set s created by block C may for example specify a variety of different document delivery or other characteristics such as for example 

Control set can be used to enforce a secure chain of handling and control on document container and or its contents. This secure chain of handling and control may be used for example to specify delivery routing auditing or other parameters as discussed above.

In performing step appliance may also create routing slip see and a template for return receipt s . In one example items may be embodied within electronic control set and expressed by the various elements within the electronic control set. shows an example of a routing slip data structure that may be maintained within secure electronic container e.g. as one or more DTDs in connection with one or more load modules see . This routing slip data structure may include for example 

Exception list may indicate named exceptions e.g. communications failure line busy refused receipt refused payment request etc. paired with a list of responses e.g. try again cancel entire transaction send report invoke event in PPE and data parameterizing the responses e.g. number of retries list of recipients of cancellation notices report recipients control information identifier and additional parameters for control use and or invocation respectively .

Recipient receipt information field for each recipient may indicate for example the nature of the receipt required and the recipients of that receipt. A receipt template may be included in the container may be referenced in an archive or may be named out of a set of default templates stored in each appliance.

The routing slip see associated with the document s in the container may be integrated with control information reflecting chain of handling and control relationships among recipients. For example the control information associated with the item s may be correlated with fields of the routing slip . Successful completion of a receipt may qualify a specific user to become eligible to use a subset of the control information that permits them to make changes in a portion of the item and describe their own control information for the changes so long as this control information does not provide further recipients with the right to modify the new material. The control information may further specify that no changes may be made to an item until one or more specified recipients has read the item and through use of reciprocal controls as show in for example indicated their approval of further changes.

In another example an entire class of users may be permitted to access the documents through the presence of a certificate indicating their membership in a class for example and the routing slip may be used to record who has handled a particular version of the document. Through use of chain of handling and control techniques the presence of certain users on the routing slip may permit further control information to be specified by a user. For example after an analyst s research report has been reviewed by three other analysts a manager may be permitted to modify the control information associated with the report to permit transmission to public users.

Electronic controls may also include one or more control methods specifying the type of audit information that is to be maintained in connection with the electronic transaction. This audit information may be used for constructing a receipt to provide evidence preventing repudiation and for a variety of other functions. Such audit information may be maintained exclusively within the sender s appliance it might be maintained exclusively within the recipient s appliance secure database it might be maintained exclusively within the trusted go between s appliance secure database or it might be maintained in a combination of any or all of these. Additionally the audit information may or may not be delivered with item depending on the particular objectives. A usage clearinghouse as described above in connection with and or as disclosed in the Shear et al. patent disclosure may be used to track the audit information based on event driven or periodic reporting for example. Audit records could be transmitted to a usage clearinghouse or to a trusted go between by an automatic call forwarding transmission by a supplemental call during transmission by period update of audit information by the maintenance of a constant communication line or open network pathway etc.

As mentioned above audit information associated with use of a document may be transmitted to many different parties. Audit information may also be treated as part of the signaling methodology described for reciprocal methods see to provide receipts. For example copies of receipts may be delivered to the sender as described above as well as to the sender s manager in a corporate setting or to the sender s legal counsel or other professional advisors such as tax advisers accountants physicians etc. Some items which are delivered to or used by recipients to gather information such as tax forms purchase orders sales reports and insurance claims may require delivery of receipts to several parties other than the sender. Some transactions may require the delivery of such receipts before completion. For example a sales report requesting delivery of products from a company s inventory may require that a receipt from the reading of a document delivered to the sales organization be received by the accounting department for audit purposes before permitting receipt of the document by the sales organization.

Referring once again to electronic appliance may next request authority from sender to obtain payment for delivery of the item block block D . Payment may be by any convenient mechanism and may be made by the sender the recipient and or by a third party. This payment processing in this example is handled by PPE in accordance for example with one or more billing methods as shown in for example.

The appliance is then ready to accept item such as a document to be sent if the item hasn t already been inputted block block E . PPE may based on control sets specifying this use the dynamic user interaction technique described above to interact with the sender and obtain the requested item for transmission. As mentioned above for physical documents appliance can optically scan the document into electronically readable form employing document reader scanner using page reader technology and or optical character recognition for example. For electronic documents or other items such as those created by a personal computer see this inputting step may be a matter of having sender select or create the item using standard document or file creation applications or physically picking such document using icons or other menu driven techniques. In one particular example sender may select a document or item to send by commanding a word processing or other application to print or otherwise write the item to a particular virtual printer or other output device which is mapped into the overall secure electronic delivery process.

Appliance may store the item in any of multiple representations. For example it could store it in Adobe Acrobat PDF or other text based page description. Storing the document in CCIT Group III Facsimile format is an example of a universal image format for black and white images. Group V is an example of a color format. TIFF is another example that incorporates many image types as well as different compression formats and descriptive metadata.

PPE may perform various tests on the inputted item and or other results of the user interaction provided by block E in accordance with one or more user controls. For example if the sender has specified that he is sending a 6 page letter but only inputs five pages PPE may notice this discrepancy and notify the sender decision block F . PPE may abort the process or perform other suitable exception handling N exit to decision block F if the results of the test are not satisfactory.

PPE may embed any seals signatures or hidden signatures into the item if needed block . This process may involve for example identifying signature insertion locations and embedding signatures upon directed or other controlled circumstances. Intelligent optical character recognition OCR may be used to identify signature locations. The display might also show an image of the page and allow the operator to identify the signature locations for themselves or more importantly for other parties. The PDF or other document description format expressions could be extended to include a code that would allow indication of signature insertion points.

Depending upon the particular electronic controls being used placement of the sender s signature or seal on the document may be based on the PPE s authentication of the sender as shown in FIG. and may require an additional indication of assent from the sender for example pressing a Yes button providing additional biometric or other identification information e.g. place your finger on the sensor if you want to sign this letter or Provide your mother s maiden name to sign this letter . Such authentication is important for non repudiation and to prevent fraud. The sender might actually sign his signature on a pressure sensitive or magnetic sensing signature capture and or verification pad provide a bit map image of his signature by presenting a smart card storing it plus using appropriate authentication techniques to assure that the bitmap image is being presented by the true signature owner or provide enough information through user interaction as described above that the PPE can access an electronic signature file containing the signature e.g. stored locally within appliance or accessible over network from an archive .

In the multi party execution example shown in appliance could simultaneously embed two or more signatures into the same document or other item but only upon securely receiving indications that all signatories assent to the document s terms.

Appliance may next place the item and associated electronic controls into one or more secure containers block H . Referring to once again step normally involves placing the image I of item including any seats signatures and other information into the secure container . It may also involve placing a data e.g. text version of the item D into the same or different container along with possibly adding tools for using the item in either or both forms. The PPE may then send the completed object to an object switch see for transmission to the recipient.

Referring to appliance may then deliver the secure container s to the intended recipient and or to trusted electronic go between based upon the instructions of sender as now reflected in the electronic controls associated with the object block . Such delivery is preferably by way of electronic network but may be performed by any convenient electronic means such as for example Internet Electronic Mail or Electronic Mail Attachment WEB Page Direct Telephone floppy disks bar codes in a fax transmission filled ovals on a form delivered through physical mail or any other electronic means to provide contact with the intended recipient s .

Appliance may through further interaction with PPE immediately and or later provide a receipt such as shown in block . Appliance can immediately issue a receipt indicating that the object has been sent. If rapid electronic communications means are being used appliance may also receive audit trail information from the recipient s appliance while the sender waits and issue a receipt indicating some or all of the kind of recipient interaction information shown in the example receipt. This receipt providing step may for example be based on PPE receiving one or more administrative or other objects containing audit information see .

For purposes of security and trustedness PPE may actually issue the receipt although it may use various other portions of appliance e.g. receipt printer A display card media reader etc. to output the receipt to the sender . PPE may also or alternatively maintain a copy of the receipt information and or the audit information on which it is based within its secure database see . The trusted go between similarly may maintain a copy of the receipt information and or the audit information on which it is based within a secure electronic archive .

Intended recipient may be given an option of accepting or declining delivery of the object block . If intended recipient accepts the item appliance may store the container locally block and then generate a register object event for processing by PPE .

PPE may next securely authenticate the received item to ensure that it is not a counterfeit block C . For example appliance may check one or more digital signatures within container to ensure that they are authentic or perform other authentication tests as described in detail above. PPE may perform critical and or non critical exception processing not shown if the received object and its contents are not authentic.

PPE may analyze any seal or other secure information that is part of the item . For example although the item image may be captured and cropped by untrusted processes the analysis of the image data is preferably done inside the PPE . Once the seal option of the image is identified an analysis process will be run to recover the digital information stored in the seal or steganographically encoded in the document . The next step is to determine what the expected values should be. To do this the PPE may make requests of an application program running locally to determine a user s expectations may use a digital representation of a receipt or other audit data and or may contact a trusted go between or other trusted third party to obtain the appropriate expected values. To facilitate this process there may be some unencrypted information in the seal that can be used to establish a correlation with other information e.g. a receipt a transaction number etc. . If such information is not available a local store or a trusted third party might compare the entirety of the recovered digital information with stored records to determine such a correlation. In other cases the expected values may be determined from context e.g. a default set of expected values or by examining the seal information itself in either encrypted or decrypted form for tags or other schema or semantic information .

Once the expectation values of the information is determined any encrypted portion must be decrypted using the public key corresponding to the private key used above to make the seal. This key can be obtained using the mechanisms discussed in Ginter et al.

Once decrypted the expected values may be compared with the actual values to determine correlation. Information about the correlation may be reported to a user and or a third party as appropriate. In addition some or all of the seal information may be included in such report.

Once PPE is satisfied that the received item is authentic it may embed receipt related information into the item if the electronic controls associated with the item require it block D . In one example the electronic fingerprinting techniques described above in connection with may be used for encoding various types of information onto item for example to show where the document has been. PPE may embed seals and or hidden information onto the item image at this time if desired. Electronic fingerprinting sealing and embedding hidden information may also be performed by the PPE at the sender s site but it may be advantageous to delay this process until the item arrives at the recipient s site because more things have happened to the item by then. For example it may be desirable to encode into seal hidden information and or hidden or unhidden electronic fingerprinting and or watermarking information the time stamp of when the recipient actually opened the container . In some arrangements one seal hidden signature or hidden or unhidden electronic fingerprint could be added at the end of sender and an additional seal piece of hidden information and or hidden or visible electronic fingerprint could be added at the end of recipient . Any or all of these various techniques may be used depending upon business requirements convenience logistics and aesthetics.

PPE may next perform any required payment and or other processing as needed block E . For example PPE may charge the recipient . for receiving the document e.g. collect on delivery or it may perform other processing such as debiting crediting initiating a local audit round robin pass along or the like all as specified for example by electronic controls .

Referring again to appliance may next index or otherwise catalog item for later access and reference block and may automatically identify document file format for storage or presentation to recipient block . Appliance may then select any additional information necessary to allow the recipient to interact with the document e.g. conduct any associated database searches or the like block and then initiate any associated application s and any carrier application required to interact with the document file block . Appliance may then generate a send or open event to PPE requesting the PPE to open container and allow the user to access its contents.

Referring again to appliance may then wait for further instructions from the recipient . If the recipient wishes and is permitted by controls to print the item decision block appliance may send a print event to PPE . shows example steps PPE may perform in response to such a print event. In this example the PPE may print the item using a suitable printer including if necessary or desirable a certifying seal and or other markings on each page of the document block A .

If recipient wants to redistribute the item to another person decision block appliance may generate a distribute event to PPE . shows example steps PPE may perform in response to such as distribute event. If the electronic control set associated with the item permits redistribution PPE and appliance may redistribute the item within a secure container s based on the conditions set forth in the applicable control set. For example the control set may specify that item is to be electronic fingerprinted to indicate that recipient has received and looked at it block A . Other information that may be embedded into the document at this time could include for example information related to the retransmittal such as for example name of sender s name of recipient s location of sender s location of recipient s employer s of sender s and or recipient s and or any other identifying information. PPE may then package all required information within the same or different electronic container and release the completed object s to appliance for transport using electronic or other communications means block B . PPE may if required by controls also send an administrative object providing additional audit and or receipt information to the sender indicating that the item has been passed on to the next intended recipient s block C .

In addition to the secure archive witnessing and transaction management functions discussed above trusted electronic go between may perform additional services such as for example 

The trusted electronic go between may comprise or include a transaction authority as disclosed in the above referenced Shear et al. patent disclosure and may have the same structure and architecture as shown in et seq. of that co pending application.

The trusted electronic go between may be one computer or many. It may be centralized or distributed. It may be public or private. It may be self sufficient or it may operate in conjunction with other go betweens or other support services. It may be entirely automatic or it may include functions and tasks that must be performed using human skills and expertise. It could be owned by a corporation or other organization or it could be a cooperative. It could charge for its services or it might offer its services free of charge.

As illustrated in the trusted go between may use reciprocal methods and distributed processing see and following to perform its tasks. For example the trusted go between could actually be a group of organizations e.g. a trusted go between and a notary public that each provide an aspect of the overall function. For example a certifying authority a governmental regulator and an arbitrator could provide the trusted go between function with the arbitrator acting as the front end i.e. appearing as the trusted go between from the participants point of view . Alternatively all three of these parties may each play a role as independent trusted go betweens with the cost of more complex control structures and all three parties requiring some level of coordination by one or more of the other participants to the extent their functions relate to the same subject matter .

In another trusted go between topology each of the participants could have one or more trusted intermediaries that interact with each other on behalf of the participants.

In this specific example additional electronic appliance B may be owned and or operated by an entity having the legal authority to be an electronic notary public. The notary public protected processing environment B may execute a control set B relating to notary functions. Control set B in this example has a reciprocal relationship between an overall control set A executed by a protected processing environment A of electronic appliance A. As shown in a notary protected processing environment B may originate both parts of reciprocal control sets and deliver one half A for operation by appliance A or electronic appliance A could originate both parts and deliver part B to the notary electronic appliance B.

The illustrated reciprocal control sets A B may reciprocally interact as described above in connection with for example. shows example reciprocal methods that might be contained within an example pair of reciprocal control sets A B. In this specific example the control set B operated by the notary protected processing environment B may include for example the following methods 

Similarly the reciprocal control set A operated by electronic appliance protected processing environment A may include methods responding to reciprocal events such as for example 

The control sets B A thus define and control the processing which go between performs on documents and other items in order to notarize them. Human users may interact with this process if desired through optional user interfaces . Such human intervention may be required under certain circumstances for example if a live human witness might be required to testify as to certain notarization facts if the automatic processes determine that a fraud is being attempted etc. . The dynamic interface technology described above can provide a mechanism for delivering a user interface through the system without direct intervention by the provider of the overall service with respect to user interface and by the notary with respect to the customer relationship.

Trusted electronic go between may also archive transmission related data as determined by the electronic control set associated with the item being sent the transaction type and or sender and or recipient information block . For example trusted electronic go between might automatically determine archiving requirements based at least in part on certified class based identification information regarding sender and or recipient . In one example trusted electronic go between archives transmittal related information such as receipt data structure in an object oriented database employing secure containers . It may also perform data reduction analysis and or authentication processes block to provide client specific class and or transaction type usage analysis.

Trusted electronic go between may next further process the received item in accordance with requirements provided by electronic control set block . For example the trusted electronic go between might perform an integrity check on the item or it may notarize the item before archiving it. Other processes that might be performed by trusted electronic go between depending on the particular scenario include for example the following non exhaustive list of functions and or operations 

As part of this processing trusted electronic go between may if necessary redistribute the electronic container to the intended recipient block .

Unless it already has the required permission to redistribute the object e.g. based on controls within the object s container trusted go between may need to request permission to redistribute block . Trusted go between may test to determine whether it has the required permissions decision block and request them from the appropriate party or parties if necessary.

If trusted go between is unable to obtain the necessary additional permissions no exit to decision block the trusted go between may send a failure notification block and may archive the requests replies and audit records block . If on the other hand trusted go between has the necessary permission s to redistribute the received object yes exit to decision block the trusted go between may affix one or more new seals to the item s block and may then send the sealed copies within secure containers to the appropriate recipient s block .

Trusted go between may perform appropriate payment processing block and may optionally provide appropriate return receipts as required by the controls associated with the object block .

In most instances retrieving archived data requires a user to authenticate themselves and present information identifying the container. Some containers may require more than one party to retrieve data e.g. both the recipient and the sender in most cases a user who is not party to the transaction cannot retrieve data an exception could be a government authority such as a court or tax auditor . In one interesting case all electronic copies have been lost or were never stored presumably the archive only contains transaction information and a hash value .

In this example the trusted go between may authenticate the received request and in the process may also satisfy itself that the requester has authorization to make the request blocks . This authentication process provides assurance that the request is authentic and has come from a party with authorization to obtain the requested information for example a court of competent jurisdiction .

Assuming the request and requestor are both authentic trusted go between may access the requested item s from its secure archive block . Trusted go between may affix one or more appropriate seals to the item s block and then send the sealed copy s of the item s to the requester block .

In this example trusted go between may optionally notify the owner s or other interested parties of item that it has provided a copy to the authorized requestor block . Trusted go between may perform appropriate payment processing as may be required for this transaction block and may optionally issue appropriate receipts to appropriate parties block .

Alice may indicate to protected processing environment within her electronic appliance that she wishes to sign the contract thereby creating a legal offer block . She may do so by for example clicking on a I agree icon or button her PPE causes to be displayed by placing her finger on a biometric sensor etc. The particular mechanism used is preferably sufficiently secure to make it difficult for Alice to later repudiate her decision to sign. The strength of the authentication should be indicated in the transmission as well as some requirement for this strength. This is central to commercial trustedness and furthermore the level of assurance e.g. location tamper resistance etc. is directly tied to this. The level of trustedness is based on the strength of authentication which can never exceed the strength of the assurance level both of which should be disclosed to all relevant parties in a transaction.

In this response to this action Alice s protected processing environment may affix Alice s signature and or appropriate personal seals to the contract see block . The process may at this point perform an appropriate payment method pre authorization for example to ensure that Alice will pay the compensation required under the contract block . Alice s protected processing environment may package the sealed signed contract with appropriate controls provided by block within an electronic container block . Alice s electronic appliance may send the resulting object to Bob s electronic appliance .

Upon receipt by Bob s electronic appliance block Bob s protected processing environment may open the container and authenticate the received object Alice s signature and or her seal block . Bob s protected processing environment may then cause Alice s signed contract to be displayed so that Bob can read and understand it block .

Assume that Bob reads the contract and agrees to sign it block . In this case Bob s protected processing environment may send an object to Alice s protected processing environment containing agreement controls electronic controls that provide PPE with methods to perform when the parties have agreed to execute the contract block . At this point Alice may confirm her intention to sign the contract as now agreed to by Bob e.g. Bob may have modified the contract before agreeing to sign it block . This confirmation may for example be based on biometric or other non repudiation assuring techniques as described above.

Alice s protected processing environment may send notification of Alice s confirmation to Bob block . Upon receipt of Alice s confirmation block Bob may also sign the contract conditional on Alice s signature block . Bob s protected processing environment may send the conditionally signed and sealed contract to Alice s protected processing environment block . Alice may then sign and seal the contract block and her protected processing environment may send the signed and sealed contract to Bob retaining a copy for Alice herself block .

In this example Alice s protected processing environment may also send a copy of the signed sealed contract to a trusted go between for notarization and or archival purposes see block . The trusted go between may notarize and or archive the signed sealed contract block and may issue archival and or notary receipts to both Alice and Bob block .

In one specific example the delivered contract can be a non disclosure agreement co delivered with an item s subject to the non disclosure provisions of the agreement. Associated electronic controls automatically enforce the non disclosure provisions of the agreement with respect to the co delivered item s .

Upon receiving the object block the trusted go between may open the object and authenticate it block . The trusted go between may then apply its own seal and send its sealed notarized copy of the offer in an electronic container with associated appropriated electronic controls to Bob block . Trusted go between may notarize and archive the item and associated audit information so far created block e.g. to keep a secure record of the negotiation process .

Upon receipt of the object Bob s protected processing environment may open the container block and send audit records indicating receipt and opening of the object block . Assuming that Bob agrees to sign the document e.g. after he has read it block A Bob may indicate his assent through biometric sensing or other techniques as described above and his protected processing environment may at that point send an object with agreement controls to the trusted go between block .

The trusted go between may notify Alice of Bob s intention to sign the contract block . Alice may then send the trusted go between her signature with electronic controls making the signature conditional on Bob s signature block . The trusted go between may archive Alice s signature and send Bob notification of Alice s conditional signature block . Bob may the sign the contract conditional on Alice s signature block A and send the conditionally signed and sealed contract to the trusted go between block . The trusted go between may apply Alice s signature and or seal to the contract based on the controls she sent to the trusted go between at block FIG. B block . The trusted go between may deliver the completed signed and sealed contract to both Alice and Bob block and may optionally itself notarize and or archive the signed sealed contract block .

The following are some non exhaustive examples of how system provided by the present inventions can be used in a variety of different illustrative contexts.

To prevent either party from later repudiating the contract trusted go between may require certain secure indication s allowing the trusted go between to verify that Bob and Ted are who they say they are. These indications required by trusted go between should have sufficient reliability that they will later stand up in a court of law. One possibility is for trusted go between to capture biometric information such as photographic images fingerprints handprints retina patterns or the like. Another possibility is to rely on the digital signatures and thus the security of the private keys of Bob and Ted possibly in conjunction with digital certificates and biometric sensing techniques as described above. In system Bob s private key and Ted s private key might never be exposed outside of their respective secure electronic appliances preventing each of them from voluntarily exposing their private keys as a basis for repudiating the contract.

Trusted go between may be completely electronic and automatic. It may receive container and open the container to access the contract it contains. Trusted go between may create a notarial seal on the document encoded with information encrypted using the trusted go between s private key. This encrypted information might indicate the time and date the trusted go between received the document a digital certificate number that securely identifies the trusted go between and the hash value of the signed contract see above . Trusted go between may include this resulting digital signature within its notarial seal and or may place the digital signature elsewhere on the document to create a notarized version .

Trusted go between may then store the notarized document within its secure electronic archive . The trusted go between may also if desired supply copies of the notarized document back to Bob and Ted within additional electronic containers so they each have record copies of the notarized contract .

Suppose a dispute arises between Bob and Ted. Bob wants to enforce the contract against Ted. Ted claims he never signed the contract. Trusted go between supplies a copy of the notarized contract to a court of law or other dispute resolver. By electronically analyzing the executed contract the court can read the notarization assurance of trusted go between that Ted did in fact execute contract . So long as the trusted go between required sufficient verification of Ted s identity before electronically notarizing the document the court should accept the notarization as conclusive evidence that Ted executed it.

Because of the extremely high degree of trustedness possible using system the example could be used to communicate national security secrets or highly sensitive criminal investigation results e.g. wiretaps between authorized government agents. Trusted go between might be authorized to register but not open the containers it receives for later use as evidence in court .

This teleconferencing capability can be useful for example to allow sender and recipient to verify they each are who they say they are and to assist in negotiating contract or otherwise discussing the content of an item . In order to further assure the authenticity of the communication a secure communications link may be established using key exchange techniques e.g. Diffie Hellman and encryption of the signal between the stations.

Secure containers may be used to encapsulate the video and audio being exchanged between electronic kiosk appliances to maintain confidentiality and ensure a high degree of trustedness. Thus in this example each secure container might contain some portion of or multiple video images and or some portion of or multiple audio segments. Electronic appliances can exchange such secure container back and forth in rapid succession to provide real time audio and video transmission In order to improve performance the containers themselves may remain at the users sites and only the encrypted contents transmitted between the participants. This may allow one or two containers to protect the entire communications between the parties.

In still another variation the teleconferencing shown in does not need to be simultaneous. For example sender could walk up to kiosk appliance and operate the kiosk to record a brief video and audio recording of a message. Sender could use appliance to review and approve the recording and then send the recording to recipient in more or more secure containers . Recipient could present himself to the same or different electronic appliance at a later time. The electronic appliance could verify that recipient is who he says he is and then play back the sender s recording.

The doctor may then send container to a trusted go between . Trusted go between could be a computer within a doctor s office or it could be a commercially operated trusted go between specializing in health care transactions or usable in general types of transactions. Trusted go between might be instructed by electronic controls to time and date stamp electronic container upon receipt and to store the electronic container within its secure archive . It might also be instructed to maintain patient records completely confidential indeed controls may prevent the trusted go between from itself having any access to these patient records but to forward a copy of the patient records to the patient s insurance company so the insurance company can pay for the medical services rendered by the doctor . For example the trusted go between in one example has no access to the content of the container but does have a record of a seal of the contents. If trusted go between has the seal it can interact with other parties to confirm the contents of the seal without needing to know or disclosing as the case may be the contents. Controls might also instruct trusted go between to forward the drug prescription to the patient s selected drug store upon the request of patient .

The patient could make such a forwarding request for example by operating An intelligent kiosk at the drug store . The patient s electronic request could be sent to trusted go between which in response might retrieve the drug prescription from its secure archive and forward it electronically within a secure container to the drug store chosen by patient .

One of the patient records might be a consent form that was executed by patient . To help prevent the patient from later repudiating his consent doctor might register this consent form with trusted go between which could then witness it by notarizing it and affixing its seal date stamp and or digital signature. Trusted go between could provide this consent form to a court of law and or medical malpractice company in the event that patient sued the doctor for medical malpractice.

Trusted go between registers the contract and then creates an electronic list of rules based on contract . A partial example rule list is shown in . Although the conditions are shown as being written on a clipboard in the preferred embodiment the clipboard is electronically implemented by a computer and comprises one or more electronic control sets that specify the conditions that must be satisfied in order for the overall real estate transaction to settle.

Trusted go between may need to communicate with each of a number of parties in order to determine whether the conditions have been satisfied. For example 

In this example trusted go between may receive electronic notifications in secure containers as each step in the overall process is completed. As illustrated in FIG. AA trusted go between can electronically check each completed condition off of its electronically maintained condition list as it receives such event notifications. Trusted go between maintains this electronic list in a secure validated and authenticated manner using system requiring for example receipt of electronic containers having event notifications that are signed cryptographically with one or more digital signatures from the appropriate parties. In this way trusted go between can maintain a highly reliable and validated authenticated audit of the transaction steps as the overall transaction proceeds.

In addition trusted go between may if desired be empowered to issue additional requirements and or instructions to facilitate the progress of the transaction. For example trusted go between might be a private trusted go between operated by lender and thus might be empowered to select which lawyer to use and to send that lawyer automatically appropriate instructions and forms for completing the transaction. As another example the trusted go between may be part of the business operated by lawyer or other settlement agent and may thus be empowered to select and instruct escrow bank .

When trusted go between determines based on the electronic rules control set and the notifications it has received that all conditions for settlement have been satisfied the trusted go between may allow the atomic transaction to settle by issuing appropriate notifications and or instructions once again using secure electronic containers and the receipt verification authentication and other mechanisms discussed above to ensure reliability confidentiality and a high degree of trustedness. For example 

All of these various coordination steps can be performed nearly simultaneously efficiently rapidly and with an extremely high degree of trustedness based on the user of electronic containers and the secure communications authentication notarization and archiving techniques provided in accordance with the present inventions.

For example defendant s attorney can specify one container for opening by his co counsel client or client s in house counsel and program another container for opening only by opposing plaintiffs counsel . Because of the unique trustedness features provided by system the defendant s attorney can have a high degree of trust and confidence that only the authorized parties will be able to open the respective containers and access the information they contain.

Appliances. may issue highly trusted and reliable return receipts as described above. These highly trusted electronic return receipts may substitute for certificates of service if court permits.

The lawyers can also electronically file any of these exchanged documents with the court by sending the documents to the clerk via secure electronic containers . In this example the clerk may actually be a computerized trusted go between represented here by a person but implemented in practice in whole or in part by one or more secure electronic appliances . The clerk may present a digital certificate evidencing that it is authorized to open a secure container it has received. The clerk may then date stamp each received document this may involve placing a seal on the document but more typically might involve simply placing a digital time signature on the document . The clerk may file the document electronically within a secure electronic archive that can provide a database for linking related documents together.

The judge might have a secure electronic appliance in the courtroom or in chambers that could be used to view and or print documents from the secure electronic archive . The judge could instantly call up any filing to determine when it was received by the clerk and to review its contents. Different authorizations and or encryption strengths could be used with respect to publicly available documents and documents under seal for example so that sealed documents could only be opened by the judge or her staff .

The judge could write her orders and opinions using electronic appliance . She could then send these documents within a secure electronic container for filing by the clerk in secure electronic archive and for automatic service on the lawyers .

In this example the clerk trusted go between could also be used to ensure compliance with the local rules of court. For example the clerk trusted go between could maintain in electronic form electronic controls indicating the time and formal requirements with respect to different kinds of filings. The clerk trusted go between could automatically check all incoming filings from the lawyers to ensure compliance with the local rules and to issue notices and other appropriate forms in accordance with the local rules. Use of a dynamic interface technology may be used to generate and deliver a set of controls to the sender s system that defines the parameters of receipt and default controls may be used to specify appropriate parameters formats etc.

Note that in this example documents can be controlled independently of where they are routed. For example defendant s litigating counsel could specify electronic controls that would allow court to access a document that need not be filed with the court but which might be of interest to the court at a later date e.g. letter between opposing counsel later used as an exhibit to a motion . The fact of document transmission along with some information about the document such as document title and identifier could be transmitted without actually transmitting the document itself allowing the court to retrieve the document itself independently at a later time if desired.

Upon receiving the patent application a trusted go between within the Patent Office could open the container and access the patent application . Trusted go between could electronically examine the patent application to ensure it meets all formal requirements and could also date time stamp the received patent application in order to document its filing date.

Trusted go between could automatically issue the inventor a filing receipt based upon secure receipt of the patent application using the return receipt techniques described above. Trusted go between could then deposit the patent application into a secure electronic archive to await examination. Trusted go between could include appropriate routing information based on a routing slip as described above to route the patent application to the appropriate group and or patent examiner within the Patent Office .

A patent examiner. could examine the patent application by requesting a copy of it from electronic archive . All communications could take place within secure electronic containers to ensure confidentiality and reliability completely avoiding the problem of lost files. The patent examiner could conduct prior art searches using the same electronic appliance used to review the patent application . The examiner could print out a copy of the patent application as desired.

The patent examiner could also use electronic appliance to draft office actions and notices. The examiner could communicate these notices and actions via trusted go between to the inventor . Trusted go between could maintain copies of the examiner s actions and notices within secure electronic archive ensuring their confidentiality and also making sure they do not become lost. System could provide a return receipt when the inventor opened the electronic container containing the examiner s actions or notices thus proving in a highly reliable and trusted fashion that the inventor had in fact received what the examiner sent. Similarly inventor could file responses and could even teleconference with the examiner via electronic appliance . The high degree of trustedness and confidentiality provided by system along with the return receipt and other options discussed above provide a highly reliable confidential communications means that can be used to demonstrate when items were actually filed.

Once the examiner after conducting a lengthy prior art search and carefully analyzing the patent application to ensure that the invention is patentable is fully and completely satisfied that the inventor is entitled to a patent the examiner could instruct the trusted go between to grant the application as a patent. Trusted go between could retrieve a copy of the application from the secure electronic archive use automatic means to transform it into an issued patent and insert a seal for example bearing the digital certificate of the Patent Office onto the document. The trusted go between could then issue the granted patent to the inventor by sending it in a secure electronic container thus ensuring that it does not get lost and is in fact received by the inventor.

Members of the public could obtain a copy of the issued patent by requesting one from trusted go between . Trusted go between could maintain a copy of the issued patent within secure electronic archive along with electronic controls that specify the document is a matter of public record and can be disclosed to members of the public. Other documents in secure electronic archive e.g. patent applications that have not yet been published can be maintained confidential by use of electronic controls specifying that only certain people e.g. patent examiner can access them.

The example also provides a convenient mechanism for registering invention disclosure documents with the patent office or other organization. For example inventor could use electronic appliance to file an invention disclosure document with the trusted go between . Trusted go between would notarize or witness receipt of the document upon receipt by embedding the document with a digital signature specifying the trusted go between s identity the current time and date and a hash value for use in an integrity check. Trusted go between could then file the invention disclosure document within secure electronic archive . At a later date inventor could prove the invention disclosure document had been created as of a certain date by requesting trusted go between to produce a copy of the invention disclosure document from secure electronic archive . Trusted go between would thus provide a secure trusted independent corroboration of document creation since it could demonstrate based upon its imprinted digital signature that it had received the document on a certain date and that the document had a certain contents.

The disclosure service could also simply send the inventor a signed hash value and then discard the document since the hash value could be used with a copy preserved by the inventor. The service could archive the signed hash value themselves as well although that is not required .

Appliance may help the taxpayer complete her tax return . For example the appliance could ask a series of questions based on a preprogrammed electronic script. The appliance could calculate the taxes owed and once taxpayer approved the tax return allow the taxpayer to electronically sign the return as described above. Appliance could accept tax payments via credit or smart cards debit authorizations from bank accounts etc. Appliance could also issue a paper or electronic receipt to the taxpayer assuring the taxpayer that the tax return has been filed. A court might accept this receipt as evidence of timely filing.

Tax authority may include an internal trusted go between that registers and securely date stamps all tax return filings and places them into a secure electronic archive . The trusted go between can also analyze each tax return to ensure that it complies with electronic rules embodying the tax laws some of this process could be performed by humans and some by computers if desired . Trusted go between can provide to a payment mechanism an electronic container requesting the payment mechanism to issue a refund to or collect a deficiency from the tax payer . In one example payment can be in the form of electronic currency carried within one or more secure containers . If the return is structured appropriately for automated processing tax calculations and application of relevant tax rules can also be automated by the trusted go between.

Organization A s Intranet might also be used to exchange and or distribute highly confidential design specifications. System can provide a highly secure audit trail indicating who has had access to a container containing the confidential design specifications when the person s accessed it and what they did with the specification print a copy view it on screen for so many minutes make a copy of it etc. System with or without the assistance of a trusted go between A can also maintain in digital form a detailed record of who has signed off on the design specifications thus ensuring personal accountability and providing a high degree of efficiency.

Private transaction authorities A B can also provide a firewall function to protect confidential information from escaping to outside of the respective organizations A B. Suppose for example that organization A is an integrated circuit design house and organization B is an integrated circuit foundry. Organization A designs and specifies the circuit layout of a chip producing a tape out that it sends to organization B. Organization B manufactures an integrated circuit based on the tape out and delivers chips to organization A.

System can be used to facilitate the above business transaction while protecting confidentiality within each of organizations A and B. For example 

Telecommunications are becoming ubiquitous in post industrial societies. As a convenience to customers the trusted go between could offer many of its services as part of or in conjunction with providers of telecom services. In one non limiting example shown in a trusted go between is co located and integrated with a telephone switch that connects to a telephone or other telecommunications network via wires or other connections in another example the switch and trusted go between cooperate but are not co located . In one example a person with a laptop or other computer lacking a PPE wishes nontheless to take advantage of a subset of secure item delivery services. The computer is equipped with a fax modem and associated application software. The computer dials a special number which may be an 800 number and is connected to the trusted go between who authenticates the sender using a pre established password and or stronger methods such as biometric measurements. The sender indicates the telephone number of fax machine to receive the document.

After selection of delivery options and trusted go between services and after making arrangements for payment the sender s computer faxes the document pages to the trusted go between . In one example the trusted go between applies seals to each page of the faxed document and an additional seal for the overall document. The trusted go between then faxes the sealed document to the recipient fax machine . The trusted go between also archives and notarizes the sealed document in case the sender or other authorized party requires proof that the document was sent on a particular time and date to a device with a particular telephone number. In the event that the sender s and or recipient s appliance is VDE aware e.g. fax machine equipped with a protected processing environment this service will be provided with additional levels of security and trustedness.

In another example the sender may prefer to have the document delivered in a secure container over a network such as the Internet in which case the sender may indicate the recipient s network address. The sender may connect a personal computer with a modem to another special number and send a digital item to the trusted go between using Internet protocols. In this one example the sender may not have yet installed VDE and so the trusted go between takes the document or item and puts it in a secure container along with controls selected by the sender and delivers the secure container to the recipient who in this example does have VDE installed.

These examples illustrate the more general point that the trusted go between may provide a range of value added services even to parties who do not yet have the VDE installed on their appliances and can enhance the security and trustedness of item delivery nevertheless.

While the invention has been described in connection with what is presently considered to be the most practical and preferred embodiment it is to be understood that the invention is not to be limited to the disclosed embodiment but on the contrary is intended to cover various modifications and equivalent arrangements included within the spirit and scope of the appended claims.

