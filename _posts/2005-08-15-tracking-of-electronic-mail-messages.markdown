---

title: Tracking of electronic mail messages
abstract: Electronic mail messages are tracked for the sender by allowing the sender to flag the electronic mail messages. Flagging the electronic mail messages allows for various notifications to be provided to the sender. For example, notification may be provided to the sender by placing an item in a to-do bar for the sender that corresponds to the electronic mail message. As another example, notification may be provided to the sender by firing a reminder at some future time that corresponds to the electronic mail message. As another example, notification may be provided to the sender by including an indication in a related incoming electronic mail message that the incoming electronic mail message is related to the electronic message sent by the sender.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07660859&OS=07660859&RS=07660859
owner: Microsoft Corporation
number: 07660859
owner_city: Redmond
owner_country: US
publication_date: 20050815
---
Electronic mail messages are a convenient way of communicating. Often an electronic mail message is sent for a situation where some activity should take place thereafter. For example the sender may expect that the recipient will take some action as a result of receiving the electronic mail message such as sending a reply electronic mail message or performing some other task. As another example the sender may be expected to take some action as a result of having sent the electronic mail message such as sending an electronic mail message that specifically states that the sender will do something on behalf of the recipient.

Conventionally there is no manner of selecting that the electronic mail message while being prepared by the sender be tracked in order to provide notifications to the sender that remind the sender to follow up on the electronic mail message. For users of the OUTLOOK 2003 electronic mail message program by Microsoft Corporation of Redmond Wash. senders can set follow up flags for recipients but not for themselves when composing an electronic mail message. To set a follow up flag for themselves the senders have resorted to taking additional avenues such as manually setting up a specific task entry copying oneself on the sent electronic mail message and then flagging the received electronic mail message in the Inbox folder or moving a stored copy of the sent electronic mail message which currently surfaces within the Sent Items folder so as to have it surface within the Inbox folder and then flagging the moved electronic mail message in the Inbox. Thus the user must take steps beyond composing and sending the electronic mail message in order to manually create a way to be notified about following up.

Tracking of sent electronic mail messages occurs by providing the sender with an option to flag the electronic mail message to provide a notification regarding the sent electronic mail message to the sender. The resulting notification may take on one or more of various forms such as but not limited to a to do bar item corresponding to the electronic mail message a reminder associated with the electronic mail message that fires at some future time and an indication within an incoming electronic mail message noting that it is related to the electronic mail message that has been flagged by the sender. Furthermore the sender may be provided with an option to flag the electronic mail message to provide a possibly different notification regarding the sent electronic mail message to the recipient in addition to providing the notification regarding the sent electronic mail message to the sender.

This Summary is provided to introduce a selection of concepts in a simplified form that are further described below in the Detailed Description. This Summary is not intended to identify key features or essential features of the claimed subject matter nor is it intended to be used as an aid in determining the scope of the claimed subject matter.

One or more notifications relating to an electronic mail message that has been composed are provided to the sender of the electronic mail message when the sender selects an option for the electronic mail message to be flagged. According to one or more embodiments the sender may select the option when composing the electronic mail message or after the electronic mail message has already been sent. The notification to the sender that results from selecting the option may be of various forms discussed in more detail below.

In the example of the processor implements instructions stored in the mass storage in the form of an operating system and a message task application for example a Messaging Application Programming Interface MAPI compliant application. In doing so the processor provides data to a display adapter that generated a display on a display screen. The display may include a graphical user interface that allows the user of the computer system to interact with windows and dialog boxes of the graphical user interface when managing electronic mail messages tasks and other features provided by the message task application program . The windows and dialog boxes include controls and data fields that allow the user to make selections and enter data when composing electronic mail messages and the user makes such selections and enters data through an input device such as a keyboard and or mouse. Furthermore the message task application makes use of the network adapter to exchange data with remote computer systems such as electronic mail message servers that allow the message task application to send and receive electronic mail messages.

When using the message task application the user sends electronic mail messages to others and a copy of the sent electronic mail message may be stored within a message store. The message store may be the mass storage or other storage location such as a remote server and the message store may be a specific data folder on the mass storage accessible by the message task application . The user of the message task application who composes electronic mail messages and chooses to track the electronic mail messages by flagging them is referred to herein as the sender while those to whom the electronic mail message is directed are referred to herein as the recipient. show various examples of screenshots that are produced by the message task application when the sender is interacting with the message task application . show an example of an operational flow that may be performed by the message task application when interacting with the sender and specifically when responding to input from the sender to track an electronic mail message composed by the sender by providing notification back to the sender. It should be appreciated that the screenshots and operational flow are provided only for the purposes of illustration and are not intended to be limiting of the scope of the claims set forth below.

Computer system typically includes a variety of computer readable media. Computer readable media can be any available media that can be accessed by computer and includes both volatile and nonvolatile media removable and non removable media. By way of example and not limitation computer readable media may comprise computer storage media and communication media.

Computer storage media includes both volatile and nonvolatile removable and non removable media implemented in any method or technology for storage of information such as computer readable instructions data structures program modules or other data. Computer storage media includes but is not limited to RAM ROM EEPROM flash memory or other memory technology CD ROM digital versatile disks DVD or other optical disk storage magnetic cassettes magnetic tape magnetic disk storage or other magnetic storage devices or any other medium which can be used to store the desired information and which can accessed by computer system .

Communication media typically embodies computer readable instructions data structures program modules or other data in a modulated data signal such as a carrier wave or other transport mechanism and includes any information delivery media. The term modulated data signal means a signal that has one or more of its characteristics set or changed in such a manner as to encode information in the signal. By way of example and not limitation communication media includes wired media such as a wired network or direct wired connection and wireless media such as acoustic RF infrared and other wireless media. Combinations of the any of the above should also be included within the scope of computer readable media.

Now referring to and screenshot window once the sender has selected the Custom sub option the message task application receives the selection and displays a dialog box that shows fields for entering flagging details at dialog operation . For example a box allows the sender to set the flag for providing notification only to the sender. Field receives a flag name such as a default flag to follow up or a flag to forward the message or the user may enter a custom flag name. Field receives a start date to include in the notification and field receives a due date to include in the notification.

Additionally the sender can select box within the dialog box to set a reminder that fires within the message task application of the sender to provide another form of notification to the sender in relation to the electronic mail message. Fields receive a date and time for the reminder to fire for the sender in the future.

Additionally in this embodiment the dialog box allows the sender to select the option of providing flagging for the recipient to provide notification to the recipient. For example a box allows the sender to set the flag for providing notification to the recipient. Field receives a name of the flag such as a flag to follow up a flag to forward the message or a custom flag name entered by the sender.

Additionally the sender can select box within the dialog box to set a reminder that may fire within the message task application of the recipient if that message task application supports flagging and reminders to provide a form of notification to the recipient in relation to the electronic mail message. Fields receive a date and time for the reminder to fire for the recipient in the future.

Now referring to and screenshot window once the sender has entered all of the flagging details for the sender and or recipient notification the message task application of the sender generates flag data from the information entered by the sender at flag operation . Additionally at this point the message task application provides a notification within an information bar based on the flag data. As shown in the notification of information bar states that once the message is sent it will be marked as a task for the sender that has the follow up details that have been entered by the sender. The information bar may also state if appropriate that recipients are asked to follow up according to the details that have been entered by the sender. The flag data is discussed in more detail below with reference to .

Returning briefly to where the user selects an option from the drop down menu that has default flag values associated with it such as the today sub option then operational flow may proceed from menu operation directly to a flag operation since the operation associated with the dialog box of is unnecessary.

At this point the sender then selects to close out the electronic mail message by sending it. The message task application then stores a copy of the electronic mail message within the message store of the message task application at message operation . The stored electronic mail message may surface within a default folder or within a folder that is specified by the sender when composing the electronic mail message. For example a copy may be stored in the message store and be set to surface by default within a Sent Items folder. Furthermore the electronic mail message may surface within additional folders used for processing purposes based on the header data included within the message. For example the message may surface within a swap folder and or a reminder folder both of which are discussed in more detail below where such folders allow messages to be discovered in order to perform a particular post send process for providing a notification to the sender.

Now referring to screenshot window includes the stored copy of the electronic mail message after it has been sent by the user and thus shows how it would appear when opened from a folder after being sent such as the Sent Items folder as shown. The information bar provides a notification that indicates the details entered by the sender for the flag set for the sender for the electronic mail message and may also indicate the details entered by the sender for the flag set for the recipient. In this embodiment the portion of this notification that pertains to the flag set by the sender for the sender is not transferred for the copy of the electronic mail message that is sent to the recipient such that the recipient does not see that the sender has set a flag for the sender.

The notification located in the information bar results from the message task application performing post send processing on the copy of the electronic mail message and the flag data that it contains at post process operation of . Such post processing in the context of mail messages that have been sent by the user and the relationship of post processing to the flag data is discussed in greater detail below in relation to and the progression of the states of the electronic mail message.

The post processing of operation may provide for various other forms of notification to be provided to the sender. For example with reference to and screenshot window a to do bar within the graphical user interface includes task items and a task item that corresponds to the electronic mail message is included to provide a form of notification about the electronic mail message to the sender at task operation . The task item is organized within the to do bar based on the flagging details entered by the sender and in this example the to do bar is arranged by start date and the start date entered by the sender is today. The task item serves as a control to open the stored copy of the electronic mail message when the sender clicks or otherwise selects to open the task item .

As shown the sender has the Sent Items folder open and has highlighted the stored copy of the electronic mail message such that the message body is being displayed within a preview pane . The stored copy that surfaces in the Sent Items folder has a flag to further indicate to the sender that this particular electronic message has been flagged. The preview pane also includes the information bar that is separate from the message body and that further provides notice to the sender about the details of the flagging including specifying the start date and due date for the sender that has been specified in the flagging details by the sender and may also display any flagging details set by the sender for the recipient. It will be appreciated that the information bar providing the same notification as shown may also be present where the stored copy is opened in a separate window rather then being displayed in the preview pane .

The flagged electronic mail message that has been sent is added to the to do bar by finding a to do property in the flag data that has been generated. As discussed below with reference to in the context of a MAPI compliant messaging engine manipulation of the location of the to do property occurs so that the to do item may be generated for the sender but not for the recipient such as for embodiments where there is no separate flagging for recipients or where there is separate flagging for recipients but the sender chose not to flag for the recipient.

Another example of notification to the sender provided by the post send processing of post send operation is shown with reference to . Here a screenshot window shows that the sender has the Inbox folder open and an incoming electronic mail message that has been sent in reply to the flagged electronic mail message sent by the sender is highlighted. A preview pane displays the incoming electronic mail message including the message body and an information bar separate from the message body .

To further provide notification to the sender regarding the flagged electronic mail message that has been sent the message task application causes the information bar of the incoming electronic mail message to include an indication that the incoming electronic mail message is part of a tracked branch of conversation relative to a sent electronic mail message at thread operation . The information bar further indicates to the sender that the sender may click the information bar in order to open the flagged electronic mail message that has been sent and that is related to this particular incoming electronic mail message . It will be appreciated that the information bar providing the same notification may also be present where the incoming electronic mail message is opened in a separate window rather then being displayed in the preview pane .

The message task application provides the notification in the information bar based at least on thread identifiers and may also base the notification on whether an incoming message is a descendant message that is part of a tracked branch relative to a message previously flagged and sent by the sender. The message task application determines at least whether the incoming electronic mail messages have a thread identifier in the header data that matches the thread identifier of the flagged electronic mail message that has been sent at thread operation . In one embodiment when the thread identifier of the two electronic mail messages match then the information bar is provided with the appropriate notification and the information bar links to the flagged electronic mail message that has been sent and that has the matching thread identifier. In another embodiment where it is desirable to indicate that the message is specifically part of a flagged branch of the ongoing conversation the message task application may also determine whether the incoming electronic mail messages also are descendants of the sent electronic mail message flagged by the sender based on the send time of each and then only provide the notification of the incoming message being a part of the tracked conversation when the thread ID matches and when the incoming message is a descendant. In this embodiment an option to find all related messages may be included where this option functions to find all the electronic mail messages in the store that have the matching thread ID without regard to whether the messages are descendants.

While the message body of this example includes the header and message body of the electronic mail message that has been sent the recipient could have chosen to not include this in the incoming electronic mail message. In that case the information bar would have been the only way that the sender could have noticed that the incoming electronic mail message was related to the flagged electronic mail message that was sent. Additionally even when the recipient chooses to include the header and message body within the reply sent back to the sender in this example the sender cannot open the flagged electronic mail message by clicking somewhere within the message body. Thus clicking on the information bar is the most convenient way to open the flagged electronic mail message that was sent in this example.

Screenshot window further illustrates that while the Inbox folder is open the to do bar may remain present within the window . Furthermore the to do bar continues to display the task item that corresponds to the flagged electronic mail message that has been sent.

Yet another example of notification to the sender provided by the post send processing of post process operation is shown with reference to . Here a reminder dialog box is fired so as to be displayed for the sender at reminder operation at a time designated by the sender in the flagging details. The reminder of this example includes an item that corresponds to the flagged electronic mail message that has been sent. A control is provided to open the flagged electronic mail message or the sender may double click on the item in order to open the flagged electronic mail message. Additional information of the flagging details such as the end date specified for the flag may also be included within the reminder . Other standard reminder controls may also be provided such as a snooze button and a snooze time drop down menu .

The reminder may be fired in the normal manner by discovering the flagged electronic mail message within a reminder search folder where it has surfaced at operation based on the flag data including a reminder property and where a persistent search of the reminder folder is done to find a flagged electronic message whose reminder property in the flag data specifies a reminder fire time equal to the current time. Once the reminder fire time for the flagged electronic mail message is reached the reminder is fired for display to the sender. As discussed below with reference to in the context of a MAPI compliant messaging engine manipulation of the location of the reminder property occurs so that the reminder may be generated for the sender but not for the recipient such as for embodiments where there is no separate flagging for recipients or where there is separate flagging for recipients but the sender chose not to flag for the recipient.

As an alternative manner of providing the notifications to the user of the message task application the user may set a flag for a message in the message store at some time other than when the message is being composed and even for messages that are received by the user rather than those that have been sent. For example the user can flag a message after the message has been sent and then surfaces in a Sent Items folder or flag a message after the message has been received and then surfaces in an Inbox folder. As shown in the message task application may receive flagging details from the user for the surfaced message within the message store at flag operation . The message task application then processes the message flag data of the copy of the message at post process operation due to its presence within a search folder. In this context where the message is being flagged other than on compose the post process operation is not performing post send process as discussed above but is providing the same processing in a post flagging context. Operational flow proceeds from the post processing such that the notification for the flagged message in the message store may then be provided to the sender via operations and in the same manner as discussed above.

It should be noted that in the embodiments discussed above the notifications may cease to be provided if one of various conditions are met. If the user chooses to not keep a saved copy of the electronic mail message that has been flagged and chooses not to be included on the recipient list for sent electronic mail messages then there is no stored copy to surface within a search folder corresponding to reminders to do bars tracked conversations etc. such that no notification regarding the sent electronic mail message is provided. Furthermore in these embodiments the user may choose to clear the flag or mark the saved copy as completed by accessing the saved copy from one of the folders where it has surfaced or by accessing the item that has surfaced within the to do bar. Once the flag has been cleared or the sender has marked the item has being completed the flag data is no longer found via the search folders such that the notifications are no longer provided.

The progression begins by the sender composing the new electronic mail message at compose operation which includes the sender flagging the message and providing the flagging details such as the dates and whether a reminder should fire. At that time the electronic mail message has a draft state where the flag data that pertains to flagging for the recipient i.e. recipient flag data is stored in a primary storage location of the draft electronic message . Also in this draft state the flag data that pertains to flagging for the sender i.e. sender flag data is stored in a secondary storage location . At this point as the electronic mail message has an inactive To Do state since it is in draft format and has not been post send processed.

Once the sender has completed composing the electronic mail message the sender submits the electronic mail message at send operation . At this point the electronic mail message within the message task application of the sender takes on a submitted state. In the submitted state the recipient flag data remains in the primary storage location while the sender flag data remains in the secondary storage location . Also there has been no post send processing such that the To Do state remains inactive.

After the electronic mail message is placed into the submitted state the transport mechanism of the message task application does two things at send operation . The transport mechanism relays the electronic mail message to the address of the recipient. The transport mechanism also stores a copy of the electronic mail message in the message store so that it may surface within a designated folder for the sender such as the Sent Items folder.

In the context of the MAPI compliant message task application the secondary location of the submitted message is out of range for purposes of relaying the electronic mail message to recipients. Accordingly the sender flag data is not relayed as part of the electronic mail message such that the secondary location of electronic mail message is empty. Furthermore the To Do state of the application is also not transmitted with the message since the message task application of the recipient may post receive process the primary location to handle whatever the recipient flag data specifies. Since the sender flag data is not transferred there is no risk that the flags that are set for the sender not for the recipient and that are set by the sender will cause the message to also be treated as flagged for the recipient by the message task application of the recipient.

However for some embodiments steps may be taken to ensure that even if the sender flag data is transferred or where the sender and recipient share the same mail server and a single instance of the message exists in order to surface in both mailboxes the sender flag data does not become exposed to the recipient such as by an information bar message or otherwise. These steps may include providing a second value for the electronic mail message that has been submitted where the second value that is also non transmittable by a MAPI transport under normal circumstances and that uniquely identifies the sender. This second value may then be checked against the current user to determine whether this electronic mail message is sent by the current user or not. Where the secondary location and the second value identifying the sender are mistakenly transmitted to the recipient then the message task application of the recipient will detect the message within a swap search folder and will then compare the current user to the second value that identifies the sender. If the two do not match then the secondary flag location and the second value are simply deleted from the electronic mail message by the message task application of the recipient. Where the message task application of the recipient does not support flagging such that the comparison of the second value to the current user is not performed and the secondary flag data remains then the secondary flag data is meaningless and goes unused.

Where the sender has not flagged the electronic mail message for the recipient then the recipient flag data of primary location will be empty since there has been no recipient flag data generated and since the sender flag data that was generated was not included in the primary location and therefore was not transferred. Accordingly no notifications will be provided automatically for the recipient based on the electronic mail message that has a received status within the message task application of the recipient. Instead the recipient will be required to set any notifications such as by manually flagging the message for follow up setting a reminder and adding a separate task if desired. However where the sender has flagged the electronic message for the recipient then post receive processing of the electronic mail message will result in notifications being automatically set for the recipient based on the flagging details for the recipient that have been set by the sender if the recipient is using a message task application that utilizes such flag data. Additionally the message task application of the recipient may allow the recipient to overwrite the flag data for the received electronic mail message .

A stored copy of the electronic mail message that is retained within the message store by the message task application of the sender now has a status of sent. However just prior to any post send processing of the stored copy the primary location retains the recipient flag data while the secondary location retains the sender flag data. Additionally the To Do state maintains an inactive status. As discussed above the electronic mail message may include the second value that is non transmittable and that identifies the sender.

Shortly after the stored copy has been created post send processing of the stored copy occurs at post send operation . The stored copy undergoes post send processing due to the stored copy surfacing in a search folder that triggers such processing. For example the stored copy may surface within a swap search folder that has criteria for finding messages that require the flag data to swap locations. This post send processing to find the sent message and perform a swapping operation is set to occur prior to other post send processing search folders such as the reminder search folder to prevent the recipient flag data from causing notifications intended for the recipient to be mistakenly provided to the sender.

In this particular example where the second value that identifies the sender is present the search criteria of the swap search folder where the stored copy of the sent electronic message will surface includes looking for electronic messages in the message store that have a status of sent but also include the second value that identifies the sender. The second value is compared to the current user in this case the sender and because they match this indicates that the primary location and the secondary location have not been swapped. In that case the contents of the primary location and the contents of the secondary location are swapped so that the sender flag data is now in the primary location and is actionable by search folders for generating notifications to the sender while the recipient flag data is present in the secondary location to preserve the flagging details set by the sender for the recipient. Furthermore the second value that identifies the sender is deleted such that the electronic mail message no longer satisfies the criteria of the swap search folder so that no additional swapping occurs.

Accordingly when post send processing the message that has the sender flag data in the secondary location of the stored copy and or recipient flag data in the primary location then the sender flag data and the primary flag data swap locations as shown in post send processed copy . This stored copy has a sent state has the sender flag data stored in the primary location and has the recipient flag data stored in the secondary location .

After swapping the location of the recipient flag data and the sender flag data the primary location may be acted upon to provide notifications in accordance with the sender flag data. For example the sender flag data being present may result in changing the To Do state to active to thereby surface an item corresponding to the electronic mail message into the to do bar. Furthermore the sender flag data being present may result in a reminder search finding the reminder property of the sent flag data that specifies when to fire a reminder. Additionally the sender flag data being present may result in the thread ID of the stored copy being referenced when incoming electronic messages are received so that when a matching thread ID and thread index are found the information bar of the incoming electronic message indicates that there is an electronic message within the tracked conversation.

The embodiments discussed above may include various properties that the MAPI compliant message task application operates upon. Those properties that are specifically associated with providing the notifications based on the electronic message being flagged for the sender include 

While the invention has been particularly shown and described with reference to various embodiments thereof it will be understood by those skilled in the art that various other changes in the form and details may be made therein without departing from the spirit and scope of the invention. For example although the post processing to provide the notification is said to occur by acting upon flag data in the primary location which provides for backward compatibility with pre existing MAPI messaging applications embodiments not requiring such backward compatibility may alternatively provide for separate logic that looks for sender flags in the secondary location of sent items while other separate logic looks for non sender flags in the primary location of received items such that swapping of the flag data is not performed in order to provide sender notifications to senders and recipient notifications to recipients.

