---

title: Method and system for secure communications with IP telephony appliance
abstract: A method and system are disclosed for providing secure communications with a communication appliance such as an IP telephone, wherein such an appliance has a reduced risk to attacks by unauthorized or rogue applications. In particular, “denial of service” and “man-in-the-middle” attacks are prevented. One embodiment establishes authenticated and encrypted communications with a single IP server for transmitting and receiving substantially all IP application communications with third parties.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07965701&OS=07965701&RS=07965701
owner: Avaya Inc.
number: 07965701
owner_city: Basking Ridge
owner_country: US
publication_date: 20050429
---
The present application claims the benefit of U.S. Provisional Patent Application No. 60 615 302 filed Sep. 30 2004 which is incorporated by reference herein.

The present invention is related to Internet Protocol network method and system for obtaining secure managed access to IP telephony appliances devices and for interacting with the capabilities of such devices.

Voice telecommunication infrastructures have traditionally been implemented with technologies very different from the technologies that are at the foundation of Internet based communication systems. However most telecommunications equipment providers and service providers are rapidly migrating their voice telecommunication applications to use IP networks for the transport of voice in the form of data. Such migrated applications are broadly referred to as Voice over Internet Protocol VoIP . In particular technologies supporting VoIP applications merge the transport of voice telephony data with the data transport for other IP enabled applications on IP networks.

Adoption of IP telephony services by corporations and other large organizations is also accelerating. Many new VoIP deployments are targeted for internal use by corporations on their private local area networks LANs . Additionally VoIP technology also enables commercial telephony service providers to offer IP based telephony for their commercial market customers. In particular various Internet IP telephony solutions are commercially available that provide communication services via the Internet e.g. Vonage 2147 Route 27 Edison N.J. USA 08817 Packet88x8 Inc. 2445 Mission College Blvd Santa Clara Calif. 95054 etc . As such IP telephony services gain popularity and interoperate with traditional Internet based services e.g. e mail instant messaging display of graphics video music popup advertising corporate directory accounting expense management package tracking etc. the communication appliances e.g. IP telephones utilizing such services will be subject to security attacks similar to those that Internet connected personal computers PCs have experienced. The IP based applications providing telephony services are often referred to as CTI Applications or computer telephony interface applications because these applications provide substantial interaction or communication between a communication appliance and an Internet or Intranet computer server e.g. an email server which may be also providing one or more telephony services. Moreover such communication appliances enabled for CTI application access can experience particularly troublesome security attacks since they simultaneously connect to a telephony networks for traditional telephony services switched or otherwise which have historically not exposed to hackers and b data networks which are frequently the target of hacking attempts network storms or malware as one skilled in the art will understand . For example in the current state of the art the firmware for a CTI enabled IP telephone must continuously monitor one or more IP ports thereby listening for network broadcast requests from the CTI applications that the phone s current user is authorized to use. Upon receiving an initial network broadcast request from substantially any CTI application the IP telephone may with minimal or no authentication and or authorization checks respond with information sufficient for a requesting CTI application to carry out unauthorized and or damaging attacks e.g. via the IP telephone. In particular during an initial handshake exchange of information between the IP telephone and the CTI application the IP telephone may provide the phone s IP address or its telephone number also referred to as its extension . With an IP telephone s IP address or its telephone number captured a rogue CTI application may impersonate a.k.a. spoof the IP telephone s identity for unintended and or destructive purposes. These types of vulnerabilities can provide the opportunity for a number of network attacks including 

Thus it would be desirable to have IP telephones that are more secure from at least denial of services attacks and man in the middle attacks as well as other security compromising attacks from e.g. hackers and or illicit network applications. More particularly it would be desirable to ensure that IP telephones do not blindly follow directions received from a network application without better determining that the application is a trusted information source.

The present invention is a method and system for providing and maintaining secure communications between a network communication appliance such as an IP telephone and one or more network applications. In particular the present invention provides secure communications with such a network communication appliance while allowing a user thereof simultaneously to access both 

In providing secure network communications with such network communication appliances the present invention establishes and uses authenticated and encrypted communications between each such network communication appliance and a corresponding appliance connection server wherein the appliance connection server is a trusted intermediary between the network communication appliance and substantially all other network applications that communicate with the network communication appliance. Thus such a network communication appliance will not respond as requested to communications received from sources other than the appliance connection server and in particular the network communication appliance may ignore and or log communications from sources other than the appliance connection server as illegitimate communications. In this manner such a network communication appliance is insulated from various types of attacks to illicitly gain information and or illicitly control the network communication appliance e.g. an IP telephone . Moreover it is an aspect of the present invention to provide a method and system for establishing secure communications between a plurality of such network communication appliances e.g. IP telephones and the appliance connection server.

It is also an aspect of the present invention that such a network communication appliance can be activated for communication on a network without substantial programmatic configuration. In particular the communication appliance may activate built in programming for broadcasting its presence on one or more networks for obtaining information that allows the communication appliance to establish secure communications with a corresponding appliance connection server that effectively functions as a gateway and or broker between the communication appliances and network applications who wish to communicate with the communication appliance. For example an IP telephone according to the present invention may be purchased removed from its packaging provided with a network connection and powered up wherein the IP telephone subsequently establishes a secure network connection with an appliance connection server without further effort by an installer of the IP telephone.

In at least some embodiments of the present invention the following steps are performed by the network communications appliance for establishing secure communications with an appliance connection server 

Other benefits and advantages of the present invention will become apparent from the accompanying drawing and the Detailed Description hereinbelow.

Prior to an IP telephone becoming fully operational it is an aspect of the present invention that it establishes secure communications with the appliance connection server so that a first communication as well as every subsequent communication on a predetermined port of the IP telephone be can fully trusted as both authentic and private. Accordingly during a process of the IP telephone becoming fully functional i.e. booting up when first activated the IP telephone will initiate and broadcast network IP messages to a network identification server wherein this server responds with a message that contains both an IP address for the IP telephone and a second network IP address which is the address of a configuration server . An example of such a network identification server is the PowerEdge Server manufactured by Dell however other servers provided by e.g. Sun Microsystems Inc. 4150 Network Circle Santa Clara Calif. 95054 may be also used with the present invention.

The configuration server provides the IP telephone with most of the additional information it needs to become fully functional. In particular when the IP telephone receives the IP address of the configuration server the IP telephone sends a network IP message to the configuration server requesting configuration information. In response as will be described further hereinbelow the configuration server provides the IP telephone with the IP address of an appliance connection server and may also provide the IP telephone with one or more of the following 

Note that in one embodiment where the communication appliance is provided by e.g. Avaya Inc. the IP address of the configuration server is transmitted to the communication appliance in a data field that has been pre assigned to Avaya and can therefore be identified and used by the Avaya communication appliance since its firmware includes programmatic instructions for decoding the pre assigned data field and using the information therein.

Upon receipt of the IP addresses the communication appliance sends step a network IP message addressed to the configuration server wherein the message requests secure communications e.g. a secure communications tunnel with the configuration server . In one embodiment such secure communications is provided using the IP communications protocol HTTPS i.e. HTTP over the Transport Layer Security TLS which is well known in the art and is fully described in the following references fully incorporated by reference herein IETF RFC 2246 http www.ietf.org rfc rfc2246.txt and IETF RFC 2818 http www.ietf.org rfc rfc2818.txt . Moreover to more fully disclose the present invention a brief description of the steps performed by the TLS protocol is provided here as follows 

The client and server can now exchange application data such as HTTP data over the secured channel they have established. Accordingly all messages sent from the client to the server and from the server to the client are encrypted using the session keys.

Once the configuration server and the communication appliance establish secure communications e.g. via a secure tunnel using HTTPS on the IP network e.g. a local site wide or enterprise wide IP network or the Internet in step the communication appliance requests any configuration information available at the configuration server. Accordingly the configuration server transmits via the secure communications tunnel the following information to the communication appliance 

In step the communication appliance transmits an IP message to the appliance connection server wherein a secure communications tunnel is established between the communication appliance and the appliance connection server via e.g. HTTPS as described in steps 1.2 through 1.8 above. Thus once the secure communications tunnel is established in step the communication appliance and the appliance connection server communicate via the secure communications tunnel to agree on one or more keys to be subsequently used to both authenticate and encrypt decrypt IP network communications from and to a specified port of the communication appliance . Additionally the communication appliance registers with the appliance connection server by providing its IP address via an authenticated message to the appliance connection server . The communication appliance may also negotiate with the appliance connection server for additional keys and methods used for subsequent encryption and authentication. Note that agreement on the key s can be performed in various ways such as distribution of keys from one party to another negotiation of keys where each party contributes a portion of the resulting keys or cryptographic creation of keys through symmetric or asymmetric techniques as one skilled in the art will understand.

Subsequently in step the specified port of the communication appliance is opened as substantially the only IP port that the communication appliance listens for IP information from a source such as the appliance connection server or a third party IP application via the appliance connection server .

The one or more agreed to keys are used to both authenticate and encrypt decrypt subsequent IP packets transmitted between the communication appliance and the appliance connection server . In particular the encryption algorithm used may be any of the widely used encryption algorithms such as AES RC4 Two Fish Blow Fish Triple DES DES etc. Moreover the authentication to be used in such subsequent communication may be a hash message authentication code which is authenticated by an authentication technique such as HMAC as described in IETF RFC 2104 http www.ietf.org rfc rfc2104.txt fully incorporated herein by reference the SHA1 authentication algorithm as described in NIST FIPS PUB 180 1 Secure Hash Standard fully incorporated herein by reference or the MD5 authentication algorithm as described in IETF RFC 1321 http www.ietf.org rfc rfc1321.txt fully incorporated herein by reference . However to provide further disclosure regarding such authentication techniques at a high level such techniques use a code that is incorporated as a separately accessible portion of each IP packet such that when the packet is received the code and e.g. the actual message within the packet are provided as a pair to the authentication technique. Accordingly if the result from the authentication technique matches the value of the code as calculated via a predetermined algorithm which receives as input the rest of the IP packet and or one or more of the keys negotiated between the communication appliance and the appliance connection server then the message portion of the IP packet is considered authentic and as a result is decrypted and processed.

Once the above key s are agreed upon and the communication appliance opens a specified port for listening for IP communications step it then waits for IP communications on this port step . Thus when a communication is detected on the specified port step the communication appliance uses at least one of the negotiated keys to first authenticate each IP packet for determining that the packet was transmitted by the appliance connection server step and if authenticated then step the communication appliance decrypts the message portion of the packet and processes the message. Alternatively if the packet cannot be authenticated then step the EP packet may be ignored or discarded and accordingly is not decrypted. Thus once the current IP packet has been processed or ignored the communication appliance returns to a state i.e. step wherein another IP packet on the specified port can be at least inspected for authentication.

It is important to note that the step of ignoring an IP packet effectively can be understood as the processing of the IP packet differently from how it would have been processed if it had been determined to be authenticate i.e. from the appliance connection server . For example an instruction or request in the IP packet will not be performed if the IP packet is determined not to be authentic. In particular such ignoring may be embodied in various ways such as a allowing the data storage for IP packet to be overwritten so that the information in the packet is no longer available for its intended use b quarantining the IP packet so that it may be subsequently inspected c not decrypting the data message portion of the IP packet and or d transmitting the IP packet to the appliance connection server another IP network address so that it can be further analyzed.

Thus substantially all IP communications to and from the communication appliance are only with the appliance connection server or another authenticated instance of such an appliance connection server via the specified port on the communication station . Moreover the communication appliance can subsequently reject substantially all communications from any source other than the appliance connection server .

It is worthwhile to note that the appliance connection server will typically be the intermediary between a plurality of IP applications and a plurality of communication appliances . In various embodiments the communication appliances and or the IP applications may be such that 

To further describe the processing that can be performed at the appliance connection server reference is again made to . The appliance connection server includes both encryption and decryption modules when such modules are distinct . These modules perform the encryption and decryption of IP communications with the communication appliance s described hereinabove. The encryption module receives data for encryption from the application programming interface API that provides a common network interface to the IP applications . In particular the API may be a substantially conventional IP network interface as is well known in the art. Thus the API may re arrange IP requests so that they are processed in the order transmitted rather than the order received and extract application data from the requests prior to outputting such application data to the encryption module . Moreover note that an application manager may communicate with the API and or other modules such as the IP telephone network interface to ensure that the IP application data is routed to the appropriate communication appliance on the appropriate network if the appliance connection server provides secure communication services to communication appliances residing on a plurality of IP networks . Note however that the encryption module must be provided with sufficient information to determine the appropriate encryption key s to use in encrypting data received from the API since each communication appliance is likely to have a different set of one or more keys to be used in encrypting such application data. Similarly the authentication module which receives encrypted data from the encryption module must also have access to information that is specific to a communication appliance for attaching an appropriate authentication code to the encrypted application data. Accordingly in at least one embodiment of the appliance connection server each of these modules is able to access an IP telephone database that may be similar to a home location register HLR in a more traditional telephony context. In particular the database may provide information about each of the plurality of communication appliances that securely communicate with the appliance connection server . For example for each such communication appliance the database may include the following information 

Accordingly once the authentication module has provided an authorization code to an application message the message is provided to the message queuing module for determining the priority of the message in comparison to other messages being transmitted both a to the communication appliances on a given IP network and b to a given communication appliance. For example if message corresponding to various advertisements are queued for eventual transmission to one or more communication appliances and a reverse 911 alert is also detected by the message queuing module then all such advertisements as well as most other IP communications may be pre empted such that they may be sent at a much later time or not sent at all.

In any event when messages are output by the message queuing module these messages are then provided to the IP telephone interface for routing on the appropriate network to the target communication appliance .

Conversely when IP messages are received by the appliance connection server from one of the communication appliances such messages are first identified by the IP telephone network interface as to their presumed originating communication appliance and then these IP messages are provided to the authentication module for authenticating that the messages are indeed from the presumed originating communication appliance. Assuming that the messages are authenticated the encrypted application data within the messages is provided to the decryption module for decryption and are subsequently provided to the API for transmitting to the destination IP application identified in the IP messages received from the communication appliance . Thus it can be seen that the appliance connection server offers substantial benefits to the IP applications in that such applications can have much greater assurance that the communication appliances with which the IP applications communicate are legitimate and that the application is not being spoofed.

Communication with each of the communication appliances may be controlled by an IP phone controller wherein this controller handles such events as 

In order for certain IP applications to be accessed licenses may be required. For example an enterprise having a plurality of the communication appliances registered thereto may desire to purchase four licenses to a particular proprietary IP application such as a stock brokerage transaction service or access to a proprietary patent database. Accordingly a licensing manager may be provided by the appliance connection server wherein this licensing manager ensures that e.g. the number of activations of the IP application by the enterprise does not violate the license. Accordingly such a licensing manager may communicate with the application manager for determining what communication appliances are communicating with what IP applications .

In certain contexts it is important for IP communications between IP applications and communication appliances to be logged and or monitored. Accordingly the appliance connection server may also include a communications logging module and a communications monitoring module . In one embodiment instructions for performing logging and or monitoring are provided by one or more of the application manager the IP phone controller or the server controller . Note that the server controller provides overall supervisory control of the appliance connection server . Accordingly the server controller performs at least the following functions 

The present invention may be embodied as a combination of both hardware devices and software including firmware . Accordingly suitable software for operatively enabling various aspects of the present invention discussed herein and shown in the accompanying figures can be provided on a computer readable medium or media and can be coded using any suitable programming or scripting language. However it is to be understood that the invention as described herein is not dependent on any particular operating system environment or programming language. Illustrative operating systems include without limitation LINUX UNIX or any of the Windows family of operating systems and illustrative languages include without limitation a variety of structured and object oriented languages such as C C Visual Basic or the like as well as various network communication languages such as Perl.

As those skilled in the art will also understand the program s of instructions for embodying the various aspects of the invention can be loaded and stored onto a program storage medium or device readable by a computer or other machine executed by the machine to perform the various aspects of the invention as discussed and claimed herein and or as illustrated in the accompanying figures. The program storage medium can be implemented using any technology based upon materials having specific magnetic optical semiconductor or other properties that render them suitable for storing computer readable data whether such technology involves either volatile or non volatile storage media. Specific examples of such media can include but are not limited to magnetic hard or floppy disks drives optical drives or CD ROMs and any memory technology based on semiconductors or other materials whether implemented as read only or random access memory. In particular an embodiment of the invention may reside on a medium directly addressable by a computer s processor main memory however implemented and or on a medium indirectly accessible to the processor secondary storage media such as hard disk drives tape drives CD ROM drives floppy drives or the like .

Moreover although various components of the present invention have been described in terms of communications on an IP network it is within the scope of the present invention to encompass other types of networks for example Novell or AppleTalk networks. Additionally the modules described hereinabove of the appliance connection server may be distributed on one or more networks as one skilled in the art will understand. Furthermore a program and data storage device e.g. the IP telephone database can be affixed permanently or removably to a bay socket connector or other hardware provided by a cabinet motherboard or another component of a given computer system or a given networked distributed computing system.

Those skilled in the art will also understand that networked computational components in accordance with the above teaching using known programming languages provides suitable means for realizing the various functions methods and processes as described and claimed herein and as illustrated in the accompanying figures attached hereto.

Those skilled in the art will further understand when reading this description that unless expressly stated to the contrary the use of a singular or a plural number herein is generally illustrative rather than limiting of the instant invention. Accordingly unless expressly stated otherwise or clear from the context where a given item or aspect of the invention is discussed herein in the singular it is to be understood that the invention also contemplates a plural number of such items.

The foregoing discussion of the invention has been presented for purposes of illustration and description. Further the description is not intended to limit the invention to the form disclosed herein. Consequently variations and modifications commensurate with the above teachings within the skill and knowledge of the relevant art are within the scope of the present invention. The embodiments described hereinabove are further intended to explain the best mode presently known of practicing the invention and to enable others skilled in the art to utilize the invention as such or in other embodiments and with the various modifications required by their particular application or uses of the invention. It is intended that the appended claims be construed to include alternative embodiments to the extent permitted by the prior art.

