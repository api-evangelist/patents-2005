---

title: Method and apparatus for utilizing an object model for managing content regions in an electronic document
abstract: A method and apparatus are provided for utilizing a document object model to manage content regions for use in an electronic document. A content region is a predefined area which may be inserted in an electronic document and which serves as a placeholder for receiving and displaying specific types of content such as text, graphics data, calendar data, or tabular data. The document object model enables a user to create, modify, and delete content regions from an electronic document using an application programming interface from within a computer application program.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07712016&OS=07712016&RS=07712016
owner: Microsoft Corporation
number: 07712016
owner_city: Redmond
owner_country: US
publication_date: 20050225
---
This patent application is a continuation in part application of U.S. patent application Ser. No. 10 955 612 filed Sep. 30 2004 entitled Method System And Computer Readable Medium For Managing Specific Types of Content In An Electronic Document the disclosure of which is expressly incorporated herein in its entirety by reference. This patent application is also related to and filed concurrently with U.S. patent application Ser. No. 11 066 083 entitled Programmability For Binding Data which is assigned to the same assignee as the present application and expressly incorporated herein in its entirety by reference.

Modern word processors enable a user to readily create and insert various types of content e.g. text pictures etc. in an electronic document. In addition modern word processors enable a user to conform individual types of content to a variety of formats. For example text may be inserted in a document in paragraph form or as word fragments with different individual formatting properties e.g. bold italic underline font color font size or with no formatting at all. The freeform entry of content allowed by modern word processors however suffers from several drawbacks.

One drawback associated with content entry with many modern word processors is that it is often difficult for a user to readily insert identify and manipulate regions of the document or template which require different types of content e.g. a specific fragment of text or a picture in a document without either manually typing the content in or scanning another document finding and manually selecting the location for the desired content and then creating or moving the desired content from another location in the document to the desired location. Even if a predefined set of document fragments i.e. content blobs are available for insertion into the document the document cannot express which pieces of content are valid in any specific location other than by including static informational text which the user must read understand and voluntarily adhere to. Since conventional word processors do not label the locations where the different types of content predefined or not may be inserted in an electronic document they do not permit a user to quickly identify the locations of interest for the insertion of specific content.

It is with respect to these considerations and others that the various embodiments of the present invention have been made.

In accordance with the present invention the above and other problems are solved by a method and apparatus for utilizing a document object model to manage content regions for use in an electronic document. A content region is a predefined area which may be inserted in an electronic document and which serves as a placeholder for receiving and displaying specific types of content such as text graphics data calendar data or tabular data. The document object model enables a user to create modify and delete content regions from an electronic document using an application programming interface from within a programming environment such as a word processing application program.

According to one aspect of the invention a method is provided for utilizing an object model for managing content regions for displaying specific types of content in an electronic document. The method includes providing in the object model a group of objects which include properties methods and events exposing an application programming interface in the object model for accessing the objects and utilizing the properties methods and events in the object model to manage the content regions. The properties in the object model allow a user to set the behaviors of objects corresponding to content regions which may be used in the electronic document. Utilizing the properties a user may set a date format for a content region for displaying a date set a document part category associated with a content region for displaying document parts set a first locking behavior for restricting the deletion of a content region set a second locking behavior for restricting the deletion of the contents of a content region set a picture format for a content region for displaying pictures set a title for a content region and set a content region type. A user may also utilize a property to return a current validation status of a content region.

The methods in the object model allow a user to perform specified actions with respect to content regions which may be used in an electronic document. A user may call one or more methods to add a content region around a specified range in the electronic document copy a content region from a first location in the electronic document for insertion in a second location in the electronic document delete a content region from the electronic document set placeholder text for a content region set a custom validation error for a content region reorder the dropdown list cut the content region add a new item to a dropdown list for a predetermined content region and remove all of the dropdown entries from a dropdown list. In calling the methods the user may select one or more parameters for performing a specified action.

The events in the object model are generated by the application programming interface in response to an action related to a content region. The application programming interface may fire one or more events in response to a user selection inside of a content region in the electronic document in response to a user selection outside of a content region in the electronic document and in response to the creation and deletion of content regions in the electronic document. A user may configure the events to fire based on one or more selected parameters.

The method further includes validating the properties against one or more predetermined types of content regions. The method further includes validating the called methods against one or more of the properties set for a content region. The method further includes providing enumeration objects the enumeration objects representing possible values for the properties in the object model.

The invention may be implemented as a computer process a computing system or as an article of manufacture such as a computer program product or computer readable media. The computer program product may be a computer storage media readable by a computer system and encoding a computer program of instructions for executing a computer process. The computer program product may also be a propagated signal on a carrier readable by a computing system and encoding a computer program of instructions for executing a computer process.

These and various other features as well as advantages which characterize the present invention will be apparent from a reading of the following detailed description and a review of the associated drawings.

Referring now to the drawings in which like numerals represent like elements various aspects of the present invention will be described. In particular and the corresponding discussion are intended to provide a brief general description of a suitable computing environment in which embodiments of the invention may be implemented. While the invention will be described in the general context of program modules that execute in conjunction with program modules that run on an operating system on a personal computer those skilled in the art will recognize that the invention may also be implemented in combination with other types of computer systems and program modules.

Generally program modules include routines programs components data structures and other types of structures that perform particular tasks or implement particular abstract data types. Moreover those skilled in the art will appreciate that the invention may be practiced with other computer system configurations including hand held devices multiprocessor systems microprocessor based or programmable consumer electronics minicomputers mainframe computers and the like. The invention may also be practiced in distributed computing environments where tasks are performed by remote processing devices that are linked through a communications network. In a distributed computing environment program modules may be located in both local and remote memory storage devices.

Referring now to an illustrative computer architecture for a computer utilized in the various embodiments of the invention will be described. The computer architecture shown in illustrates a conventional desktop or laptop computer including a central processing unit CPU a system memory including a random access memory RAM and a read only memory ROM and a system bus that couples the memory to the CPU . A basic input output system containing the basic routines that help to transfer information between elements within the computer such as during startup is stored in the ROM . The computer further includes a mass storage device for storing an operating system application programs and other program modules which will be described in greater detail below.

The mass storage device is connected to the CPU through a mass storage controller not shown connected to the bus . The mass storage device and its associated computer readable media provide non volatile storage for the computer . Although the description of computer readable media contained herein refers to a mass storage device such as a hard disk or CD ROM drive it should be appreciated by those skilled in the art that computer readable media can be any available media that can be accessed by the computer .

By way of example and not limitation computer readable media may comprise computer storage media and communication media. Computer storage media includes volatile and non volatile removable and non removable media implemented in any method or technology for storage of information such as computer readable instructions data structures program modules or other data. Computer storage media includes but is not limited to RAM ROM EPROM EEPROM flash memory or other solid state memory technology CD ROM digital versatile disks DVD or other optical storage magnetic cassettes magnetic tape magnetic disk storage or other magnetic storage devices or any other medium which can be used to store the desired information and which can be accessed by the computer .

According to various embodiments of the invention the computer may operate in a networked environment using logical connections to remote computers through a network such as the Internet. The computer may connect to the network through a network interface unit connected to the bus . It should be appreciated that the network interface unit may also be utilized to connect to other types of networks and remote computer systems. The computer may also include an input output controller for receiving and processing input from a number of other devices including a keyboard mouse or electronic stylus not shown in . Similarly an input output controller may provide output to a display screen a printer or other type of output device.

As mentioned briefly above a number of program modules and data files may be stored in the mass storage device and RAM of the computer including an operating system suitable for controlling the operation of a networked personal computer such as the WINDOWS XP operating system from MICROSOFT CORPORATION of Redmond Wash. The mass storage device and RAM may also store one or more program modules. In particular the mass storage device and the RAM may store a word processing application program . As known to those skilled in the art the word processing application program is operative to provide functionality for creating and editing electronic documents such as document . According to one embodiment of the invention the word processing application program comprises the WORD word processing application program from MICROSOFT CORPORATION. It should be appreciated however that word processing application programs from other manufacturers may be utilized to embody the various aspects of the present invention. It should further be appreciated that the various aspects of the present invention are not limited to word processing application programs but may also utilize other application programs which are capable of processing various forms of content e.g. text or pictures such as spreadsheet application programs.

In conjunction with the editing of a word processing document the word processing application program provides functionality for allowing a user to insert specific types of content into various locations in the document called content regions. For instance according to embodiments of the invention a user may utilize an interactive content pane generated by the word processing application program which includes a content region and serves as a placeholder for inserting text such as a paragraph for the Objective section of a resume in the document . A user may utilize other interactive content panes generated by the word processing application program for inserting text which may be arbitrarily restricted by the document s author a date a table or graphics data i.e. pictures into content regions. Alternatively a user may also define customized content as one of a set of document parts which may be inserted into the content region of an interactive content pane. As defined herein document parts are preformatted structural elements or layouts which add structure to documents. Document parts may include cover pages mathematical equations indexes and tables e.g. Table of Contents Table of Figures and Table of Authorities page headers and footers pages and sections e.g. blank pages and two column pages personal contact information e.g. name and address information images tables and watermarks. Document parts are described in greater detail in U.S. patent application Ser. No. 10 955 622 entitled Method System And Computer Readable Medium For Creating Inserting And Reusing Document Parts In An Electronic Document the disclosure of which is incorporated herein in its entirety by reference.

It should be appreciated that the word processing application program may utilize interactive content panes to restrict the specific types of content which may be entered into the document . According to various embodiments of the invention the word processing application program is also operative for generating interactive content panes which serve as bindings between areas of the document and an external data source such as Extensible Markup Language XML data . According to still other embodiments of the invention the word processing application program or other text processing application program may utilize an XML schema comprising structural elements for defining a content region for displaying content in the document .

The word processing application program also includes an application programming interface API which provides an object model interface for providing all of the functionality of the word processor s user interface via code. As is known to those skilled in the art object models are used in software applications to provide a way for code to automate tasks that a user may perform through a user interface of an application such as the word processing application program . The object model allows code to be written which for example automates repetitive tasks for the user and reacts to e.g. validates etc. actions by the user. The API provides structures which provide code access to equivalents of all of the paradigms user interfaces of the word processing application program . These structures are organized into four basic categories 

It will be appreciated that any object within an object model can include methods properties and or events which allow code to manipulate that object. According to one embodiment of the invention the word processing application program comprises the WORD word processing application program from MICROSOFT CORPORATION. It should be appreciated however that word processing application programs from other manufacturers may be utilized to embody the various aspects of the present invention. It should further be appreciated that the various aspects of the present invention are not limited to word processing application programs but may also utilize other application programs which are capable of processing text.

The object model which may be utilized with the various embodiments of the invention may include the following objects methods properties and events 

The object model discussed above may also include a group of enumerations for assigning named constants i.e. values to the properties defined in the object model.

Referring now to an interactive content pane is shown according to an illustrative embodiment of the present invention. The interactive content pane includes a content region for receiving and displaying specific types of content e.g. text graphics data calendar data or table data in the document . The content region includes a place for instructional text which provides instructions for inserting specific content whenever the content region is empty. For instance a content region for inserting an Objective paragraph in a resume document may include instructional text such as Please insert your objective paragraph here. It will be appreciated that the instructional text may be tailored to the specific content to be received in the content region of an interactive content pane. For instance a graphics data or picture content region may include instructional text such as Insert your photo here. It should be understood that once a user clicks in the content region containing the instructional the instructional text disappears to allow the user to insert the specific content.

As shown in the interactive content pane also includes a boundary a selection region a label a handle and a notification region . The boundary defines limits for the content region for receiving and displaying the specific type of content. In one illustrative embodiment the boundary may fix the area of the content region to a specific size. For instance the content region for a single paragraph interactive content pane may be limited to fifteen lines of text. Once this limit is reached no further text is permitted to be entered into the content region.

The selection region is a user interface for selecting specific types of content from similar content for display in the content region . For instance a selection region in an interactive content pane for inserting calendar data may include a user interface for selecting a date from a calendar for insertion in a document. The selection region may also display a user with choices from a list of predefined items in a dropdown list for example. It will be appreciated that in one illustrative embodiment the user interface in the selection region may automatically be generated when a user clicks in the content region of certain types of interactive content regions. For instance a user clicking into an interactive content region defined for inserting calendar data may automatically generate a calendar user interface for a user to select a specific date.

The label identifies the specific type of content e.g. dates which may be entered into the content region . The handle is utilized to drag the interactive content region to different areas of a displayed document. The notification region is utilized to communicate messages to a user. It should be understood that the word processing application program includes functionality for validating specific content entered into the content region . Thus the notification region may communicate error messages when content received in the content region does not correspond to the specific type of content for an interactive content pane or when the specific type of content received in the content region exceeds a predefined content restriction e.g. the number of lines or characters in a paragraph .

Referring now to an illustrative routine will be described illustrating a process performed by the word processing application program for utilizing an object model to manage content regions in an electronic document. It should be appreciated that although the embodiments of the invention described herein are presented in the context of the word processing application program the invention may be utilized in other types of application programs that support text processing.

When reading the discussion of the routines presented herein it should be appreciated that the logical operations of various embodiments of the present invention are implemented 1 as a sequence of computer implemented acts or program modules running on a computing system and or 2 as interconnected machine logic circuits or circuit modules within the computing system. The implementation is a matter of choice dependent on the performance requirements of the computing system implementing the invention. Accordingly the logical operations illustrated in and making up the embodiments of the present invention described herein are referred to variously as operations structural devices acts or modules. It will be recognized by one skilled in the art that these operations structural devices acts and modules may be implemented in software in firmware in special purpose digital logic and any combination thereof without deviating from the spirit and scope of the present invention as recited within the claims set forth herein.

Referring now to the routine begins at operation wherein the word processing application program exposes the API which allows a user to manage objects corresponding to content regions by calling the properties and methods in the object model discussed above. The routine continues from operation at operation where the API receives calls for call properties for setting user specified behaviors for content regions. In particular a user may utilize properties to set a string representing a date format for a content region for displaying a date set a document part category associated with a content region for displaying document parts set a locking behavior for restricting the deletion of a content region set a locking behavior for restricting the deletion of the contents of a content region set a picture format for a content region for displaying pictures set a title for a content region set a content region type e.g. data combo box picture text etc. and return a current validation status of a content region.

The routine continues from operation at operation where the API receives calls for methods to perform user specified actions on content regions. In particular a user may call methods to add a content region around a specified range in the electronic document copy a content region from a first location in the electronic document for insertion in a second location in the electronic document set placeholder text for a content region set a custom validation error for a content region add a new item to a dropdown list for a predetermined content region i.e. a dropdown list or combo box content region remove all of the dropdown entries from a dropdown list in a content region reorder the dropdown list and cut a content region from the electronic document. It will be appreciated that in calling the methods to perform user specified actions a user may set one or more parameters for each method if provided in the object model .

The routine continues from operation at operation where the API fire events in response to user initiated actions in content regions. In particular an event may be fired in response to a user selection inside of a content region in the electronic document in response to a user selection outside of a content region in the electronic document in response to the insertion of a content region in the electronic document or in response to the deletion of a content region in the electronic document. It will be appreciated that a user may set one or more parameters for each event if provided in the object model . For instance a user may set the OnExit event to True to prevent a user from exiting a range within a content region. Thus when a user attempts to move an insertion point outside of the content region the event will fire and the insertion point is pushed back into the content region.

The routine continues from operation at operation where the API validates any properties against a content region type. For instance if a user attempts to set a property to assign a picture format for a non picture content region the property call will fail and the API will generate an error message e.g. This property can only be used with picture content regions . The routine continues from operation at operation where the API validates any validate methods against properties set for content regions. For instance if a user attempts to call a method for adding a dropdown list item to a content region which is not a dropdown list or a combo box the method call will fail and the API will generate an error message e.g. This method can only be used with dropdown list or combo box content regions . The routine then ends.

Based on the foregoing it should be appreciated that the various embodiments of the invention include a method and apparatus for utilizing a document object model in an application program to manage content regions for displaying specific types of content in an electronic document. The above specification examples and data provide a complete description of the manufacture and use of the composition of the invention. Since many embodiments of the invention can be made without departing from the spirit and scope of the invention the invention resides in the claims hereinafter appended.

