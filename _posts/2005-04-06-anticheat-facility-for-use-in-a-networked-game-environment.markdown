---

title: Anti-cheat facility for use in a networked game environment
abstract: The invention is directed to detecting and taking action against unauthorized behavior, such as cheating, committed by a participant in a networked game. A game client receives from an anti-cheat server one or more encrypted blocks containing executable code and computer-readable data. The anti-cheat server transmits a series of challenges, at periodic or randomly-determined intervals, to the game client. A challenge includes instructions regarding the decryption and manipulation of a black box. The anti-cheat server monitors responses, if any, by the game client to the challenges, and determines whether the game client is engaged in unauthorized behavior. The nature of a challenge is such that the player is not easily able to determine or predict whether the challenge actually performs a meaningful cheat-detection procedure, whether the challenge is identical to a challenge received by another player, and whether the challenge is substantially the same as a previously-received challenge.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08302199&OS=08302199&RS=08302199
owner: Valve Corporation
number: 08302199
owner_city: Bellevue
owner_country: US
publication_date: 20050406
---
The present invention relates to networked multiplayer games and in particular but not exclusively to a system and method for detection and prevention of cheating and other unauthorized behavior in such games.

The growth in popularity and complexity of multiplayer online games has been accompanied by an increase in the problem of cheating. Many kinds of cheats are currently in use by players of such games. Typically a cheat is designed to give a player an unfair advantage over other players. Cheats commonly expose game states or other information that otherwise would be hidden from the player for example the ability to see through walls or to see into the future . A cheat may also involve the manipulation of the game client program to enhance the player s abilities. A cheating player might use the application programming interface provided with a game program to manipulate the workings of the program and extract information about the game or the player might intercept graphics commands issued by the program to the operating system. Cheating and other unauthorized behavior may also be perpetrated to harm other players and to cause general disruption in the operation of the game.

The detection and prevention of cheating and other unauthorized behavior is important in ensuring the quality of service of multiplayer online games because if such behavior is uncurbed non cheating players tend to abandon the game. Some game providers have developed techniques for detecting cheats of various kinds. However the nature of cheat detection in a networked game setting has limited the effectiveness of anti cheat systems. To detect a cheat or other unauthorized activity an anti cheat facility typically executes code on a game client machine. The code examines the machine and reports results. It is important that the anti cheat facility be able to trust the results. Because the cheating player is presumably in control of the machine he typically can examine the executing anti cheat code and figure out what the code is doing regardless of its complexity or obscurity. A sophisticated cheater can thus find ways of avoiding detection and of subverting the anti cheat system.

Two problems in particular have arisen in previous anti cheat systems. In one case the client is actually cheating but deceptively leads the system to conclude that it is not cheating. In another case a cheating player attacks the integrity of the anti cheat system by causing the system to believe that he is a different non cheating player. The system then bans the innocent player from participating in the game. In both cases the cheating player uses his control of the client machine to diminish the ability of the system to trust the results of anti cheat detection code. It is with respect to these considerations and others that the present invention has been made.

In the following detailed description reference is made to the accompanying drawings in which are shown exemplary but non limiting and non exhaustive embodiments of the invention. These embodiments are described in sufficient detail to enable those having skill in the art to practice the invention and it is understood that other embodiments may be used and other changes may be made without departing from the spirit or scope of the invention. The following detailed description is therefore not to be taken in a limiting sense and the scope of the invention is defined only by the appended claims. In the accompanying drawings like reference numerals refer to like parts throughout the various figures unless otherwise specified.

Throughout this specification and in the accompanying claims the term cheating is employed to refer not only to actual violations of rules of play with respect to particular online games but also more broadly to disruptive or unauthorized behavior by a player that has the effect of undermining the integrity of and players trust in the game system including an anti cheat system deployed by the game system to detect and combat cheating. The term unauthorized behavior includes but is not limited to cheating by a game participant. Detecting is employed herein to refer both to identifying cheating players and to taking action against such players and behavior.

Briefly stated the present invention is directed to a system apparatus method and computer program product for detecting and responding to unauthorized behavior committed by a player in a networked game. The invention may employ a networked anti cheat server game server and one or more game clients. The invention may also operate in a peer to peer environment with multiple participants and the invention may operate within other kinds of environments or architectures for computer games. In one embodiment a game client receives from the anti cheat server an anti cheat module and one or more black boxes. A black box is encrypted instructions or data containing in its unencrypted form executable code and computer readable data. The black box is preferably customized for the game client to which it is provided. The encrypted instructions may be communicated over a network or by way of other computer readable media.

In accordance with the invention the anti cheat server transmits a series of challenges to the game client or the anti cheat module . Challenges may be sent at regular or irregular periodic or randomly determined intervals. A challenge may include a decryption key and one or more parameters and includes instructions regarding the decryption and manipulation of a black box. A challenge may also include or be accompanied by a new black box. Typically the game client is instructed to decrypt a section of the black box execute it with any supplied parameters perform any other provided instructions and return a result to the anti cheat server within a certain period of time. A challenge might also or in the alternative include or be accompanied by unencrypted code to be executed by the game client. The executed routine may include a cheat detection routine a no op routine or another kind of routine. The anti cheat server monitors responses if any by the game client to the challenges and may determine based on this monitoring that the game client is likely engaged in unauthorized behavior such as cheating. The nature and complexity of the challenge are such that the player typically is not easily able to determine or predict whether the challenge will actually perform a meaningful cheat detection procedure whether the challenge is identical to a challenge received by another player and whether the challenge is substantially the same as a previously received challenge.

As shown in the figure system includes client devices network anti cheat network device and game network device . Network enables communication among client devices anti cheat network device and game network device .

Generally client devices may in principle include any computing device capable of connecting to another computing device to send and receive information including game information and anti cheat detection information. The set of such devices may include devices that typically connect by way of a wired communication medium such as personal computers microprocessor based or programmable consumer electronics network PCs and the like. The set of such devices may also include devices that typically connect by way of a wireless communication medium such as cell phones smart phones radio frequency RF devices infrared IR devices integrated devices combining one or more of the preceding devices mobile devices and the like. Similarly client devices may include any device that is capable of connecting by way of a wired or wireless communication medium such as PDA wearable computer and any other device that is equipped to communicate over a wired and or wireless communication medium. Client devices may further include a client application or the like that is configured to manage the actions described above. It will be appreciated by those having skill in the art that the invention may be practiced in a peer to peer environment rather than a client server environment.

Client devices may also include a game client application or the like that is configured to enable an end user to interact with and play a game. The game client may be configured to interact with a game server program or the like. In one embodiment the game client is configured to provide various functions including but not limited to authentication ability to enable an end user to customize a game feature synchronization with the game server program and the like. The game client may further enable game inputs such as keyboard mouse and the like. The game client may also perform some game related computations including but not limited to audio game logic physics computations visual rendering and the like. In one embodiment client devices are configured to receive and store game related files executable files audio files graphics files and the like that may be employed by the game client game server and the like.

In accordance with the present invention in a manner described in further detail elsewhere in this Specification client devices are configured to receive from an anti cheat server and store anti cheat modules encrypted anti cheat black boxes and the like. Client devices are further configured to decrypt and execute code within anti cheat black boxes and the like in accordance with challenges received from the anti cheat server and to return results of such operations to the anti cheat server. In one embodiment the anti cheat server resides on a dedicated network device such as the anti cheat network device . However the invention is not so limited. For example the game network device may be configured to include the anti cheat server program or the like.

In one embodiment the game server resides on a network device such as the game network device . However the invention is not so limited. For example client devices may also be configured to include the game server program or the like such that the game client and game server may interact on the same client device or another client device. Furthermore although the present invention is described as employing a client server architecture the invention is not so limited. Thus other architectures may be employed including but not limited to peer to peer and the like.

Network is configured to couple client devices and the like anti cheat network device and game network device to one another. Network is enabled to employ any form of computer readable media for communicating information from one electronic device to another. Network can include the Internet in addition to local area networks LANs wide area networks WANs direct connections such as through a universal serial bus USB port other forms of computer readable media or any combination thereof. On an interconnected set of LANs including those based on differing architectures and protocols a router may act as a link between LANs to enable messages to be sent from one to another. Also communication links within LANs typically include twisted wire pair or coaxial cable while communication links between networks may use analog telephone lines full or fractional dedicated digital lines including T1 T2 T3 and T4 Integrated Services Digital Networks ISDNs Digital Subscriber Lines DSLs wireless links including satellite links or other communication links known to those skilled in the art.

Network may further employ a plurality of wireless access technologies including but not limited to second 2G third 3G or fourth 4G generation radio access for cellular systems wireless LAN and the like. Access technologies such as 2G 3G 4G and future access networks may enable wide area coverage for mobile devices such as client device with various degrees of mobility. For example network may enable a radio connection through a radio network access such as Global System for Mobile Communications GSM General Packet Radio Services GPRS Enhanced Data Rates for GSM Evolution EDGE Wideband Code Division Multiple Access WCDMA Code Division Multiple Access 2000 CDMA 2000 and the like.

Furthermore remote computers and other related electronic devices may be remotely connected to either LANs or WANs by way of a modem and temporary telephone link. In essence network includes any communication method by which information may travel between computing devices.

Additionally network may include communication media that typically embodies computer readable instructions data structures program modules or other data in a modulated data signal such as a carrier wave data signal or other transport mechanism and includes any information delivery media. The terms modulated data signal and carrier wave signal include a signal that has one or more of its characteristics set or changed in such a manner as to encode information instructions data and the like in the signal. By way of example communication media includes wired media such as but not limited to twisted pair coaxial cable fiber optics wave guides and other wired media as well as wireless media such as but not limited to acoustic RF infrared and other wireless media.

Each of anti cheat network device and game network device may include any network device configured to include the anti cheat server program and the game server program respectively. As such both anti cheat network device and game network device may be implemented on a variety of computing devices including personal computers desktop computers mobile devices multiprocessor systems microprocessor based devices network PCs servers network appliances and the like.

Game network device may further provide secured communication for interactions and accounting information to speed up periodic update messages between the game client and the game server. Such update messages may include but are not limited to a position update velocity update audio update graphics update authentication information and the like.

Network device includes processing unit video display adapter and a mass memory all in communication with each other by way of bus . The mass memory generally includes RAM ROM and one or more permanent mass storage devices such as hard disk drive tape drive optical drive and or floppy disk drive. The mass memory stores operating system for controlling the operation of network device . Basic input output system BIOS or the like is also provided for controlling the low level operation of network device . As illustrated in network device also can communicate over the Internet or some other computer or communications network such as network in by way of network interface which is constructed for use with various communication protocols such as TCP IP. For example in one embodiment network interface unit may employ a hybrid communication scheme using both TCP and IP multicast with a client device such as client devices of . Network interface unit may be a transceiver a network interface card NIC or the like.

The mass memory as described above illustrates another type of computer readable medium namely computer storage media. Computer storage media may include volatile nonvolatile removable and non removable media implemented in any method or technology for storage of information such as machine readable instructions data structures program modules or other data. Examples of computer storage media include RAM ROM EEPROM flash memory or other memory technology CD ROM DVD or other optical storage magnetic tape magnetic disk storage or other magnetic storage devices or any other medium which can be used to store the desired information and which can be accessed by a computing device.

The mass memory also stores program code and data. One or more applications are loaded into mass memory and run on operating system . Examples of application programs include transcoders schedulers graphics programs database programs cryptographic programs word processing programs user interface programs and so forth. Mass storage may further include applications such as game server anti cheat server and game client . In a peer to peer setting applications performing substantially the same functions as game server anti cheat server and game client may be present.

The operation of anti cheat server in accordance with the present invention is described in more detail below. Briefly however anti cheat server is configured to transmit to game clients by way of a network or other computer readable media black boxes which are encrypted blocks of cheat detection instructions and other instructions and data to send packets containing challenges or instructions for manipulating the black boxes to the game clients to monitor and receive game client responses to determine whether a game client is engaged in unauthorized behavior and should be banned from a game and to make appropriate communications with the game server.

Game server is configured to enable an end user to interact with a game. In one embodiment game server interacts with a game client residing on a client device such as client devices of . Game server may also interact with other components residing on the client device another network device and the like. For example game server may interact with a client application security application transport application and the like on another device.

Game client is the application through which a user joins and interacts with a game coordinated by a game server such as game server or a game server residing on a separate network device linked to network device . Game client also interacts with an anti cheat server such as anti cheat server as described in further detail elsewhere in this application.

Network device may also include an SMTP handler for transmitting and receiving e mail an HTTP handler for receiving and handling HTTP requests and an HTTPS handler application for handling secure connections. The HTTPS handler application may initiate communication with an external application in a secure fashion. Moreover network device may further include applications that support a secure connection including but not limited to TLS TTLS EAP SSL IPSec and the like.

Network device also includes input output interface for communicating with external devices such as a mouse keyboard scanner or other input device not shown in . Likewise network device may further include additional mass storage facilities such as CD ROM DVD ROM drive and hard disk drive . Hard disk drive may be used to store application programs databases client device information anti cheat detection code and related data security information including but not limited to certificates ciphers and passwords and the like.

Anti cheat server may be implemented as part of a broader software delivery system and or content management platform. Anti cheat server may alternatively be implemented as part of game server . Moreover anti cheat server is substantially similar to anti cheat server game client is substantially similar to game client and game server is substantially similar to game server of .

As shown in game client includes interacts with or is otherwise associated with an anti cheat module and one or more black boxes . Anti cheat module is downloaded to and executed on or in association with game client . Black box comprises encrypted instructions and data that are transmitted to game client from anti cheat server . Any suitable cryptographic technique can be used to encrypt black box such as RSA or another public key cryptosystem. In one embodiment an initial black box may be sent to game client with anti cheat module . In one embodiment a black box is approximately 2 kilobytes in size. In its original unencrypted form black box typically includes several sections of instructions and data including for example one or more cheat detection modules or cheat detection routines and routines for generating responses to challenges received from anti cheat server . Because black box is encrypted one can have confidence that the player who receives the black box will not independently discover its contents or determine its operation. Black box is preferably customized for or unique to a particular game participant. In one embodiment a unique black box is generated by anti cheat server by randomly generating a polymorphic version of a black box template selected from a database of black box templates.

As noted above downloaded anti cheat module is configured to receive a series of challenges from anti cheat server and to return responses to the challenges to anti cheat server . A challenge is included in one or more packets sent by anti cheat server at regular or irregular periodic intervals such as every five minutes. The interval preferably comprises a sufficiently narrow time window such that responses sent to anti cheat server during the interval are trusted and the system can be presumed not to be compromised. A response is trusted in the sense that it is presumed that a cheating player has not had enough time to figure out how to send fake responses showing him to be a non cheater or has not figured out how to cause other players to be banned.

A challenge typically includes a decryption key for decrypting all or a portion of black box . A challenge may also include one or more parameters. The challenge includes instructions regarding the manipulation of black box . For example the challenge might direct anti cheat module to a particular address within black box and instruct anti cheat module to decrypt a range of bytes beginning with the address using the supplied decryption key. The challenge might further instruct anti cheat module to execute the decrypted portion using the supplied parameters. The executed code might further direct anti cheat module to decrypt and execute another portion of black box . In one embodiment a challenge includes a new black box along with a key parameters and instructions for using the key and parameters with the new black box. A subsequent challenge may comprise a variation on a previous challenge. The use of parameters in addition to a decryption key permits an extensive number of challenges to be used.

Some challenges involve detections of specific kinds of unauthorized behavior. For example some challenges attempt to detect cheats while other challenges attempt to detect whether the process in which anti cheat module is running is maintaining its integrity. Still other challenges are no ops performing no detection but causing game client to be disconnected if no response to the challenge is made. A challenge and the black box to which it is directed are of such a nature that the player is highly unlikely to be able to determine or predict whether the challenge will actually perform a meaningful procedure or simply execute a no op and whether the challenge is the same as a challenge received by any other player. Each challenge preferably appears different from previous challenges so that a malign player is unlikely to be able to determine whether the challenge performs some operation that was performed by a previous challenge or whether the challenge is a new cheat detection mechanism. A challenge is also preferably designed to be of sufficient complexity that a cheating client is unlikely to be able to automate the production of a correct response or to determine whether to turn off a particular cheat mechanism to avoid detection by a particular challenge. For example a challenge might cause anti cheat module to decrypt and execute a portion of code that performs a complex mathematical function upon given parameters. If the function result is divisible by a given large prime number anti cheat module may then be directed to use the result as a key for decrypting a specified second portion of black box .

In another embodiment a challenge sent by anti cheat server is accompanied by unencrypted code which the challenge directs anti cheat module to execute and return the result. In this case it is important that game client not be able to recognize whether the unencrypted code resembles any previous challenge.

In one kind of attack on prior anti cheat systems a game player operates two computers. The player uses the responses produced by a good computer as the responses to be returned by anti cheat module on game client machine being used for cheating or other unauthorized behavior. The present invention combats this attack in a number of ways. First a black box on the cheating client is different from the black box on the non cheating client. Each black box is associated with particular challenges and responses so responses from one are not substitutable for responses from the other. Second information pertaining to a player is communicated to anti cheat server by game server including information communicated to game server by anti cheat module . This information is incorporated into one or more challenges sent by anti cheat server to anti cheat module on game client . The required responses to the challenges may also incorporate information derived from game server . By way of such techniques anti cheat server can determine with a high degree of confidence whether the client sending a response is also the client connected to game server .

In general a challenge directs anti cheat module to return a response to the challenge to anti cheat server . Anti cheat server authenticates the response. The response provides a means for anti cheat server to determine whether game client is engaged in some form of unauthorized behavior. For example anti cheat server can keep track of whether anti cheat module responds to challenges within particular time limits. If a response is not sent to anti cheat server for a certain number of iterations of challenges anti cheat server concludes that the player is probably engaged in unauthorized behavior and directs game server to ban the player from play. This may involve interaction between anti cheat server and game server . For example if game client sends a request to game server to play a game game server informs anti cheat server . Anti cheat server then responds with an indication that game client is allowed to play or has been banned from play. A ban itself may be delayed to obfuscate the moment at which a cheat is detected. This makes it difficult for cheat developers and cheaters to figure out which cheats are detected and not detected by the system. The anti cheat system similarly employs various random time delays to conceal the motion of critical anti cheat data.

Alternatively if anti cheat server determines that game client has failed to answer challenges anti cheat server may inform game server that it should disconnect the player from the game if game client is still online and communicating with game server . Although not shown a peer to peer network with multiple game participants can be arranged to operate in substantially the same manner as the client server architecture discussed above. In the peer to peer arrangement the other participants perform substantially the same roles as the game server and the anti cheat server in substantially the same manner.

The operation of certain aspects of the present invention will now be described more explicitly as a process with respect to . is a flow diagram generally showing one embodiment of a process of detecting cheating and other unauthorized behavior by way of an anti cheat system. Process may be implemented for example using the interacting networked components of the system of . Process may also be implemented using interacting devices participating in a peer to peer environment or the like.

Process begins after a start block at block where a player connects to a game server by way of a game client and requests to join a game. At this point the game client and the game server are both connected to the anti cheat server.

At block an anti cheat module and the initial black box are downloaded to the game client machine. As explained above the black box includes encrypted instructions the contents of which are preferably customized for the game client and which may include cheat detection routines routines for generating responses to challenges by the anti cheat server and the like. The anti cheat module waits to receive instructions in the form of a challenge from the anti cheat server.

At block the anti cheat server sends a challenge to the game client. A challenge typically includes a key for decrypting a portion of the black box. A challenge may also include one or more parameters to be applied in accordance with the challenge to code that is decrypted. The anti cheat module at the game client is required to provide a response to the anti cheat server in accordance with the challenge. A challenge may also include a black box.

A challenge is sent periodically as explained above in reference to . At decision block if a response is received processing flows to block at which the anti cheat server authenticates the response. Otherwise the process flows to decision block where it checks for expiration of the period for response. If the period whether regular randomly determined etc. has not yet expired the process flows back to decision block . As depicted in the flow diagram of the period provides the time within which a response by the game client to the anti cheat server can be trusted. If the period expires the process flows to decision block . If a response was authenticated at block processing also flows to decision block . At decision block the anti cheat server determines whether based on the response or lack thereof the player is likely cheating or engaging in other unauthorized behavior disruptive to the game or the anti cheat system. For example if a response to a challenge is sent after the period expires it may be suspected that the player is a cheating player who has had sufficient time to figure out how to generate correct responses. If no response is provided to a challenge or a series of challenges or if the content of a submitted response so indicates the anti cheat server may conclude that the player is probably a cheater.

If the anti cheat server determines that the game client has not engaged in unauthorized behavior the process returns to block at which the anti cheat server sends a new challenge to the client. If however the anti cheat server determines that the client has engaged in unauthorized behavior processing flows to block at which the anti cheat server causes the game client to be disconnected from the game and or banned from further play. This involves interaction between the anti cheat server and the game server as explained above in reference to . As noted above a ban may be delayed to obfuscate the moment at which a cheat is detected. This is employed to prevent cheat developers and cheaters from being able to discover which cheats are detected and not detected by the system. Following block the process then returns to perform other actions.

It will be understood that each block of the flow diagram discussed above and combinations of blocks therein can be implemented by computer program instructions. These program instructions may be provided to a processor to produce a machine such that the instructions which execute on the processor create means for implementing the actions specified in the flow diagram block or blocks. The computer program instructions may be executed by a processor to cause a series of operational steps to be performed by the processor to produce a computer implemented process such that the instructions which execute on the processor provide steps for implementing the actions specified in the flow diagram block or blocks.

Accordingly blocks of the flow diagram illustration support combinations of means for performing the specified actions and program instruction means for performing the specified actions. It will also be understood that each block of the flow diagram illustration and combination of blocks in the flow diagram illustration can be implemented by special purpose hardware based systems which perform the specified actions or steps or combinations of special purpose hardware and computer instructions.

The above specification examples and data provide a complete description of the manufacture and use of the composition of the invention. Since many embodiments of the invention can be made without departing from the spirit and scope of the invention the invention resides in the claims hereinafter appended.

