---

title: Apparatus and methods for managing firmware verification on a wireless device
abstract: Apparatus, methods, processors and machine readable media for verifying the integrity of firmware on a wireless device. Aspects include generating a verification scheme for testing the integrity of firmware on a wireless device and transmitting the verification scheme to the wireless device. The wireless device applies the verification scheme to the firmware and obtains a verification test result, which is forwarded for analysis. An analyzer compares the generated verification test result with a predetermined test result to obtain an integrity determination that indicates the integrity of the firmware. In some aspects, control commands to change an operational characteristic of the wireless device may be generated based on the integrity determination.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07907531&OS=07907531&RS=07907531
owner: QUALCOMM Incorporated
number: 07907531
owner_city: San Diego
owner_country: US
publication_date: 20051215
---
The present application for patent claims priority to Provisional Application No. 60 690 209 entitled METHOD AND APPARATUS FOR FIRMWARE VERIFICATION ON A WIRELESS DEVICE filed Jun. 13 2005 and assigned to the assignee hereof and hereby expressly incorporated by reference herein.

The described aspects generally relate to wireless communications devices and computer networks. More particularly the described aspects relate to verifying the integrity of the firmware of a wireless device along with the collection reporting and analysis of firmware related information gathered from the wireless device.

Wireless networking connects one or more wireless devices to other computer devices without a direct electrical connection such as a copper wire or optical cable. Wireless devices communicate data typically in the form of packets across a wireless or partially wireless computer network and open a data or communication channel on the network such that the device can send and receive data packets. The wireless devices often have wireless device resources such as programs and hardware components which individually and cooperatively operate to use and generate data in accordance to their design and specific protocol or configuration such as using open communication connections to transmit and receive data on the network.

Further these wireless devices contain firmware that comprises data and program code that enable the wireless device to operate. This data and program code is critical to the operation of the wireless device. For example the data and program code may specify the protocol for the wireless device to use to communicate with the network or the data and program code may specify the wireless network s with which the wireless device may operate.

In one aspect the integrity of the firmware of a wireless device relates to whether the values in the firmware of a wireless device are the correct values for that version of the firmware. For example a measure of firmware integrity may determine if the firmware has been corrupted either unintentionally such as by a bug in a program or intentionally such as by a computer virus or intentional manipulation. In another aspect the integrity of the firmware of a wireless device relates to whether or not the version of the firmware is the current version for the wireless device. The version of firmware for a given wireless device may need to be updated or replaced on a periodic basis. Further it is even possible that the wireless device has the wrong firmware installed or that the firmware installed is not acceptable to a particular wireless network provider.

Many problems may occur if the integrity of the firmware of the wireless device is compromised. For example the wireless device may not function or may interfere with the operation of the network by using incorrect communications protocols on the wireless network. In another example changes in the firmware may allow the wireless device to be used for a different wireless network service provider than the one for which it was purchased. In this case the original wireless network service provider may lose money if it subsidized the price of the wireless device based on the agreement that the wireless device would only be used on the original network service provider s network. Thus changing the firmware so that the wireless device will operate with another wireless network service provider may violate the agreement signed by the owner of the wireless device.

Accordingly it would be advantageous to provide an apparatus and method that allows for verification of firmware integrity on a wireless device.

The described aspects comprise apparatus methods computer readable media and processors operable for firmware verification on a wireless device.

In some aspects a wireless communication device comprises a computer platform having firmware and a firmware verification module operable to execute a verification configuration to collect firmware information wherein the firmware information is indicative of an integrity of the firmware.

In other aspects a wireless device comprises a means for controlling operations on the wireless device and a means for applying a verification configuration to the means for controlling operations of the wireless device to collect information indicative of an integrity of the means for controlling operations of the wireless device.

In yet others aspects an apparatus for managing the integrity of firmware on a wireless device comprises a firmware management module operable to generate and transmit a verification configuration to the wireless device. The verification configuration comprises a verification scheme to apply to the firmware to test an integrity of the firmware. The apparatus further comprises an information repository operable to receive and store a generated verification test result based on an execution of the verification configuration by the wireless device. Additionally the apparatus comprises an analyzer operable to generate an integrity determination based on the generated verification test result wherein the integrity determination represents an integrity of the firmware.

In still other aspects an apparatus for managing firmware integrity on a wireless device comprises a generator means for generating and transmitting a verification configuration across a wireless network to a wireless device. The verification configuration comprises a verification scheme to apply to the firmware to test an integrity of the firmware. The apparatus further comprises a storing means for receiving and storing a verification test result based on an execution of the verification configuration by the wireless device. Additionally the apparatus further comprises an analysis means for analyzing the verification test result and generating a report based on the analysis wherein the report comprises an integrity determination indicating an integrity of the firmware.

In other aspects a method of verifying firmware integrity on a wireless device comprises generating a verification configuration comprising a verification scheme to test an integrity of firmware on the wireless device forwarding the verification configuration to a wireless device receiving a generated verification test result based on an application of the verification scheme on the firmware by the wireless device and generating an integrity determination based on the generated verification test result wherein the integrity determination indicates the integrity of the firmware.

In further aspects a method of verifying firmware integrity on a wireless device comprises receiving a verification scheme for testing an integrity of firmware on the wireless device generating a verification test result based on applying the verification scheme to the firmware and forwarding the verification test result for analysis to determine the integrity of the firmware.

In some aspects a machine readable medium comprises instructions which when executed by a machine cause the machine to perform operations including generating a verification configuration comprising a verification scheme to test an integrity of firmware on the wireless device forwarding the verification configuration to a wireless device receiving a generated verification test result based on an application of the verification scheme on the firmware by the wireless device and generating an integrity determination based on the generated verification test result wherein the integrity determination indicates the integrity of the firmware. In some related aspects at least on processor may be configured to perform the above stated actions.

In other aspects a machine readable medium comprises instructions which when executed by a machine cause the machine to perform operations including receiving a verification scheme for testing an integrity of firmware on the wireless device generating a verification test result based on applying the verification scheme to the firmware and forwarding the verification test result for analysis to determine the integrity of the firmware. In related aspects at least on processor may be configured to perform the above stated actions.

Referring to one aspect of a wireless device firmware verification system for making a firmware integrity determination includes a wireless device having a resident firmware verification module that checks the integrity of resident firmware based on a verification configuration . In this aspect verification configuration is generated by and received from a remote firmware management module associated with a user manager server Events and . For example user manager server may be resident on a computer device such as a server located across a wireless network from wireless device . Further for example verification configuration may be generated by executing a configurator module associated with firmware management module . Verification configuration includes in one aspect a verification scheme executable by wireless device to apply to firmware to generate a verification test result Event . For example in one aspect verification scheme includes but is not limited to a predetermined redundancy check that is applied to at least a portion of firmware to generate a checksum value as the verification test result . It should be noted however that other verification schemes may be utilized and verification test results may be obtained as is discussed below in more detail. In any case the resident firmware verification module stores verification test result for example in an information log . Further in one aspect firmware verification module forwards information log across wireless network to user manager server Event . User manager server may operate to store information log in information repository .

Firmware management module associated with the user manager server accesses information log and executes an analyzer to generate an integrity report that reflects the integrity of firmware on wireless device Event . For example in one aspect analyzer includes a predetermined verification result which it compares to the generated verification test result in the information log to produce integrity determination . Predetermined verification result comprises known data or information in any format that corresponds to the result of the application of predetermined verification scheme to an unaltered version of firmware . In the aspect discussed above for example predetermined verification result may include a predetermined checksum value which is compared to the generated checksum value mentioned above. In this case if there is a match between predetermined verification result and generated verification test result then integrity determination may be an output that indicates that firmware is unaltered or is of a proper state. Alternatively for example if there is not a match then integrity determination may be an output that indicates that firmware has been altered. Further analyzer generates integrity report that includes integrity determination and based on verification configuration which may further include additional firmware information associated with firmware as is discussed below in more detail.

Firmware management module may then execute to transmit integrity report to an operator computer for analysis Event . In one aspect for example an operator at operator computer then reviews integrity report and based on the contents of report may make a decision to send a control command to the wireless device via user manager server Events and . In one aspect operator executes firmware management module to transmit control command across wireless network to wireless device . For example control command includes but is not limited to commands such as a disable command to shut down the ability of the user of wireless device to communicate with wireless network a reconfigure command to reload or reset a firmware configuration and an enable command to re establish the ability of the user of wireless device to communicate with wireless network . As an example operator may decide to disable wireless device to protect wireless network from the wireless device sending messages that do not conform to the proper protocol for the wireless network . Similarly a reconfigure command may be sent to correct altered firmware to restore the firmware and return it to its predetermined unaltered state and an enable command may be sent after a disable command to allow communications once altered firmware is corrected.

Additionally in one aspect firmware management module may include a device control module which reviews control command and makes a permission decision as to whether or not to send control command to wireless device Event . For example as will be discussed in more detail below permission decision may be based on a source or generator of control command the type of action associated with control command and other factors associated with wireless device and its associated wireless network . Further in some aspects device control module may query the source of control command to confirm and or verify the control command before sending it to wireless device as will be discussed below in more detail.

In conjunction in one aspect firmware verification module may include a device control module which receives and executes control command Event . In other aspects local device control module may query the source or generator of control command to confirm the control command before executing it. Further in addition or in the alternative device control module may query user manager to verify that control command is valid and or that the originator of control command has the authorization to issue the command.

Thus the present apparatus methods computer readable media and processors provide for generating and applying verification scheme to firmware of wireless device in order to obtain verification test result to use in making integrity determination . Further the described aspects may provide for the collection analysis and reporting of additional firmware information based on verification configuration and may further allow for control commands to be executed on the wireless device in response to integrity determination .

Referring to wireless device can include any type of computerized wireless device such as cellular telephone personal digital assistant two way text pager portable computer and even a separate computer platform that has a wireless communications portal and which also may have a wired connection to a network or the Internet. The wireless device can be a remote slave or other device that does not have an end user thereof but simply communicates data across the wireless network such as remote sensors diagnostic tools data relays and the like. The apparatus and method of firmware verification collecting and reporting on the wireless device can accordingly be performed on any form of wireless device or computer module including a wired or wireless communication portal including without limitation wireless modems PCMCIA cards access terminals personal computers telephones or any combination or sub combination thereof.

Additionally wireless device has input mechanism for generating inputs into wireless device and output mechanism for generating information for consumption by the user of the wireless device. For example input mechanism may include a mechanism such as a key or keyboard a mouse a touch screen display voice recognition module etc. Further for example output mechanism may include a display an audio speaker a haptic feedback mechanism etc.

Further wireless device has computer platform that can transmit data across wireless network and that can receive and execute software applications and display data transmitted from user manager server or another computer device connected to wireless network . Computer platform includes a data repository which may comprise volatile and nonvolatile memory such as read only and or random access memory RAM and ROM EPROM EEPROM flash cards or any memory common to computer platforms. Further data repository may include one or more flash memory cells or may be any secondary or tertiary storage device such as magnetic media optical media tape or soft or hard disk.

Further computer platform also includes a processing engine which may be an application specific integrated circuit ASIC or other chipset processor logic circuit or other data processing device. Processing engine or other processor such as ASIC may execute an application programming interface API layer that interfaces with any resident programs such as firmware verification module in a data repository of the wireless device . API is a runtime environment executing on the respective wireless device. One such runtime environment is Binary Runtime Environment for Wireless BREW software developed by Qualcomm Inc. of San Diego Calif. Other runtime environments may be utilized that for example operate to control the execution of applications on wireless computing devices.

Processing engine includes various processing subsystems embodied in hardware firmware software and combinations thereof that enable the functionality of wireless device and the operability of the wireless device on wireless network . For example processing subsystems allow for initiating and maintaining communications and exchanging data with other networked devices. In one aspect such as in a cellular telephone communications processing engine may include one or a combination of processing subsystems such as sound non volatile memory file system transmit receive searcher layer layer layer main control remote procedure handset power management diagnostic digital signal processor vocoder messaging call manager Bluetooth system Bluetooth LPOS position determination position engine user interface sleep data services security authentication USIM SIM voice services graphics USB multimedia such as MPEG GPRS etc. For the disclosed aspects processing subsystems of processing engine may include any subsystem components that interact with applications executing on computer platform . For example processing subsystems may include any subsystem components which receive data reads and data writes from API on behalf of the resident firmware verification module . Further all or a portion of additional firmware information that is gathered and then logged in the information log is available from these subsystems .

Computer platform may further include a communications module embodied in hardware firmware software and combinations thereof that enables communications among the various components of the wireless device as well as between the wireless device and the wireless network .

Additionally computer platform includes firmware which may comprise any nonvolatile memory that contains data such as firmware data and or a set of executable instructions such as firmware code that affect the operation of the wireless device . For example firmware may comprise software that is embedded in a hardware device. Some examples of nonvolatile memory include ROM EPROM EEPROM and flash cards. Additionally firmware includes verification information that is utilized to determine the integrity of firmware . For example verification information includes but is not limited to all or any portion of the data and or executable instructions that comprise firmware and may further include data that is a function of all or a portion of the data and or executable instructions that comprise firmware . In one aspect for example verification information includes a firmware signature which is information that identifies and or authenticates the given firmware. For example firmware signature includes but is not limited to data representative of at least one of a firmware name a firmware version a firmware size a firmware manufacturer etc. In another example verification information may include a predetermined value stored at a predetermined location within firmware where any attempted alteration of firmware would change the value and or the location. In yet another aspect verification information includes all or a portion of the firmware data and or all or a portion of the firmware code . In this case firmware data and or firmware code may be operated on by verification scheme to generate verification test result .

Computer platform further includes firmware verification module to manage firmware verification activities on wireless device . Firmware verification module may include any hardware software firmware and or other set of executable instructions operable to manage the collection on the wireless device and transmission across the wireless network of any information relating to the integrity of firmware of the wireless device . In one aspect firmware verification module includes verification logic that provides the capability to collect store and provide access to or forward information based on verification configuration . Further in some aspects verification logic may provide the capability to generate verification test result and compare it with predetermined verification result to generate integrity determination . Firmware verification module may be initiated at any time and verification test result and or additional firmware information logged in the information log may be stored on the wireless device and obtained at any time via a wired or wireless connection to the wireless device .

Firmware verification module can collect any firmware verification information relevant to firmware usage and or verification. Based on verification configuration firmware verification module may apply firmware verification scheme to the firmware and generate verification test result . Further firmware verification module may store this information in an information log either in resident data repository or in another memory device connectable to the wireless device or accessible to the wireless device over the wireless network . Further information log may include the details of verification configuration in association with the collected firmware verification information.

In an aspect where predetermined verification result is known to wireless device for example when it is included in verification configuration firmware verification module may then execute verification logic to locally compare test result with predetermined result to derive the integrity of the firmware . Thus in one aspect firmware verification module provides wireless device with a resident or self contained capability for retrieving and recording firmware information on a wireless device as well as for allowing the transmission and remote analysis of such firmware information.

Alternately firmware verification module may transmit test result and or information log to another computer device to derive the integrity of the firmware of the wireless device . For example firmware verification module may cause the wireless device to selectively transmit information log to user manager server across wireless network . In one aspect the information log is transmitted over an open communication connection from the wireless device to the wireless network and thus piggybacked across an open connection such as a voice or data call at the wireless device . In a cellular network configuration the information log can be transmitted to user manager server through short message service.

In another aspect remote user manager server reads the information log from the wireless device through the resident firmware verification module and in some instances writes control commands to computer platform and alters the operation of the wireless device such as re setting firmware . Accordingly the access to firmware verification module allows the user manager server to remotely control parameters for firmware verification information collection analysis and reporting.

Firmware verification module operates based on verification configuration . Verification configuration may be generated by any computer device connected to wireless network or may be locally transmitted to the wireless device such as by a manual input from a user and or through transmission from a locally connected media reader or may even have been loaded on the wireless device at the time of manufacture. In one aspect for example verification configuration is generated by the user manager server as is explained below.

Verification configuration includes instructions and data that dictate operations to be performed by firmware verification module . For example as discussed above verification configuration may include verification scheme which comprises instructions for testing the integrity of firmware . Verification scheme may include but is not limited to instructions relating to tests such as a redundancy check including a checksum parity bits check digits longitudinal redundancy check cyclic redundancy check CRC horizontal redundancy check vertical redundancy check cryptographic message digest Fletcher s checksum and Adler 32 testing for a predetermined value at a predetermined location within firmware and testing for a predetermined result of applying a predetermined function to all or a portion of the data and or the code contained within firmware . Alternatively verification scheme may include instructions for retrieving a predetermined verification scheme from a predetermined source such a from another computer device across wireless network . Further for example in order to keep track of changes to certain portions of firmware or to increase security firmware may be segmented and one or more verification schemes may be applied to one or more of the segments of firmware . As such verification scheme may identify a scheme to apply to each segment of firmware .

For example referring to one aspect of firmware verification scheme comprises a CRC algorithm where the firmware verification module applies the CRC algorithm to different segments of the firmware . In one aspect firmware is divided into a predetermined number of code segments such as code segments and a predetermined number of data segments such as data segments . Verification logic executes verification configuration to apply the CRC algorithm to each segment and generate verification test result values . Further in this aspect where verification configuration includes predetermined verification result verification logic executes to compare the test result values to predetermined verification values to generate an integrity determination for each segment of the firmware . In alternative cases however predetermined verification values may be stored at another computer device such as at user manager and the generated verification test result values are transmitted from wireless device to the other device for the comparison. In any case this method of splitting up the firmware into segments is advantageous for several reasons. First if only one or more of the segments are found to have a problem with their integrity then only those segments will need to be repaired. Further if segments that are not critical to the operation of the wireless device are the only segments found to have a problem with their integrity then the wireless device may not have to be disabled. Further many firmware verification schemes may operate more reliably when applied to fewer data items of the firmware . For example a firmware verification scheme based on parity may be more reliable with fewer data items of the firmware .

Continuing to refer to another firmware verification scheme may simply log firmware signature . For example in this case firmware signature may include values or data relating to a firmware version a firmware size and a current date . This information is then compared to predetermined verification test result values which in this case are a predetermined firmware version a predetermined firmware size and a predetermined date to determine the integrity of the firmware .

Additionally referring back to verification configuration may further include a tracking parameter that dictates which information to collect in information log and how often to gather this information. For example tracking parameter may include instructions on how often to initiate verification scheme and instructions to record the generated verification test result . Additionally for example tracking parameter may include instructions that define which additional firmware information to collect and when to collect them. For example tracking parameter may identify predetermined status or state information to collect as additional firmware information at predetermined times from predetermined applications and or predetermined subsystems . Additional firmware information may comprise but is not limited to any information relating to successful and or unsuccessful firmware access attempts changes made to the firmware operations being performed by wireless device and or subsystems wireless device diagnostic information information relating to the state and or operation of any resident applications on wireless device etc. Further for example tracking parameter dictate the tracking of certain activities or actions taking place on device such as the execution of control command and require the storage of information relating to these activities actions in information log such as in action record .

Further verification configuration may include a reporting parameter that specifies when the firmware verification module should report or transmit information log or whom to allow access to information log . For example reporting parameter may include instructions to transmit information log immediately after applying firmware verification scheme to firmware . Other reporting parameters may include instructions to transmit information log at a predetermined time or a predetermined interval or on the occurrence of predetermined events such as upon establishing a communication channel with communications network .

Additionally in an aspect verification configuration may include control command parameters which may include control command associated with a predetermined condition in order to control operations on wireless device . For instance in the case where wireless device locally generates integrity determination by comparing generated verification test result with predetermined verification test result control command parameters may allow firmware verification module to locally control wireless device in the case where incorrect or altered firmware is discovered. For example condition may be a certain integrity determination such as 1 a determination that indicates the proper firmware is present and 2 a determination that indicates that firmware has been altered. In the case of condition 1 then control command may be a continue operation command to carry on operations of wireless device . In the case of condition 2 then control command may be a disable command to shut down the ability of wireless device to communicate with wireless network . There may be a wide variety of conditions and corresponding control commands depending on the given application that may be included in control command parameter . For example in some embodiments the various parameters comparisons and results may be recorded in information log . Additionally the actions performed based on verification configuration such as those actions associated with control command may be recorded in action record .

Thus verification configuration provides a flexible means for controlling the operation of the firmware verification module .

Further in some aspects firmware verification module includes device control module operable to receive either a locally generated or a remotely generated control command . Further device control module may include control logic operable to execute control command on the wireless device . As will be explained in more detail below device control module may verify a control command before executing the control command on the wireless device .

For example control command may be any operation that can be executed on the respective wireless device and includes but is not limited to the commands such as a disable command an enable command and a reconfigure command where the disable command makes the wireless device non operable for non emergency communications or completely non operable where the enable command makes the wireless device operational for communications and where the reconfigure command sets at least one of the firmware values relating to an operational characteristic of the wireless device. In some embodiments for example the reconfigure command may include changing firmware data and or values over the air such as by including a software patch operable to over write software on firmware . In general the control command is issued either locally or remotely in response to the results of the firmware verification module and will normally be in response to deriving the integrity of the firmware .

Further firmware verification module may include a limited service configuration operable to establish a limited access communications channel across the wireless network which in one aspect is generally not available to the end user of wireless device . For example the limited access communications channel may be used for transmitting information log or for receiving control command . Further in the case when communications from wireless device have otherwise been disabled the limited access communications channel may allow emergency calls such as 911 calls or may allow calls to an operator or other designated party associated with the wireless network provider. The identification and set up of the limited access communications channel is based on a limited service setting . Limited service setting may identify the type of communications that are allowed and may identify the associated communication channels that can be utilized. Limited service configuration may be received over the wireless network may be locally transferred to wireless device such as through a serial connection or may be preloaded on the wireless device .

Referring back to wireless network includes any communications network operable at least in part for enabling wireless communications between wireless device and any other device connected to wireless network . Further wireless network may include all network components and all connected devices that form the network. For example wireless network may include at least one or any combination of a cellular telephone network a terrestrial telephone network a satellite telephone network an infrared network such as an Infrared Data Association IrDA based network a short range wireless network a Bluetooth technology network a ZigBee protocol network an ultra wide band UWB protocol network a home radio frequency HomeRF network a shared wireless access protocol SWAP network a wideband network such as a wireless Ethernet compatibility alliance WECA network a wireless fidelity alliance Wi Fi Alliance network and a 802.11 network a public switched telephone network a public heterogeneous communications network such as the Internet a private communications network and land mobile radio network. Suitable examples of telephone networks include at least one or any combination of analog and digital networks technologies such as code division multiple access CDMA wideband code division multiple access WCDMA universal mobile telecommunications system UMTS advanced mobile phone service AMPS time division multiple access TDMA frequency division multiple access FDMA orthogonal frequency division multiple access OFDMA global system for mobile communications GSM single carrier 1 radio transmission technology RTT evolution data only EV DO technology general packet radio service GPRS enhanced data GSM environment EDGE high speed downlink data packet access HSPDA analog and digital satellite systems and any other technologies protocols that may be used in at least one of a wireless communications network and a data communications network.

User manager server may comprise at least one of any type of hardware software firmware server personal computer mini computer mainframe computer or any computing device either special purpose or general computing device. Further user manager server may reside entirely on the wireless device . Further there can be separate servers or computer devices associated with user manager server that work in concert to provide data in usable formats to parties and or to provide a separate layer of control in the data flow between the wireless devices and user manager server . User manager server or plurality of modules can send software agents or applications such as the resident firmware verification module to wireless device across wireless network such that the wireless device returns information from its resident applications and subsystems. For example wireless devices may transmit the result of applying a firmware verification scheme to firmware in the form of an information log where the user manager server may then compare this result with predetermined verification result to generate integrity determination that represents the integrity of the firmware of the wireless device .

User manager includes remote firmware management module to manage firmware verification operations. Remote firmware management module may include software hardware firmware and generally any executable instructions operable by user manager server . Remote firmware management module may download all or a portion of the resident version of firmware verification module to a wireless device . Alternatively the resident version of remote firmware management module may be loaded onto the wireless device during the initial assembly process or via direct connections during a configuration process. Further remote firmware management module includes verification logic which is executable by user manager server to generate verification configuration and to manage the collection and analysis of information log from wireless devices . Remote firmware management module may pull the log based on commands from a user or the log may be pushed from the wireless devices at predetermined times upon reaching predetermined memory data storage levels or upon reaching predetermined conditions such as the wireless device providing improper protocols between the wireless device and the wireless network .

Referring to in one aspect remote firmware management module includes configurator module that includes hardware firmware software and or any other associated logic that allows the configurator module to generate verification configuration . In one aspect configurator module executes configuration logic which assembles the various components of a given verification configuration based on making selections from a number of variable parameters. For example that parameters that make up verification configuration may vary depending on the type make model of the wireless device and or the network service provider. As such configuration logic may provide a user with the ability to select from a menu of a plurality of wireless device types and a plurality of network service providers in order to generate a appropriate menu from which to select the parameters of verification configuration . Similarly there may be one or more of each type of parameter to choose from to make up verification configuration . For example verification logic may provide a user with the ability to select from a menu of at least one of a plurality of firmware verification schemes a plurality of tracking parameters a plurality of reporting parameters a plurality of control command parameters and a plurality of predetermined verification result values . Alternatively rather than selecting the various parameters individually configuration logic may provide the user with the ability to select from a menu of a plurality of predetermined verification configurations which include predetermined groupings of the above noted parameters that comprise verification configuration . Further in one aspect the selected one of the plurality of wireless device types and the selected one of the plurality of network service providers may be correlated to a given one of a plurality of types of firmware and or a predetermined set of verification parameters that are appropriate for a particular wireless device . For example for an XYZ brand of wireless device operating on ABC wireless service provider configuration logic may be able to determine which firmware the wireless device should have installed and thus may generate verification configuration that includes the appropriate set of corresponding parameters.

Once verification configuration is determined configurator module and or remote firmware management module is operable to transmit verification configuration to one or more wireless devices to initiate the tracking and management of firmware verification on that device.

Remote firmware management module may include information repository for storing information log including verification test result and or additional firmware information received from wireless device based on executing verification configuration . Information repository may include any type of memory or storage device. Although illustrated as being associated with remote firmware management module information repository may be located anywhere in communication with user manager such as on another server or computer device connected to wireless network on wireless device or on a wireless network help computer .

Further as noted above remote firmware management module may include analyzer which may include hardware software firmware and combinations thereof for analyzing and processing logged firmware verification information in the information repository in order to generate a report and integrity determination . Additionally analyzer may further include analysis logic comprising algorithms decision making routines statistical programs etc. for analyzing and interpreting the information logs contained in the information repository module . Although illustrated as being associated with remote firmware module analyzer may be located anywhere in communication with user manager server on another server connected to wireless network on wireless device or on a wireless network help computer .

Additionally it should be noted that since many firmware verification schemes are heuristic the derived integrity determination of the firmware may be a subjective value or probability. Further as described earlier the derived integrity determination of the firmware further may depend on which version of the firmware is installed in a particular make and or model of wireless device at a particular time. So for example the existing firmware may not be corrupted and was the correct firmware for the wireless device at the time of manufacture but may no longer be a current valid version of firmware thus in this case analyzer may determine that the integrity of firmware is compromised.

Additionally in one aspect firmware integrity determination is a measure of both whether or not the wireless device has the correct firmware and whether or not the firmware on the wireless device is or may be corrupted or a measure of a certainty that the firmware is not corrupted. So integrity determination of firmware on wireless device may represent a low integrity if for example a wireless device has a version of firmware that is no longer supported by the network service provider or if the version of the firmware on the wireless device may be corrupted as measured by a comparison of verification test result with predetermined verification result . In some aspects this comparison of verification test result with predetermined verification result may only be an indication of whether or not the firmware is corrupted and thus integrity determination may be a probability or subjective category e.g. most likely 10 chance etc.

In one aspect report and or information log may be reviewed manually such as by a technician field engineer carrier operator or the user of the wireless device for evaluation of firmware verification related information associated with a particular wireless device . Operator or the user of the wireless device may generate a new verification configuration or control command such as a disable wireless device command for the respective wireless device based on the information log and or on the report . Generally report may be useful in detecting and correcting problems related to firmware verification through analysis of information log . As such report includes any form of output that represents analysis of information log and other information contained in the information repository as well as any other associated information that may be incorporated in predetermined standards such as reports of viruses proper firmware versions for the wireless device shut down times for improper firmware versions etc.

Although illustrated as producing report firmware management module and its corresponding components can give a ready view of firmware verification related information collected from the wireless devices in any form such as tables maps graphics views plain text interactive programs or web pages or any other display or presentation of the data. For example firmware management module may present firmware verification related information on a monitor or display device and or may transmit this information such as via electronic mail to another computer device for further analysis or review. Also firmware management module may be executable to change verification configuration and or send a control command to be executed on the respective wireless device based on the information log and or based on the report generated by analyzer .

Referring to both the remote firmware verification module and the firmware verification module may have a device control module operable to receive generate control command either locally or remotely and either execute control command on wireless device or transmit control command to wireless device . In one aspect for example control command may contain both a user identification ID and a control activity . User ID may be some manner of identifying the originator of control command . For example user ID may be a name a number a digital signature a hash a digital certificate or any other type of data or value that may be associated with a party. Further user ID may not be explicitly contained in the control command but rather may be derived from the origin of control command . Additionally control activity is the operation to be performed by firmware verification module through executing control command . As mentioned above these operations include disabling communications enabling communications reconfiguring firmware and or communications parameters etc.

Before executing or forwarding the control command device control manager may execute permission logic to check the authenticity or authority of the user issuing control command and or to verify and confirm that the user truly wants to initiate the command. The verification of a control command may include for example a prompt to operator or other user to confirm whether operator actually wishes to execute control activity on wireless device . The confirmation or cancellation of the control command may be received as command verification . Further for example to authenticate the control command permission logic may parse user ID and control activity from control command and may utilize a database of a plurality of user IDs correlated with a plurality of control permissions and further correlated with a plurality of wireless device identifications IDs in order to check the authorization for issuing control command . Control permissions may identify one or more authorized control activities for a given user ID and or wireless device IDs which is an identification of a specific wireless device. For instance certain users may be restricted to certain control activities or to being able to control certain wireless devices. It should be noted however that the plurality of user IDs the plurality of control permissions and the plurality of wireless device identifications IDs may be correlated in any manner. For example control command may contain a user ID of an operator and a control activity of disable communications for a particular one of the plurality of wireless device identifications . Permission logic searches the database of control permissions and user IDs to determine if the operator was permitted to disable the given wireless device . Permission logic generates a permission decision based on this authorization check and or based on the value of command verification .

As previously described in reference to although operator in this aspect is illustrated as a person in other aspects operator may be a computing device which may include hardware software firmware and combinations thereof for analyzing and responding to report or to an external communication such as from the user of the wireless device . Further operator may reside on the same computing device as the user manager server which could be the wireless device . In one aspect operator is a person that may respond to a report . Additionally operator may further include algorithms decision making routines statistical programs etc. for analyzing and interpreting report . Although illustrated as being associated with wireless network help computer operator may be located anywhere in communication with wireless network such as on user manager server another server connected to the network or even on the wireless device .

Referring to in one aspect wireless device comprises a cellular telephone. A cellular telephone system may include wireless network connected to a wired network via a carrier network . Wireless devices are being manufactured with increased computing capabilities and often can communicate packets including voice and data over wireless network . As described earlier these smart wireless devices have APIs on their local computer platform that allow software developers to create software applications that operate on the cellular telephone and control certain functionality on the device. is a representative diagram that more fully illustrates the components of a cellular wireless network and the interrelation of the elements of one aspect of the present system. Cellular wireless network is merely exemplary and can include any system whereby remote modules such as wireless devices communicate over the air between and among each other and or between and among components of a wireless network including without limitation wireless network carriers and or servers.

In system user manager server can be in communication over a wired network e.g. a local area network LAN with a separate data repository for storing firmware verification information such as the data logs gathered from the wireless devices . Further a data management server may be in communication with user manager server to provide post processing capabilities data flow control etc. User manager server data repository and data management server may be present on the cellular telephone system with any other network components that are needed to provide cellular telecommunication services. User manager server and or data management server communicate with carrier network through a data links and which may be data links such as the Internet a secure LAN WAN or other network. Carrier network controls messages generally being data packets sent to a mobile switching center MSC . Further carrier network communicates with MSC by a network such as the Internet and or POTS plain old telephone service . Typically in network a network or Internet portion transfers data and the POTS portion transfers voice information. MSC may be connected to multiple base stations BTS by another network such as a data network and or Internet portion for data transfer and a POTS portion for voice information. BTS ultimately broadcasts messages wirelessly to the wireless devices such as wireless devices by short messaging service SMS or other over the air methods.

Referring to one aspect of a method for firmware integrity verification on a wireless device includes loading at least a portion of a firmware verification module onto a computer platform of a wireless device Block . For example the firmware verification module may be embodied within the hardware and or firmware of the wireless device during the manufacture of the device. Alternatively the firmware verification may be pushed by a user manager server to the wireless device or pulled from a user manager server by the wireless device across a wireless network . Alternatively the firmware verification module may be pulled or pushed depending on whether or not the wireless device has the latest version of the firmware verification module for the respective wireless device . In another alternative loading of the firmware verification module may be configurable in any manner for example being initiated by a predetermined event such as the wireless device having difficulty communicating with the wireless network or the wireless device communicating with a different network service provider. In another alternative the pushing or pulling of the firmware verification module to the wireless device may be configurable in any manner for example being initiated by a predetermined event.

Further this aspect of the method includes loading at least a portion of a verification configuration for testing the integrity of firmware on the computer platform of the wireless device Block . For example verification configuration may be embodied within the hardware and or firmware of the wireless device during the manufacture of the device. Alternatively verification configuration may be pushed by a user manager server to the wireless device or pulled from a user manager server by the wireless device across a wireless network . In another alternative loading of verification configuration may be initiated in any manner for example being initiated by a predetermined event such as the wireless device having difficulty communicating with the wireless network or the wireless device communicating with a different network service provider. In another alternative the pushing or pulling of the configuration to the wireless device may be configurable in any manner for example being initiated by a predetermined event.

Further this aspect of the method includes collecting firmware verification information including a verification test result in accordance with verification configuration Block . For example verification test result may be generated by applying predetermined verification scheme to firmware . Further additional firmware information may be retrieved from processing engine of the wireless device during its operation. Both verification test result and additional firmware information may be stored in information log .

Optionally this aspect of the method includes determining an integrity of the firmware by comparing a predetermined verification result to the generated verification test result Block . In one aspect for example this integrity determination may be recorded in information log .

Further this aspect of the method includes forwarding the collected firmware verification information to another computer device for analysis Block . In one aspect for example information log is uploaded from wireless device to user manager server in accordance with reporting parameter of verification configuration such as through a standard HTTP an FTP or some other data transfer protocol. In other aspects the collected firmware verification information is uploaded from the wireless device using any communication means the wireless device may access.

Additionally this aspect of the method may include receiving optionally verifying and executing a control command based on the analysis of the firmware integrity related information Block . As discussed earlier remote firmware management module may execute analyzer to generate report including integrity determination . Based on integrity determination and or a review of information log operator or another user may utilize remote firmware management module to generate control command to control the activity of wireless device . Device control module may verify the authenticity and authority of control command and then may execute control logic to initiate control activity .

Referring to one aspect of a method operable on an apparatus to verify the integrity of firmware on wireless device includes generating a verification configuration to test the integrity of firmware on a wireless device Block . In one aspect a user such as a technician or operator accesses firmware management module and executes configurator module to generate verification configuration for a given wireless device . Configurator module may utilize configuration logic to determine and or customize the various parameters that comprise verification configuration and these parameters may vary depending on the type make model of the wireless device the actual network service provider and the type of firmware.

Further this aspect of the method includes forwarding the verification configuration to the wireless device Block . For example user manager server may transmit verification configuration across wireless network to wireless device . Alternatively in another aspect verification configuration may be forwarded through a static or serial connection to wireless device . In another alternative verification configuration may be preloaded on wireless device during manufacture.

Further this aspect of the method includes receiving firmware verification related information from the wireless device based on the verification configuration Block . For example user manager server may receive information log including verification test result and or additional firmware information from wireless device . The data in information log corresponds to a processing of verification configuration by the respective wireless device . Additionally in one aspect the user manager server receives information log over wireless network . Further information log may be received either as a whole or in pieces and assembled by user manager server and or firmware management module . In another aspect user manager server receives the information log by a static or serial connection to the wireless device or from some other computer device or storage media in communication with user manager .

Further this aspect of the method includes generating a report based on the data in information log that indicates an integrity of the firmware on the wireless device Block . For example analyzer generates report based on comparing the generated verification test result with predetermined verification result . Report may include integrity determination that based on this comparison indicates the predicted integrity of firmware .

Optionally in one aspect the report of the firmware integrity is forwarded for analysis Block . For example firmware management module may execute verification logic to transmit report to another computer device the user of wireless device or a third party for review. In one aspect firmware management module transmits report to computer device for review by operator . Operator may take action based on report such as sending the user of the respective wireless device a request to have the firmware of the wireless device replaced. In another aspect the analysis of report results in a control command being issued to control operations of the wireless device. For example if defective firmware is detected then operator or another party may issue a command for example to disable the device so as to prevent harm to the wireless network or to prevent unauthorized operations.

Optionally in one aspect the method includes receiving and optionally verifying a control command based on the firmware verification related information in the report Block . For example firmware management module may receive control command from operator in response to report . Optionally device control module may execute permission logic to make permission decision as to whether or not to issue control command to the respective wireless device .

Optionally in one aspect the method includes sending the control command to the wireless device Block . For example device control module may execute control logic to forward control command to wireless device . In one aspect device control module transmits control command across wireless network to wireless device .

Thus the described aspects allow a party such as a wireless network service provider a wireless device manufacturer a firmware manufacturer etc. to maintain the integrity of the firmware on a wireless device. For example the network service provider may need to detect compromised firmware so that they may provide good service to their customers and generate revenue. Further the network service providers may need to shut down wireless devices that have compromised firmware in order to protect their wireless networks for example as a wireless device with compromised firmware may use a communications protocol that interferes with other wireless devices on the wireless network. Additionally the network service provider may need to be able to disable a wireless device when the firmware for the wireless device has become obsolete or when the wireless device is being used on a different service provider s network in violation of an agreement.

Additionally the described aspects allow the manufacturers of the wireless devices to configure a firmware verification application for different wireless devices and different versions of firmware so that an application does not have to be written for each version of firmware or each type of wireless device.

Additionally the described aspects provide a firmware verification mechanism that is able to determine whether to disable the wireless device based on what part of the firmware has been compromised. For example a buggy program may compromise the integrity of the firmware for a code segment of the firmware that merely draws entertaining pictures on the output device of the wireless device. In this situation the described aspects allow for this determination and therefore allow for merely notifying the user of the wireless device that the firmware needs to be repaired rather than disabling the wireless device. In this case disabling the wireless device may at least inconvenience the user of the wireless device and may cause the network service provider to lose revenue. Further rather than disabling the device or requesting that the user of the wireless device have the wireless device serviced the described aspects provide for reconfiguring the firmware in order to restore the integrity of the wireless device.

The various illustrative logics logical blocks modules and circuits described in connection with the aspects disclosed herein may be implemented or performed with a general purpose processor a digital signal processor DSP an application specific integrated circuit ASIC a field programmable gate array FPGA or other programmable logic device discrete gate or transistor logic discrete hardware components or any combination thereof designed to perform the functions described herein. A general purpose processor may be a microprocessor but in the alternative the processor may be any conventional processor controller microcontroller or state machine. A processor may also be implemented as a combination of computing devices e.g. a combination of a DSP and a microprocessor a plurality of microprocessors one or more microprocessors in conjunction with a DSP core or any other such configuration.

Further the actions and or steps of a method or algorithm described in connection with the aspects disclosed herein may be embodied directly in hardware in a software module executed by a processor or in a combination of the two. A software module may reside in RAM memory flash memory ROM memory EPROM memory EEPROM memory registers a hard disk a removable disk a CD ROM or any other form of storage medium known in the art. An exemplary storage medium is coupled to the processor such that the processor can read information from and write information to the storage medium. In the alternative the storage medium may be integral to the processor. The processor and the storage medium may reside in an ASIC. The ASIC may reside in a user terminal. In the alternative the processor and the storage medium may reside as discrete components in a user terminal.

While the foregoing disclosure shows illustrative aspects it should be noted that various changes and modifications could be made herein without departing from the scope of the described aspects as defined by the appended claims. Furthermore although elements of the described aspects may be described or claimed in the singular the plural is contemplated unless limitation to the singular is explicitly stated.

