---

title: Method and system for service-enablement gateway and its service portal
abstract: A method and system for dynamic service support is presented. A portal-page service and an interface bundle are installed at the gateway. A customer service at the gateway, based on the interface bundle, is installed at the gateway. The portal-page service searches for the customer service and generates a user interface for the customer service based on the customer service. The portal-page service generates a portal-page based on the user interface and the portal page service.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07574660&OS=07574660&RS=07574660
owner: Verizon Corporate Services Group Inc.
number: 07574660
owner_city: New York
owner_country: US
publication_date: 20050408
---
This is a continuation of prior U.S. patent application Ser. No. 09 870 084 filed May 30 2001 now U.S. Pat. No. 6 920 615 entitled Method and System for Service Enablement Gateway and its Service Portal which claims benefit from U.S. Provisional Patent Application Ser. No. 60 250 037 filed on Nov. 29 2000 entitled Software Architecture using OSGI Service J2EE and an API to Deliver Data Services A Case Study and is related to U.S. patent application Ser. No. 09 870 143 filed May 30 2001 entitled Method and System for Partitioned Service Enablement Gateway with Utility and Consumer Services. 

This invention relates in general to data processing and more particularly to a method and system for a service enablement gateway with a service portal.

As computers have grown increasingly important in today s society the Internet has been increasingly used to deliver information and services to customer premises. Such services include purchasing merchandise communication via email voice and video and downloading and uploading of data. Access to these services typically requires a computer accessing the Internet via a telephone line connection.

Currently automatically billing for services provided to a remote user is cumbersome and unreliable. Also existing services provide minimal support for controlling specific devices present in a particular premises. For example no control or customization of telephony features in the premises is possible.

Other embodiments technical advantages features and aspects will be apparent to one of ordinary skill in the art from the following figures descriptions and claims.

A method and system for dynamic service support is presented. A portal page service and an interface bundle are installed at the gateway. A customer service at the gateway based on the interface bundle is installed at the gateway. The portal page service searches for the customer service and generates a user interface for the customer service based on the customer service. The portal page service generates a portal page based on the user interface and the portal page service.

The present invention provides numerous technical advantages. Various aspects of the present invention may have all some or none of these advantages. One such technical advantage is the capability for a gateway to provide services without the use of a personal computer and with zero administration by the user. Another such technical advantage is the provision and control of service user interfaces with no prior knowledge of the service in a standard way according to the application programmer interface. Another such technical advantage is the ability for multiple users from a single location to access the gateway simultaneously. Another such technical advantage is the facilitation of revision and maintenance of the portal service over the network through its use of the model view controller design pattern.

One such technical advantage is the capability for delivery of services in a zero administration always on gateway that use a remote server for all or a portion of their functionality and persistence and an API to dictate how they communicate with each other. Also a portal utility service provides and controls consumer service user interfaces with substantially no prior knowledge of the consumer services in the gateway by using an API that dictates how the portal service finds services and displays their user interfaces. The portal utility service also provides for access of multiple users from a location and is designed to facilitate maintenance and revision.

High speed connections to the Internet are becoming more and more common in today s society. In addition networks of computers are becoming increasingly important to both home and business users. The increasingly ease of use and commonality of high speed Internet connections and computer networks is leading to a convergence between traditional electronic devices such as appliances environmental controls lamps and audio equipment and computers.

A centralized connection and distribution point may be used to simplify management and control of devices and services available to a home or business and the Internet. An example is presented illustrating the use of a gateway to provide this centralized connection and distribution point in the context of a premises. The exemplary premises comprises a lamp and a computer and a human user of both the lamp and the computer.

Traditionally the user enters the premises and turns on the lamp. The user may then turn on the computer connect to the Internet with an analog modem and then use the Internet.

At some point the user may decide that the user needs faster access to the Internet and connect a relatively high speed Internet connection to the computer. For example the user may purchase a Digital Subscriber Line DSL modem or a cable modem.

The user may also decide that the user is tired of having to manually turn on the lamp every day. Thus the user installs a home automation system which turns the lamp on automatically when the user arrives at the premises. For example the user could wire the premises for a home automation system use a home automation system which communicates over existing infrastructure such as power lines or use a wireless home automation system. The user decides that the user likes the home automation system and adds a thermostat to the home automation system. For example a wireless communication protocol such as the Bluetooth protocol may be used to connect the thermostat to the home automation system. The user could also choose to use multiple home automation systems such as a wireless system and a wireline system.

Now when the user enters the premises the lamp turns on automatically and the thermostat automatically changes to the correct temperature. The user may then decide to do online stock trading so the user goes on the Internet and finds a stock trading program. The user then retrieves the stock trading program from the Internet installs the program and signs up for stock trading services from an online trading service. For example the user may access a subscription web page enter information about the user and receive a user name and password from the online trading service.

The increased convenience and automation provided by the computer and the home automation system lack the ability to share information and use common control equipment. A gateway and a client device such as a web pad to control the gateway replaces or augments the computer and provides a means of controlling the home automation system using a network on the premises and or the Internet. The gateway provides increased convenience and automation and supports control and use of the home automation system. New or upgraded software may also be automatically installed from the network on the gateway.

The user may use the gateway to access and control the home automation system in conjunction with and or instead of using the control system supplied with the home automation system. The gateway may also provide a more familiar user interface to the user as opposed to the control system associated with the home automation system. In addition the relatively high speed Internet connection may now be used with the home automation system to allow for example the user to access and control the home automation system from an external site such as the office.

Now when the user is leaving work the user can tell the home automation system to turn on the light at a particular time and tell the computer to begin downloading and printing various news items of interest to the user. While the user is coming home from work the gateway may be informed that an online audio entertainment program is available. The gateway may then install the online audio entertainment program at the gateway provide an interface for using the program on the computer and wait for the user to approve signing up for the online audio entertainment s monthly subscription service.

When the user arrives at the premises the lamp has been turned on and the user sits down at the computer. Waiting for the user at the web pad or other client device is the option for the user to approve or disapprove signing up for the online audio entertainment service. If the user approves signing up for the online audio entertainment the gateway may retrieve appropriate personal information associated with the user and stored at the gateway and sign up the user for service. The gateway may also support billing the user for the online audio entertainment. The gateway has allowed the user to sign up for the online audio entertainment service by simply approving signing up for the service. Thus the user is freed from having to find an audio entertainment program and manually signing up for service.

Similar to computers the expandability of the gateway provides opportunities for a malicious person to introduce a virus or other detrimental software to the gateway. The ability of the gateway to control appliances such as microwaves TVs and thermostats provides numerous possibilities for a malicious person or a virus.

Customer location houses a gateway a premises network one or more devices one or more client devices and one or more users . Client devices and users may also be located outside the customer s physical location and access the gateway via the network . Customer location comprises a location associated with a subscriber to system . For example customer location may comprise a house an apartment a collection of multiple dwelling units or a business.

Gateway comprises hardware and or software for managing communication between devices origin server and portal server . Gateway is operable to communicate over premises network network and or PSTN .

Premises network comprises one or more networking technologies operable to communicate with one or more devices and gateway . More specifically premises network may comprise suitable wireless and or wireline network systems either alone or in suitable combination. Premises network is described in more detail in association with .

Devices comprise electronic and or mechanical devices operable to communicate using premises network . For example devices may comprise phones appliances light switches televisions audio equipment thermostats and other devices operable to communicate using premises network . Devices may use wireless and or wireline technologies to communicate with premises network . Client devices may comprise web pads personal digital assistants PDAs computers and other electronic devices capable of displaying a user interface and Hypertext Transport Protocol HTTP communication using premises network . Customer location is described in more detail in association with . User comprises a human user or an automated process operable to use client devices and devices . For example devices and client devices may communicate using a wireless networking protocol such as Bluetooth. Bluetooth comprises a relatively short range wireless networking protocol. Generally Bluetooth attempts to connect devices which are about 30 feet from each other and provides about 1 mega bit per second of bandwidth.

Network comprises suitable data communications network operable to communicate data between gateway portal server and origin server . Network may be further operable to communicate with PSTN . For example network may comprise an Ethernet network an Asynchronous Transfer Mode ATM network an Internet Protocol IP network a cellular network a Synchronous Optical Network SONET and other suitable networking technologies either alone or in combination. Network may further comprise a suitable combination of wireless and wireline technologies. In the disclosed embodiment network may comprise for example the Internet.

Portal server comprises an application server a database a web server . Application server comprises software and or hardware operable to support billing portion authentication portion profile portion remote logging portion and authorized third party portion . For example portal server may have a processor and computer readable memory for executing programs and other computer logic.

Logic as used herein comprises software and hardware instructions input output components data and other suitable information operable to be used to achieve a result. Logic further comprises the instructions input output components data and other suitable information both during execution and while not being executed or otherwise used.

Storage as used herein comprises transient and or persistent computer readable storage alone and in suitable combination. For example storage may comprise transient storage such as dynamic random access memory DRAM static random access memory SRAM synchronous DRAM SDRAM and other suitable transient storage either alone or in suitable combination. Persistent storage may comprise magnetic media such as a hard disk drive optical media such as a CD ROM and other suitable persistent storage either alone or in a suitable combination.

Billing portion comprises software and or hardware operable to support the billing of users at customer location . Authentication portion comprises software and or hardware operable to authenticate users at customer locations . Profile portion comprises software and or hardware operable to support premises preferences and user preferences at customer location . Remote logging portion comprises software and or hardware operable to support logging of events in the gateway . Authorized third party service portions provide network based functionality for authorized third party services. For example portions and may each provide support for their associated services using technologies such as remote distributed objects remote procedure calls access to Enterprise Java Beans EJB and other distributed functionality usable by gateway . As used herein each means everyone of at least a subset of the identified items.

Database provides data storage and retrieval capabilities directly and indirectly to portal server . More specifically application server may store and retrieve various types of information using database . In addition portal server may store and retrieve various types of information using database directly over communication links .

Web server comprises hardware and or software for receiving and responding to requests for information from customer location either alone or in suitable combination. Web server may comprise a single computer executing software or may comprise a plurality of computers each executing software. Web server generally operates to return and or generate one or more web pages and to return software bundles containing utility services and consumer services. For example web server may comprise a hypertext transport protocol HTTP server. Web server may additionally support other protocols such as the file transfer protocol FTP . Web server is operable to retrieve static and dynamic content such as prewritten text files images animations applications applets dynamically generated web pages pre existing web pages and other data from data sources in response to requests for data.

Web server further comprises software and or hardware operable to supply software bundles described in more detail in association with to gateway .

PSTN comprises one or more public switched telephone networks either alone or in suitable combination. Communication links comprise suitable data communications links between gateway network PSTN origin server and portal server . For example communication links may comprise a digital subscriber line DSL a cable modem a T line a dial up line an Ethernet connection an ATM connection a SONET connection a fiber distributed data interchange FDDI connection and other suitable data communications systems. Communication links may also utilize wireless links such as a cellular digital packet data CDPD network a cellular network a Bluetooth network an Institute for Electrical and Electronics Engineers IEEE 802.11b network a HomeRF Network and other suitable wireless technologies either alone or in combination.

In operation gateway allows devices and client devices to access network and PSTN . Gateway also provides various services to devices and client devices and users . Gateway may be provided with content by origin server and access portal server by devices and client devices and users . Gateway may also retrieve data for updating expanding and customizing gateway from portal server . Also gateway may include security and partitioning capabilities. Devices and may access portal server through gateway . Device and may also use gateway to access the PSTN such as when device or is a phone. For example when a device is a personal digital assistant PDA the PDA may retrieve information from portal server . Gateway may then reformat the content retrieved from portal server for proper display using the display on the PDA.

For example a particular premises using gateway may include many devices and such as a TV lamps a coffee maker a thermostat and a computer which communicate with a home automation system based on premises network . The premises may also include a relatively high speed always on Internet connection such as a digital subscriber line DSL connection coupled to the gateway . As used herein always on means capable of being available for an indefinite period of time and includes services which may be inactive from time to time. For example while a DSL connection is capable of being continuously available the DSL connection may be deactivated or unavailable for periods of time and still be termed an always on service. Gateway provides access to devices and and supports software for communicating with devices and and portal server . For example software may be used by gateway to allow communication between the Internet the computer and the thermostat to allow user to set the temperature at consumer location from a remote location such as the office. Gateway may also support software for preventing security breaches and malicious software from impacting device client device and user .

For another example user could use gateway and a computer to place a time sensitive stock purchase. More specifically instead of placing a limit order on a stock user could specify a specific time for the transaction to occur and or program various rules controlling when to purchase the stock using the computer and gateway .

In general gateway allows the many communications links that may be used to couple devices and and a relatively high speed communications link to interact. The interaction between the Internet and the devices and allows the power and flexibility of the information available on the Internet and the functionality of the devices and to be used together to achieve increased usefulness to user .

Gateway comprises a processor memory one or more internal network interfaces one or more external network interfaces one or more layers and one or more bundles . Processor comprises suitable general purpose or specialized electronic optical or other processing device such as a central processing unit CPU operable to communicate with storage and to execute applications and logic encoded on storage . Processor may comprise multiple processors.

Storage comprises transient and or persistent storage operable to store data either alone or in combination. For example storage may comprise a suitable combination of optical electronic and or magnetic storage such as floppy disk drives hard disk drives CD ROM drives random access memory RAM and static RAM SRAM . Storage may also represent multiple computer readable storage devices in suitable combination.

Internal network interface comprises one or more wireless and or wireline communications interfaces either alone or in suitable combination. For example internal network interface may comprise an X.10 interface an Ethernet interface a Bluetooth interface an ECHELON interface a HomeRF Interface and or an IEEE 802.11b interface.

External network interface comprises one or more wireless and or wireline data communications interfaces either alone or in suitable combination. For example external network interface may comprise a digital subscriber line DSL interface a cable interface an analog modem interface an Ethernet interface an Asynchronous Transfer Mode ATM interface a cellular digital packet data CDPD interface a Bluetooth interface and or an IEEE 802.11B interface. External network interface may comprise multiple types of interfaces in suitable combination. In the disclosed embodiment external network interface comprises a DSL interface.

Layers comprise an OSGi layer a Java virtual machine layer an operating system layer and a hardware layer . In general a layer comprises a discrete logical element based on one or more software and or hardware elements either alone or in suitable combination. For example a layer may be based one or more collections of functions such as a library of functions. For another example a layer may include hardware and appropriate software for interfacing with the hardware. Layers may communicate with each other. In one embodiment a given layer may communicate only with layers directly above and directly below the given layer . Layers allow for functionality to be abstracted and or organized in an appropriate fashion. For example a lower level layer may provide basic input output capabilities by interfacing with hardware while a higher level layer may use the lower level layer s functionality to support a word processing application.

OSGi layer comprises the functionality provided by an OSGi system. More particularly OSGi layer provides support for bundles and the partitioning of bundles .

Java virtual machine layer comprises a Java virtual machine operable to support execution of OSGi layer .

Operating system layer comprises an operating system operable to support Java virtual machine layer and OSGi layer on the hardware used.

Bundles comprise software modules Application Programmer Interfaces APIs and other programs either alone or in a suitable combination usable by OSGi layer to perform some function. For example a particular bundle may provide Internet stock trading capabilities. For another example a particular bundle may provide the ability to interface with devices controlled by a home automation system. For yet another example a particular bundle may provide the ability to order groceries from an Internet based grocery store. In general bundles comprise software that may be used at gateway to provide functionality to user .

Bundles may be grouped into a partition . Bundles may have an associated identity. For example bundles may be named. In one embodiment the identity associated with a bundle comprises an object oriented class name associated with the bundle .

Partition comprises a grouping of one or more bundles which operates to separate certain bundles from other bundles . For example a first bundle which provides a sort functionality in a partition is not accessible by a bundle outside of the partition. In one embodiment a partition may be formed by associating a particular digital identifier such as a digital signature with bundles within a partition .

Partition may be used to protect gateway from malicious bundles . For example a home automation interface bundle which is used to control the lights in a premises may be placed in a partition and the partition configured to forbid access to the home automation interface bundle by other bundles without permission from user . By protecting the home automation interface bundle from unknown bundles a decreased chance of a malicious bundle negatively impacting the comfort of the user for example cycling the lights in a house on and off at high speed is achieved.

In one embodiment gateway is based on OSGi. OSGi typically allows bundles to be installed in the OSGi system and supports communication between bundles . However OSGi places minimal security and access controls on bundles . As computers have demonstrated malicious programmers are both creative and plentiful. Partitions provides gateway with increased protection from malicious programmers by forbidding access to particular bundles.

A digital signature comprises a mathematically generated unique value which may be uniquely associated with an item. For example cryptographic methods may be used to generate a unique value based on the characteristics of a particular bundle . For another example a company may further identify a particular bundle by applying further cryptographic transformations to the unique value associated with a particular bundle . In one embodiment public key private key encryption techniques may be applied to the unique value. The unique value associated with the bundle may be encrypted using the private key associated with the company so that the public key associated with the company can be applied to the encrypted unique value to determine whether the company has actually authorized that particular bundle .

In operation bundles are installed in OSGi layer . The execution of bundles by OSGi layer is supported by Java virtual machine in operating system .

Bundles may provide various types of functionality to user devices and and other bundles . In one embodiment bundles comprise a provisioning bundle a portal page bundle a billing bundle a profile bundle an authentication bundle a maintenance bundle a remote logging bundle an Application Programmer Interface bundle and one or more authorized third party bundles . In one embodiment the provisioning bundle the portal page bundle the billing bundle the profile bundle the authentication bundle the maintenance bundle the remote logging bundle and the Application Programmer Interface bundle are termed utility bundles. Bundles may also comprise one or more unauthorized bundles .

Provisioning bundle comprises a module operable to download data from portal server . More specifically provisioning bundle may retrieve utility bundles authorized third party bundles and updates to bundles from portal server using web server . In general provisioning comprises retrieving bundles from a remote server to a local device and handling the retrieved bundle at the local device. For example handling the retrieved data may comprise installing and starting the retrieved bundles at gateway . For another example retrieving bundles from a remote server may comprise determining bundles available at the remote server which are not presently available at the local device and retrieving bundles at the remote server which are not presently available at the local device. Provisioning bundle may receive notifications from and or at regular intervals inquire of portal server for updates or upgrades to bundles . Individual bundles may provide for a self update mechanism or may be updated by provisioning bundle at regular or irregular intervals or upon request from user .

Portal page bundle provides a user interface to user at customer premises to allow the user to interact with bundles . In addition in one embodiment authorized third party bundles provide a user interface API for use by portal page bundle.

Portal page bundle may also provide the capability to reformat data depending on the type of client device on which the data is to be displayed. For example when client device is a Personal Digital Assistant PDA with a monochrome screen portal page bundle may remove graphics and convert colors for use on a monochrome display. In general portal page bundle may use knowledge regarding the size type speed capabilities and other information associated with client devices to reformat change and otherwise modify data provided to client devices . For example portal page bundle may determine that a user is communicating with gateway from a remote location using a PDA. Portal page bundle may reformat a home page associated with the user for proper display on the PDA. For example the reformatting may include removing and or changing elements on the home page for display on the PDA.

Billing bundle provides the capability for authorized third party bundles to bill user for services provided by those bundles . More specifically billing bundle may provide a particular billing service application programming interface API and associated support functionality for use by bundles . Billing bundle may access billing portion at application server .

Profile bundle supports customization of gateway by users at customer location . More specifically profile bundle may track preferences associated with customer location preferences associated with users in the customer location the location of the customer location installed devices at customer location and other information. In addition profile bundle may communicate with portal server so that portal server can provide profile persistence to users and location . In one embodiment profile bundle communicates with portal server across network by accessing Enterprise Java Beans based functionality in profile portion at application server . Profile portion then accesses database where the preferences are stored in a persistent storage.

Authentication bundle supports authorization and authentication of users . More specifically authentication bundle provides authentication functions by supporting the determination and verification of the identity of user. For example authentication bundle may use passwords smart cards magnetic stripe cards fingerprints retinal scans and other suitable biometric knowledge and or item based authentication schemes either alone or in suitable combination. In addition authentication bundle provides authorization services to other bundles within the partition in gateway . More specifically once it has been determined that user is whom user claims to be the portal page bundle may need to determine whether user is allowed to access a particular bundle . For example authentication bundle may consult an access control list ACL associated with a particular bundle to determine whether a particular user is allowed to access that bundle . In general authentication bundle may use a variety of suitable techniques for authenticating and authorizing users .

Application Programmer Interface bundle comprises software modules that define functionality in utility services that consumer services can access software modules that define functionality that consumer services must have to interact with utility services and software modules that provide interaction between consumer and utility services.

Authorized third party bundles comprise other bundles which are authorized to use particular services such as provisioning bundle portal page bundle billing bundle profile bundle maintenance bundle remote logging bundle and authentication bundle in partition . For example authorized third party bundles may include functionality for controlling devices when the devices are light switches climate controls and other electronic and mechanical equipment. Authorized third party bundles contain authorized third party services which must implement specific API interfaces contained in the Application Programmer Interface bundle . Services which implement specific API interfaces and provide functionality to users are called consumer services . Other third party bundles comprise services which are not authorized to use bundles in partition . In general utility services and consumer services communicate with each other. For example a consumer service may send a request to one of the utility services and receive a response from the utility service.

Partition provides controlled access to bundles . More specifically unauthorized bundles should be restricted from passing information to receiving information from providing services to or requesting services from bundles which are inside partition . The same restrictions may apply between authorized bundles inside partition and unauthorized bundles . Referring to the example of authorized bundles may be allowed to access profile bundle because authorized bundle is within partition . In contrast unauthorized bundle may be forbidden from accessing profile bundle because unauthorized bundle is outside of partition .

Remote logging bundle provides logging services to bundles . Bundle stores and retrieves logged events actions and other information from services and bundles . Bundle further provides support for remote access to portal server for logging information.

Maintenance bundle provides maintenance services and capabilities to gateway . For example maintenance bundle may periodically test the network environment provide unique global sequence numbers and manage failed calls over the network. In one embodiment maintenance bundle may save one or more software objects encapsulating a method called by functionality of a service on storage when a problem is detected or the method is prevented from completing. When for example communication with portal server is restored maintenance service uses the saved software objects to resume and complete the originally called method. Also upon request maintenance bundle may return network status information to other bundles allowing other bundles to properly handle loss of use of network . Returning to the stock trading program example previously described the lack of an active network connection could cause the stock trading bundle to refuse to accept a trade request and instead suggest that the user place a telephone call directly to the brokerage house. In general maintenance bundle provides information regarding network status to bundles and services so that the bundles and services may respond appropriately to the loss of the network.

Gateway is further operable to provide one or more services . Services are provided by particular bundles . More specifically services comprise functionality and capabilities that may be used by other services to accomplish some task. A particular bundle may provide one or more services . As shown in the portal page bundle contains a portal page service a provisioning bundle containing the provisioning service . These utility bundles contain the utility services. Authorized bundles contain authorized services which are usually consumer services .

A bundle may have an associated bundle digital identifier . Respective bundle digital identifiers may be respectively associated with one or more bundles . Bundle digital identifier comprises a unique pattern of data associated with a particular bundle that may be used to authenticate the identity of the particular bundle . For example digital identifiers may be generated by applying a private key of a public key private key encryption system to the associated bundle .

The digital identifiers may be generated by applying key to bundles . More specifically key may be used with a cryptographic algorithm to generate digital identifiers . For example key may comprise a private key associated with a public key private key encryption system. For another example key may comprise an encryption key used with a symmetric encryption system such as Blowfish or Twofish.

In one embodiment gateway may use the digital identifiers to support partition . For example a partition may be configured to grant access only to bundles that have a particular associated digital identifier.

In the embodiment of gateway provides the portal service a provisioning service a billing service a profile service an authentication service a remote logging service a maintenance service which are utility services and one or more authorized third party services providing the consumer services.

Provisioning service is associated with provisioning bundle . Provisioning service may be invoked by the OSGi layer at gateway startup. Provisioning service operates to contact the portal server to retrieve utility bundles and authorized third party bundles and updates from the web server .

Billing service is provided by billing bundle . Billing service may be called by other services inside the partition . Billing service communicates with billing portion at portal server in order to provide support for billing users . For example user may have signed up for various services provided by portal server and billing service may be used to generate an invoice to user for the costs of those services.

Profile service is provided by profile bundle . Profile service may be called by other services inside the partition . Profile service operates to retrieve and store profile information such as local customization for users and the location in database at portal server and locally in storage . For example profile server may be used to store a unique identifier associated with each user the user s name and the address of customer location . In addition profile service may be used by other services to store personalization and customization information for the other service . For example profile service may provide an API for use by other services .

Profile service may contain preferences used to provide customized presentations of information to users . More specifically each user at customer location may have a customized portal page presenting various information. For example a particular user may indicate various sports related web sites that are of interest to that user that are to be displayed to that user when that user logs into a device . A user may have one or more pre set settings for devices . For example when a user indicates that the user is in the living room the volume for a home theater system controlled by gateway may be automatically set. For another example when a user may indicate particular TV programs which the user is interested in and specify that if the user is not logged in at home and at the TV that gateway should activate a VCR controllable by gateway to record the TV programs. For yet another example various users in a given premises may have different preferred TV programs and profile service may change a program list displayed on the TV based on the user currently logged in at the TV. In addition a parent may use profile service to restrict the TV channels available to a child when the child is logged in at the TV. In general profile service may store suitable settings for devices and for one or more users .

Authentication service is provided by authentication bundle . Authentication service may be called by other services including portal page service . Authentication service operates to authenticate the identity of user and to determine whether user is authorized is access a particular service or bundle .

Portal page service is provided by portal page bundle . Portal service operates to support selection and or aggregation of user interfaces provided by other services .

The portal page service provides a user interface for consumer services in gateway which is automatically customized according to which consumer services are present in OSGi layer what device is used to access the portal and which user is accessing the portal. In one embodiment the user interface comprises a portal page . Portal page is customized according to the services present because each consumer service in an authorized third party bundle provides its own user interface UI to the portal in a manner specified by the Application Programmer Interface API bundle . Consumer services in authorized third party bundles implement specific API interfaces. More specifically the API specifies the rules and interface associated with accessing functionality available from API bundle and portal service .

Portal page service controls the functionality of the consumer services but remains independent of their code. Stated another way the portal page service can control any service which exposes its capabilities information and interfaces collectively methods in the manner specified by Application Programmer Interface API bundle without having the consumer service s methods specifically already written into the code of the portal page service. Thus the portal page service is dynamic and able to display and control a changing collection of consumer services . In contrast a typical user interface on a web page is coded to provide control for a fixed group of services and is static. The static approach is inappropriate for portal page because any changes to consumer services such additions or deletions to the list of the consumer services in the portal page would require recoding and redistribution of portal page service to all of gateways .

The dynamic design of portal page service enables consumer services written or provisioned after the deployment of portal page service to work in the gateway . Consumer services can be added deleted or changed without changing portal service provided that consumer services continue to conform to the API provided by API bundle . The behavior of portal page service allows gateways to support a collection of consumer services which may change with time and differ from gateway to gateway.

Portal page service provides the dynamic behavior through indirect invocation of functionality by consumer services . When portal page service is written the consumer services which will have their functions invoked are unknown and are determined only when portal page service runs in gateway .

In one embodiment portal page service invokes the methods in the consumer services using the dynamic capabilities of the Java programming language to display the user interface for a consumer service and use the functionality of a consumer service. In order to display the user interface gateway is searched for consumer services using the definitions in the API provided by API bundle . The functionality mandated for consumer services by the API is indirectly invoked to display the user interface for each consumer service installed in gateway . The invocation is indirect because when portal page service is installed in gateway portal page service has no prior knowledge of the specific consumer services in gateway . For example the indirect invocation may be achieved by using capabilities associated with the Java Reflection API which allows portal page service to interact with consumer services when portal page service is running in ways that were unknown when portal page service was originally compiled.

Once the user interface for a consumer service or services is displayed in the portal page generated by portal page service the functionality of a particular consumer service may be activated by the user using portal page service . A user activating a control in a user interface causes portal page to receive a message containing information about a specific function of a particular consumer service . The message is decoded in portal page service and information is extracted about what consumer service was activated and what function and associated parameters of that service should be initiated in response. The proper function is invoked by portal page service without portal page service having prior knowledge of the specific consumer services in the gateway.

In addition a user may log in at a given client device such as a computer or a PDA and portal service may present an appropriate web page based on the type and capabilities of device or user device . The web page presented may also be customized based on information associated with the user and managed by profile service . For example based on device portal service may recognize that user is using a PDA. Portal service may then present an interface appropriate for the small screens typically associated with PDAs. When user logs into the computer located in the office portal service may present a different interface to user because the user is now using a device with increased capabilities compared to the PDA. For either the computer based interface or the PDA based interface user may also be able to control climate control systems lighting and other appliances which communicate with gateway .

Remote logging service is provided by remote logging bundle . Remote logging service may be used by other services to store a log of events activities and other actions occurring at gateway at a remote location using portal server or another network based server. Logging service is provided by remote logging bundle and operates to store a local copy of events actions and other activities occurring at gateway in storage .

Then at step a user interface is displayed to user . More specifically the services may provide various user interfaces for use by users . Portal page service is responsible for integrating and managing the user interfaces provided by services to provide an integrated user interface for use by user . For example authorized third party services provide an API for user interfaces that is used by the portal page service and bundle to provide customer and user interfaces to user .

Proceeding to step portal page service determines which authorized service has been selected by user . Next at step portal page service invokes the appropriate method of the authorized service requested by the user. The selected service then performs the requested method and at step the results are displayed on an output device associated with user . For example if user has logged in on a PDA then the results are displayed in a format appropriate for the PDA. If user has logged in at a personal computer the results would be displayed in a format appropriate for the personal computer. Often the display capabilities of a PDA and a personal computer differ significantly. Portal page service may use the capabilities to reformat data based on the type of device being used before displaying the data. The method then returns to step to handle the selection of the next service by user .

At step portal page displays one or more user interfaces associated with found consumer services on portal page . Portal page formats the user interfaces based on client device used to display portal page . Next at step user actives one or more controls associated with the user interface for a consumer service . Then at step client device sends a data message to portal page service indicating the controls active by user . Next at step portal page service then extracts a service name a function and one or more parameters from the data message from client device . Proceeding to step portal page service invokes selected function on the indicated service such as one of the consumer services with the indicated parameters. Then at step the results are displayed to user on client device .

The method begins at decisional step where portal page service searches for a portal controller for a given user . For example the portal controller for the given user may be stored on storage . In one embodiment the portal controller comprises a software object respectively instantiated for each user that maintains the identity of user and calls methods in consumer services for that user .

If portal page service does not find a portal controller for user then the NO branch of decisional step leads to step . At step portal page service generates a new portal controller for user containing unique identity information for that user and retrieves a user profile from profile service for that user . If portal page service does find a portal controller for user then the YES branch of decisional step leads to step .

Next at step an identity associated with user is retrieved from the portal controller for that user . Next at step portal page service determines whether a user interface is to be displayed or if functionality has been invoked in a consumer service using the user interface associated with that consumer service at step . If a user interface is to be displayed then the DISPLAY branch leads to step . The user identity is then used to retrieve the user profile from the profile service at step and portal page service uses the user profile when displaying the user interface for the consumer service at step . The operation then ends.

If functionality has been invoked then the FUNCTION branch of decisional step leads to step . At step in the case of invocation of functionality in a consumer service the portal controller uses the identity of the user to retrieve the user profile from profile service . Next at step the portal controller uses the user profile to invoke the functionality on the consumer service at step . The operation then ends.

Proceeding to step new bundles are installed at gateway . More specifically provisioning service installs new bundles at gateway . Then at step services in bundles are started and register with the OSGi layer .

The method proceeds to step where the result determined by billing portion is returned to billing service . More specifically billing portion indicates to billing service whether or not the billing information has been successfully saved in database or has been rejected for some reason such as the identification of an invalid user.

At decisional step portal service asks the authentication service to determine whether authenticated user is authorized to use a service . More specifically authentication service may determine whether user is allowed to access the requested service . Authorization may be at a high level where access is granted or denied to gateway or at a low level where access granted or denied for a specific service. For example authentication service may consult an access control list to determine whether user is authorized to use the requested service . If authentication service determines that user does not have access to the requested service then the NO branch of decisional step leads to step . If authentication service determines that user is authorized to access the requested service then the YES branch of decisional step leads to step . At step the requested service is presented to the user .

The connected site system of the present invention provides the capability to allow multiple different devices in a home or business location to access the Internet. The connected site system further provides the capability to control various electronic devices and reformat information based on the display processing or other capabilities of the device. In addition the system of the present invention allows for the customization of the gateway for use by users at the location. For example the portal service may provide a web based interface to a user so that the user can control climate control systems appliances and other electronic devices at the location. The portal service may present an interface customized based on information associated with the user and the type of device on which the interface is being displayed.

The connected site system not only provides the capability to control devices within the premises but to communicate with the Internet. The gateway may automatically retrieve and install new capabilities for use by the user. In addition the gateway may upload information associated with the users to a remote portal server so that the customizations provided by the user are backed up in the case of failure of the gateway.

Other changes substitutions and alterations are also possible without departing from the spirit and scope of the present invention as defined by the following claims.

