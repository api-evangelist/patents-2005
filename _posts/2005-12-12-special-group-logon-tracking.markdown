---

title: Special group logon tracking
abstract: A method of generating a computer user activity log for a user belonging to a specially monitored group includes allowing a user to logon to a local computer. The local computer verifying the user account credentials and creating a user logon session. A token is created by the local computer for identification of any group membership with which the user associated and also having the user access privileges. The group information in the token is compared with a specially monitored group list. The specially monitored group list may be obtained from a domain server or may be configured locally. If the user has membership in the specially monitored group, then a special logon session is created and activities of the user are recorded.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07690036&OS=07690036&RS=07690036
owner: Microsoft Corporation
number: 07690036
owner_city: Redmond
owner_country: US
publication_date: 20051212
---
Today modern operating systems require mechanisms for managing the identities and relationships of the distributed resources that make up network environments. A directory service provides a place to store information about network based entities such as applications files printers and people. It provides a consistent way to name describe locate access manage and secure information about these individual resources. A directory service acts as the main switchboard of the network operating system. It is the central authority that manages the identities and brokers the relationships between these distributed resources enabling them to work together. Because a directory service supplies these fundamental network operating system functions it must be tightly coupled with the management and security mechanisms of the operating system to ensure the integrity and privacy of the network. It also plays a critical role in an organization s ability to define and maintain the network infrastructure perform system administration and control the overall user experience of a company s information systems.

Today directory services enable tracking the computer session activities of specific users. Commonly auditing capabilities in directory services can provide user session recording and tracking. Some of those users may be users of special interest or sensitive users . Sensitive users can be defined in many ways. Examples of sensitive users can be users new to an organization and or users that have special system resource permissions such as administrative users with broad capabilities and resource accesses.

Windows security administrators commonly want to track the activities of sensitive user accounts. These accounts are often logically organized into Windows software groups . The Windows software auditing feature does not have a facility for tracking user accounts by group membership it only tracks user accounts individually. In an environment with a large number of user accounts such as is found in most large networks it is difficult to locate only the events involving these sensitive accounts. This is true because an auditor policy can generate an extremely large amount of audit events such as user session activities and sifting through the audit records can be difficult and time consuming. Thus a technique to identify audit records of some sensitive users is desirable.

One existing technique to track the activities of a specific group of users is to enumerate group membership of sensitive groups at some point in time and identify events for the accounts which were members of the group at the time of enumeration. This method has an inherent flaw group membership changes over time. One possible threat to network security is a rogue user that has broad levels of access to computer resources and attacks one or more of the resources but remains anonymous. For example a clever attacker can modify group membership log onto a network perform mischief and modify membership back before the next enumeration and thus avoid detection. One method of detection in this instance could be modification of the existing group detection method to search for events indicating group membership changes. Those changes could be taken into account in searching for malicious activity. But this modification would be extremely complex and fragile in a distributed environment. In addition clairvoyant knowledge of the malicious user in geographic and temporal terms may be necessary for a successful query of the log of all user activity to determine the identify of the malicious user. Therefore a more secure option is desirable.

This Summary is provided to introduce a selection of concepts in a simplified form that are further described below in the Detailed Description. This Summary is not intended to identify key features or essential features of the claimed subject matter nor is it intended to be used to limit the scope of the claimed subject matter.

A means to create audit records for specific groups of users also provides a reliable way to locate members of these groups in the audit trail and provides positive correlation with other related audit records in the audit trail. The method includes generating a special audit record for computer users that belong to specific groups identified by a system administrator. When a user with a valid account logs onto a computer a local token is generated that contains data concerning the user privileges and membership of the user in any group. The token is compared against a list of groups to be specially monitored. If the user is a member of one of the specially monitored group a special audit record is initialized having a locally unique identifier useful for tracking the user activities. The locally unique identifier is subsequently useful in locating other audit records of the activities of the user.

The computing device then begins generation of a login session step . The login session may include the generation of a data structure to record activities occurring with the newly accessed account. Identification of the user with one or more groups is then performed step . In one embodiment this step may be performed using the Windows Local Security Authority software function. The Local Security Authority maintains information about all aspects of local security on a system. In this instance the Local Security Authority assembles a list of groups to which the logged on account belongs. This information may be stored locally or may be acquired remotely. For example in one embodiment the Local Security Authority may acquire this information from a domain controller or server that services the local machine.

The groups to which the account belongs may be generally be input by a system administrator or auditor function. The list of groups may include sensitive groups or groups of particular interest for monitoring. These groups may be created deleted or modified by a system administrator and stored in the audit policy stores. In one embodiment the Active Directory software package maintains a registry file or database that contains the listing of groups and their individual membership. This membership can change over time as members are added or deleted to from various groups.

After the user is identified as being a member of one or more groups the local computing device creates a token step . The token may take several forms. In one embodiment the token is a cache that contains information for access control to the resources available to the user as a result of his logon privileges. The token is assigned to the logon session for the user account. Thus the token is unique to the logon session. In one embodiment the token and logon session is uniquely identified by a locally unique identifier. A locally unique identifier is a 64 bit value that is guaranteed to be unique on the operating system that generated it until the system is restarted. In one embodiment the data structure of the token generated by the local computing machine may store the list of groups in which the logged in account user has membership.

A special group logon check is performed step to check the logged on user group membership against the list of sensitive or special groups in the audit policy. In one embodiment the local computer may access a list provided by a domain server to assess if the user is a member of a specially monitored group. If one of the groups which the user is a member matches the audit policy sensitive group intended for monitoring then a new audit record is created. The new audit record identifies such items as the user identification the specially monitored group the locally unique identifier the login session and the users activities. Following the initiation of a new audit record activities of the logged in user are recorded step .

The new audit record can be accessed at a later time by a system administrator or auditor and may be easily searched. In one embodiment if a malicious user is identified using the special group identification other records may be searched more easily now that the identity of the malicious user is known. Other events in the user account may then be examined to further inform the system administrator or auditor of activities by the identified user.

Although not required embodiments of the invention can also be implemented via an operating system for use by a developer of services for a device or object and or included within application software. Software may be described in the general context of computer executable instructions such as program modules being executed by one or more computers such as client workstations servers or other devices. Generally program modules include routines programs objects components data structures and the like that perform particular tasks or implement particular abstract data types. Typically the functionality of the program modules may be combined or distributed as desired in various embodiments. Moreover those skilled in the art will appreciate that various embodiments of the invention may be practiced with other computer configurations. Other well known computing systems environments and or configurations that may be suitable for use include but are not limited to personal computers PCs automated teller machines server computers hand held or laptop devices multi processor systems microprocessor based systems programmable consumer electronics network PCs appliances lights environmental control elements minicomputers mainframe computers and the like. Embodiments of the invention may also be practiced in distributed computing environments where tasks are performed by remote processing devices that are linked through a communications network bus or other data transmission medium. In a distributed computing environment program modules may be located in both local and remote computer storage media including memory storage devices and client nodes may in turn behave as server nodes.

With reference to an exemplary system for implementing an embodiment of the invention includes a general purpose computing device in the form of a computer system . Components of computer system may include but are not limited to a processing unit a system memory and a system bus that couples various system components including the system memory to the processing unit . The system bus may be any of several types of bus structures including a memory bus or memory controller a peripheral bus and a local bus using any of a variety of bus architectures. By way of example and not limitation such architectures include Industry Standard Architecture ISA bus Micro Channel Architecture MCA bus Enhanced ISA EISA bus Video Electronics Standards Association VESA local bus and Peripheral Component Interconnect PCI bus also known as Mezzanine bus .

Computer system typically includes a variety of computer readable media. Computer readable media can be any available media that can be accessed by computer system and includes both volatile and nonvolatile media removable and non removable media. By way of example and not limitation computer readable media may comprise computer storage media and communication media. Computer storage media includes volatile and nonvolatile removable and non removable media implemented in any method or technology for storage of information such as computer readable instructions data structures program modules or other data. Computer storage media includes but is not limited to Random Access Memory RAM Read Only Memory ROM Electrically Erasable Programmable Read Only Memory EEPROM flash memory or other memory technology Compact Disk Read Only Memory CDROM compact disc rewritable CDRW digital versatile disks DVD or other optical disk storage magnetic cassettes magnetic tape magnetic disk storage or other magnetic storage devices or any other medium which can be used to store the desired information and which can accessed by computer system . Communication media typically embodies computer readable instructions data structures program modules or other data in a modulated data signal such as a carrier wave or other transport mechanism and includes any information delivery media. The term modulated data signal means a signal that has one or more of its characteristics set or changed in such a manner as to encode information in the signal. By way of example and not limitation communication media includes wired media such as a wired network or direct wired connection and wireless media such as acoustic RF infrared and other wireless media. Combinations of any of the above should also be included within the scope of computer readable media.

The system memory includes computer storage media in the form of volatile and or nonvolatile memory such as read only memory ROM and random access memory RAM . A basic input output system BIOS containing the basic routines that help to transfer information between elements within computer system such as during start up is typically stored in ROM . RAM typically contains data and or program modules that are immediately accessible to and or presently being operated on by processing unit . By way of example and not limitation illustrates operating system application programs other program modules and program data .

The computer system may also include other removable non removable volatile nonvolatile computer storage media. By way of example only illustrates a hard disk drive that reads from or writes to non removable nonvolatile magnetic media a magnetic disk drive that reads from or writes to a removable nonvolatile magnetic disk and an optical disk drive that reads from or writes to a removable nonvolatile optical disk such as a CD ROM CDRW DVD or other optical media. Other removable non removable volatile nonvolatile computer storage media that can be used in the exemplary operating environment include but are not limited to magnetic tape cassettes flash memory cards digital versatile disks digital video tape solid state RAM solid state ROM and the like. The hard disk drive is typically connected to the system bus through a non removable memory interface such as interface and magnetic disk drive and optical disk drive are typically connected to the system bus by a removable memory interface such as interface .

The drives and their associated computer storage media discussed above and illustrated in provide storage of computer readable instructions data structures program modules and other data for the computer system . In for example hard disk drive is illustrated as storing operating system application programs other program modules and program data . Note that these components can either be the same as or different from operating system application programs other program modules and program data . Operating system application programs other program modules and program data are given different numbers here to illustrate that at a minimum they are different copies. A user may enter commands and information into the computer system through input devices such as a keyboard and pointing device commonly referred to as a mouse trackball or touch pad. Other input devices not shown may include a microphone joystick game pad satellite dish scanner or the like. These and other input devices are often connected to the processing unit through a user input interface that is coupled to the system bus but may be connected by other interface and bus structures such as a parallel port game port or a universal serial bus USB . A monitor or other type of display device is also connected to the system bus via an interface such as a video interface which may in turn communicate with video memory not shown . In addition to monitor computer systems may also include other peripheral output devices such as speakers and printer which may be connected through an output peripheral interface .

The computer system may operate in a networked or distributed environment using logical connections to one or more remote computers such as a remote computer . The remote computer may be a personal computer a server a router a network PC a peer device or other common network node and typically includes many or all of the elements described above relative to the computer system although only a memory storage device has been illustrated in . The logical connections depicted in include a local area network LAN and a wide area network WAN but may also include other networks buses. Such networking environments are commonplace in homes offices enterprise wide computer networks intranets and the Internet.

When used in a LAN networking environment the computer system is connected to the LAN through a network interface or adapter . When used in a WAN networking environment the computer system typically includes a modem or other means for establishing communications over the WAN such as the Internet. The modem which may be internal or external may be connected to the system bus via the user input interface or other appropriate mechanism. In a networked environment program modules depicted relative to the computer system or portions thereof may be stored in the remote memory storage device. By way of example and not limitation illustrates remote application programs as residing on memory device . It will be appreciated that the network connections shown are exemplary and other means of establishing a communications link between the computers may be used.

Various distributed computing frameworks have been and are being developed in light of the convergence of personal computing and the Internet. Individuals and business users alike are provided with a seamlessly interoperable and Web enabled interface for applications and computing devices making computing activities increasingly Web browser or network oriented.

For example MICROSOFT s .NET platform available from Microsoft Corporation includes servers building block services such as Web based data storage and downloadable device software. While exemplary embodiments herein are described in connection with software residing on a computing device one or more portions of an embodiment of the invention may also be implemented via an operating system application programming interface API or a middle man object between any of a coprocessor a display device and a requesting object such that operation may be performed by supported in or accessed via all of .NET s languages and services and in other distributed computing frameworks as well.

As mentioned above while exemplary embodiments of the invention have been described in connection with various computing devices and network architectures the underlying concepts may be applied to any computing device or system in which it is desirable to implement a group selectable mechanism for generating audit records. Thus the methods and systems described in connection with embodiments of the present invention may be applied to a variety of applications and devices. While exemplary programming languages names and examples are chosen herein as representative of various choices these languages names and examples are not intended to be limiting. One of ordinary skill in the art will appreciate that there are numerous ways of providing object code that achieves the same similar or equivalent systems and methods achieved by embodiments of the invention.

The various techniques described herein may be implemented in connection with hardware or software or where appropriate with a combination of both. Thus the methods and apparatus of the invention or certain aspects or portions thereof may take the form of program code i.e. instructions embodied in tangible media such as floppy diskettes CD ROMs hard drives or any other machine readable storage medium wherein when the program code is loaded into and executed by a machine such as a computer the machine becomes an apparatus for practicing the invention.

While aspects of the present invention has been described in connection with the preferred embodiments of the various figures it is to be understood that other similar embodiments may be used or modifications and additions may be made to the described embodiment for performing the same function of the present invention without deviating therefrom. Furthermore it should be emphasized that a variety of computer platforms including handheld device operating systems and other application specific operating systems are contemplated especially as the number of wireless networked devices continues to proliferate. Therefore the claimed invention should not be limited to any single embodiment but rather should be construed in breadth and scope in accordance with the appended claims.

