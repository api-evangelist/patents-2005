---

title: Long-life digital certification for publishing long-life digital content or the like in content rights management system or the like
abstract: A digital certificate is employed to produce a digital signature for a digital construct. In the digital certificate is set forth a certificate validity period defining for the digital certificate a time period during which the digital certificate is to be honored as valid for producing digital signatures, and a signature validity period defining for each digital signature produced based on the digital certificate a time period during which the digital signature is to be honored as valid.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07549051&OS=07549051&RS=07549051
owner: Microsoft Corporation
number: 07549051
owner_city: Redmond
owner_country: US
publication_date: 20050310
---
The present invention relates to a digital content distribution or rights management RM system whereby access to digital content is provided to one or more users by an authorized content distributor. More particularly the invention relates to providing a long life digital certificate when publishing the content or the like such that authenticity of the content can be validated according to the certificate for an extended period of time.

Digital content distribution is widely used to distribute software data and documents where the origin and authenticity of the data is an important consideration for the receiving party. Rights management RM and enforcement is highly desirable in connection with digital content such as digital audio digital video digital text digital data digital multimedia etc. where such digital content is to be distributed to one or more users. Digital content could be static such as a text document for example or it could be streamed such as the streamed audio video of a live event. Typical modes of distribution include tangible devices such as a magnetic floppy disk a magnetic tape an optical compact disk CD etc. and intangible media such as an electronic bulletin board an electronic network the Internet etc. Upon being received by the user such user renders the digital content with the aid of appropriate rendering software such as an audio player a text displayer etc. on a personal computer or other hardware.

In one scenario a digital content owner wishes to distribute digital content to many users or recipients in a form allowing the recipient to assess the origin and validity of the content. In such a scenario the content may be computer software or data. The content owner or publisher derives value from the use of its products but the recipients may be reluctant to use it without proof of its origin and integrity.

In another scenario a content owner or rights owner such as an author a publisher a broadcaster etc. wishes to distribute such digital content to each of many users or recipients in exchange for a license fee or some other consideration. In such scenario then the content may be an audio recording a multimedia presentation etc. and the purpose of the distribution is to generate the license fee. Such content owner given the choice would likely wish to restrict what the user can do with such distributed digital content. To do this they need to target a rendering device or software application that will enforce the desired restrictions. This requires the ability to generate a content license which 1 identifies the content 2 describes the desired use restrictions and 3 allows the rendering device or software to validate the license as coming from an authorized content owner.

The second scenario can be extended in a straightforward manner to encompass a content developer such as an employee in or member of an organization that wishes to distribute such digital content to one or more other employees or members in the organization or to other individuals outside the organization. Here the distribution of the content is more akin to organization based content sharing in a confidential or restricted manner as opposed to broad based distribution in exchange for a license fee or some other consideration.

In such extended second scenario then the content may be a document presentation spreadsheet database email or the like such as may be exchanged within an office setting and the content developer may wish to ensure that the content stays within the organization or office setting and is not rendered by non authorized individuals such as for example competitors or adversaries. Again such content developer wishes to restrict what a recipient can do with such distributed digital content. As before this requires the ability to generate a content license which 1 identifies the content 2 describes the desired use restrictions and 3 allows the rendering device or software to validate the license as coming from an authorized content owner.

As described in the preceding scenarios publication of digital content is likely to include digitally signing the content to produce a digital signature that can be employed to validate the content s owner and its integrity at some later point. Publication of such content may in addition or in the alternative include issuing a publishing license and or use license or the like for the content and digitally signing the issued license to produce a digital signature for similar purposes. In either situation and as is known authority to digitally sign may be granted from a higher authority to the publisher or licensor by way of issuance of a digital certificate from the higher authority where the digital certificate includes a public private cryptographic key pair and where the digital signature is based on the private key and validated based on the public key.

Thus the publisher or licensor attaches to the digital signature the digital certificate and perhaps a chain of certificates leading back to a root trust authority that is known to an entity that would validate the digital signature. In particular the entity would be in possession of a public key of the root trust authority and would employ same to validate a digital signature of a first root certificate in the chain. Assuming the signature of the root certificate does indeed validate a public key in the root certificate would be employed to validate the signature of the next certificate in the chain and so on until the signature of the last certificate in the chain is validated and the public key therein is then employed to validate the digital signature of the content or license.

In the prior art in the situation where a digital certificate is employed to publish content an issue exists in that the digital certificate and the private key and signature thereof have an expiration after which such certificate and private key and signature thereof are not guaranteed by the issuer. For example in the case of an X.509 digital certificate a date is specified in the certificate after which the signature the private key and the certificate expires. Reasons for such an expiration are many and varied but typically are based on the fact that the issuer of the certificate is not required to guarantee the certificate after the expiration thereof and accordingly is not responsible for performing ministerial tasks with regard to the certificate such as possible revocation if need be. At any rate an expired certificate from an issuer usually is replaced by a newer certificate from the issuer likely as part of a retail transaction where the issuer receives some sort of remuneration for the newer certificate.

Thus from the point of view of the issuer of a certificate an issued certificate should expire after a relatively short period of time both to lessen the liability of the issuer and to provider the issuer with an amount of revenue from issuing a newer certificate. However from the point of view of a publisher of digital content using such a certificate to digitally sign the content the certificate should remain valid for an extended period of time if in fact the certificate expires at all especially inasmuch as an expired certificate typically cannot be employed to validate and render content in an RM system. Of course based on the tension between such two opposing points of view a digital certificate usually expires in some period of time on the order of six months to two or three years.

Nevertheless even such a period of time is oftentimes not long enough for the consumer of the content. For example commercial software distributed over the Internet may have value to customers for five years or more. For digital content such as a musical recording with a license that provides for use of the content in perpetuity the consumer would not wish to have the usefulness of such license diminished because the license or the content is validated based on a digital certificate that expires after a year or two.

To alleviate such a situation and in the prior art a work around solution has been developed whereby use of a certificate that expires also requires an additional signature based on another root trust authority where the additional signature is based on a digital certificate from the another root trust authority that never expires. However doing so requires that the another root trust authority assume the aforementioned liabilities of guaranteeing the certificate in perpetuity and performing ministerial tasks with regard to the certificate in perpetuity. As may be appreciated such liabilities can be quite burdensome and should be avoided if at all possible. In addition such a root authority becomes a single point of failure whose compromise would prevent validation of digital signatures on very large bodies of content potentially from multiple owners or publishers.

Accordingly a need exists for a long life digital certificate for long life digital content or the like whereby the certificate can be employed to validate the content for a relatively long period of time but where the liabilities and costs associated with issuing the certificate and maintaining information on its validity are mitigated. In particular a need exists for such a certificate where the time during which a signature based on the certificate may be created and hence the associated private key used is separated out from the expiration of the certificate. More particularly a need exists for such a certificate where the validity of the certificate and ability to use same to validate a digital signature has a relatively longer life span while the time during which a digital signature may be created and hence the private key used has a relatively shorter life span. In addition there are many instances where one would like to provide specific restrictions within the certificate governing what types of content may be signed. Thus even though the certificate and the private key thereof may be employed in the creation of digital signatures only for the relatively shorter life span the digital signature provided based on such certificate may be validated for the relatively larger life span.

The aforementioned needs are satisfied at least in part by the present invention in which a computer readable medium has stored thereon a digital structure defining a digital certificate for being employed to produce a digital signature for a digital construct. The digital certificate identifies the public key of a public private key pair associated therewith and controlled by the certificate owner. The private key is employed to produce the digital signature and the public key is employed to validate the digital signature. In the data structure a first field sets forth the public key associated with the digital certificate. In addition a second field sets forth a signature creation validity period defining for the digital certificate itself and the private key thereof a time period during which the private key may be used to create digital signatures which may be validated using the certificate. Also a third field separate from the second field sets forth a certificate validity period during which time the certificate is considered valid for the purpose of validating digital signatures produced using the associated private key. In essence a digital signature may be validated based on the certificate if the certificate is still valid according to the certificate validity period the signature was created during the signature creation validity period and the signed content matches any authorized content signature types set forth in the certificate.

Although not required the invention can be implemented via an application programming interface API for use by a developer and or included within the network browsing software which will be described in the general context of computer executable instructions such as program modules being executed by one or more computers such as client workstations servers or other devices. Generally program modules include routines programs objects components data structures and the like that perform particular tasks or implement particular abstract data types. Typically the functionality of the program modules may be combined or distributed as desired in various embodiments. Moreover those skilled in the art will appreciate that the invention may be practiced with other computer system configurations. Other well known computing systems environments and or configurations that may be suitable for use with the invention include but are not limited to personal computers PCs automated teller machines server computers hand held or laptop devices multi processor systems microprocessor based systems programmable consumer electronics network PCs minicomputers mainframe computers and the like. The invention may also be practiced in distributed computing environments where tasks are performed by remote processing devices that are linked through a communications network or other data transmission medium. In a distributed computing environment program modules may be located in both local and remote computer storage media including memory storage devices.

With reference to an exemplary system for implementing the invention includes a general purpose computing device in the form of a computer . Components of computer may include but are not limited to a processing unit a system memory and a system bus that couples various system components including the system memory to the processing unit . The system bus may be any of several types of bus structures including a memory bus or memory controller a peripheral bus and a local bus using any of a variety of bus architectures. By way of example and not limitation such architectures include Industry Standard Architecture ISA bus Micro Channel Architecture MCA bus Enhanced ISA EISA bus Video Electronics Standards Association VESA local bus and Peripheral Component Interconnect PCI bus also known as Mezzanine bus .

Computer typically includes a variety of computer readable media. Computer readable media can be any available media that can be accessed by computer and includes both volatile and nonvolatile media removable and non removable media. By way of example and not limitation computer readable media may comprise computer storage media and communication media. Computer storage media includes both volatile and nonvolatile removable and non removable media implemented in any method or technology for storage of information such as computer readable instructions data structures program modules or other data. Computer storage media includes but is not limited to RAM ROM EEPROM flash memory or other memory technology CDROM digital versatile disks DVD or other optical disk storage magnetic cassettes magnetic tape magnetic disk storage or other magnetic storage devices or any other medium which can be used to store the desired information and which can be accessed by computer . Communication media typically embodies computer readable instructions data structures program modules or other data in a modulated data signal such as a carrier wave or other transport mechanism and includes any information delivery media. The term modulated data signal means a signal that has one or more of its characteristics set or changed in such a manner as to encode information in the signal. By way of example and not limitation communication media includes wired media such as a wired network or direct wired connection and wireless media such as acoustic RF infrared and other wireless media. Combinations of any of the above should also be included within the scope of computer readable media.

The system memory includes computer storage media in the form of volatile and or nonvolatile memory such as read only memory ROM and random access memory RAM . A basic input output system BIOS containing the basic routines that help to transfer information between elements within computer such as during start up is typically stored in ROM . RAM typically contains data and or program modules that are immediately accessible to and or presently being operated on by processing unit . By way of example and not limitation illustrates operating system application programs other program modules and program data .

The computer may also include other removable non removable volatile nonvolatile computer storage media. By way of example only illustrates a hard disk drive that reads from or writes to non removable nonvolatile magnetic media a magnetic disk drive that reads from or writes to a removable nonvolatile magnetic disk and an optical disk drive that reads from or writes to a removable nonvolatile optical disk such as a CD ROM or other optical media. Other removable non removable volatile nonvolatile computer storage media that can be used in the exemplary operating environment include but are not limited to magnetic tape cassettes flash memory cards digital versatile disks digital video tape solid state RAM solid state ROM and the like. The hard disk drive is typically connected to the system bus through a non removable memory interface such as interface and magnetic disk drive and optical disk drive are typically connected to the system bus by a removable memory interface such as interface .

The drives and their associated computer storage media discussed above and illustrated in provide storage of computer readable instructions data structures program modules and other data for the computer . In for example hard disk drive is illustrated as storing operating system application programs other program modules and program data . Note that these components can either be the same as or different from operating system application programs other program modules and program data . Operating system application programs other program modules and program data are given different numbers here to illustrate that at a minimum they are different copies. A user may enter commands and information into the computer through input devices such as a keyboard and pointing device commonly referred to as a mouse trackball or touch pad. Other input devices not shown may include a microphone joystick game pad satellite dish scanner or the like. These and other input devices are often connected to the processing unit through a user input interface that is coupled to the system bus but may be connected by other interface and bus structures such as a parallel port game port or a universal serial bus USB .

A monitor or other type of display device is also connected to the system bus via an interface such as a video interface . A graphics interface such as Northbridge may also be connected to the system bus . Northbridge is a chipset that communicates with the CPU or host processing unit and assumes responsibility for accelerated graphics port AGP communications. One or more graphics processing units GPUs may communicate with graphics interface . In this regard GPUs generally include on chip memory storage such as register storage and GPUs communicate with a video memory . GPUs however are but one example of a coprocessor and thus a variety of co processing devices may be included in computer . A monitor or other type of display device is also connected to the system bus via an interface such as a video interface which may in turn communicate with video memory . In addition to monitor computers may also include other peripheral output devices such as speakers and printer which may be connected through an output peripheral interface .

The computer may operate in a networked environment using logical connections to one or more remote computers such as a remote computer . The remote computer may be a personal computer a server a router a network PC a peer device or other common network node and typically includes many or all of the elements described above relative to the computer although only a memory storage device has been illustrated in . The logical connections depicted in include a local area network LAN and a wide area network WAN but may also include other networks. Such networking environments are commonplace in offices enterprise wide computer networks intranets and the Internet.

When used in a LAN networking environment the computer is connected to the LAN through a network interface or adapter . When used in a WAN networking environment the computer typically includes a modem or other means for establishing communications over the WAN such as the Internet. The modem which may be internal or external may be connected to the system bus via the user input interface or other appropriate mechanism. In a networked environment program modules depicted relative to the computer or portions thereof may be stored in the remote memory storage device. By way of example and not limitation illustrates remote application programs as residing on memory device . It will be appreciated that the network connections shown are exemplary and other means of establishing a communications link between the computers may be used.

One of ordinary skill in the art can appreciate that a computer or other client device can be deployed as part of a computer network. In this regard the present invention pertains to any computer system having any number of memory or storage units and any number of applications and processes occurring across any number of storage units or volumes. The present invention may apply to an environment with server computers and client computers deployed in a network environment having remote or local storage. The present invention may also apply to a standalone computing device having programming language functionality interpretation and execution capabilities.

Distributed computing facilitates sharing of computer resources and services by direct exchange between computing devices and systems. These resources and services include the exchange of information cache storage and disk storage for files. Distributed computing takes advantage of network connectivity allowing clients to leverage their collective power to benefit the entire enterprise. In this regard a variety of devices may have applications objects or resources that may interact to implicate authentication techniques of the present invention for trusted graphics pipeline s .

It can also be appreciated that an object such as may be hosted on another computing device or . Thus although the physical environment depicted may show the connected devices as computers such illustration is merely exemplary and the physical environment may alternatively be depicted or described comprising various digital devices such as PDAs televisions MP3 players etc. software objects such as interfaces COM objects and the like.

There are a variety of systems components and network configurations that support distributed computing environments. For example computing systems may be connected together by wireline or wireless systems by local networks or widely distributed networks. Currently many of the networks are coupled to the Internet which provides the infrastructure for widely distributed computing and encompasses many different networks.

In home networking environments there are at least four disparate network transport media that may each support a unique protocol such as Power line data both wireless and wired voice e.g. telephone and entertainment media. Most home control devices such as light switches and appliances may use power line for connectivity. Data Services may enter the home as broadband e.g. either DSL or Cable modem and are accessible within the home using either wireless e.g. HomeRF or 802.11b or wired e.g. Home PNA Cat 5 even power line connectivity. Voice traffic may enter the home either as wired e.g. Cat 3 or wireless e.g. cell phones and may be distributed within the home using Cat 3 wiring. Entertainment media may enter the home either through satellite or cable and is typically distributed in the home using coaxial cable. IEEE 1394 and DVI are also emerging as digital interconnects for clusters of media devices. All of these network environments and others that may emerge as protocol standards may be interconnected to form an intranet that may be connected to the outside world by way of the Internet. In short a variety of disparate sources exist for the storage and transmission of data and consequently moving forward computing devices will require ways of protecting content at all portions of the data processing pipeline.

The Internet commonly refers to the collection of networks and gateways that utilize the TCP IP suite of protocols which are well known in the art of computer networking. TCP IP is an acronym for Transport Control Protocol Interface Program. The Internet can be described as a system of geographically distributed remote computer networks interconnected by computers executing networking protocols that allow users to interact and share information over the networks. Because of such wide spread information sharing remote networks such as the Internet have thus far generally evolved into an open system for which developers can design software applications for performing specialized operations or services essentially without restriction.

Thus the network infrastructure enables a host of network topologies such as client server peer to peer or hybrid architectures. The client is a member of a class or group that uses the services of another class or group to which it is not related. Thus in computing a client is a process i.e. roughly a set of instructions or tasks that requests a service provided by another program. The client process utilizes the requested service without having to know any working details about the other program or the service itself. In a client server architecture particularly a networked system a client is usually a computer that accesses shared network resources provided by another computer e.g. a server. In the example of computers etc. can be thought of as clients and computer etc. can be thought of as the server where server etc. maintains the data that is then replicated in the client computers etc.

A server is typically a remote computer system accessible over a remote network such as the Internet. The client process may be active in a first computer system and the server process may be active in a second computer system communicating with one another over a communications medium thus providing distributed functionality and allowing multiple clients to take advantage of the information gathering capabilities of the server.

Client and server communicate with one another utilizing the functionality provided by a protocol layer. For example Hypertext Transfer Protocol HTTP is a common protocol that is used in conjunction with the World Wide Web WWW . Typically a computer network address such as a Universal Resource Locator URL or an Internet Protocol IP address is used to identify the server or client computers to each other. The network address can be referred to as a Universal Resource Locator address. For example communication can be provided over a communications medium. In particular the client and server may be coupled to one another via TCP IP connections for high capacity communication.

Thus illustrates an exemplary networked or distributed environment with a server in communication with client computers via a network bus in which the present invention may be employed. In more detail a number of servers Oa etc. are interconnected via a communications network bus which may be a LAN WAN intranet the Intemet etc. with a number of client or remote computing devices or objects etc. such as a portable computer hand held computer thin client networked appliance or other device such as a VCR TV oven light heater and the like in accordance with the present invention. It is thus contemplated that the present invention may apply to any computing device in connection with which it is desirable to process store or render secure content from a trusted source.

In a network environment in which the communications network bus is the Internet for example the servers can be Web servers with which the clients etc. communicate via any of a number of known protocols such as HTTP. Servers may also serve as clients as may be characteristic of a distributed computing environment. Communications may be wired or wireless where appropriate. Client devices may or may not communicate via communications network bus and may have independent communications associated therewith. For example in the case of a TV or VCR there may or may not be a networked aspect to the control thereof. Each client computer and server computer may be equipped with various application program modules or objects and with connections or access to various types of storage elements or objects across which files may be stored or to which portion s of files may be downloaded or migrated. Thus the present invention can be utilized in a computer network environment having client computers etc. that can access and interact with a computer network bus and server computers etc. that may interact with client computers etc. and other devices and databases .

In a network environment in which the communications network bus is the Internet for example the servers can be Web servers with which the clients etc. communicate via any of a number of known protocols such as HTTP. Servers may also serve as clients as may be characteristic of a distributed computing environment. Communications may be wired or wireless where appropriate. Client devices may or may not communicate via communications network bus and may have independent communications associated therewith. For example in the case of a TV or VCR there may or may not be a networked aspect to the control thereof. Each client computer and server computer may be equipped with various application program modules or objects and with connections or access to various types of storage elements or objects across which files may be stored or to which portion s of files may be downloaded or migrated. Thus the present invention can be utilized in a computer network environment having client computers etc. that can access and interact with a computer network bus and server computers etc. that may interact with client computers etc. and other devices and databases .

As is known and referring now to rights management RM and enforcement is highly desirable in connection with digital content such as digital audio digital video digital text digital data digital multimedia etc. where such digital content is to be distributed to users. Upon being received by the user such user renders the digital content with the aid of an appropriate rendering device such as a media player text displayer etc. on a personal computer or the like.

Typically a content owner or developer hereinafter owner distributing such digital content wishes to restrict what the user can do with such distributed digital content . For example the content owner may wish to restrict the user from copying and re distributing such content to a second user or may wish to allow distributed digital content to be rendered only a limited number of times only for a certain total time only on a certain type of machine only on a certain type of rendering platform only by a certain type of user etc.

However after distribution has occurred such content owner has very little if any control over the digital content . An RM system then allows the controlled rendering of arbitrary forms of digital content where such control is flexible and definable by the content owner of such digital content. Typically content is distributed to the user in the form of a package by way of any appropriate distribution channel. The digital content package as distributed may include the digital content encrypted with a symmetric encryption decryption key KD i.e. KD CONTENT as well as other information identifying the content how to acquire a license for such content etc.

The trust based RM system allows an owner of digital content to specify license rules that must be satisfied before such digital content is allowed to be rendered on a user s computing device . Such license rules can include the aforementioned temporal requirement and may be embodied within a digital license or use document hereinafter license that the user user s computing device hereinafter such terms are interchangeable unless circumstances require otherwise must obtain from the content owner or an agent thereof. Such license also includes the decryption key KD for decrypting the digital content perhaps encrypted according to a key decryptable by the user s computing device . As seen in such encrypting key is a public key of the user s computing device PU BB and the user s computing device presumably has the corresponding private key PR BB by which PU BB KD may be decrypted.

The content owner for a piece of digital content must trust that the user s computing device will abide by the rules and requirements specified by such content owner in the license i.e. that the digital content will not be rendered unless the rules and requirements within the license are satisfied. Preferably then the user s computing device is provided with a trusted component or mechanism that will not render the digital content except according to the license rules embodied in the license associated with the digital content and obtained by the user.

The trusted component typically has a license evaluator that determines whether the license is valid reviews the license rules and requirements in such valid license and determines based on the reviewed license rules and requirements whether the requesting user has the right to render the requested digital content in the manner sought among other things. As should be understood the license evaluator is trusted in the RM system to carry out the wishes of the owner of the digital content according to the rules and requirements in the license and the user should not be able to easily alter such trusted element for any purpose nefarious or otherwise.

As should be understood the rules and requirements in the license can specify whether the user has rights to render the digital content based on any of several factors including who the user is where the user is located what type of computing device the user is using what rendering application is calling the RM system the date the time etc. In addition the rules and requirements of the license may limit the license to a pre determined number of renderings or pre determined rendering time for example. Thus the trusted component may need to refer to a clock on the computing device .

The rules and requirements may be specified in the license according to any appropriate language and syntax. For example the language may simply specify attributes and values that must be satisfied DATE must be later than X e.g. or may require the performance of functions according to a specified script IF DATE greater than X THEN DO . . . e.g. .

Upon the license evaluator determining that the license is valid and that the user satisfies the rules and requirements therein the digital content can then be rendered. In particular to render the content the decryption key KD is obtained from the license and is applied to KD CONTENT from the content package to result in the actual content and the actual content is then in fact rendered.

As set forth above the license with PU BB KD in effect authorizes an entity in possession of PR BB to access KD and thereby access the content encrypted according to such KD presuming of course that the entity abides by all conditions as set forth in the license . As should be appreciated though other types of licenses may exists within the RM system .

For example it may be appreciated that in one scenario the author or publisher of the content may authorize a particular licensor to issue a license for corresponding content by providing the licensor with a publishing license . As may be appreciated such publishing license is similar to the license in that such publishing license likely includes the decryption key KD for decrypting the digital content here encrypted according to a public key of the licensor PU BB . Likewise the publishing license likely includes the rules and requirements for rendering the content . Here however such rules and requirements are to be inserted into the license as issued by the licensor and are not especially applicable to such licensor .

Note though that the publishing license may indeed include other rules and requirements that are indeed applicable to the licensor . Accordingly the licensor should include a trusted component with a license evaluator in a manner akin to the user s computing device .

Although the present invention is applicable with respect to content and licenses from the aforementioned RM system it is to be appreciated that such present invention is not in fact limited to the environment of such RM system . Instead such RM system merely sets forth one particular environment where a digital certificate of the present invention is applicable. In particular and significantly each type of license etc. as proffered typically includes a digital signature for authentication validation purposes. Likewise other forms of digital constructs such as a piece of digital content may also have such a digital signature for authentication validation purposes.

As should be known such a digital signature is typically constructed based on a first key from a pair of asymmetric keys for example by performing some sort of hash on the underlying data to which the signature is attached and then encrypting the hash with the first key. Thereafter the signature is validated by applying the second key from the pair of asymmetric keys again for example by decrypting the encrypted hash and comparing the decrypted hash to another hash of the underlying data to which the signature is attached. If the hashes match it can be presumed that the underlying data has not been altered and the underlying construct therefore can be authenticated. Correspondingly if the hashes do not match it can be presumed that the underlying data has in fact been altered and the underlying data therefore can not be authenticated.

As may be appreciated and turning now to each digital signature is validated with reference to a digital certificate from a root trust authority or a series or chain of such certificates leading back to such a root trust authority. Notably each certificate has an associated public private key pair PU   PR   and includes a digital signature for authentication verification purposes and each signature is constructed based on a private key and validated according to a corresponding public key.

As may be appreciated in a chain of certificates leading from a root trust authority to a particular license etc. or piece of content or the like the root digital certificate from the root trust authority includes a digital signature based on a private key from the root trust authority PR ROOT and is validated based on a corresponding public key PU ROOT which is presumed to be available to the verifying entity. For each other digital certificate in the chain and for the license etc. or piece of content or the like at the end of the chain such other certificate or license etc. or piece of content or the like includes a digital signature based on a private key PR N 1 associated with the next certificate in the chain toward the root trust authority and is validated based on a corresponding public key PU N 1 .

Accordingly to validate a digital signature on a license etc. or a piece of content or the like a corresponding chain of certificates back to a root trust authority is found a corresponding public key of such root trust authority is found PU ROOT and the found public key of the root trust authority is employed to validate the signature of the root certificate . Assuming such validation succeeds a public key PU X for the next certificate in the chain is found in the root certificate and is employed to validate the signature of the next certificate in the chain. The process repeats until the signature of the last certificate in the chain is validated at which point a public key PU 1 is found in such last certificate and employed to validate the signature of the license etc. or piece of content or the like. Of course if the validation of any signature fails the process ends and the license etc. or piece of content or the like is not authenticated. Typically a RM system will not honor a license etc a piece of digital content or the like that is not authenticated.

As was alluded to above the prior art in digital certificates may be best typified by the known X.509 certificate standard as promulgated by the International Telecommunication Union ITU . Among other things such X.509 certificate standard provides a particular certificate with only a single validity period. Thus such single provided validity period governs the time during which the private key PR   associated with such certificate can be employed to produce a digital signature on a next certificate in a chain or on a license or piece of content or other digital construct to which the certificate is attached. In addition such single provided validity period governs the time during which the produced signature is itself valid based on the signer s certificate. Thus in addition to validating a digital signature based on whether the hash therein matches the underlying data such digital signature may also be validated based on whether the single validity period set forth in the certificate employed to produce the signature has expired.

However and as was also alluded to above setting a single validity period in a certificate for both the certificate itself and the private key thereof and also for signatures produced based on the certificate results in a certificate and the private key thereof likely being defined to have a relatively short life span and by extension signatures produced based thereon also having the same relatively short life span. Accordingly in one embodiment of the present invention and as seen in a digital certificate is provided with at least a pair of validity periods including a certificate validity period defined for the certificate itself and the private key thereof and a signature validity period defined for signatures produced based on the certificate . Thus and in the present invention a digital signature is validated based on whether the hash therein matches the underlying data whether the signature was created during the signature creation validity period set forth in the certificate whether the signature is applied to content matching the authorized content types and whether the certificate validity period set forth in the certificate spans the current time.

As should be appreciated then with the present invention the certificate validity period within a certificate should be set to give a signature based on such certificate a relatively longer life span while the signature creation validity period within the certificate should be set to give a digital signature created based on the certificate a relatively shorter life span. Thus even though the certificate and the private key thereof may be employed only for the relatively shorter life span as the basis for a signature on another certificate or a license or piece of digital content or the like the signature provided can be validated based on such certificate for the relatively larger life span.

For example then it might be the case that a particular certificate specifies a signature creation validity period on the order of a year or so and authorizes the creation of signatures for audio and video media content while such certificate also specifies a certificate validity period on the order of ten years or so. Of course any appropriate validity period and corresponding expiration may be set without departing from the spirit and scope of the present invention. Note that a validity period may be specified according to both an expiration time and a start time. Thus it may be that a particular validity period is set for ten years starting on Mar. 1 2006 at 12 01 AM UTC and ending on Mar. 1 2016 at 12 01 AM UTC.

As a result of employing both a certificate validity period and a signature creation validity period and perhaps a content type restriction within a certificate the issuer of the certificate is satisfied that the issued certificate and associated private key will be used to create signatures for a relative short time and perhaps a restricted type of content both to lessen the liability of the issuer and to provide the issuer with an amount of revenue from issuing a newer certificate . Likewise a consumer of digital content or the like to which the certificate is associated is satisfied that signatures based on the certificate expire as late as possible if in fact at all especially inasmuch as an expired signature typically cannot be employed to validate and render content in an RM system .

It is to be appreciated that since the X.509 certificate standard as presently existing provides a particular X.509 certificate with only a single validity period such an X.509 certificate in its present form cannot be employed in connection with the present invention to set forth both a certificate validity period and a signature validity period. It would be straightforward to add appropriate semantics to the X.509 certificate standard.

Thus in one embodiment of the present invention the certificate is constructed according to an extensible Markup Language XML that defines a standard with both the certificate validity period and the signature validity period. Such an XML defined standard should be apparent to the relevant public and therefore need not be set forth herein in any detail. For example such XML defined standard may be the MPEG Rights Expression Language REL as approved by the International Organization for Standardization ISO which already has the requisite syntactic forms designed in.

In one embodiment of the present invention each of the signature creation validity period and optional authorized content types and the certificate validity period with regard to a certificate is set forth within the certificate as policy. Such policy may be any appropriate policy without departing from the spirit and scope of the present invention. For example such policy may express a particular principal a right granted a type of digital construct with which the right can be exercised and constraints on the right which normally would include one or more of the aforementioned certificate validity period and signature validity period.

Constraint after time T and before time T T would grant rights to a principal named K1 that could be a particular user or type of user the holder of the certificate or the like. The right would be for K1 to use the certificate to digitally sign a construct where the construct is the specified content of type C1. Significantly the right is constrained in that such right may not be exercised before a time T nor after a time T and thus the period between T and T is the aforementioned signature creation validity period during which the certificate and private key thereof can be employed to produce a digital signature for the content of type C1.

Notably in one embodiment of the present invention a certificate may specify multiple signature creation validity periods and certificate validity periods. For example the certificate having the aforementioned first policy with regard to content of type C1 and a first signature creation validity period for such first policy may also have a second policy with regard to a license of type L1 and a second signature creation validity period for such second policy 

Constraint after time T and before time T T Thus such second policy would grant rights to the principal named K1 to use the certificate to digitally sign a construct where the construct is the specified license of type L1. Here the right is constrained in that such right may not be exercised before a time T nor after a time T and thus the period between T and T is the aforementioned second signature creation validity period during which the certificate and private key thereof can be employed to produce a digital signature for the license of type L1.

Note that no certificate validity period has thus far been specified for the certificate with the aforementioned first and second policies. As may be appreciated such a certificate validity period may for example be specified in the certificate as a third policy 

Thus such third policy would grant rights to any holder of the certificate to use the certificate to validate a signature produced based on such certificate and with regard to the specified license of type L1 or the specified content of type L1. Here the right is constrained in that such right may not be exercised before time T nor after a time T is the signature validity period during which the certificate can be employed to validate a digital signature based on such certificate . As set forth the certificate validity period T T will typically span the digital signature validity periods T T and T T and extends beyond T and T to a time T which is presumably a much more distant time such that the certificate validity period T T is a relatively large span and the signature creation validity periods T T and T T are relatively short spans.

Of course additional policies may be set forth within the certificate to specify additional certificate validity periods as well as additional signature creation validity periods. As may be appreciated such additional certificate validity periods and such additional signature creation validity periods may be specific to particular principals rights and or constructs.

As may now be appreciated by setting forth policies within certificates that are chained to a digital construct a trusted component validating the signature on the construct validates the certificates in the chain and enforces any policy set forth in each such certificate . Thus by use of policy bearing certificates and in one embodiment of the present invention policy with respect to using a particular piece of content for example may be specified in a corresponding license and or may be specified in the certificates chained to the license and or the content . In fact it may be the case that the license for the content specifies no policy but instead merely includes decryption key KD for decrypting the content and a chain of certificates that in fact set forth policy that is to be applied to the content .

A certificate may set forth therein a signature creation validity period during which the certificate may be employed to produce a signature for any authorized type of content and a certificate validity period during which such signature may be validated based on the certificate . More generally a certificate may set forth policy regarding longevity publication actions rendering actions identity certification and the like. The policy is fully contained in the certificate and therefore is easily communicated to recipients of constructs to which the certificate has been chained and the like.

The programming necessary to effectuate the processes performed in connection with the present invention is relatively straight forward and should be apparent to the relevant programming public. Accordingly such programming is not attached hereto. Any particular programming then may be employed to effectuate the present invention without departing from the spirit and scope thereof.

In the present invention a long life digital certificate is provided for long life digital content or the like whereby the certificate can be employed to validate the content for a relatively long period of time but where the liabilities associated with issuing the certificate are mitigated. The certificate includes an expiration for a signature validation based on the certificate which may be separate from an expiration of the signature creation itself and the private key thereof. The expiration of the signature based on the certificate is set to give such signature a relatively longer life span while the expiration of the signature creation authorization itself and the private key thereof is set to give such certificate and private key thereof a relatively shorter life span. Thus even though the certificate and the private key thereof may be employed only for the relatively shorter life span as the basis for signature creation on another certificate or a piece of digital content or the like the signature provided based on such certificate has the relatively larger life span.

It should be appreciated that changes could be made to the embodiments described above without departing from the inventive concepts thereof. It should be understood therefore that this invention is not limited to the particular embodiments disclosed but it is intended to cover modifications within the spirit and scope of the present invention as defined by the appended claims.

