---

title: Providing SIP signaling data for third party surveillance
abstract: A method for facilitating surveillance of a targeted user participating in communication sessions conducted over a communications network, such as a voice over Internet protocol (VoIP) network, that employs a session initiation protocol (SIP). The method includes receiving a subscription request from a third party subscriber, the subscription request identifying a targeted user to be monitored, monitoring communication sessions in which the targeted user is a participant, to detect SIP events corresponding to state transitions associated with the communication sessions. A system for facilitating surveillance of a targeted user includes an application programming interface (API) operable to receive a subscription request from a third party subscriber, the subscription request identifying the targeted user, wherein the third party subscriber is not a participant in the one or more communication sessions, and a SIP events monitoring module operable to detect one or more predetermined SIP events associated with the communication sessions based on the subscription request and notify the third party subscriber of the detected SIP events.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08689317&OS=08689317&RS=08689317
owner: Level 3 Communications, LLC
number: 08689317
owner_city: Broomfield
owner_country: US
publication_date: 20051219
---
Contained herein is material that is subject to copyright protection. The copyright owner has no objection to the facsimile reproduction of the patent disclosure by any person as it appears in the Patent and Trademark Office patent files or records but otherwise reserves all rights to the copyright whatsoever. Copyright 2005 Level 3 Communications Inc.

Embodiments of the present invention generally relate to systems and methods to providing SIP signaling data for third party surveillance and more specifically for notifying a third party of SIP events related to a selected user communicating over a communications network.

Authorized electronic surveillance is an indispensable tool used by various law enforcement entities in the fight against crime and terrorism. In 1994 in order to preserve the ability of law enforcement entities to conduct electronic surveillance with the continuing advances in the telecommunications industry Congress passed the Communications Assistance for Law Enforcement Act CALEA . The law defines the statutory obligations of telecommunication carriers to assist law enforcement entities with properly authorized electronic surveillance. At a high level CALEA requires carriers to design or modify their systems to ensure that the appropriate level of electronic surveillance may be performed. Specifically CALEA ensures that telecommunications carriers will have the necessary capability and sufficient capacity to assist law enforcement entities in various types of electronic surveillance regardless of the telecommunications carriers specific systems or services.

Electronic surveillance typically refers to either the interception of call content commonly referred to as full wiretaps and or the interception of call identifying information commonly referred to as partial wiretaps through the use of pen registers and or trap and trace devices. Full wire taps allow the interception of the call content and allow the law enforcement entity to hear all of the conversations that occur. In contrast a partial wiretap only allows the law enforcement entity to find what numbers have been dialed incoming calls and the like.

As technology advances communication carriers are required to provide support for electronic surveillance. In Voice over Internet Protocol VoIP networks for example one solution has been to specify the P DCS LAES header to signal the need to send a copy of signaling and optionally content as the call is setup. Typically this type of mechanism for marking an endpoint as requiring lawfully authorized surveillance is undefined and proprietary. Communication carriers have used Private Session Initiation Protocol SIP proxy to proxy extensions to support the packet cable distributed call signaling architecture. One disadvantage to this approach however is that it does not provide any mechanism for identifying a surveillance requestor as being authorized. Another common method used in some VoIP networks is to route all the media packets and signaling through a centralized location which then determines which media packets and signaling information should be monitored and reported to the law enforcement agency.

Thus a need exists for systems and methods for collecting call signaling and event notification information of a monitored user based on an authorized surveillance request.

Embodiments are described herein that facilitate surveillance of a targeted user of a network by monitoring communication sessions for designated signals. A third party can subscribe to dialogs associated with a targeted user. If the third party is authorized to conduct surveillance of the targeted user the third party is notified of predetermined signals of interest associated with communications sessions in which the targeted user participates. Notification to the third party can identify the initiator recipient duration terminator and other attributes of the communication session. In addition the third party could be notified as to content sent to or received by the targeted user.

A method for facilitating surveillance of a targeted user participating in communication sessions conducted over a voice over Internet protocol VoIP network that employs a session initiation protocol SIP . The method includes receiving a subscription request from a third party subscriber the subscription request identifying a targeted user to be monitored monitoring communication sessions in which the targeted user is a participant to detect SIP events corresponding to state transitions associated with the communication sessions.

A system for facilitating surveillance of a targeted user includes an application programming interface API operable to receive a subscription request from a third party subscriber the subscription request identifying the targeted user wherein the third party subscriber is not a participant in the one or more communication sessions and a SIP events monitoring module operable to detect one or more predetermined SIP events associated with the communication sessions based on the subscription request and notify the third party subscriber of the detected SIP events.

A more complete understanding of various embodiments of the present invention may be derived by referring to the detailed description of preferred embodiments and claims when considered in connection with the figures.

Embodiments of the present invention generally relate to systems and methods to facilitate surveillance of a targeted user participating in communication sessions over a communications network. Communication sessions associated with a targeted user are monitored to detect predetermined signaling events based on an authorized surveillance request from a third party subscriber.

Some embodiments include a VoIP network operable to facilitate electronic surveillance of a selected network user by law enforcement in compliance with Communications Assistance for Law Enforcement Act CALEA requirements. In this regard some embodiments of the present invention provide a general event notification framework by including a dialog event package to allow authorized third party entities to subscribe to dialog events for selected users.

In various embodiments the dialog event package can use a standard communication protocol to notify the third party subscriber of designated types of session initiation protocol SIP events associated with communication sessions in which a targeted user participates. For example common signaling events include but are not limited to communication session setup or attempted setup and termination. SIP data that can be communicated to the third party subscriber includes but is not limited to origin duration direction destination or termination dialed digit extraction when the digits are involved in session setup party hold join drop information in band out of band signaling and timing information.

Although various embodiments discussed throughout this specification focus on monitoring of dialog state changes some embodiments may provide for the monitoring of content. For example in addition to monitoring SIP signaling events one or more embodiments may detect and record other types of content such as instant messages IMs document data video data image data and others. As another example content conveyed through proprietary or other non standard extensions of SIP messages may be monitored and recorded.

While various embodiments of the present invention have been described for illustrative purposes in relation to a VoIP communications network the scope of various embodiments of the invention are not limited to VoIP communications networks. More generally embodiments of the present invention are equally applicable to reporting state changes on any type of media communications session established with SIP. Examples of such media communications include but are not limited to voice video text fax instant messaging IM and the like. In addition for the purposes of explanation numerous specific details are set forth in the specification below in order to provide a thorough understanding of embodiments of the present invention. It will be apparent however to one skilled in the art that embodiments of the present invention may be practiced without some of these specific details.

Embodiments of the present invention may be provided as a computer program product which may include a machine readable medium having stored thereon instructions which may be used to program a computer or other electronic devices to perform a process. The machine readable medium may include but is not limited to floppy diskettes optical disks compact disc read only memories CD ROMs and magneto optical disks ROMs random access memories RAMs erasable programmable read only memories EPROMs electrically erasable programmable read only memories EEPROMs magnetic or optical cards flash memory or other type of media machine readable medium suitable for storing electronic instructions. Moreover embodiments of the present invention may also be downloaded as a computer program product wherein the program may be transferred from a remote computer to a requesting computer by way of data signals embodied in a carrier wave or other propagation medium via a communication link e.g. a modem or network connection .

Brief definitions of terms abbreviations and phrases used throughout this application are given below.

The terms connected or coupled and related terms are used in an operational sense and are not necessarily limited to a direct physical connection or coupling.

The phrases in one embodiment according to one embodiment and the like generally mean the particular feature structure or characteristic following the phrase is included in at least one embodiment of the present invention and may be included in more than one embodiment of the present invention. Importantly such phases do not necessarily refer to the same embodiment.

If the specification states a component or feature may can could or might be included or have a characteristic that particular component or feature is not required to be included or have the characteristic.

The term endpoint can be a logical location on a communication network such that communications ongoing in relation to the logical location can be targeted a physical location such that communications emerging from the geographic location are targeted and or an individual or entity such that communications associated with the individual or entity are targeted.

A communicator is used in its broadest sense to include endpoints and or communication devices. Thus a communicator can be a location physical or logical where a transmission is sent to from an entity or individual associated with communications and or a communication device capable of receiving and or sending such transmissions. In some cases transmissions can be real time transmissions including but not limited to video audio chat rooms instant messaging combinations of the aforementioned and or the like.

The term signal path manager generally refers to a feature server such as a class five type switch for Voice over Internet Protocol VoIP endpoints or other back to back user agents as known by those skilled in the art.

The term call identifying information generally refers to dialing or signaling information that identifies the origin direction destination or termination of each communication generated or received by a subscriber by means of any equipment facility or service of a telecommunications carrier. This term may also encompasses additional information such as dialed digit extraction party hold join drop information subject initiated dialing and signaling in band out of band signaling timing information and the like. This is meant to be an exemplary list of information which is encompassed by this term. By no means is this list meant to be exhaustive. As such other information as known by those skilled in the art is included within the coverage of this definition.

The term third party refers to an entity that is not a participant in a communication session to be monitored. When a third party subscribes to dialogs of a selected target user the third party is referred to as a third party subscriber. Tap entities and other surveillance entities can be types of third party subscribers. Internet service providers can also be third party subscribers.

The term tap entity generally refers to any entity which is lawfully authorized or otherwise legally entitled to perform electronic surveillance or record and monitor transmissions or other call identifying information from endpoints of a telecommunications carrier. For example common tap entities may include but need not be limited to law enforcement agencies such as the Federal Bureau of Investigation FBI Drug Enforcement Agency DEA Immigration Naturalization Service INS Central Intelligence Agency CIA local and state police and the like. A network communications provider may be legally required for example under the Communications Assistance for Law Enforcement Act CALEA to assist in tapping an endpoint communication device. In other situations other agencies or entities may be entitled to record and monitor transmissions or other call identifying information from a telecommunications carrier. For example an internet service provider ISP may have the right to be notified of all VoIP transmission destined for 911.

The term SIP data generally refers to any data carried by or associated with a SIP protocol that could be surveilled e.g. monitored detected notified upon . By way of example but not limitation SIP data could include any information included in or capable of being derived from a SIP protocol message or data associated with the SIP protocol message. For example SIP data includes but need not be limited to both message headers and message content. SIP headers SIP header extension parameters Uniform Resource Information URI extension parameters and various SIP message bodies containing content such as text documents or any other type of computer file digital signatures Instant Messages images icons audio video or links to other information anywhere on the Internet or other computer networks are covered by this term. In addition SIP data may also include information such as a time stamp an initiator identifier a recipient identifier a target user identifier a communication session identifier an event attribute a replace element a referred by element a state element a duration element and local and remote elements containing an identity element a target element and a session description element may be considered SIP data.

The phrase communication network or term network generally refers to a group of interconnected devices capable of exchanging information. A communication network may be as few as several personal computers on a Local Area Network LAN or as large as the Internet a worldwide network of computers. As used herein communication network is intended to encompass any network capable of transmitting information from one entity to another. In one particular case a communication network is a Voice over Internet Protocol VoIP network. In some cases a communication network may be comprised of multiple networks even multiple heterogeneous networks such as one or more border networks voice networks broadband networks service provider networks Internet Service Provider ISP networks and or Public Switched Telephone Networks PSTNs interconnected via gateways operable to facilitate communications between and among the various networks.

As such network enables SIP communications to from devices in operable communication with the network . To facilitate such communications network includes a number of subnetworks and components. For example network includes voice over Internet Protocol VoIP network public switched telephone network PSTN Internet and Internet each of which may include subnetworks of their own.

Via the subnetworks one communication device can cause a communication session to be set up with another communication device. For example an analog telephone in a home network can attempt to set up a communication session with a second analog telephone or vice versa. Analog telephone is connected to terminal adapter which facilitates communication between the analog telephone and digital broadband network which enables communications to from Internet and or autonomous system AS .

Home network may also include a broadband modulator demodulator MODEM for interfacing with the broadband network and a router firewall FW for routing data within the home network and or to from the broadband network and or performing security functions. Although the network is described as a home network the components and functions of network are also applicable to other types of end user networks such as but not limited to office and corporate intranets. The components within network can be wirelessly connected wired or any combination thereof.

In another exemplary scenario a communication session can be set up between a computing device such as desktop computer and another network based communication device such as the second analog telephone . In this regard desktop computer accesses broadband network through router firewall and broadband MODEM .

The second analog telephone accesses network via local exchange carrier LEC . LEC can access PSTN and or VoIP via media gateway MG . PSTN typically uses signaling system 7 SS7 for setting up communication sessions. LEC is able to interface with SS7 directly. To communicate over the VoIP network LEC uses time division multiplexing TDM to communicate with the MG which converts the communications from the LEC into a protocol such as Real Time Protocol RTP which can be used over the VoIP network .

VoIP network includes components that perform various functions to facilitate communications within the network . For example VoIP network includes a media gateway controller MGC which communicates with MG via internet protocol device control IPDC . MGC is also able to communicate with Signaling Gateway SG . SG provides a signaling interface from analog phone which has been routed through PSTN via Signaling Transfer Point STP to MGC . MGC is able to interface with IP to PSTN Routing element via SIP messaging. A network address translator NAT traversal manager NTM uses SIP signaling and RTP to enable SIP signaling and RTP to traverse a NAT not shown and or router FW that may be operating at network . Caller identification ID with name CNAM server provides caller name information caller ID for calls made across internet via a CNAM Signaling Gateway to the Signal Path Manager SPM .

Of course other network elements known to those skilled in the arts may be used with the exemplary network shown while some elements shown in this configuration may not be present in other network setups. For example various proprietary media gateways interfacing various border networks including one or more local exchange carriers and other border network elements used in relation to a PSTN internet service provider ISP or other border network type may be used.

Real time transport protocol RTP is typically utilized to communicate dialog content between various communicating users. For signaling purposes session initiation protocol SIP is used between some of the elements and SS7 protocol is used between various other elements. Voice over IP VoIP network can be implemented for example by a wholesale telecommunications service provider that sells services to other carriers or service providers and or directly to an end user of telecommunication services. Network can be used to pass transmissions internally as IP packets but provide the transmissions externally in one or more defined formats. From a signaling perspective network provides an ability to support SS7 signaling to a PSTN as well as accepting SIP signaling from customers and carriers.

In accordance with various embodiments VoIP network is also configured to assist a third party in conducting surveillance of network users. One example of a third party entity is referred to as a tap entity. Generally speaking a tap entity is any entity which is lawfully authorized or otherwise legally entitled to perform electronic surveillance such as recording and or monitoring signals associated with communication sessions between targeted endpoints. For example common tap entities may include but need not be limited to law enforcement agencies such as the FBI DEA local and state police and the like.

VoIP network service provider may be legally required for example under the Communications Assistance for Law Enforcement Act CALEA to assist in tapping an endpoint communication device. In other situations other agencies or entities may be entitled to record and monitor transmissions or other call identifying information from a telecommunications carrier. For example an internet service provider ISP may have the right to be notified of all VoIP transmission destined for 911. In addition tap entity may have a private surveillance network by which the tap entity conducts surveillance. Embodiments of the present invention provide an SPM with which the surveillance network interfaces.

Various functions of SPM support the tap entity in monitoring call identifying information of one or more communicators. In one embodiment SPM is a feature server such as a class 5 soft switch for Voice over Internet Protocol VoIP endpoints. In other embodiments a feature server may represent a registrar server. Feature servers are generally servers that are operable to provide one or more services supported by a communications network such as VoIP network . For example a feature server may provide telecommunications services such as caller identification call forwarding voice mail and or the like.

Various functions are provided by SPM to facilitate surveillance. Specific embodiments of exemplary functions are described below. Briefly these various functions support the tap entity in conducting a partial tap of a targeted endpoint. A partial tap generally involves monitoring signaling information. Signaling information can include without limitation call identifying information dialing information call setup information or any other information that identifies the origin direction destination or termination of each communication generated or received by a targeted endpoint by means of any equipment facility or service of a telecommunications carrier. SPM may also encompasses additional features to provide tap entity information such as dialed digit extraction party hold join drop information subject initiated dialing and signaling in band out of band signaling timing information and the like.

In accordance with another embodiment SIP content could be surveilled in addition to or in place of SIP event signaling information. Such SIP content may include any content that can be attached to and or carried with a SIP message. Such content is typically in the form of a content object. For example SIP supports Instant Messaging whereby the content of instant messages IMs can be attached as a message body to SIP messages similar to the manner in which documents can be attached to email messages. As those of ordinary skill in the art will appreciate many other types of content currently exist that could be attached to SIP messages and future types of content yet to be defined could be attached to SIP messages. These additional types of content are also capable of being used with various embodiments of the present invention. Some examples include but are not limited to documents or any other type of computer file Icons image sound or video files digital signatures security certificates and or links to information anywhere on the Internet or other computer network. In addition more than one type of content may be attached to a single SIP message and more than one content object of the same type may be attached to a single SIP message.

Signal path manager is configured to provide one or more of the following functions registrar capabilities monitor endpoint dialogs and other transmissions record endpoint dialogs generate a report and or forward the dialog transmissions to an acquisition facility or other destination specified by a tap entity. Embodiments of the SPM employ a dialog event package that is capable of detecting SIP signals. The SPM can facilitate CALEA compliance while supporting voice services commonly supported across IP networks. In addition the SPM generally requires minimal architectural changes to such networks.

In particular network provides an architecture for directing signaling information of transmissions that can include but are not limited to dialed digit extraction party hold join drop information subject initiated dialing and signaling in band out of band signaling timing information origin direction destination or termination of each communication generated or received by a subscriber or endpoint by means of any equipment facility or service of a telecommunications carrier. Various embodiments also include an acquisition facility or other destination which may include an acquisition server a distribution function server and an administrator.

When SPM receives a transmission SPM determines if one or more of the communicators associated with the transmission have been designated for surveillance. When SPM has determined that a transmission has been designated or selected for acquisition SPM directs the signaling associated with the transmission to the destination endpoint s indicated by the transmission. In addition SPM directs a copy of the call identifying information in real time or the information which has been recorded to the surveillance network . The signaling protocol and or interface between the SPM and surveillance network can include a proprietary interface or an existing standard for encapsulation and or representation of the SIP signaling event information. In either case SPM passes the transmission to a surveillance network . For example according to some embodiments the dialog event package for SIP events framework can report desired SIP dialog state information represented using a standard general markup language SGML . For example eXtensible Markup Language XML or a language based on XML such as Geography Markup Language GML RDF XML RSS MathML XHTML SVG MusicXML and cXML may be used.

In accordance with various embodiments tap requests and notification can be passed via a transmission protocol and or interface that can be proprietary or can be implemented using extensions to open standard protocols such as SIP for example using Subscribe and or Notify methods. In some cases such notification includes providing a computer readable medium with a list of communicators selected for acquisition and an indication that the list has been modified. This list can be accessed in real time by SPM or can be transferred on occasion to a computer readable medium more easily accessible to other interested devices.

According to one embodiment a signal path manager is introduced into a general system architecture which adds registrar capabilities to the existing edge proxy server. In addition to supporting partial taps in accordance with CALEA various embodiments also relate to supporting other collection of call identifying information that may not be required by CALEA. For example various embodiments also support monitoring dialogs of communicators which may then be used to report event specific transmission data to an ISP. One example of an event specific transmission is a 911 call. In this case call identifying information from a communicator calling 911 is forwarded to an ISP.

The DEP can be any DEP as may be known in the art and may be a proprietary or publicly available package. The third party server communicates to the SPM via an application programming interface API . One embodiment of the API employs open standards such as SIP extended with RFC 3265 and an industry standard dialog event package such as described in RFC 4235. RFC 3265 and RFC 4235 are hereby incorporated by reference for all purposes. Other embodiments could employ a proprietary API. In other embodiments the API can be integrated with the DEP . To have user s and or user s traced third party server subscribes to dialogs of the user s and or user s . As is discussed in more detail below the third party server issues a subscription request to the SPM for each user and or for which the third party wants to monitor dialogs. The DEP can determine if the third party is authorized and if so store valid subscriptions in memory for later access.

Based on the subscriptions DEP monitors dialogs of associated users . DEP detects predetermined events in SIP signals to and from the monitored users . Exemplary events include call attempt call establishment call modification and call termination. The DEP can then notify the third party server of the predetermined events. The DEP may store and retrieve data related to SIP events to from memory. In one embodiment the DEP can notify the third party server in real time.

According to one embodiment SIP signaling passed between communicators such as user and user are intercepted by SPM . Depending on the direction of the SIP signaling message either of the communicators could be a destination communicator or a sending communicator. In this case sending and destination are in reference to the SIP messaging and not to the call originator and the call destination. Again SPM is logically positioned between the communicators. It is not necessary that SPM be physically located between the communicators.

In the embodiment depicted in SPM comprises DERN . In one embodiment DERN may be a software package or component. In another embodiment DERN may be implemented by hardware components. No matter whether DERN is implemented in hardware software or a combination thereof DERN may be configured to pass one copy of the SIP message to the appropriate destination user or . To this end the copy of the SIP message may be passed to a first child node which lies on the path between DERN and the destination communicator.

According to one embodiment DERN is configured to determine the sending user and or the destination user information contained within the SIP message. Using this information and the stored valid subscriptions DERN determines if either of the communicators are on the valid subscription list and should be monitored. DERN then generates a notify request comprising a subscription including one or more of at least the following an event header indicating a dialog package information about the communicator which is being monitored and other information about the communications session itself. Once the notify request is generated by DERN the notify request may be transmitted or otherwise effectively communicated or routed to the third party . According to one embodiment the notify request may be transmitted directly to third part surveillance server . In another embodiment the notify request is routed to a child node on the path to the destination indicated by the third party.

With the DEP the SPM can also transport Subscribe and Notify SIP messages to and from potential trace targets for the message summary event package RFC 3842 . Such Subscribe and Notify SIP messages carry indications of changes in voicemail message counters such as total number of new messages total number of old messages already listened to etc. as defined in RFC 3842. Law enforcement agencies and other third parties could subscribe to such SIP messages which may be useful in surveillance. In such embodiments the third party can subscribe to the same voicemail server that the trace target is subscribing to and monitor Subscribe and Notify SIP messages that the target receives when voicemail counts change. In one embodiment this may be done directly using industry standards described in RFC 3842. In another embodiment DEP may be involved to monitor Subscribe and Notify SIP messages.

In an alternative embodiment a third party agent can be instantiated. The third party agent receives and processes SIP event data on behalf of the third party server . The third party agent can queue event notifications based on local policy. For example the third party agent can accumulate SIP events over time and send them to the third party server at designated times or upon the occurrence of certain events. The third party agent could gather or retrieve all SIP events associated with each call and send them together to the third party server after the associated call terminates. Alternatively the third party agent could gather or retrieve SIP events for each call over the course of a certain time duration e.g. one week group the events by call and send the call grouped events at the end of the time duration.

At step the subscription request is authenticated. According to various embodiments this authentication process includes both an authentication of the subscription requestor and the subscription request itself. If the authentication fails for any reason the subscription request is denied at step and then the result is communicated to the subscription requestor at step .

To authenticate the tap entity third party in one embodiment digest authentication is used. For example digest authentication as defined in RFC 2617 which is hereby incorporated by reference for all purposes may be used for any SIP request including the Subscribe from the third party e.g. law enforcement agency LEA . This type of authentication involves challenging the request with a Unauthorized response containing a WWW Authenticate header. This header contains seed information. The third party subscriber uses the seed along with a secret e.g. a password shared with the server e.g. SPM in or SPM in the Subscriber was sent to as input to an algorithm to produce an output value. The value is sent back to the SPM in an Authorization header within a new Subscribe request. The SPM performs the same algorithm with the same inputs the subscriber used and checks the resulting answer against the value in the received Authorization header. If the answers match the SPM determines that the Subscriber used the correct password. This mechanism allows authentication without actually sending the password over the network. describe in more detail an exemplary embodiment of the present invention which utilizes digest authentication.

If the authentication is successful the verified subscription request is installed at step . Installing valid subscriptions can include storing the subscriptions in memory. At step the subscriber is notified of the successful installation and may also be notified of the current dialog state of the target. As previously mentioned the subscription request may contain guidelines or parameters which must be satisfied in order for the subscription to be valid. For example in some embodiments a subscription commencement and expiration date may be included. In these cases the signaling path manager may be used for example to check the validity of the subscription request on a predetermined interval.

The dialogs of targets are monitored for the requested activity including state transitions indicating various call signaling activities at step . One embodiment of monitoring step involves a dialog events package monitoring SIP signals that are routed through the SPM. A dialog events package allows users to subscribe to another user and subscribe to dialogs between endpoints and receive notifications about changes in communication session status. The various notifications used in the dialog event package contain partial information about the communications covered by the subscription. In some embodiments NOTIFY signals are sent to inform the subscribing service of changes in the communication session state. Since the information typically contained in the NOTIFY dialogs is only partial the information will have to be collected and combined to form a more complete description of the communication activities.

In any case the various activity may then be recorded step and then communicated to either the subscription requestor or a destination designated by the subscription requestor at step . In some embodiments the recorded activity may be used to generate a report in a pre determined format specifying the activity of the target at a desired level of detail. For example the report may comprise a collection of target identifiers event dialogs and call signaling activities for one or more of the one or more targets being monitored. Then for example the report can be transferred or communicated to the subscription requestor. In other embodiments the recorded activity may be communicated to the subscription requestor an acquisition facility or the like on a real time basis as it is collected from the target.

In the embodiment depicted tap entity sends a subscription request F to the SPM to collect call identifying information about a communication device of a targeted user. The subscription request identifies the tap entity and the targeted communication device i.e. the target . For example the subscription request can include a phone number Internet address or universal resource identifier associated with the targeted user. The subscription may also include an expiration date specifying the duration of the subscription. The SPM checks the subscription request F for authentication credentials and sees valid credentials are not present so it responds with an unauthorized message F challenging the tap entity to prove the tap entity s identity. Tap entity resends a similar subscription request F with additional information proving its identity. SPM inspects the new information in new request F to authenticate the subscription request F is from the tap entity . An OK message F is sent from SPM to tap entity to indicate SPM received and accepted the subscription request F after SPM authenticates the subscription request F and validates the contents of the subscription request F. The SPM then installs the requested subscription and sends notify message F to the subscriber the tap entity to indicate the successful installation of the request and optionally the current state of targeted communications device . Tap entity sends an OK message F to SPM to indicate tap entity received and accepted notify message F.

When a communications session e.g. phone call is initiated by targeted communication device to a destination communicator various initiation signals are routed through SPM . Targeted communication device transmits invite F which is received by NTM . NTM responsively sends a corresponding invite signal F to SPM . SPM and then NTM respond to the target with SIP signals F F requesting the communicator to provide identification credentials so that the SPM can determine the target s identity. In response acknowledgement signals ACK F and ACK F are transmitted to SPM . Invite F and invite F are then sent to the SPM containing appropriate credentials. Based on the target s address the SPM checks valid dialog subscriptions to determine whether the communicator should be monitored.

SPM sends invite F to call processing system CPS . A communication session attempt notification F is sent by SPM to tap entity to notify the tap entity that a communication session was attempted by the target . Tap entity responds with OK message F.

The communication session is set up with the CPS sending SIP invite signal F to media gateway . SIP session progress signals F F are sent by media gateway CPS SPM and NTM respectively to indicate that the communication session setup is in progress. A communication session attempt notification F is sent by SPM to tap entity to notify the tap entity that a communication session setup is in progress. Tap entity responds with OK message F.

When the communication session is set up e.g. the destination user answers the phone at the destination OK signals F F are sent from media gateway to target . Acknowledgement signals F F are responsively communicated from the target to the media gateway . Upon receiving ACK F the SPM communicates a notify signal F to the tap entity to notify the tap entity that the communication session has been successfully set up. Tap entity responds with OK message F.

Once the call is initiated standard 2 way real time protocol RTP is used to transfer real time content of the communication session. When one of the participants in the communication session terminates the communication session e.g. hangs up a SIP Bye signal is communicated to the SPM . In the exemplary scenario illustrated the destination user terminates the call. Accordingly SIP Bye signal F is transmitted to CPS which sends corresponding SIP Bye signal F to SPM . SPM is able to determine which participant in the communication session terminated the session in this case the destination user. SPM can also use the Bye signal F to determine the duration of the communication session or other information about the communication session. Bye signals F and F are sent to the NTM and the targeted communication device respectively.

In response corresponding OK signals F F are communicated from the target NTM SPM and CPS respectively. Upon receiving OK signal F SPM can transmit SIP event notification signal F to the tap entity. The SIP event notification signal F notifies the tap entity that the communication session was terminated and can include which user terminated the session. Tap entity sends OK signal F in response to event notification signal F.

For illustrative purposes exemplary data associated with signals shown in are depicted in . Signals typically include headers and bodies that include information relevant to surveillance of a targeted user. provides an exemplary subscription request and notification dialog in accordance with embodiments of the present invention. The exemplary embodiment depicted in these figures are based on a dialog event package.

Various header fields and message bodies are used in the communication to indicate subscription requests call identifying information and the like. In the examples depicted F represents a signal from the tap entity to the SPM . Subscribe request line indicates the subscription request. A communicator identifier identifies the target that should be monitored by SPM . The subscription request contains a variety of other information including who the request was from where to send notifications expiration authentication credentials and the like. Expiration can correspond to virtually any time duration ranging from minutes to years. In the example depicted the expiration is set for 315 360 000 seconds which corresponds to 10 years.

Messages F F complete the subscription process with OK Notify and OK SIP messages. In messages F F F F and F the bodies of the Notify messages are formatted in eXtensible Markup Language XML . These messages contain a variety of call signaling information as previously discussed which may be used to generate reports for the tap entity In message F the entity indicator identifies the target . In message F the entity indicator identifies the target and the state indicator identifies a request for a communication session setup has been received. In message F the entity indicator identifies the target and the state indicator identifies a communication session setup attempt is in progress. In message F the entity indicator identifies the target and the state indicator identifies a communication session setup attempt has been answered. In message F the entity indicator identifies the target and the state indicator identifies a communication session has been terminated by the remote party the target was communicating with.

Message F illustrates an exemplary NOTIFY message from the SPM to the tap entity . For example entity indicator of message F identifies the target . The state indicator of message F identifies a request for a communication session setup has been received. Under local indicator of message F identity indicator identifies who is attempting to initiate a communications session e.g. who is making a call the initiator and under remote indicator of message F identity indicator identifies who a communications session is being attempted to e.g. who is being called the recipient . In the exemplary scenario of target initiated the communication session. By identifying the initiator and recipient of the communication session the SPM indicates the direction of the communication session.

In embodiments previous described the SPM transports Subscribe and Notify SIP messages to and from potential trace targets for the message summary event package RFC 3842 . These particular Notify messages carry indications of changes in voicemail message counters such as total number of new messages total number of old messages already listened to etc. as defined in RFC 3842 which is hereby incorporated by reference for all purposes.

According to one embodiment information about the voicemail would be useful to LEAs and thus communicated to them. While the standard dialog event package is only designed to carry events related to Invite initiated dialogs phone calls it may be augmented by defining a new event package to also report these voicemail count changes.

In another embodiment the information is collected by using the same message summary event package. To accomplish this the LEA subscribes to the same voicemail server the trace target is subscribing to thus the LEA would see all the same Notify messages the target sees when voicemail counts change.

If a response is received in response to trying to set up the communication session the SPM enters the proceeding state . The SPM may then enter the confirmed state in which the communication session has been established. In the confirmed state a communication session established event is reported meaning that an answer was received from the destination. When the communication session ends e.g. one party hangs up or if there is no answer during the trying state the SPM enters a terminated state . In the terminated state a communication session termination event is reported. Those skilled in the art will appreciate that other states may be included without straying from the spirit and scope of the present invention.

Embodiments of the present invention include various steps which were described in more detail above. A variety of these steps may be performed by hardware components or may be embodied in machine executable instructions which may be used to cause a general purpose or special purpose processor programmed with the instructions to perform the steps. Alternatively the steps may be performed by a combination of hardware software and or firmware. As such is an example of a computer system with which embodiments of the present invention may be utilized. According to the present example the computer system includes at least one processor at least one communication port a main memory a read only memory a mass storage a bus and a removable storage media .

Processor s can be any know processor such as but not limited to an Intel Itanium or Itanium 2 processor s or AMD Opteron or Athlon MP processor s or Motorola lines of processors. Communication port s can be any of an RS 232 port for use with a modem based dialup connection a 10 100 Ethernet port or a Gigabit port using copper or fiber. Communication port s may be chosen depending on a network such a Local Area Network LAN Wide Area Network WAN or any network to which the computer system connects.

Main memory can be Random Access Memory RAM or any other dynamic storage device s commonly known in the art. Read only memory can be any static storage device s such as Programmable Read Only Memory PROM chips for storing static information such as instructions for processor .

Mass storage can be used to store information and instructions. For example hard disks such as the Adaptec family of SCSI drives an optical disc an array of disks such as RAID such as the Adaptec family of RAID drives or any other mass storage devices may be used.

In conclusion embodiments of the present invention provides novel systems and methods to facilitate tracing of communication session signaling of a particular user and more specifically for collecting communication session signaling and event notification information of a monitored user based on an authorized surveillance request. While detailed descriptions of one or more embodiments of the invention have been given above various alternatives modifications and equivalents will be apparent to those skilled in the art without varying from the spirit of the invention. Therefore the above description should not be taken as limiting the scope of the invention which is defined by the appended claims.

