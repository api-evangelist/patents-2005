---

title: System and method for adaptive DC offset compensation in wireless transmissions
abstract: A first direct current (DC) component of a first amplified representation of a received signal at an output of an amplifier set to a first gain setting is determined during a first expected idle period of a received signal. A second DC component of a second amplified representation of the received signal at the output of the amplifier set to the first gain setting is determined during a second expected idle period of the received signal. A first average DC component is determined based at least in part on the first and second DC components and a DC offset used by the amplifier when set to the first gain setting is adjusted based on a comparison of the first average DC component to one or more threshold values.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07400869&OS=07400869&RS=07400869
owner: ViXS Systems Inc.
number: 07400869
owner_city: Toronto, Ontario
owner_country: CA
publication_date: 20050322
---
The present disclosure relates to the compensation of direct current DC components in transmitted signals.

The wireless transmission of a signal representative of information in accordance with one or more wireless protocols i.e. IEEE 802.11x 3G etc. typically entails formatting the signal at the transmitting device modulating the formatted signal over a baseband carrier receiving the modulated signal at the receiving device and demodulating the modulated signal whereupon the received signal may be processed further by the receiving device.

The formatted signal typically is modulated over a baseband carrier so that the resulting signal ideally would have a relatively small direct current DC component if any. However as a result of noise present in the transmission environment and or changes in the characteristics of the transmitting equipment resulting from for example heat in the components of the transmitting device a significant DC component may be present in the received signal. Similarly the components of the receiving device also may introduce a significant DC component into the received signal as it is processed.

A number of techniques have been developed to reduce or minimize the DC component in the received signal. One conventional technique utilizes a training period at start up whereupon the DC component in the received signal is measured for one or more gain settings. After the initial training period the receiving device uses a fixed DC offset associated with the initial measured DC component for the particular gain setting. However it will be appreciated that the DC component present in the received signal for any given gain setting typically varies over time due to any of a variety of factors such as the operating temperature of the components of the transmitting device or receiving device noise in the transmission environment and the like. Accordingly the use of a fixed DC offset may not adequately compensate for the DC component of the received signal as the DC component of the received signal varies from the value originally measured during the initial training period. Other conventional techniques measure the DC offset on each burst during the training for the bust. However these techniques typically require considerable hardware to perform this training which increases both the complexity cost and power consumption of those devices utilizing such techniques. Accordingly an adaptive technique for compensating for a varying DC component in a received wireless signal would be advantageous.

The following description is intended to convey a thorough understanding of the present disclosure by providing a number of specific embodiments and details involving adaptive DC offset compensation in wireless systems. It is understood however that the present disclosure is not limited to these specific embodiments and details which are exemplary only. It is further understood that one possessing ordinary skill in the art in light of known systems and methods would appreciate the use of the disclosure for its intended purposes and benefits in any number of alternative embodiments depending upon specific design and other needs.

Referring now to an exemplary wireless system utilizing one or more adaptive DC component compensation techniques is illustrated in accordance with at least one embodiment of the present disclosure. For ease of discussion the system is discussed in the context of the delivery of multimedia information such as MPEG encoded audio and video A V data. However it will be appreciated that the illustrated system may be utilized for the transmission of any of a variety of information types without departing from the spirit or the scope of the present disclosure.

In the illustrated example the system includes a transmitting device and a receiving device wherein the transmitting device transmits information represented by one or more wireless signals to the receiving device . It will be appreciated that the receiving device may also be a transmitting device and the transmitting device may also be a receiving device. The transmitting device includes for example an A V encoder e.g. an MPEG encoder or transcoder coupled to receive an A V feed e.g. a DVD player a cable head in a set top box etc. . The resulting encoded transcoded multimedia data is supplied to an RF transceiver whereupon it is formatted for transmission as for example wireless signal . The receiving device includes an RF transceiver to receive the wireless signal and process it to obtain the information e.g. the encoded MPEG data represented by the wireless signal . The resulting encoded MPEG data may be stored in a buffer and an A V decoder e.g. an MPEG decoder or transcoder may obtain the encoded MPEG data from the buffer decode the MPEG data and provide the resulting decoded multimedia data as an A V feed .

In at least one embodiment the RF transceiver of the receiving device implements an adaptive DC offset compensation technique whereby the DC offsets employed for various gain settings of one or more amplifiers of the RF transceiver are adjusted in a periodic or quasi periodic manner so as to compensate for changes in the DC component of the wireless signal that may result from for example changes in the transmission environment or changes in the operating characteristics of the components of the RF transceiver .

The wireless signal typically comprises a series of transmission bursts and subsequent idle periods. To illustrate a portion of the wireless signal may comprise transmission bursts and followed by idle periods and respectively. Following each transmission burst the RF transceiver may determine the DC component present during the subsequent idle period for a selected gain setting. A DC component of the signal for a particular gain setting is measured over multiple burst idle periods to obtain multiple measured DC component values. To obtain the multiple measurements for a particular gain setting the gain settings may be alternated between burst idle periods e.g. the DC component present for a first gain setting may be measured for one burst idle period and the DC component present for a second gain setting may be measured for the next burst idle period or the DC component for a single gain setting may be measured over multiple adjacent burst idle periods e.g. the DC component present for a first gain setting is measured for two adjacent burst idle periods .

As represented by block the measured DC components are filtered for each gain setting to determine a DC component running average for each gain setting. The average DC component for a given gain setting may be determined using for example a moving average technique or leaky bucket technique for some or all of the measured DC components for the gain setting. To illustrate assuming a three value sliding window three measured DC components DCM DCM and DCM determined for a given gain setting during idle periods and respectively may be averaged to produce the running average DC component for the given gain setting.

As represented by block the average measured DC component for a given gain setting may be used to determine whether to adjust the DC offset used by the given gain setting to compensate for DC components when the given gain setting is used. In one embodiment this determination is made based on a comparison of the average measured DC component to one or more thresholds. In the event that a threshold is exceeded the RF transceiver is adjusted to so that the DC offset used for the given gain setting is modified accordingly.

Referring now to an exemplary implementation of the PHY level of the RF transceiver and an exemplary operation of the PHY level of the RF transceiver are illustrated in accordance with at least one embodiment of the present disclosure. As depicted in the transceiver includes a mixer amplifiers and analog to digital A D converters and an amplifier control module e.g. an automatic gain control AGC type controller an offset adjustment module and one or more processing components . In the illustrated example amplifier amplifies the real in phase component of a received signal and the amplifier amplifies the imaginary quadrature component of the received signal . The amplifier includes amplifier modules and summer . The amplifier module has an input connected to the mixer and an output connected to an input of the summer . The summer has another input connected to the output of a digital to analog converter DAC . The output of the summer is connected to the input of the amplifier module which has an output coupled to the input of the A D converter via for example one or more filtering components not shown . The amplifier includes amplifier modules and summer . The amplifier module has an input coupled to the output of the mixer and an output coupled to an input of the summer . The summer has another input coupled to the output of a DAC and an output coupled to the input of the amplifier module . The output of the amplifier module is coupled to the input of the A D converter . Although the amplifiers and are illustrated as two stage amplifiers for ease of reference the amplifiers and may include more or fewer stages as appropriate.

In operation the mixer provides the real component of the received signal to the amplifier and the imaginary component of the received signal to the amplifier . The real and imaginary components are amplified and adjusted to compensate for any DC component present. The resulting amplified and adjusted signals are converted to digital values by the A D converters and the digital values may be provided to the processing components of the transceiver for further processing as appropriate. The output of the processing components may be processed at additional layers of the transceiver e.g. the media access control MAC layer the link layer etc. . As the processing of the real component and the processing of the imaginary component typically are substantially similar only the processing of the real component of the received signal is described in detail herein for ease of discussion. However the described techniques are similarly applied to the processing of the imaginary component unless otherwise noted.

In the illustrated example the received signal is processed by the mixer and the resulting real and imaginary components are provided to the amplifier module and respectively. The amplifier module amplifies the signal in accordance with the particular gain setting and the amplified signal is provided to the summer whereupon the amplified signal is adjusted by a DC offset provided from the DAC .

In at least one embodiment the control module maintains a gain setting table for the real component and a gain setting table for the imaginary component . Each of the tables and may include for example an entry for a particular gain setting and a corresponding entry that stores a DC offset value representative of the DC offset to be implemented for the particular gain setting. To illustrate the table may include entries for each gain setting of 2 decibels dB 4 dB 10 dB and 20 dB and the corresponding DC offset entries may have a value between for example 0 to 255 where a value of zero may correlate to a DC offset voltage of for example 500 millivolts mV and a value of 255 may correlate to a DC offset voltage of for example 500 mV. When the amplifier is operating in a particular gain setting the control module indexes the entry for the gain setting used and provides the DC offset value stored in the corresponding entry to the DAC . The DAC in turn converts this value to a voltage that is supplied to the summer to offset the amplified signal output by the summer . For example if the amplifier is operating at the 20 dB gain setting the control module provides the value stored in the corresponding DC offset entry a value of 20 in the illustrated example . The DAC converts the value 20 to a voltage of for example 400 mV and the summer accordingly adjusts the signal down by 400 mV. The adjusted signal then is amplified by the amplifier module in accordance with the particular gain setting in use and the resulting amplified signal is converted to a digital value by the A D converter .

Ideally the DC offset provided by the DAC for a particular gain setting in use has the same magnitude and opposite sign as the DC component present in the received signal for the particular gain setting. However as noted above the DC component of the received signal often varies due to any number of factors. Accordingly the offset adjustment module monitors the DC component of the received signal and adjusts the DC offsets of one or more of the gain settings as appropriate.

As illustrated the offset adjustment module may include inputs operably coupled to the outputs of the A D converters and so as to monitor the amplified signals resulting from the operations of the amplifiers and . As described above in one embodiment the offset adjustment module measures the value of the signal during the idle periods following transmission bursts as the value of the amplified signal during the idle period typically is representative of the residual DC component of the amplified signal. In another embodiment the transceiver may include integrators and coupled to the outputs of the A D converters and respectively to determine the DC component of the amplified signal. In this instance the integrators and may operate during transmission bursts wherein the values output by the integrators and are representative of the DC component of the received signal during the transmission bursts. Using measured values obtained from the integrators and or obtained from the outputs of the A D converters and during idle periods or a combination thereof the offset adjustment module may calculate a running average of the current measured DC component and previous measured DC component and use this running average DC component to determine whether adjustment of the DC offset introduced during the amplification stages is appropriate. In one embodiment the offset adjustment module makes the determination of whether to adjust the DC offset used for a given gain setting based on a comparison of the average measured DC component for the gain setting to one or more thresholds.

The offset adjustment module may adjust the DC offset supplied to the amplifier for a given gain setting by adjusting the corresponding DC offset value in the table . For example if the DC offset value stored in an entry of the table corresponding to the 2 dB gain setting is 35 and if the offset adjustment module determines that the DC offset for the 2 dB gain setting needs to be increased based on the sign of the average measured DC component and because the magnitude of the average measured DC component for the 2 dB gain setting is above a certain threshold the adjustment module may increase the DC offset value stored in the corresponding entry to for example 36 assuming that an increase in the DC offset value results in a less negative DC offset output by the DAC so as to increase the DC offset supplied by the DAC to the summer when the amplifier is operating in the 2 dB gain setting. Conversely if the offset adjustment module determines that the DC offset for the 2 dB gain setting needs to be decreased based on the sign of the average measured DC component and because the magnitude of the average measured DC component greater than a certain threshold the offset adjustment module may decrease the DC offset value stored in the corresponding entry to for example 34 assuming that a decrease in the DC offset value results in a more negative DC offset output by the DAC so as to decrease the DC offset supplied by the DAC to the summer .

It will be appreciated that it may not be practical to directly update the tables and to change DC offset values stored by the tables and . Accordingly in at least one embodiment the offset adjustment module maintains shadow copies of the tables and illustrated as shadow tables and respectively . Changes to one or more DC offset values may be made to the shadow tables and and at the appropriate time portions or all of the tables and may be overwritten by the corresponding portions of the shadow tables and respectively. The tables and typically are overwritten or updated with the information in the shadow tables and directly after the idle measurement periods of the signal .

As noted above the offset adjustment module maintains an average measured DC component for some or all of the gain settings. The average measured DC component for a gain setting may be determined as for example a moving average or leaky bucket on the most recent measured DC components as an average or mean calculated from all or substantially all of the measured DC components and the like. To facilitate the determination of the average measured DC component the offset adjustment module may maintain measured DC component tables and corresponding to the amplifier and respectively whereby the previous and current measured DC components may be stored for some or all of the gain settings. For example if the average measured DC component is calculated using a sliding window technique the tables and may include as many entries for each gain settings as the width of the window. Thus the offset adjustment module may calculate the average DC components for each gain setting simply by averaging the values stored in the tables or for the gain setting.

In certain instances a perceived transmission burst may be invalid because the transmission burst was not a valid transmission burst e.g. it was a burst of noise or static . The validity of a transmission burst may be determined from for example a cyclical redundancy check CRC . Accordingly the measured DC component obtained from an integration of the invalid transmission burst or from the expected idle period following the invalid burst typically is suspect. In such instances the offset adjustment module effectively discards the measured DC component upon notification that the transmission burst associated with the measured DC component was invalid. However if a DC offset value in the table or has been changed as a result of a comparison of the current average measured DC component in one embodiment the offset adjustment module sets the current average measured DC component to a predetermined value e.g. zero .

At step the current calculated average DC component DCM Avgis compared to an upper threshold threshold A e.g. 500 mV . In the event that the upper threshold is exceeded the offset adjustment module adjusts the DC offset value stored in the table or table at step so as to result in a more negative DC offset output by the DAC when supplied with the adjusted DC offset value. The adjustment of the DC offset value may be incremental e.g. from 35 to 34 proportional to the degree by which the average measured DC component exceeds the upper threshold and the like.

At step the current average DC component DCM Avgis compared with a lower threshold threshold B e.g. 500 mV . In the event that the lower threshold is exceeded the offset adjustment module adjusts the DC offset value stored in the table or table at step so as to result in a more positive DC offset output by the DAC when supplied with the adjusted DC offset value. The DC offset value may be adjusted incrementally proportionally etc. In the event that the DC offset value is adjusted at either step or the current average DC component DC Avgis set to a predetermined value e.g. zero .

At step the offset adjustment module filters the measured DC component obtained at step by using the measured DC component and one or more previous measured DC components for the selected gain setting to calculate a temporary average measured DC component DCM Avg . Typically the temporary calculated average measured DC component is stored in a register until it is determined whether the burst is valid at step discussed below . At step the offset adjustment module determines whether the transmission burst that was perceived or expected to end at step was a valid transmission burst. Typically the validity of the transmission burst may be determined by an evaluation of its CRC. If the burst is valid at step the current average measured DC offset DCM Avg is set to the temporary average measured DC offset DCM Avg . If the burst is invalid the temporary average measured DC offset is discarded or otherwise disregarded.

At step the next gain setting is selected. The gain settings may be alternated between burst idle periods on a round robin basis or some gain settings may be updated more frequently than others. Moreover the same gain setting may be used over multiple adjacent burst idle periods. At step the idle period terminates or is expected to terminate. Steps may be repeated for the next burst idle period for the next selected gain setting.

Other embodiments uses and advantages of the present disclosure will be apparent to those skilled in the art from consideration of the specification and practice of the disclosure disclosed herein. The specification and drawings should be considered exemplary only and the scope of the disclosure is accordingly intended to be limited only by the following claims and equivalents thereof.

