---

title: Multi-protocol wireless communication apparatus and method
abstract: A scalable, multi-protocol mobile switching center in a wireless communications network provides communications control for digital and analog wireless communications devices including devices that operate according to GSM and IS-41 standards. The hardware and software architecture of the switching center is designed so that processing that is unique to a particular protocol is performed at the lowest possible level, and remaining processing can use generic procedures. The switching center incorporates a home location register and visitor location register that are used in conjunction with software applications to determine the protocol of mobile communications devices using the wireless communications network. The mobile switching center can be used to provide a large scale distributed wireless network or a small scale wireless network. The switching center can also be used as an adjunct to a private branch exchange to provide in-building wireless services and call control. Graphical user interfaces make the wireless communications network easy to maintain.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07733901&OS=07733901&RS=07733901
owner: Tecore
number: 07733901
owner_city: Columbia
owner_country: US
publication_date: 20050412
---
This Application is a Continuation of U.S. application Ser. No. 09 245 292 filed Feb. 5 1999 now U.S. Pat. No. 6 912 230 entitled MULTI PROTOCOL WIRELESS COMMUNICATION APPARATUS AND METHOD which is hereby incorporated in its entirety by reference herein.

The invention is directed to a wireless communications apparatus and method. In particular the invention is directed to a multi protocol scaleable wireless switching platform and method.

Wireless communications in the United States were initially conducted solely through analog systems and protocols. The most prevalent analog protocol remains the Advanced Mobile Telephone System AMPS protocol. To handle wireless communications and to allow interconnection with traditional wired land lines switching systems and base stations were required. The analog switching systems are large and are designed to cover large markets and handle large volumes of calls.

In the 1990 s digital systems and protocols began to be used for wireless communications. Examples of digital protocols are the Global System for Mobile Communication GSM code division multiple access CDMA and time division multiple access TDMA . When wireless networks began to switch to digital protocols they could not simply upgrade their analog base stations to digital. New equipment for the digital facilities was required. However the networks continued to use large switching systems designed to cover their large spread markets. Examples of large switching systems are AT T s 5ESS system and the AXE system made by Ericsson. The 5ESS switch is described in detail in the AT T Technical Journal Vol. 64 No. 6 part 2 July August 1985 pages 1305 1564.

Large switching systems are designed to cover large markets and to handle many thousands of customers. The larger systems have the advantage of being able to provide a wide range of call options such as call forwarding caller identification and call waiting. The switching systems are expensive however and therefore may not be appropriate for small markets and wireless providers. Additionally large switching systems can be inefficient because of the added additional cost for increased back hauls of calls.

Typical switching systems employ proprietary architectures that use hardware components for switching external interfaces operating system and control.

A multi protocol mobile switching center MSC provides wireless communications for mobile devices operating on a local wireless network according to any standard protocol including those of the Global Systems for Mobile Communications GSM standards and IS 41 standards including time division multiple access TDMA code division multiple access CDMA and Advanced Mobile Telephone System AMPS . The MSC may be incorporated onto a single platform having a home location register HLR and an authentication center AC or AuC as well as a visitor location register VLR and an equipment identity register EIR .

The multi protocol MSC is scalable so that it may be used for a small number of customers such as in a rural setting to provide telephone access or as part of an in building communications network. The scalable multi protocol MSC may also be used to construct a large distributed wireless network. Thus the scalable multi protocol MSC provides the flexibility to be used with a wide range of customer bases and within a variety of different typographies.

Because the MSC can process wired and wireless calls according to any protocol a single switching center may serve customers who operate mobile and fixed communications devices regardless of protocol. This true multi protocol functionality makes this switching solution extremely efficient and cost effective and eliminates the need for separate protocol specific components.

The multi protocol MSC can be housed in a standard chassis. The multi protocol MSC can use standard off the shelf hardware for most data storage and processing functions. The multi protocol MSC can be easily updated to take advantage of industry advances by simply replacing select components in the chassis.

The multi protocol MSC provides full featured telephone and data services including wired and wireless analog and digital telephony conference calling prepaid calling emergency call routing and long distance resale. The multi protocol MSC also provides pocket switching applications such as asynchronous transfer mode ATM .

The multi protocol MSC incorporates advanced graphical user interfaces GUIs that display system data in a convenient easy to access format. A system operator can quickly select data for display and can easily modify selected data entries. The system operator can control operation of the multi protocol MSC using the intuitively structured GUIs.

The multi protocol MSC may incorporate a number of sophisticated features in addition to the HLR VLR EIR and the authentication center. These features include an operations and maintenance center wire line and tandeming services and hot real time billing and prepaid services.

When used for distributed switching the multi protocol MSC may reduce build out and operational costs associated with large switching centers. This architecture also eliminates needless back hauling by switching local calls locally. Finally the architecture allows for add on as a wireless customer base expands.

The multi protocol MSC includes a first interface that receives digital and analog communication according to a first protocol and a second interface that receives digital communication according to a second protocol. The first and the second interfaces include inter system system to system message handlers and intra system within system message handlers.

The hardware and software architecture of the MSC is designed to use generic signaling as much as possible to provide call connection and other functions. Protocol specific communications are handled at a device handler lower level and higher level processing uses generic messaging. A table may be used to map messages of the different protocols to the generic messages used by the MSC. The hardware of the aircore system is based on off the shelf industry standard components for each of the four areas typically found as proprietary in current systems. The use of off the shelf standardized switching components interface boards operating system and control processing provide a unique evolution path for the aircore system.

The HLR and VLR are structured so that data that does not depend on a specific protocol is stored in a common memory portion while protocol specific data is stored in protocol specific portions of the HLR and VLR. This logical arrangement of the HLR and VLR provides for quick access to data by components of the MSC and allows for easier updating by a system operator.

An advanced intelligent message AIM handler interfaces with the VLR and the HLR to determine the current location and identification of mobile units homed on the HLR or roaming in the local wireless network. The AIM also determines the protocol applicable for the mobile unit. For calls received at the MSC from a local wireless network base station the protocol determination may be made by reference to the protocol of the base station. For multi protocol base stations the determination includes decoding information provided in the service request or similar message sent by the base station. For other mobile units the MSC may communicate with external wireless components such as other HLRs VLRs and MSCs.

The MSC includes an authentication and registration system that controls registration of mobile communications devices operating on the system controlled by the MSC. The authentication and registration system also provides encryption and ciphering of voice and data communications.

The MSC can also be used as an adjunct to a private branch exchange PBX to create an in building wireless network. Used as such the MSC and HLR can be used to route calls preferentially among mobile units and fixed telephones and other communications devices.

Mobile telecommunications radio systems that permit customer calling from mobile stations such as automobiles or small light weight hand held personal communications units are becoming increasingly prevalent. These systems use the principles of cellular technology to allow the same frequencies of a common allocating radio bandwidth to be reused in separated local areas or cells of a broader region. Each cell is served by a base transceiver station comprising a group of local transceivers connected to a common antenna. Base station systems each including a controller and one or more transceiver stations are interconnected via a switching system called a mobile switching center MSC which is also connected to the public switched telephone network PSTN and the Public Land Mobile Telephone Network PLMN . These mobile telecommunications systems are now entering a second generation characterized by digital radio communications with a different set of standards such as the European Global System for Mobile Communications GSM standard promulgated by the Special Mobile Group SMG . The GSM standard is also being adapted for use in the United States. In addition in the United States CDMA TDMA DAMPS and AMPS are used for digital cellular mobile communications.

The mobile telecommunications systems have many components that need to communicate signaling information for controlling the establishment of connections. Such signaling information is communicated over channels that are separated from the channels carrying actual voice or data communications between the connected customers. Among the components that need to communicate to establish voice and data communication links are the mobile units the base station system connected by radio to the mobile units the mobile switching center and the various databases that are consulted for the establishment of mobile calls. These databases include a home location register HLR with an authentication center AC IS 41 or AuC GSM a visitor location register VLR and an equipment identification register EIR .

Signaling messages among these components are processed by many expensive protocol handlers. In the past these protocol handlers were too expensive to permit incorporation into a single unit. Modern switching systems typically include expensive MSCs such as AT T s 5ESS switch. These systems only make sense for deployment when there are a large group of mobile customers who will use the system.

This invention uses advanced signal processing a novel method of structuring signal processing software and an enhanced home location register visitor location register to provide multi protocol scaleable mobile telecommunications capability. The software architecture is specifically designed so that generic processing is used to the maximum extent possible to process signals and data related to different digital and analog protocols including GSM TDMA CDMA and AMPS and proprietary protocols.

Base transceiver stations BTSs receive messages from and transmit messages to the aircore platform over land lines . The land lines may be any telecommunications medium that is capable of high speed data transmission such as fiber optic cable T 1 and E 1 lines and coaxial cable for example.

The BTS transmits messages to and receive messages from mobile and fixed sources. In the BTSs are shown in wireless communication with mobile phones a mobile phone in a car a roaming mobile phone a microcell and a wireless local loop . The wireless local loop may include several connections. The wireless local loop is described in more detail below. A telephone may operate in conjunction with a private branch exchange PBX .

The BTSs may operate in conjunction with the fixed and mobile sources according to one of several wireless protocols as set forth above.

The aircore platform communicates with a public switched telephone network PSTN via a wired path and with a wireless network via a signal path .

The VLR contains the profile data for the mobile unit and the transient data for each mobile customer including the mobile unit s present or most recently known location area the mobile unit s on off status and security parameters.

An authentication center is used to ensure that only properly authorized mobile and wired sources communicate through the aircore platform . The authentication center provides authentication encryption parameters to ensure that a mobile customer cannot falsely assume the identity of another mobile customer and provides data for encryption of the voice data and control signals transmitted via the air between the mobile unit and the servicing base station system. Encryption is desirable for the transmission of messages between the mobile unit and the radio transceiver at a base station serving that mobile unit because it is possible to listen in or tap the radio channels carrying voice communications.

An equipment identity register EIR includes a database of the mobile equipment using the aircore platform including specific protocols and equipment preferences. The EIR retains the ranges of certified equipment identifications and the ranges of or the individual equipment identifications that are under observation or barred from service. The equipment identification information is received from a mobile unit at the MSC . The EIR is used to verify that the equipment number of the mobile unit is certified for use in the public network and is not on the observation or service barred list.

The MSC is connected to other wireless network components and to the PSTN for accessing land based customer stations and to the integrated services digital network ISDN for communicating according to ISDN protocols. A base station system BSS may include the BSC and one or more BTSs for communicating with mobile units. The BSS and the mobile units communicate via radio connections. The BSS is also connected via trunks to carry the voice data and control messages between the mobile units and the MSC . The BSC and the BTS may be in different physical locations for example the BSC may be co located with the MSC in which case a trunk is required to interconnect the two . This is done since the communications between the BTS and the BSC can typically be compressed to optimize the BTS connectivity requirements.

The aircore platform provides a full range of mobile services to a wireless local loop or location area. In the aircore platform is shown providing mobile services to a wireless local loop and a wireless local loop . In this type of mobility situation customers may move with their wireless terminals in a given wireless local loop or location area. Movement outside of the location area is not supported for these types of terminals. A typical implementation of this type of mobility is provided in a village or town scenario where the coverage is disjointed from other parts of the telecommunications system.

The aircore platform provides for intrasystem or base station wireless communication using GSM protocols via a GSM BSC and BTS . The aircore platform provides wireless communications using CDMA and TDMA via a IS 634 link an IS 95A BSC a BTS and a IS 136 BSC and BTS . The aircore platform communicates with an AMPS BTS using the ISDN PRI or the IS 634 protocol. The aircore platform provides communications with a private branch exchange PBX via T 1 E 1 lines. The aircore platform also provides for connection to a billing system using TCP IP protocols for example and for voice mail and messaging functions via voicemail module .

Table A shows a list of interfaces from the aircore platform and the functionality each of the interfaces adds. A Network Management Center Operations and Maintenance Center NMC OMC communicates with the aircore platform using TCP IP protocols for example. The billing system and the NMC OMC may also communicate with the aircore platform using CCITT X.25 protocols.

The call processing control module of the real time application layer handles the application layer tasks that are real time related. At the real time application layer of software direct knowledge of specific protocols is not required. Instead this layer handles functions from a generic standpoint. For example a call processing state machine processes mobile originated call set up in the same manner regardless of the type of interface used to connect to the base station equipment. The event set and state machine commonality allow lower layers of software to change without effecting the call processing control module of the real time application layer .

The device handler layer is the lowest layer of software in the aircore software architecture . The device handler layer contains the specific software applications to receive and transmit protocol specific messages.

The SCM layer includes a control panel CTL which is the father process of all the other processes in the system. The CTL is responsible for startup and auditing of the overall aircore software architecture . Once started the CTL is only involved in limited auditing functions.

A call record management SCR tracks the call report data generated in the system. These records can be used for billing tracking system tendencies or prepaid type of access. Call records are archived and the files rotated periodically. For example the files may be rotated hourly. Real time output is accessible via standard output options such as a printer or a screen output. Archived output is accessible on screen or may be accessed over a standard TCP IP network or dial up.

An operational measurements manager OMM is responsible for tracking system counters. A count is defined as the occurrence of a particular situation. Each time the situation occurs the counter is incremented. Operational measurements are archived and the files rotated periodically. For example the files may be rotated hourly. Each time a new file is created each of the counters is reset to zero. This type of data is captured to allow an operator to track system performance and tendencies over time. Operational measurements are archived into files rotated periodically. Real time output is accessible using standard output options such as a printer or a screen output. Archived output is accessible on screen or can be accessed over a standard TCP IP network or dial up.

A real time log report manager RTL tracks system level reports. System level reports are generated to notify an operator of certain tasks or situations occurring on the aircore platform . For example at the top of the hour the system level audit log reports may be output. Log reports range from reporting normal system maintenance events to system status changes. Log reports are archived into files rotated periodically. Real time output is accessible using standard output options such as a printer or a screen output. Archived output is accessible on screen or can be accessed over a standard TCP IP network or dial up.

An auto removal process AUTO is responsible for automatic removal of outdated archived report files. Automatic removal may occur on a periodic basis such as monthly.

A network management database administration NMS allows access to databases that provide configuration information for routing rating and language for mobile devices. A system configuration SYSCFG allows access to the configuration of system telephony hardware resources. A system maintenance SYSMTC allows access to operator initiated maintenance procedures.

A visitor location register interface VLI provides the operator access to a visitor location register. A home location register interface HLI provides an operator interface to the home location register and authentication center information. An equipment identity register interface EII provides an operator interface to the equipment identity register. The VLI HLI and EII may be implemented as a graphical user interface s GUI or as batch type operations. These interfaces will be described in more detail later.

The call processing control module CPCM of the real time application layer includes a recovery and startup REC which is the father process of the software subsystems in the real time application layer and at the device handler layer . The REC manages the maintenance states for the trunk and signaling facilities in the real time application layer . The REC interfaces with each of the device handlers in the device handler layer for maintenance and status as well as with graphical user interface based applications in the SCM layer to process operator initiated maintenance requests. The REC also initiates an audit of all real time application layer subsystems. The audit may run every two minutes for example and provides assurance that all subsystems are running properly.

A fault analysis unit FAU is responsible for the collection of all log reports and operational measurement related data created within the CPCM . The FAU to real time layer interface is a singular path for this information to pass. All CPCM subsystems have access to pass events to the FAU for this purpose.

The timer manager TIM provides timing facilities to call processing control module subsystems in the aircore platform . The TIM is used for application level timers that operate on a one second or greater granularity. Timers are stored in a list and are tracked until they are released or until they expire. Timers requiring finer granularity or those that are specific to a particular subsystem s requirements are controlled locally either in the subsystem or on board in the hardware. The timers associated with the aircore platform will be described later in more detail.

A resource manager RCM is used to manage base station resources connected to the aircore platform . The RCM has the capability to configure download and track the state of individual cell site components as well as the base station as a whole.

A CPCM call record management CCR module provides for local collection of call detail record CDR information for calls in progress. When calls are completed the CDR information is transferred from the CCR to the SCR in the SCM where the call record data is processed and stored.

A call processing manager CPM provides the processing required for all communication channel establishment tear down feature processing and hand off control. The state machines in place in the CPM are based on a half call model. Each party in a session moves through a defined set of states based on received and sent events and timers used. Each side of a call steps through its own state. The two sides of the call progress together. For a basic call setup the state of one side of the call is never more than one step ahead or behind the state of the other side. In the CPM each call placed requires the creation of a session object. This object is created based on an index number created from the board span and channel used by the originator of the call. The session adds and removes call objects as dictated by the progress of the call. The reference number for the session is always based on the originator s board span and channel. However the session may also be indexed via the index number of the board span and channel of any of the involved parties.

A hand off processor HOP is responsible for the preprocessing required for hand off or hand over GSM . Based on the technology and the involvement of intersystem border cells the level of involvement of the HOP varies from one air interface protocol to the next. However like other modules performing specific functions the unique aspects of the protocol are handled internally in the HOP . The interface to the CPM for hand off processing is made generic. Preprocessing in relation to handoff processing refers to the collection of data and the decision process used to determine the appropriate base station to target for the hand off. This entire process has been formed into a generic procedure within the aircore software architecture .

A tone and announcement manager TAM is responsible for management of the digital signal processor resources in the system used for playing tones and announcements. The TAM interacts directly with the CPM to provide the necessary digital signal processor allocations. The digital signal processors are controlled by components of the device handler . Direct communication to the device handler from the CPM is avoided so that the CPM does not have to maintain direct knowledge of the current digital signal processor configuration and allocations.

A visitor location register VLR is responsible for establishing and maintaining a VLR database for the aircore platform . As shown in the VLR is co located with the aircore platform . However the VLR could be located remotely from the aircore platform . The VLR is a collection of customer profiles for users currently active on the system. The VLR is a dynamic database created and maintained while the aircore platform is running. The VLR communicates with threads inside an Advanced Intelligent Message Handler AIM which will be described later for real time application messaging. Any communications to or from the VLR from the CPCM are received via the AIM . Communications with the VLI are limited to those necessary to allow for the display of individual customer profile information listing the current profiles in the VLR and allowing an operator the ability to update customer profiles from the VLR database.

A home location register authentication center HLR is responsible for establishing and maintaining the HLR database for the aircore platform . As shown in the HLR is co located with the aircore platform . However the HLR could also be located remotely from the aircore platform . In addition the functions of the HLR could be carried out in separate HLR and AC modules. The HLR includes a collection of permanent customer profiles for users homed on the system. The HLR is a static database that tracks the current location of a customer in addition to the individual profile parameters and status of customer related features. The HLR communicates with the AIM for real time application messaging. Any communications to or from the HLR in the CPCM are received via the AIM . Communications with the HLI are limited to those necessary to allow for the manipulation of individual customer profiles listing the current customer profiles in the HLR and allowing an operator to update the customer profiles.

The HLR also contains the functionality to perform the advanced security calculations used in digital air interface protocols. These calculations are based on a piece of secret data combined with a random number to yield a result that only has meaning to the authentication center and the mobile unit. This functionality is included in the HLR database and is integrated as part of the customer profile. The actual comparison of data is done in the AIM or in the HLR itself depending on the protocol. Since the authentication center is integrated in the HLR communications with the authentication center all funnel through the HLR . The authentication process will be explained in more detail later.

An equipment identity register EIR is responsible for establishing and maintaining an EIR database for the aircore platform . The EIR database is a collection of the serial number information for mobile telephone handsets and other equipment in the system. The EIR normally maintains at least three lists 

White range listing of valid international mobile equipment identities International Mobile Equipment Identity IMEI serial numbers .

The EIR is used with GSM type systems. However application to other system protocols may also be accomplished. The EIR communicates with the AIM for real time application messaging. Any communications to or in the EIR from the CPCM are received via the AIM . Communications between the EIR and the EII are limited to those necessary to allow for the manipulation of list information. This includes allowing an operator to add modify and delete from the information the EIR database.

The device handler includes a portion of the AIM . The device handler includes a device handler for digital CAS interface DHD a device handler for voice input and output devices DHA a device handler for ISDN interfaces DHI a device handler for conference DHC and a device handler for timers DHT . The AIM also includes a device handler for SS 7 DH .

Communications to various software entities such as the VLR HLR and EIR funnel through the AIM subsystem. This approach is taken to remove the knowledge of the low layer message destination from each of those entities. This approach also allows for the isolation of protocol specifics to the AIM layer of software. Finally this approach allows for the seamless separation of these functions to physically separate entities without effecting the application software. The following is an example of the benefit of this approach When the CPM needs to request the current location of a subscriber from the HLR the message is sent to the AIM subsystem without the direct knowledge of the HLR location or the protocol used to communicate with the HLR . The AIM handles the routing either internal or external and the selection and construction of the appropriate message based on the protocol.

In a main AIM thread is shown along with subordinate threads . In addition a common memory is used to share data related to a transaction or connection between the subordinate threads and the device handler for SS 7 DH . Since each of the procedures followed for call establishment location updating etc. involve multiple threads and actions the common memory optimizes the performance of the AIM by reducing the copying of data between threads while at the same time allowing data sharing across all of the threads by simply passing a pointer.

The A interface message handler AMH provides message decoding and encoding for interface processing between an external base station and the aircore platform event structures and state machines.

An authentication and registration processing ARS thread see provides appropriate calculations comparisons and invocations of the required authentication for a given base station interface. A paging processing PAG thread see provides the processing necessary for paging in the AirCore system. Paging is the mechanism for locating and starting the process of notifying a mobile unit of an incoming call or message.

Each channel in the DHD is allocated a thread for processing the low layer protocol state machine. As shown in spans are associated with processing threads and . The top layer process in the DHD architecture is responsible for the interworking between the thread output in the real time application layer .

Path between the REC and subsystem at the device handler layer is defined for startup status and maintenance communications used to interact with the telephony board level hardware. The REC communicates directly with all device handler level subsystems with the exception of the DH which is handled via communications with the AIM . Two way path between the CPM and the device handler layer is established for the exchange of messages for call processing related activities in the aircore platform . The CPM communicates directly with all device handler level subsystems with the exception of the DHA and the DH . Communications path between the TAM and the DHA provides for the allocation and deallocation of voice I O resources for tones and announcements. Much like trunk groups that abstract the physical location of trunks this level of communication abstracts the physical location of the digital signal processors used for playing the tones and announcements. Communications path between the AMH SMH IMH and the DH provides for communications between the SS 7 links and the builder decoder threads in the AIM .

As shown in the HLR includes customer profiles for each mobile customer. The customer profile includes a customer data module . The customer data module includes a customer group identification which is a four digit number specifying the routing translations index for the customer. The number must be previously configured in a routing translations data base via a routing administration window. The customer data module also includes the International Mobile Customer Identity IMSI the International Mobile Equipment Identity IMEI or Electronic Serial Number ESN which is the serial number of the handset hardware and the K or A key which is the key used for authentication calculations. The customer data module also includes the name of the customer the language for customer announcements a three to five digit carrier ID identifier for long distance carrier code associated with the customer a check box for calling card features and a prepaid feature. A call offering module includes an indication of current features such as call forwarding unconditional CFU call forward busy CFB call forwarding no reply CFNRy and call forwarding not reachable CFNRc and call forwarding default CFD .

A VLR MSC data module indicates the VLR in and the MSC associated with the current area of operation of the customer. A personal identification number PIN data module indicates if the customer uses a PIN when accessing the system for calling card or long distance calls and the four digit PIN number associated with the customer. A protocols module is used for multi mode customers to determine the capabilities of the customers units. The protocols may include but are not limited to TDMA CDMA GSM and AMPS. A call restriction module stores features for restricting the calling capabilities of the customer to and from the network. The call restriction features include baring of all outgoing calls suspended service no calls allowed baring of all outgoing international calls baring of all incoming calls baring of all outgoing international calls except those to the home PLMN country and baring incoming calls to a customer when they are roaming to another system.

A call features module indicates the set of features allocated to a customer. The call features include call hold multi party calling 3 way calling roaming call waiting and access to sending and receiving short messages. A line identification module identifies features that provide restrict calling and called number information to various parties in a call. The line identification features include calling line ID presentation calling number presentation connected line ID presentation calling line ID restriction calling number restriction and connected ID restriction.

A message center data module provides for storage of short messages pending delivery to a customer s mobile unit.

The HLR may also include an authentication center. The authentication center provides authentication and encryption parameters to insure that a mobile customer cannot falsely assume the identity of another mobile customer. The authentication center also provides data for encrypting the voice or data and control signals transmitted via the air between the mobile station and the serving base station subsystem. A GSM reference model prescribes digital communications over the radio channels. Since it is possible to surreptitiously listen to these channels encryption becomes desirable for the link between the mobile station and the radio receiver at a base station serving that mobile station. Any public or proprietary encryption algorithm known in the art can be used with the aircore platform .

The calculations for the authentication center use the secret key information associated with the subscriber and the protocol specific calculations. The HLR pre processes these authentication calculations and stores them as part of the subscriber profile. As required this information is shared with the servicing MSC VLR to authenticate the mobile unit as it accesses the system.

The VLR contains current data for each active mobile customer including that customer s mobile station present or most recently known location area the mobile unit s on off status and security parameters. The VLR is logically constructed in the same manner as the HLR .

The HLR and VLR databases both simultaneously accommodate customer profiles from any interface protocol. There are two significant classifications of profile types based on the intersystem protocol used to transmit and receive profile information over the wireless network. Both GSM and IS 41 based networks share common information in the customer profile structures but each profile type also requires fields and information that are unique to that particular protocol type. The HLR and VLR databases provide for this by an internal structure that uses a common top level header for the common data and then protocol specific attachments. This internal structure is shown in . A GSM side and an IS 41 side are used with the VLR and HLR databases. A common data header is used for both GSM and IS 41 profile information. A GSM specific data area is used for GSM specific data. An IS 41 specific data area is used for IS 41 specific data. The common data header allows the two sides of the database to use common search routines while the specific data areas allows for the storage of data that pertains to a specific protocol alone.

A description of the timers used by the MSC will now be provided. A call proceeds from initiation to connection through a series of steps. The time associated with this call set up and connection is usually short. Nonetheless one or more voice channels may be reserved at the start of the call set up. If the call will not connect some mechanism is desirable to release these resources as quickly as possible so that they may be used by other customers. Furthermore during the time that the mobile unit is held waiting for an incoming call the mobile unit cannot call out or receive other incoming calls. To free up resources and to release the mobile unit the TMR in conjunction with the TIM see includes a number of timers that may be established at various points in the call set up and connect process. The timers are generally set based on a message from the AMH or similar interface.

A timer may be set when a device handler such as the device handler requests a BSC to assign a channel. In this case the AMH sends a message to the TMR to set the timer. If an assignment is not completed within the time limit of the timer the call connection process ends. If the assignment is completed before expiration of the timer the AMH sends a message to the TMR to release the timer.

A timer may be associated with a connect message sent to the BSC by a device handler. If a connect acknowledgment message is received by the device handler the AMH will send a timer release message allowing the call connection to complete. Similarly a timer may be set to time out a make call command a paging message for a mobile terminated call a disconnect message GSM or release message IS 634 for PSTN and mobile originated calls and a clear command to release a channel during a call disconnect sequence. Other timers may be used to ensure resources are returned for assignment to other calls.

Managing the location of a customer ensures the proper connection of the customer s mobile unit for both mobile initiated calls and mobile terminated calls. In the authentication and registration ARS thread is shown in communication with the common memory . The common memory includes the data relevant to the mobile unit and the state machine relevant to the protocol and the transaction being performed. The ARS maintains communications with the AMH and the IMH to track ongoing transactions to compare SRES to send TMSI to the mobile unit and to provide ciphering information to the AMH . The IMH provides connections to the VLR and HLR for obtaining customer profile information.

The call processing module CPM processes calls according to one of several state machines. A state machine exists for each half of every call processed through the aircore platform . A separate state machine exists for mobile originated call processing PSTN originated call processing and mobile terminated call processing for example. are examples of state machines used in processing calls at the aircore platform . is a state machine for mobile originated call processing. In eight states are possible idle S wait for UUI S wait for page response S wait for alert S wait for connect S voice S wait for handoff confirm S tone and announce S and wait for call cleared S . The state machine shows the allowed transitions between states. Starting in idle S the state machine can transition to state wait for UUI S or wait for call cleared S. The state machine transitions to wait for UUI S based on reception of the mobile customer s profile when a CALL RECEIVED message is received. The state machine transitions from idle S to wait for call cleared S based on the mobile customer profile indicating a particular call restriction or if the call fails before routing. With the authentication previously set up with the A interface protocol this transition may not be possible.

In the wait for UUI state S the state machine can transition to the wait for alert state S. This transition is based on receiving the ROUTE CALL message. The aircore platform proceeds with making the call out to the called party if the call type is direct dial DD in the routing translations or when a call delivery to a mobile unit or another system is required. The CPM then sends a MAKE CALL message. Next the state machine can transition from the wait for UUI state S to the wait for page response S based on receiving a ROUTE CALL message. A PAGE MOBILE message is sent to the PAG . The transition to this state is based on a call type of MOB in the routing translations and finding that the called mobile unit is operating in the aircore system. The state machine transitions from the wait for UUI state S to the tone and announce state S if the dialed number received from the originating mobile unit fails to translate properly or if there is a restriction on the called mobile unit. The originating mobile unit is then connected to a tone. This transition could also occur by the CPM receiving a PAGE RESPONSE message with a time out indication. Finally the wait for UUI state S can transition to the wait for call cleared state S based on receiving a disconnect from the mobile unit. When the message CALL DISCONNECTED is received at the CPM a CLEAR CALL message is sent.

The state machine transitions from the wait for page response S to the wait for alert state S based on receiving a PAGE RESPONSE message. A MAKE CALL message is then sent and the CPM proceeds with an ISDN state machine . The wait for page response state S transitions to the tone and announce state S along transition path T based on receiving a time out for a page response. The CPM then provides a time out announcement or tone to the calling party. The state machine transitions from the wait for page response state S to the wait for call cleared state S along transition path T based on receiving a disconnect from the originating mobile unit. A CALL DISCONNECTED message is received at the CPM and a CLEAR CALL message is sent. The PAG thread will time out and clear the page request data for the call.

The state machine transitions from the wait for alert state S to the wait for connect state S along transition path T based on receiving an alerting indication from the called party. The alerting indication is passed to the mobile customer s side of the call. The CPM receives the CALL ALERTING message from the called party and sends an ALERT CALL to the originating mobile unit. The transition from the wait for alert state S to the voice state S occurs along transition path T based on receiving a connect indication from the called party. The protocol allows a CONNECT message to be received without receiving alerting. The CPM receives a CALL CONNECTED message from the called party and sends a CONNECT CALL message to the originating mobile unit. The transition from the wait for alert state S to the tone and announce state S is along transition path T. This transition occurs for two possible reasons. First the transition may be based on a time out waiting for the alerting indication. The called party is cleared from the call and the mobile customer is connected to an announcement or tone. The CPM sends a CLEAR CALL message to the called party. Second the transition may be based on receiving a disconnect from the called party with user busy. The originating mobile unit is sent an announcement and the called party is released from the call. The CPM receives a CALL DISCONNECTED message from the called party and sends a CLEAR CALL message to the called party. Finally the transition from the wait for alert state S to the wait for call cleared state S occurs along transition path T if the originating mobile customer disconnects from the call before the CPM receives the alerting indication from the called party. Clearing both parties is initiated. The CALL DISCONNECTED message is received from the originating mobile unit. The CPM sends a CLEAR CALL message to both parties.

The state machine may transition from the wait for connect state S to the voice state S along transition path T based on receiving connect indication from the called party. The connect indication is passed to the mobile customer. The CPM received a CALL CONNECTED message from the called party and sends a CONNECT CALL message to the originating mobile unit. Transition from the wait for connect state S to the tone and announce state S occurs when a time out occurs waiting for the connect. The called party is cleared from the call and the mobile customer is connected to a tone or announcement. The CPM sends a CLEAR CALL message to the called party. Transition from the wait for connect state S to the wait for call cleared state S occurs along transition path T if the originating mobile subscriber disconnects from the call before the CPM receives the connect indication from the called party. Clearing both parties is initiated. The CPM receives a CALL DISCONNECT message from the originating mobile unit and sends a CLEAR CALL message to both parties.

The state machine transitions from the voice state S to the wait for called clear state S along transition path T based on receiving a disconnect indication from either party. Call clearing is initiated for both parties on the call. A CALL DISCONNECTED message is received from one of the parties. The CPM sends a CLEAR CALL message to both parties. Transition from the voice state S to the wait for hand off confirm state S occurs along transition path T based on receiving a hand off request from the HOP subsystem and having a B channel to allocate to the target BTS for the hand off. The CPM receives a HAND OFF request from the HOP and sends a MAKE CALL message with a hand off indicating to establish the target channel. Finally the voice state S transitions back to the voice state S along transition path T based on receiving a hand off request and not having a B channel available to the BTS.

The state machine transitions from the wait for hand off confirm state S to the voice state S along transition path T based on three possible events. First the CPM receives a hand off confirmation from the serving BTS. This indicates the mobile unit has confirmed the hand off and is in transition to the target BTS. The voice connection is switched to the target BTS at this point. The CPM receives a HAND OFF CONFIRM message and sends a CLEAR CALL to the old serving channel. The voice path in connected to silence until the CALL CONNECTED message is received on the target channel. Second the CPM receives a hand off confirmation with a negative indication failed . This indicates that the mobile unit is not going to the target channel. The CPM starts a disconnect sequence to release the target channel. The CPM then sends a CLEAR CALL message to the target channel. Third the CPM receives a failure on the channel setup with the target BTS. The transition to the voice state S occurs and the CPM initiates or continues with the disconnect sequence with the target BTS channel. The CPM sends a CLEAR CALL message to the target channel. Transition from the wait for confirm state S to the wait for call cleared state S occurs along transition path T based on receiving a disconnect from either party while a target BTS channel is being established for the hand off. The CPM initiates clearing all resources and transition. The CPM receives a CALL DISCONNECTED message and sends a CLEAR CALL message to the parties.

The state machine transitions from the tone and announce state S to the wait for call clear state S along transition path T based on the originating mobile unit disconnect indication being received from the CPM . This can occur as a result of a time out after the tone or an announcement is played and a disconnect is not received. In this case the CPM initiates the disconnect with the mobile customer. The CPM initiates the disconnect with the mobile customer. The CPM either receives a CALL DISCONNECTED message and sends a CLEAR CALL message or the CPM receives a time out and sends a CLEAR CALL message.

The state machine transitions from the wait for call cleared state S to the idle state S along transition path T based on both parties confirming they are cleared from the call. In cases where there is no other party involved in the call the confirmation of the clearing of the party is implied by the fact that the cell never existed. This transition takes place when the call is completely cleared. The CPM receives a CALL CLEARED message from the originating mobile unit.

The state machine transitions from the wait for page response state S to the wait for alert state S along transition path T based on receiving a PAGE RESPONSE message. The CPM sends a MAKE CALL message and proceeds with the ISDN state machine. Transition from the page response state S to the tone and announce state S occurs along transition path T based on receiving a time out for a page response i.e. PAGE RESPONSE message received by the CPM with a time out indication . The CPM provides a time out announcement or tone to the calling party. Transition from the wait for page response state S to the wait for call cleared state S occurs along transition path T based on receiving a disconnect from the originating PSTN party. The CPM receives a CALL DISCONNECTED message and sends a CLEAR CALL message. The PAG thread will time out and clear the page request data for the call.

The state machine transitions from the wait for alert state S to the wait for connect state S along transition path T based on receiving an alerting indication from the called party. The alerting indication is passed to the PSTN side of the call. The CPM received a CALL ALERTING message from the called party and sends an ALERT CALL message to the originating PSTN party. Transition from the wait for alert state S to the voice state S occurs along transition path T based on receiving a connect indication from the called party. The protocol allows reception of the connection without receiving alerting. The CPM receives a CALL CONNECTED message from the called party and sends a CONNECT CALL to the originating PSTN party. Transition from the wait for alert state S to the tone and announce state S occurs along transition path T for two possible reasons. First transition may be based on a time out waiting for the alerting indication. The called party is cleared from the call and the PSTN party is connected to an announcement or tone. The CPM sends a CLEAR CALL message to the called party. Second transition may be based on receiving a disconnect from the called party with user busy. The originating PSTN party is sent an announcement and the called party is released from the call. The CPM receives a CALL DISCONNECTED message from the called party and sends a CLEAR CALL message to the called party. Transition from the wait for alert state S to the wait for call cleared state S occurs transition path T if the originating PSTN party disconnects from the call before the CPM receives the alerting indication from the called party. Clearing of both parties is initiated. The CPM receives a CALL DISCONNECTED message from the originating PSTN party and sends a CLEAR CALL message to both parties.

The state machine transitions from the wait for connect state S to the voice state S along transition path T based on receiving connect indication from the called party. The connect indication is passed to the PSTN party. The CPM receives the call connected message from the called party and sends the CONNECT CALL message to the originating PSTN party. Transition from the wait for connect state S to the tone and announce state S occurs along transition path T when a time out occurs waiting for the connect. The called party is cleared from the call and the PSTN party is connected to a tone or announcement. The CPM sends a CLEAR CALL message to the called party. Finally transition from the wait for connect state S to the wait for call cleared state S occurs along transition path T if the originating PSTN party disconnects from the call before the CPM receives the connect indication from the called party. Clearing both parties is initiated. The CPM receives a CALL DISCONNECTED message from the originating PSTN party and sends the CLEAR CALL message to both parties.

The state machine transitions from the voice state S to the wait for call cleared state S along transition path T based on receiving a disconnect indication from either party. Call clearing is initiated for both parties. The CPM receives the CALL DISCONNECTED message from one of the parties. The CPM then sends the CLEAR CALL message to both parties.

The state machines transitions from the tone and announce state S to the wait for call cleared state S along transition path T based on the originating mobile unit disconnect indication being received from the CPM . This can also occur as a result of a time out after the tone or announcement is played and a disconnect is not received. In this case the CPM initiates the disconnect with the mobile customer. The CPM either receives a CALL DISCONNECTED message and sends a CLEAR CALL message or the CPM receives a time out and sends the CLEAR CALL message.

The state machine transitions from the wait for call cleared state S to the idle state S along transition path T based on both parties confirming they are cleared from the call. In cases where there is no other party involved in the call the confirmation of the clearing of the party is implied by the fact that it never existed. Transition takes place when the call is completely cleared. The CPM receives the CALL CLEARED message from the originating mobile unit.

State machine transitions from the wait for alert state S to the wait for connect state S along transition path T based on receiving an alerting indication from the terminating mobile customer. The alerting indication is passed to the calling party s side of the call. The CPM receives a CALL ALERTING message and sends a ALERT CALL message to the calling party. Transition from the wait for alert state S to the voice state S occurs along transition path T based on receiving a connect indication from the called mobile unit. The protocol allows receipt of a receive connect message without receiving alerting. The CPM receives a CALL CONNECTED message from the called party and sends a CONNECT CALL message to the calling party. Transition from the wait for alert state S to the wait for call cleared state S occurs along transition path T if the calling party disconnects from the call before the CPM receives the alerting indication from the mobile customer. Clearing both parties is initiated. The CPM receives a CALL DISCONNECTED message from the calling party and sends a CLEAR CALL message to both parties. In addition in time out cases where the calling party is sent to an announcement the called mobile unit will receive a CLEAR CALL message from the CPM and make the transition.

The state machine transitions from the wait for connect state S to the voice state S along transition path T based on receiving a connect indication from the called mobile customer. The connect indication is passed to the calling party. The CPM receives a CALL CONNECTED message and sends a CONNECT CALL message to the calling party. Transition from the wait for connect state S to the wait for call clear state S occurs along transition path T that the calling party disconnects from the call before the CPM receives the connect indication from the mobile customer. Clearing both parties is initiated. The CPM receives a CALL DISCONNECTED message from the calling party. The CPM then sends a CLEAR CALL message to both parties. In addition in time out cases where the calling party is sent to an announcement the called mobile unit will receive a CLEAR CALL message from the CPM and make the transition.

The state machine transitions from the voice state S to the wait for call cleared state S along transition path T based on receiving a disconnect indication from either party. Call clearing is initiated for both parties in the call. The CPM receives a CALL DISCONNECTED message from one of the parties and sends a CLEAR CALL message to both parties. Transition from the voice state S to the wait for hand off confirm state S occurs along transition path T based on receiving a hand off request from the HOP subsystem and having a B channel to allocate to the target BTS for the hand off. The CPM receives a hand off request message from the HOP and sends a MAKE CALL message with a hand off indication to establish the target channel. Transition from the voice state S back to the voice state S occurs along transition path T based on receiving a hand off request and not having a B channel available to the BTS.

The state machine transitions from the wait for hand off confirm state S to the voice state S along transition path T in one of three situations. First. the CPM receives a hand off confirmation from the serving BTS. This indicates the mobile unit has confirmed the hand off and is transitioning to the target BTS. Voice connection is switched to the target BTS at this point. The CPM receives the HANDOFF CONFIRM message and sends the CLEAR CALL message to the old serving channel. The voice path is connected to silence until the CALL CONNECTED message is received on the target channel. Second the CPM receives a hand off confirmation with a negative indication failed . This indicates that the mobile unit is not going to the target channel. A disconnect sequence to release the target channel is started and the CPM sends a CLEAR CALL message to the target channel. Third the CPM receives a failure of the channel set up with the target BTS. Transition to the voice state S in initiation or continuation of the disconnect sequence with the target BTS channel begins. The CPM sends a CLEAR CALL message to the target channel. Transition from the hand off confirm state S to the wait for call cleared state S occurs along transition path T based on receiving a disconnect from either party while a target BTS channel is being established for the hand off. The CPM initiates clearing all resources and transition. The CPM receives a CALL DISCONNECTED message and sends a CLEAR CALL message to all parties.

The state machine transitions from the wait for call cleared state S to the idle state S along transition path T based on both parties confirming they are cleared from the call. In cases where there is no other party involved in the call the confirmation of the clearing of this party is implied by the fact that a call never existed. This transition takes place when the call is completely cleared. The CPM receives a CALL CLEARED message from the originating mobile unit.

The aircore platform uses a common facility state machine for tracking the states and conditions of external connections or trunks. Two portions of the state are tracked. Each facility has a near end and a far end state. The near end state represents the internal aircore state for the facility. The far end state represents the state of the facility as reported by the connected system. This state machine tracking applies to all aircore interfaces including traffic channels and signaling channels. Like call processing these maintenance procedures are generic in the aircore platform regardless of the interface.

The state machine transitions from the blocked state S to the unblocked pending state S over transition path T when either operator initiated or automatic recovery occurs which requests that the destination device handler bring the requested facility to an unblocked in service state. Transition from the blocked state S to the maintenance state S occurs along transition T when the facility is taken to a maintenance state to perform a maintenance or test operation. This transition is based on an operator action. Transition from the blocked state S to the not configured state S occurs along transition path T when the facility is disabled and or removed from the system configuration.

The state machine transitions from the unblocked pending state S to the unblocked state S over transition path T when a maintenance action is confirmed by the device handler. The facility is now in service. Transition from the unblocked pending state S to the blocked pending state S occurs over transition path T when a maintenance action is denied by the device handler or aborted by an operator action.

The state machine transitions from the unblocked state S to the call processing state S along transition path T when the facility is allocated and will be used for call processing. Transition from the unblocked state S to the blocked pending state S occurs along transition path T when either operator initiated or automatic maintenance action from the device handler. Transition also occurs based on other internal action requests that the destination device handler bring the requested facility to a blocked off line state.

The state machine transitions from the call processing state S to the unblocked state S over transition path T when the facility is released from being used in call processing. Transition from the call processing state S to the blocked pending state S occurs over transition path T when a maintenance action is either operator initiated or automatic from the device handler or other internal action requests that the device destination handler bring the requested facility to a blocked off line state.

The state machine transitions from the blocked pending state S to the blocked state S over transition path T when a maintenance action to take facility off line is confirmed by the device handler. In a case where the device handler does not respond the state may be reached by default of no response.

The state machine transitions from the maintenance state S to the blocked state S over transition path T when the maintenance action on the facility is completed. Operator action is required to transition the state back to the blocked state S.

In addition to monitoring the near end state of the system facilities the aircore platform also maintains the far end state of facilities where applicable. The far end state represents the status of a facility at the connected system side. The far end state and near end state are used together to determine the overall operational state.

The state machine transitions from the not configured state S to the blocked state S along transition path T when a facility is added to the configuration and enabled.

The state machine transitions from the blocked state S to the unblocked state S over transition path T when an unblocking request is received from the far end. Confirmation is then sent back with an unblocking acknowledgment message. Transition from the blocked state S to the unknown state S occurs over transition path T when a discrepancy has been detected between the state reported by the far end and the stored far end state for the facility in aircore platform . The blocked state S transitions to the not configured state S over transition path T when the facility is disabled and or removed from the system configuration.

The state machine transitions from the unblocked state S to the blocked state S over transition path T when a blocking request message is received from the far end. Confirmation is sent back with the blocking acknowledgment message. Transition from the unblocked state S to the unknown state S occurs over transition path T when a discrepancy has been detected between the state reported by the far end and the stored far end state for the facility in the aircore platform .

The state machine transitions from the unknown state S to the blocked state S over transition path T when the far end reports the state of the facility is blocked. Transition from the unknown state S to the unblocked state S occurs over transition path T when the far end reports the state of the facility is unblocked.

Hand off processing occurs when an active mobile unit transitions from a wireless region supported by one base station to a wireless region supported by a second base station. Hand off processing may also occur as a mobile unit transitions from one cell site within a wireless region to another sell site.

In base station controllers BSCs and and base transceiver stations BTSs are shown connected to the aircore platform via signal lines and respectively. The BSC has an associated wireless region that includes BTSs and . The BSC has an associated wireless region with BTSs and . The mobile unit is active in the wireless region at point A and communicates with a land line phone via PSTN the aircore platform the BSC and the BTS .

In the above description the BTS receives a call from a mobile unit. The mobile unit may be a mobile telephone or a computer with a wireless modem for example. In addition the BSC BTS may be replaced in some scenarios with a BSS or any other base station configuration.

During the course of a call the mobile unit transitions from point A in wireless region to point B in wireless region . As a result of this transition the BTS detects that the signal level of the cell has dropped below the minimum to continue the call on the current channel. The BSC notifies the aircore platform which begins hand off processing to establish a new cell site using the BSC . When the new cell site is established the aircore platform tears down the previous link thereby freeing up resources for other wireless customers.

In the scenario described above the BSC and are both associated with the aircore platform and certain hand off processing functions such as strength measurements are performed by the aircore platform . In a scenario involving a base transceiver station coupled to another mobile switching center the base transceiver stations may perform these hand off processing functions.

As with other processing functions the software architecture of the aircore platform is designed to use as much as possible generic processing for mobile unit hand offs. Thus communications from the mobile units operating according to different protocols e.g. GSM TDMA CDMA and AMPS are handled in a generic fashion except where specific differences are required. The message flows associated with these protocols will be described later.

Referring to once a base station detects that the signal level has either dropped below the minimum or exceeded the maximum to continue the call on the current channel hand off processing begins. Measurements are taken of bordering systems to determine the best candidate system or target base station. The HOP is involved in this for analog protocols and some inter system hand offs. Otherwise the step may be handled directly between the base station and the mobile unit. For digital protocols the base station sends the target information to the HOP for transmission to the CPM . For ISDN PRI and DHD based analog protocols the HOP determines the appropriate target for the hand off. Next the CPM is notified via the HOP of the required hand off and begins establishing a voice circuit to the target system. Once confirmed the CPM sends the hand off command to the current serving base station. This information is passed to the mobile unit. The mobile unit confirms the reception of the target information and switches to the new frequence and voice path. Upon arrival at the new frequency the new serving base station passes the confirmation to the CPM . The CPM switches the voice path during this process to the new channel and tears down the voice path to the old serving system.

As noted above the HOP preprocess is limited. After the hand off is in progress the HOP is no longer involved. Call processing uses the information provided by the HOP to establish appropriate resources to complete the hand off. Call processing is responsible for the control of the remaining portion of the hand off.

For ISDN PRI protocol hand offs a message is sent to the aircore platform from a base station to indicate that a mobile unit requires a hand off. The message specifies a protocol discriminator a call reference whose value is assigned in a SETUP message a message type and a user identification. The aircore platform in turn sends a hand off message request to the base station to request the base station measure a specific frequency. Finally the base station sends a message to the aircore platform to report the measured strength of the signal recorded on the base station.

ISDN PRI processing requires that the HOP accept a hand off request from the DHI . Appropriate hand off related information including call reference and RF channel for example is stored in the air core platform . The call reference is a number that is retrieved from the device handler thread data that is initially stored when call setup takes place. The RF channel is also retrieved from the device handler thread data. The air core platform then sends measurement requests to appropriate boarder cells sets a measurement request timer and processes responses from the base station.

For DHD based protocol hand offs the HOP accepts a hand off request from one of the device handlers in the aircore platform . The appropriate hand off related information including the call reference and RF channel for example are stored. The aircore platform allocates a voice channel and sends measurement requests SCANs to the appropriate border cells sets a measurement timer and processes responses received from the base stations. For base stations not chosen for hand off the aircore platform initiates a channel release. If a suitable target cell is determined the HOP send the information to the CPM for hand off.

For DHD based protocol hand off processing a voice channel is assigned to each base station when the measurement process takes place. For example if three base stations border the current wireless system and a measurement is to be taken a voice channel is explicitly reserved in each base station. When the target base station is chosen the voice channels in the other base stations must be released. To accomplish this release the device handlers will allocate and release the appropriate channels for the measurements in accordance with commands sent by the HOP . If an allocation fails or there are no channels available in a base station the device handlers send allocation failure events to the HOP and the HOP removes the base station from the candidate list for the current hand off.

IS 634 analog hand off processing requires the HOP to send a measurement request to the AIM . The measurement request is then sent to appropriate border cells. The measurement requests are sent back to the requesting base station and the information is forwarded to the HOP for determination of the target cell.

The strength measurement message is transferred to cells that are listed in a Cell Identifier List parameter that is sent in the message. The HOP stores the reference number against the requesting base station so the return messages find the correct base station. The reference number is timed in accordance with a base station timer for measurement collection. Responses received after timer expiration are discarded.

IS 634 TDMA hand off processing requires that the HOP determine based on information received from the base station in a hand off required message the appropriate candidate cell. The HOP then sends the appropriate information to the CPM . If the HOP does not find a suitable target cell the hand off is aborted.

IS 634 CDMA hand off processing requires the that HOP determine an appropriate target cell based on information received by the HOP from the base station. The HOP aborts the hand off if a suitable target cell is not determined.

GSM hand off processing requires that the HOP use information received from the base station in the hand off required message to determine appropriate target cells. Once again the HOP aborts the hand off if a suitable target cell is not located.

For hand off processing from a multiple protocol base station the message flows to the HOP indicate the appropriate protocol of the mobile unit. For intersystem hand offs messages related to the intersystem hand off preprocessing are sent from the HOP to the IMH and from the IMH . The border cell for measurement may be reached in the same manner as sending a message to multiple cell sites except that the messages are intersystem. Therefore the messages are sent to the IMH or are received from the IMH instead of the AIM base station threads DHI or DHD .

Each cell supporting hand off in the aircore system must have an associated list of border cells that are contacted in the event of a hand off attempt. These cells may have an identity that ties the cells to a link. These cells also have a protocol that the HOP and the CPM can use for determining message destination supported protocols and associated trunk groups all of which may be used for new voice circuit allocations.

Because the aircore platform is capable of processing a number of different protocol messages some mechanism must be provided to determine the correct protocol. For messages received from a single protocol BSS the aircore platform determines the correct protocol by reference to the protocol established for that particular BSS. The BSS is then associated with a signaling link mechanism that connects the BSS to the MSC . The link may be a SS 7 base TCP IP LAPD CAS and ATM for example. The MSC associates the type of protocol supplied by the BSS to any incoming messages received from the BSS. The actual protocol for the base station is determined when the link to the BTS or BSS is brought into service. One example is when the DH spawns a thread connecting the BSS to the MSC .

To ensure signaling messages used with the aircore platform perform the same generic function across protocols tables of messages may be used for different aircore platform functions. The table that follows shows some of the messages used for call processing in the aircore platform and the accompanying messages according to specific protocols.

Calls may fall into one of several scenarios including mobile originated a mobile unit originates the call mobile terminated a call to a mobile unit and PSTN originated for example. Mobile originated calls may be received at the MSC and may be originated at another wireless system intersystem . Mobile originated calls may also be received at a BTS and may then be passed to the MSC.

The aircore platform initiates a location update sequence to register a mobile unit with the aircore platform . A customer profile is retrieved from the VLR or HLR as necessary. Once a customer profile is retrieved the procedures for call setup across the protocols is generic. The use of a standard internal set of procedures allows the call processing of the aircore platform to be independent of the type of interface used when establishing the call. The events that are specific to a particular protocol are handled by individual components of the AIM . A CALL RECEIVED message announces arrival of an incoming call to the CPM . When this message is sent the customer profile is included as well as the selected traffic channel. The CALL RECEIVED message is sent based on proper profile retrieval authentication and channel selection. A ROUTE CALL message is sent to the CPM as an indication that the call may be routed to the network since the traffic channel allocation to the originating mobile unit was successful. The ROUTE CALL message is sent based on proper channel assignment for the call. An ALERT CALL event is received from the CPM as an indication that the far end of the call is in the alerting state. When this event is received an alert message is sent to the mobile unit. A CONNECT CALL event is received as an indication that the far end has connected the call. This indication is passed on to the mobile station in the connect message. The above four events are used between the CPM and all other subsystems for call originations in the system.

Mobile termination also uses a set of generic events and or messages. However mobile termination is more of a challenge than mobile origination since the current operating mode of a subscriber is not known prior to querying the relative databases. Similar to the mobile origination procedure and the location updating procedure mobile termination is generic for all base station type interfaces regardless of the protocol. The first query is to the HLR via the IMH . Call processing sends an event to the IMH requesting the current location of the customer and how to reach the customer. This request is sent without indication of the intrasystem protocol to use. The IMH utilizes the MIN MSISDN to HLR mapping table to determine a protocol and location of the HLR in the network.

For an internal HLR the event is built and sent to the HLR for processing. The protocol indicator is set based on the mapping table and a search is performed to locate the customer profile in the HLR database. If the customer profile is not found the HLR can optionally query the opposite side of the database in the case where the phone supports multiple modes and protocols. Once found the VLR is contacted if not local via standard procedures such as ROUTE REQUEST or PROVIDE ROAMING NUMBER.

For call tear down the aircore platform is based on the ISDN model for call release. This scenario is a three message sequence beginning with the requesting interface presenting notification of a disconnect. The notification is followed with a two event exchange with all involved subsystems for the call to command the release of the call and a return message to confirm the release. Low level processing in the aircore platform ranges from changing the state of supervision bits to a two or three message exchange.

The components shown in communicate via a set of generic messages. These messages indicate receipt of a call authentication call routing and call connection for example.

To ensure proper tracking of a call and the call s processing whenever a call comes into the aircore platform the AMH receives a notification from the DH . The AMH accesses the decoder thread to decode the incoming message and to determine the appropriate action. If the message is the first message associated with a call the AMH allocates an area in the common memory with an index to that area. For the duration of the call processing and the call the designated area will be used as needed during the transaction processing. For example the designated area includes the customer identification number and the base station identification.

The AMH can spawn threads unique to base station protocols such as GSM or RDMA TDMA or AMPS. The AMH may also spawn different threads depending on the manufacturer of a mobile unit.

The IMH works in a fashion similar to that of the AMH in that the IMH spawns different threads depending on the protocol required for the system GSM or IS 41 . When the IMH deals with internal events it shares the index and memory space used by the associated AMH . The IMH pulls the message from the memory space of the common memory created by the AMH using the index created by the AMH .

The IMH also processes events without the involvement of an AMH thread. For these situations the index and memory area are allocated by the IMH thread. Memory and index allocation are coordinated within the AIM subsystem.

The ARS communicates with the VLR via the IMH thread to retrieve the requisite information to authenticate the subscriber and determine the validity of the transaction. The processing of the ARS thread is made generic.

The PAG thread tracks the outstanding page requests that are in process for the system. The PAG thread receives incoming PAGE MOBILE events from the CPM when a mobile unit is to be paged on the aircore system. The PAG thread determines the appropriate base station resources that should be sent the PAGE message. The PAGE REQUEST message is then communicated to the appropriate AMH threads for processing. In a multi protocol environment the decision on the base stations that receive the PAGE REQUEST event is based on the last known technology that the mobile unit was operating on. If a mobile unit has GSM and CDMA capabilities and the last activity for the mobile unit was on the GSM portion of the system the PAG thread will process this as a GSM based paging. If however there is not a last known technology for the mobile unit all technologies within the mobile unit s capabilities are paged. If the mobile unit referenced above did not have a last known technology both the CDMA and the GSM based paging would take place. Once the PAGE RESPONSE message is received the AMH thread decodes the message and sends the decoded data via the common memory to the PAG thread where an association is made between the incoming PAGE RESPONSE and the previous outgoing PAGE REQUEST messages. Based on the responding base station the appropriate technology can be determined. The determination of the proper protocol at this point is much like the determination used for mobile originated actions. The responding base station determines the protocol based on its capabilities that were known when the interface to the base station was brought into service.

Call processing also uses a common reference scheme to track all events associated with a call. This scheme is illustrated in . Each call placed with the aircore platform leads to creation of a session with a session object header . The session object header is created based on an index number generated from the board span and channel used for the first party involved in the call. Board span and channel is a reference created relative to the physical interface used for system access. The session adds and removes call objects as dictated by the progression of the call. Each session has a reference number for the session that is based on the originator s board span and channel. However the session may also be indexed by an index number of the board span and channel of any of the parties involved in the session. As shown in each party object has its own data related to the customer or the interface to which it is related.

The authentication process may be initiated as a result of either a service request by a mobile unit or following the successful page of a mobile unit but is performed primarily under the control of the VLR. The authentication process may be set up to be performed every time a mobile unit originates a call or when a call terminates at a mobile unit. Authentication may also take place whenever a location is updated for the mobile unit that is in a power on or an idle state. Finally authentication may occur when a mobile unit registers by turning power on.

When a mobile unit originates a request for service the mobile unit sends a message to the MSC including the IMSI a mobile identification number MIN or a temporary mobile subscriber identification TMSI . The MSC may use the IMSI the MIN or the TMSI as the primary identification for the mobile unit. The IMSI is a permanent number that is assigned to every mobile unit. The MIN is a permanent number assigned to a mobile unit in the case where an IMSI is not used. MIN is used in older AMPS based mobile units . The TMSI is assigned to a mobile unit only after an authentication and has only local significance. If the TMSI is not recognized from the mobile unit then a request is made to use the IMSI to continue the authentication. Upon successful authentication a new TMSI if used is assigned to the mobile unit for future system access.

The authentication center is the source of data used in authentication. The authentication center does not store data for the customers. Instead the authentication performs calculations using random numbers that are used in conjunction with data in the HLR to generate authentication data. When a customer first subscribes for service the customer is assigned a secret key Kfor GSM A key for CDMA TDMA . The key and a random number supplied by the authentication are used by the authentication center to generate a result. The data calculations also yield values used for encryption keys. Depending on the protocol GSM or IS 41 based the authentication process can occur at different times during the establishment of communications between the mobile unit and the MSC . The similarities between the authentication procedures are found in the fact that they produce results that are used for both access verification and encryption. Although the security calculations the responsibility of the authentication center the initiation of the actual collection transmission of data and the comparison to determine the validity of the access is the responsibility of the ARS thread.

When authentication is requested the MSC sends the random number of the mobile unit. The mobile unit retrieves the Kfrom its initialization memory and calculates a signed response SRES and an encryption key K. The mobile unit then stores the Kand sends the SRES to the MSC. The ARS identifies that the SRES sent by the mobile unit matches the SRES calculated by the ARS . If the values match the value of Kstored in the mobile unit is assumed to be correct. This authentication process does not require that the encryption key Kor the initial key Kbe transmitted over the air thereby ensuring security for the encryption process.

An example of the GSM authentication process is described with reference to . The authentication process starts with step S. The process then moves to step S where a mobile unit sends a service request message to the aircore platform . The message includes the temporary mobile subscriber identification TMSI . The process them moves to step S. In step S the ARS compares the TMSI sent from the mobile unit to the TMSI recorded in the VLR . If the ARS recognizes the TMSI the process moves to step S. Otherwise the process moves to step S.

In step S the ARS requests the IMSI for the mobile unit from the VLR . The process then proceeds to step S. In step S the aircore platform sends a message to the mobile unit indicating that the mobile unit is recognized. The process then moves to step S.

In step S the mobile unit sends an authentication request message to the aircore platform . The process then moves to step S. In step S the aircore platform sends a random number to the mobile unit and the authentication center platform sends a random number to the mobile unit and the authentication center calculates a signed response SRES based on the random number. The process then moves to step S.

In step S the mobile unit after receiving the random number retrieves the case Kfrom its initialization memory and calculates the SRES and the encryption key K. The process then moves to step S. In step S the mobile unit stores the encryption key Kand sends the SRES to the aircore platform . The process then moves to step S. In step S the ARS compares the SRES calculated by the mobile unit with that calculated authentication center . If the two SRESs match the process moves to step S. Otherwise the process moves to step S. In step S the aircore platform sends a message to the mobile unit indicating that the authentication failed.

In step S the ARS completes the authentication process. The process then moves to step S. In step S the ARS determines if the mobile unit needs a TMSI. If the mobile unit needs a TMSI the process moves to step S. In step S the ARS assigns a TMSI to the mobile unit and stores the value of the TMSI in the VLR . The process then moves to step S. In step S the authentication process ends and call processing continues. The message flows associated with a failed authentication are shown in .

The above described authentication process is the GSM authentication procedure which is one of several authentication procedures available to the MSC. Other authentication processes may vary according to the call processing protocol for example.

The operation of the aircore platform in a multi protocol wireless environment is explained below with reference to .

When the aircore platform and base station controllers are first brought on line they exchange messages to ensure that all circuits are properly aligned. shows the reset and reset acknowledgment function when the base station controller is started. In base station controller BSC sends a reset message to the device handler DH to initiate the message sequence. The DH transfers the message to the AMH using DH  AMH TRANSFER . The AMH then sends an AMH REC RESET to the REC to initiate the reset. The REC returns a reset acknowledge to the BSC using the REC AMH RESET ACK which is sent to the AMH . The AMH transfers the reset acknowledgment to the DH using AMH DH  TRANSFER . The DH then sends a RESET ACK to the BSC . The BSC then sends a BLOCKING or CIRCUIT GROUP BLOCK to the DH . The DH sends a DH  AMH TRANSFER to the AMH which in turn sends an AHM REC BLOCKING or AMH REC CIRCUIT GROUP BLOCKING to the REC . This process then continues until all the circuits are in the appropriate state on the side of the aircore platform .

The aircore platform may interface with other wireless systems. To set up a call trunks are established between the two systems. are flow charts that show the message traffic used to establish and reset the trunks. shows the message flows when a far end system sends a blocking request to the aircore platform . A blocking is received from the BSC and transferred to the REC . The REC returns a REC AMH BLOCKING ACK to the BSC . The state of the trunk circuit established could move to blocked or to blocked pending depending on whether a call is currently on the channel. The REC assures the appropriate state changes occur.

If a call existed on the trunk circuit the message flows vary from that shown in . shows the message flows in this situation. In the BSC sends a RESET CIRCUIT which is transferred to the REC . The REC sends a REC CPM CLEAR CALL to the CPM . The CPM sends a CLEAR CALL to the AMH . The AMH then clears the call. In parallel the REC sends a REC AMH RESET CIRCUIT ACK which is transferred to the BSC .

The trunk circuit may also be reset by action taken by the aircore platform . shows the message flows in this situation. The REC initiates a REC AMH RESET CIRCUIT which is transferred to the BSC . The AMH sets the T timer using an AMH TMR SET TIMER RESET CIRCUIT . The BSC returns a reset circuit acknowledgment using RESET CIRCUIT ACK which is transferred to the REC . Because the REC received the reset circuit acknowledgment before expiration of the T timer the AMH sends a timer release message to the TMR releasing the T timer .

In some cases the BSC will not return a reset circuit acknowledgment message before expiration of the T timer . Message flows in this situation are shown in . When the T timer times out AMH sends a time out message to the REC . The REC then repeats the reset circuit procedure n number of times where n is a settable parameter. When the nth attempt to reset the trunk circuit fails an alarm is raised at the Operations and Maintenance system. The far end state of the circuit remains in an unknown state.

The aircore platform maintains the current location of mobile customers using the VLR and HLR . When a mobile customer enters the region serviced by the aircore platform the mobile customer s mobile unit will register with the aircore platform . show the message flows associated with this registration process.

At the ARS the update request triggers authentication processing if the mobile unit operates according to IS 41 protocols. The update request is then passed to the VLR . The VLR updates the active file for the mobile unit and returns a VLR registration notification response to the BSC . When the VLR registration notification response reaches the ARS GSM authentication and ciphering are completed if the mobile unit operates according to GSM protocols. The BSC receives a LOCATION UPDATING ACCEPT message from the DH . The DH also provides a CLEAR COMMAND to the BSC . At this time GSM TMSI reallocation occurs. The BSC sends a CLEAR COMPLETE to the DH which in turn sends a DH  AMH TRANSFER to the AMH .

The mobile unit was previously registered in the VLR . Therefore the mobile unit s location is simply updated and a VLR IMH REGNOT RESPONSE is returned to the IMH . The IMH sends an IMH ARS AUTHENTICATION RESPONSE to the ARS which in turn sends and authentication result to the AMH . The AMH then sends a LOCATION UPDATING ACCEPT to the BSC . The aircore platform may also perform GSM authentication and ciphering and TMSI reallocation .

The AMH sends a CLEAR COMMAND to the BSC . The BSC returns a CLEAR COMPLETE to the DH which sends a DH AMH TRANSFER to the AMH .

The BSC transmits a CM SERVICE REQUEST to the aircore platform where the message is received and processed by the DH . The DH establishes the SS 7 link and ensures proper message routing for the inbound message. The DH sends a DH  AMH TRANSFER to the appropriate AMH either the GSM or the IS 634 thread . The AMH sends an AMH ARS CM SERVICE REQUEST to the ARS .

The ARS provides the appropriate calculations and processing to authenticate the given base station interface. The ARS then sends an ARS IMH AUTHENTICATION REQUEST to the appropriate IMH . The IMH sends an IMH VLR REGNOT REQUEST to the VLR to notify the VLR of the incoming call. The VLR registers the mobile unit as an active unit and then sends a VLR IMH REGNOT RESPONSE to the appropriate IMH . The IMH sends an IMH ARS AUTHENTICATION RESPONSE to the ARS . If the mobile unit uses a GSM protocol GSM authentication and ciphering are completed at this point.

The ARS sends an ARS AMH AUTHENTICATION RESULT to the AMH and the appropriate AMH sends an AMH DH  TRANSFER to the DH . The DH sends a CM SERVICE ACCEPT to the BSC indicating to the BSC that the mobile unit is allowed to proceed with the call processing using the aircore platform .

During the above described processing for a GSM protocol mobile unit the ARS assigns the call a temporary mobile subscriber identity TMSI . The TMSI is calculated based on an index in the VLR the time of day and the identity IMSI of the mobile unit . The TMSI provides additional security so that if the mobile call is tapped the identity of the calling mobile party cannot be determined.

In the mobile call process then proceeds to the call setup stage and the BSC transmits a SETUP to the DH . The SETUP includes the call number and an identity of the mobile customer. The DH transfers the information to the appropriate AMH by sending a DH  AMH TRANSFER . The AMH then notifies the CPM that a mobile originated call has been received by sending a CALL RECEIVED . When the CPM is notified that the mobile call has been received the CPM allocates a voice channel for a mobile call to carry the voice between the aircore platform and the BSC . The mobile call is assigned a session number and each party of the mobile call is assigned an object of the mobile call.

The AMH the DH and the BSC communicate through a series of messages that the call assignment request has been made and completed. During this processing a T timer is used to time out the call in the event a voice channel cannot be readily assigned. Once the channel assignment is complete and the radio and voice channels are assigned the AMH sends a ROUTE CALL to the CPM informing the CPM to proceed with the call because all of the incoming wireless communication requirements have been established. The CPM determines based on the number that is to be dialed out what facility the call should go to and in what format. The CPM sends a MAKE CALL to the appropriate device handler DHD DHI or DH for a land based or wired call. If the number to be dialed is for a mobile unit the CPM sends a location request not shown through the IMH to the HLR to find out where the called mobile customer is.

As shown in the device handler returns a CALL ALERTING to the CPM indicating an attempt to connect to the called party. The alerting message is then passed to the BSC using an ALERT CALL AMH DH  TRANSFER and an ALERTING .

After the MAKE CALL is transmitted the called party should return a signal to the appropriate device handler which then sends a CALL CONNECTED to the CPM . The CPM sends a CONNECT CALL to the AMH which propagates as a CONNECT to the BSC . At the same time the AMH sets a T timer using a AMH TMR SET TIMER CONNECT to the TMR . The TMR then waits for a connection acknowledgment that indicates the called party and the calling party are connected. In particular the BSC sends a CONNECT ACK to the DH and the connect acknowledgment is propagated to the AMH . The AMH then releases the T timer by sending an AMH TMR RECS TIMER CONNECT to the TMR . At this point the mobile originated call is connected.

As shown in once the page response is received the ARS initiates an ARS IMH AUTHENTICATION REQUEST to the IMH . The IMH sends an IMH VLR REGNOT REQUEST to the VLR to retrieve the profile information from the VLR for the mobile unit . The VLR returns a VLR IMH REGNOT RESPONSE containing the requested data for the mobile unit in the VLR .

During the time period that the mobile unit is being paged and the authentication and registration notification messages are being passed authentication and ciphering may occur. In particular for IS 41 protocol systems authentication may occur at block . For GSM protocol systems GSM authentication ciphering and TSMI reallocation may occur at block .

As shown in when the AMH receives the authentication result the AMH initiates an AMH PAG PAGE RESPONSE which is passed to the CPM . The CPM then initiates a MAKE CALL . The aircore platform then proceeds to call setup channel assignment alerting call connection and call connection acknowledgment .

Once the RELEASE or RELEASE COMPLETE is received the AMH sends a CALL CLEARED to the CPM and a RELEASE COMPLETE is sent to the BSC . The DH then sends a CLEAR COMMAND to the BSC and an internal timer is set in the TMR . The BSC returns a CLEAR COMPLETE and the internal timer is released.

Occasionally a base station may not return a response to the MSC within the timeout specified. The message flows for this situation is shown in . The message flow begins after the service request message flows shown in messages are completed. A SETUP is sent from the BSC and in response the AMH sends a CALL RECEIVED to the CPM and sets the T timer . Because the BSC does not return a response to the ASSIGNMENT REQUEST the T timer times out and the AMH sends a DISCONNECT CALL to the CPM to initiate a clear call sequence. The CPM sends a CLEAR CALL to the AMH which is passed to the BSC as a DISCONNECT GSM or RELEASE IS 634 . The AMH also sets a channel release timer in order to release the channel if the BSC does not respond to the DISCONNECT .

The BSC then sends a RELEASE GSM or RELEASE COMPLETE IS 634 which is transferred to the AMH . The AMH releases the timer sends a CALL CLEARED to the CPM and sends a RELEASE COMPLETE GSM to the BSC . The AMH then sends a CLEAR COMMAND to the BSC and sets an internal timer . The BSC returns a CLEAR COMPLETE which is transferred to the AMH which then releases the internal timer .

In a service request is initiated using the same message sequence as shown in . The BSC then sends a SETUP which is received at the DH . The message is transferred to the AMH which sends a CALL RECEIVED to the CPM . The call proceeds through call setup until an ASSIGNMENT REQUEST is sent to the BSC . In this case however the BSC returns an ASSIGNMENT FAILURE . As a result the MSC proceeds with call tear down in the same manner as shown in .

The BSC returns an ASSIGNMENT FAILURE indicating for example that the BSC and the MSC do not agree as to the state of the channel allocated between the BTS and the MSC . The AMH sends a DISCONNECT CALL to the CPM which returns a CLEAR CALL . Call tear down then proceeds in the same manner as shown in .

Wireless customers can pay for their services in a variety of ways including an annual subscription and on a monthly basis for example. In both these cases the customer pays for the call actually made air time plus a periodic base fee. Customers can also pay for wireless services in advance through a prepaid system. is a logical diagram of an aircore prepaid rating system . The aircore prepaid rating system includes a data management module a rating administration module a distributor data module and distributor rate plans through . Thus a distributor can have up to ten different rate plans. Each customer can select one of the ten different rate plans for each distributor in the aircore prepaid rating system .

The distributor can be viewed much like a class of service is viewed in routing. The distributor is a classification of rating service that is assigned to certain groups of subscribers in the aircore system. A distributor could be a point of sale a corporate customer or an operator classification for a group of customers. Within each distributor there can be up to ten different rate plans configured. A rate plan establishes the air time rates for the plan. The combination of distributor and rate plan provide a comprehensive rating schedule for a variety of combinations within the system.

Within each customer profile see in the aircore HLR the parameter for prepaid service is configured as prepaid or not. The prepaid configuration of the customer is controlled via a prepaid check box and associated prepaid window and a graphical user interface see . The window is used to define the distributor and rate plan that the customer uses for the prepaid service. Also the credited amount for the account is input with the prepaid data. This field tracks the amount of service that a customer is allowed on the system. The amount is updated in real time to track the usage of the system by the customer.

A third part of the prepaid system is bill generation that is integrated as part of a call record management subsystem. The set of functions available allows the operator the ability to create a range of reports based on operator defined billing cycles.

In operation when a customer who has elected a prepaid plan uses the aircore prepaid rating system the customer profile is pulled from the HLR to determine the applicable distributor rate plan. The information from the customer profile is passed to the CPM . The CPM determines if the customer has an account balance sufficient to pay for the call. The CPM also determines the least cost route for the call including defining the land charge and the air time charge associated with the destination and time of day of the call to come up with the per minute charge. This value is then used to set a timer that will indicate when the customer s account reaches a balance that corresponds to two minutes left on a call.

Once the prepaid call has begun the timer begins a time out process and when the two minute position is reached a tone warning is provided to the customer indicating that the customer is running out of money. No further warnings are provided and once the next two minutes have expired the TMR sends a message to the CPM indicating that the time has expired. The CPM then initiates a call cutoff terminating the prepaid call. In this way the customer cannot overrun the prepaid account balance

At the completion of the call the billing system calculates how much the call actually cost for the customer and updates the amount in the HLR . A call detail record CDR is prepared that provides the detailed information regarding the call so that the billing system can determine the remaining account balance. The bill generated by the billing system is then used to update the customer profile .

In the wireless environment shown in there may be a need to locate customers who place distress or emergency 911 calls. These 911 calls are used to gain rapid access to local authorities and emergency service centers. if a customer places a 911 call from a wired device locating that customer is easy using call tracing procedures. Customers using wireless devices are more difficult to locate.

The air core platform solves the problem of wireless customer location by creating an identification number based on the current position of the customer in the wireless environment. The aircore platform uses the identification number as the dialed number to route the call to an emergency service center. The identification number includes the position data available from the BSS where the call origination is received. The location information received from the BSS is coded in hexadecimal. The aircore platform converts the hexadecimal number to binary coded decimal BCD and uses this number as an indication of the customer s location.

Following is an example of the data conversion used by the aircore platform to convert the location data received from the BSS to a dialed number for emergency callers. The data received could be as shown in the following table in which the BSS receives the location of a customer with cell ID granularity. The MSC converts the data as shown in the table.

The numbers produced from the conversion yields a unique 12 digit number identifying that cell in the system.

The aircore platform may incorporate the concept of customer groups to define the routing translations classes of service for the wireless network. A customer group is a table of number ranges that is used to determine if a call is allowable. The aircore platform searches the list of entries in the table. If a match is found the call is allowed to proceed. If a match is not found the call is not allowed to proceed in the wireless network.

The aircore platform allows for the definition of up to 256 different customer groups. Each customer in the system and each trunk is associated with a customer group when a customer group is initially configured. The customer group that is used for a particular call is determined based on 1 the customer placing the call and 2 the trunk that received the call.

For emergency calls a specific customer group is used to provide the routing translations. For emergency calling the aircore platform uses emergency translations.

In step S the aircore platform checks the portion of the customer group associated with emergency calls. The process then moves to step S. In step S the aircore platform determines if the dial up number from step S is in the customer group. If the dial up number is not in the customer group the process proceeds to step S and the call is routed to a default emergency center. If the dial up number is the customer group the process moves to step S. In step S the aircore platform changes the dial up number to an emergency center number. The process then moves to step S. In step S the call is routed to the emergency center. The process then moves to step S and ends.

The aircore platform can also support other communication features. For example the aircore platform may be used with a long distance resale system.

The aircore platform can also be used to provide microcellular wireless networks in combination with land line local networks or private branch exchanges PBX . There are several standards including computer supported telecommunications applications CTSA windows telephony application programming interface TAPI and telephony services application programming interface TSAPI for example that allow a PBX to incorporate equipment and features from outside vendors. These protocols also allow for call control and routing decisions to be made by a system that is external to the PBX. The external system can be used to allow for connectivity feature processing and seamless number management that allows customers to use both the PBX infrastructure and a separate wireless system using one telephone number and one customer feature profile.

The aircore platform provides an external control function to integrate a wireless system or microcell and a PBX using the technique of third party call control. is a diagram illustrating first party call control. In an application controls a call from a PBX to a telephone . The control of the call is related to each of the signals and messages passed between the telephone and the PBX . First party call control is often used as a call control feature in private branch exchanges.

A standard PBX interface control element SPICE may be added to the aircore platform to provide an interface to a PBX. The SPICE includes software that can operate with the control protocols of different PBXs. The SPICE interfaces internally with the HLR and the SCR see . A system operator may interface with the SPICE using a graphical user interface GUI .

The SPICE provides third party call control messaging needed to provide the notice of an incoming call decide how to handle the incoming call and send the appropriate commands to route the incoming call to the correct destination. The SPICE may be co located with the HLR and requires the basic retrieval capabilities of the HLR . The customer profile information in the HLR allows the SPICE to determine how to handle a call. For example the customer profile may indicate the operational modes for the customer s wired and wireless telephone handsets.

Customers whose PBX incorporates wireless features including the SPICE noted above may designate one or more operational modes for their telephone handsets. Customers may elect to have incoming call terminate at their desktop telephone first. If the desktop telephone is not available the call may be routed via a MSRN to the customer s mobile unit. Second the call may be first routed to the mobile unit. If the mobile unit is not available the call may be routed to the desktop telephone. Third the call may be routed to the customer s mobile unit only. Fourth the call may be routed to the customer s desktop telephone only. Fifth the call may be routed to the mobile unit only when operating in the mobile unit s home area.

One advantage of this arrangement is that the HLR may house the full suite of call forwarding features voice mail and announcements. The customer s profile determines how the call is handled.

If the customer profile indicates that incoming calls are first routed to a mobile unit the HLR will locate the customer in the telecommunications network and then have an MSRN allocated to deliver the call to the switch where the customer s mobile unit is residing.

If the customer profile lists the desktop telephone as the first call delivery option the SPICE determines that the call should be terminated to the desktop telephone. If the customer answers the desktop telephone SPICE s involvement in the call ends. However if the customer does not answer at the desktop telephone SPICE processing can determine the appropriate handling for the call. The call could be routed to the mobile unit voice mail or an announcement for example.

In operation a customer using both a wired telephone and a mobile unit may specify by entry in the database for example which of the wired telephone and mobile unit should receive a call. Thus when a call comes in to a particular customer the aircore platform will determine which of the wired telephone and the mobile unit to connect to first. The aircore platform can be further instructed that when the mobile unit is active or in a power on state all calls should first be routed to the mobile unit . If the mobile unit does not respond after a certain number of rings the incoming call can then be routed to the wired telephone . The microcellular network may also be used for visitors to the building . In this case a visitor having a mobile unit may have that mobile unit initiate a registration notification when the mobile unit enters the microcellular network . Then any incoming calls to the visitor s mobile unit will be routed through the aircore platform to the microcellular network .

When a customer of the building transits from the microcellular network to the external wireless network a location update is performed that deletes the customer s location in a VLR of the microcellular network and initiates a registration notification with the mobile switching center of the external wireless network . In this way the exact location of the mobile unit may be maintained so that calls to a particular customer may be routed in accordance with the customer s routing plan contained in a VLR HLR or the database .

In the arrangement described above a particular mobile unit and wired telephone may share a common telephone number. In an alternate arrangement the wired telephone and mobile unit may have different telephone numbers.

A microcellular network such as the microcellular network may also be adapted for use in large buildings such as indoor stadiums and convention centers. A mobile switching center such as the aircore platform may incorporate multi protocol processing and base stations so that visitors to the convention center may use mobile units inside the convention center regardless of the protocol established for the mobile unit. The aircore platform may be configured to charge different rates for different visitors to the convention center. People who work in the convention center may be charged yet another rate for using mobile units in the convention center.

The aircore platform may incorporate fault resilient features which may be particularly desirable for distributed wireless systems. The fault resilient hardware architecture of the aircore platform may be logically split into three layers as shown in . A hardware architecture includes a computing element layer . The computing element layer includes computing elements and . The computing elements and are connected by an appropriate communications medium such as an ethernet . The ethernet may have a capacity of 100 Mb or more for example.

An input output I O processor layer includes I O processors and . The I O processors and are connected by an appropriate communications medium such as a 100 Mb ethernet . The I O processors and are both connected to each of the computing elements and by an appropriate communications medium such as a 40 Mb fiber optic cable .

A telephony interface processor TIP layer includes a plurality of telephony interface processors TIPs . The TIPs are connected by a dual rail ethernet . The ethernet is also used to connect the TIPs with the I O processors and .

The three layers described above comprise the three main processing areas of the aircore platform . Communications between the three layers provides for a variety of physical layouts and geographical configurations. For example the fiber optic connection between the computing element layer and the I O processor layer can be geographically separated by 1.5 kilometers or more. The TIPs can be spread geographically and remotely controlled via a centralized computing element layer and I O processor layer set. Thus the aircore platform architecture can be adapted to provide a large distributed wireless network with centralized control or the layers can be co located.

The aircore platform may provide for local network connectivity and dial out access using a standard 10base T or 100base T Ethernet connection for LAN connecting options and a 56 k dial up modem for remote access dial in capability. Other advanced telecommunications connection devices may also be used with the aircore platform . Standard telephony boards may be used with the aircore platform for T 1 E 1 and ATM communications. For example the telephony boards include TH B1240 OCTAL T 1 E 1 interface boards for common channel signaling based T 1s. TH BD96 quad T 1 interfaces are provided for channel associated signaling using T 1s. TH BD120 quad E 1 interface devises are used for channel associated signaling using E 1s. TH BV30 voice I O provides 30 ports of I O and signal processing. TH BC64 provides conferencing capabilities. A TH BSS7 board provides both DS0 and V.35 connections. Each of the telephony boards provides 4 6 trunk links. Also connected to the aircore platform are operator interface devices including a monitor a keyboard and a mouse .

The switching architecture of the aircore platform or may be the H.110 H.100 based standard for example. The H.110 and the H.100 switching matrix is a standard Application Specific Integrated Circuit ASIC that resides on each board in the system. This means that rather than shipping all interface channels to a single point in the system to make and break the connections for switching each board controls its own switching. The H.110 switching matrix uses a J4 connector or connects to the other components of the aircore platform using a J4 connector on a back plane of the chassis . There may be a total of 32 streams running at speeds of 8 MH. Each stream provides 128 channels of 64 kbps. Total bus capacity ranges from 512 to 4096 channels.

The H.100 switching matrix uses a ribbon cable to connect to boards together to provide the actual streams of digitized channels. There are a total of 32 streams running at speeds of 2 MHto 8 MH. Each stream provides from 32 to 129 channels of 64 kbps. The total bus capacity ranges from 512 to 4096 channels.

The capacity of the aircore platform may be extended. Multi chassis configurations can be provided to claim the switch matrices together. This may be accomplished using several standard multi chassis interconnection interfaces or by connecting the chassis via E 1 or T 1 connections. The addition of ATM allows for a standard extension mechanism to the switch matrix between chassis.

Other hardware configurations besides the two embodiments described above are available with the aircore platform .

The aircore platform incorporates graphical user interfaces GUIs to aid operator manipulation of system data. show the hierarchy of windows used with the GUIs and also show examples of GUI screens used with the aircore platform .

GSM subscriber profiles are configured as per the GSM feature set. CDMA subscriber profiles are configured as per the CDMA IS 664 feature set. Multi mode subscriber profiles may be configured for multiple air interfaces. Multi mode subscribers use the common feature set between the GSM CDMA TDMA and AMPS protocols. All of the above subscriber profiles can incorporate prepaid feature functionality.

Prepaid subscriber profiles are configured as strictly prepaid in the aircore system. Prepaid subscribers may use wireless or wireless prepaid features.

Subscriber profiles for other wireless protocols are similar to that described above for a GSM subscriber.

The aircore system includes graphical user interfaces that allow the operator to perform maintenance actions on individual trunks in the system. When this option is chosen in an administration pull down menu not shown the operator first selects the appropriate span and channels then executes maintenance commands as required. shows the hierarchy of windows used for trunk maintenance. In the hierarchy includes a control panel window an administration window a facilities selection window and a digital trunk maintenance window .

Trunk group configuration is part of the system configuration of the aircore GUI. A trunk group is a logical assignment of characteristics to physical resources in the aircore system. Trunk groups are used to inform both the low level and high level software in the aircore system of how to process a call. Trunk groups also allow the operator to partition the system for specialized use by groups or subscribers. shows the trunk group selection window . A properties button is used to access the trunk group configuration window .

The aircore system generates call detail records CDRs to track system resource usage and call traffic for customers. Each CDR contains information pertaining to a particular part of a call. A CDR is a record created whenever there is call activity on the aircore system. The CDR manager is a subsystem in the aircore system responsible for generating and storing this information. The CDR manager provides the operator with a complete set of options for viewing data both real time and archive monitoring traffic on the aircore system and retrieving the data for off system archival. shows the hierarchy of windows used for call record management. The hierarchy includes the call record manager window archive window configuration window and billing window . The billing window and associated lower level windows are only available if the prepaid wireless package is configured. Associated with the configuration window are output selection window and auto removal window . Associated with the billing window is distributor selection window and bill generation window . The call record manager window provides operator access to view process or redirect call detail record outputs on the aircore system.

The aircore platform can provide as an option fully integrated prepaid functionality. This functionality can span across both wireless and wireline applications providing a seamless prepaid system. Furthermore this functionality is provided as an integrated software feature saving the cost and maintenance of a separate off board prepaid system. The prepaid system feature package provides full functional real time debiting for aircore customers complete with a full billing package and a comprehensive rating schedule. shows the rating administration window hierarchy that is used in conjunction with the aircore prepaid system. A database management icon screen is shown initially. Next a rating administration window is displayed. A distributor data window and a distributor properties window can be selected from the rating administration window . Finally from the distributor data window an add modify delete rate window can be accessed as well as individual rate plans 0 9 with associated add modify delete rate windows . The aircore prepaid system accommodates ten rate plans.

The billing window see provides access to customer billing records. The billing window is accessed from the menu bar of the call record manager window . When selected the distributor selection window shown in is displayed. The distributor selection window allows an operator to select a distributor for a billing calculation. The distributor selection window provides access to the billing generation window .

The aircore system provides for the configuration of up to twenty different language files for assignment to customers or for announcements. shows a languages administration window . The languages administration window provides operator access to a language configuration database in the aircore system. The language configuration window is accessed from the database management icon screen see .

While this invention has been described in conjunction with the specific embodiment outlined above it is evident that many alterations modifications and variations will be apparent to those skilled in the art. Accordingly the preferred embodiments of the invention as set forth above are intended to be illustrative not limiting. Various changes may be made without departing from the spirit and scope of the invention as defined in the following claims.

