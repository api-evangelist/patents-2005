---

title: Optical drive spin rate control
abstract: A method and system for controlling the spin rate of an optical device. A device driver provides notification that media has been inserted into the optical device. A control service determines the format of information on the media. The spin rate of the optical device is locked or unlocked based on the format.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07599264&OS=07599264&RS=07599264
owner: Microsoft Corporation
number: 07599264
owner_city: Redmond
owner_country: US
publication_date: 20050324
---
As the functionality of personal computers begins to converge with that of consumer electronics personal computers are beginning to be used in place of traditional consumer electronic devices. For example a personal computer may be connected to home entertainment components including a television speakers stereo receiver and set top box to perform the functions traditionally associated with specialized consumer electronics such as DVD and CD players digital video recorders stereo components and the like.

Consumers often expect little or no noticeable noise from consumer electronic devices when such devices are in operation. For personal computers on the other hand consumers have come to expect significant noise particularly as the personal computers perform certain operations.

Most of the new optical drives installed on personal computers are capable of performing data transfer at speeds that far exceed those capable by consumer electronic devices. For example a personal computer s CD drive may read data on a CD 40 times or faster than the speed that a consumer electronics CD player does. Similarly a personal computer s DVD drive may read data from a DVD at 8 times or faster than a consumer electronics DVD player. These faster transfer rates are accomplished by turning the media faster. Upon inserting media into a personal computer s optical drive the drive may spin up to its maximum speed to read the data off the media. When doing so the drive may create a high volume of noise due to the mechanics and physics of the drive.

What is needed is a method and system of decreasing the noise produced by optical drives of personal computers. Ideally such a method and system would not suffer in performance when reading data files not normally contained on consumer electronics media.

Briefly the present invention provides a method and system for controlling the spin rate of an optical device. A device driver provides notification that media has been inserted into the optical device. A control service determines the format of information on the media. The spin rate of the optical device is locked or unlocked based on the format.

In one aspect if the media includes multimedia files only the spin rate is locked at a speed compatible e.g. capable of playing without pauses to the multimedia files.

In another aspect if the media includes data files that are not multimedia files the spin rate of the optical device is unlocked e.g. the optical device is allowed to access the media at its maximum rate .

In another aspect if the media includes data files and multimedia files the spin rate of the optical device may be locked or unlocked based on heuristics.

Other aspects will become apparent from the following detailed description when taken in conjunction with the drawings in which 

The invention is operational with numerous other general purpose or special purpose computing system environments or configurations. Examples of well known computing systems environments and or configurations that may be suitable for use with the invention include but are not limited to personal computers server computers hand held or laptop devices multiprocessor systems microcontroller based systems set top boxes programmable consumer electronics network PCs minicomputers mainframe computers distributed computing environments that include any of the above systems or devices and the like.

The invention may be described in the general context of computer executable instructions such as program modules being executed by a computer. Generally program modules include routines programs objects components data structures and so forth which perform particular tasks or implement particular abstract data types. The invention may also be practiced in distributed computing environments where tasks are performed by remote processing devices that are linked through a communications network. In a distributed computing environment program modules may be located in both local and remote computer storage media including memory storage devices.

With reference to an exemplary system for implementing the invention includes a general purpose computing device in the form of a computer . Components of the computer may include but are not limited to a processing unit a system memory and a system bus that couples various system components including the system memory to the processing unit . The system bus may be any of several types of bus structures including a memory bus or memory controller a peripheral bus and a local bus using any of a variety of bus architectures. By way of example and not limitation such architectures include Industry Standard Architecture ISA bus Micro Channel Architecture MCA bus Enhanced ISA EISA bus Video Electronics Standards Association VESA local bus and Peripheral Component Interconnect PCI bus also known as Mezzanine bus.

Computer typically includes a variety of computer readable media. Computer readable media can be any available media that can be accessed by the computer and includes both volatile and nonvolatile media and removable and non removable media. By way of example and not limitation computer readable media may comprise computer storage media and communication media. Computer storage media includes both volatile and nonvolatile removable and non removable media implemented in any method or technology for storage of information such as computer readable instructions data structures program modules or other data. Computer storage media includes but is not limited to RAM ROM EEPROM flash memory or other memory technology CD ROM digital versatile disks DVD or other optical disk storage magnetic cassettes magnetic tape magnetic disk storage or other magnetic storage devices or any other medium which can be used to store the desired information and which can accessed by the computer . Communication media typically embodies computer readable instructions data structures program modules or other data in a modulated data signal such as a carrier wave or other transport mechanism and includes any information delivery media. The term modulated data signal means a signal that has one or more of its characteristics set or changed in such a manner as to encode information in the signal. By way of example and not limitation communication media includes wired media such as a wired network or direct wired connection and wireless media such as acoustic RF infrared and other wireless media. Combinations of the any of the above should also be included within the scope of computer readable media.

The system memory includes computer storage media in the form of volatile and or nonvolatile memory such as read only memory ROM and random access memory RAM . A basic input output system BIOS containing the basic routines that help to transfer information between elements within computer such as during start up is typically stored in ROM . RAM typically contains data and or program modules that are immediately accessible to and or presently being operated on by processing unit . By way of example and not limitation illustrates operating system application programs other program modules and program data .

The computer may also include other removable non removable volatile nonvolatile computer storage media. By way of example only illustrates a hard disk drive that reads from or writes to non removable nonvolatile magnetic media a magnetic disk drive that reads from or writes to a removable nonvolatile magnetic disk and an optical disk drive that reads from or writes to a removable nonvolatile optical disk such as a CD ROM or other optical media. Other removable non removable volatile nonvolatile computer storage media that can be used in the exemplary operating environment include but are not limited to magnetic tape cassettes flash memory cards digital versatile disks digital video tape solid state RAM solid state ROM and the like. The hard disk drive is typically connected to the system bus through a non removable memory interface such as interface and magnetic disk drive and optical disk drive are typically connected to the system bus by a removable memory interface such as interface .

The drives and their associated computer storage media discussed above and illustrated in provide storage of computer readable instructions data structures program modules and other data for the computer . In for example hard disk drive is illustrated as storing operating system application programs other program modules and program data . Note that these components can either be the same as or different from operating system application programs other program modules and program data . Operating system application programs other program modules and program data are given different numbers herein to illustrate that at a minimum they are different copies. A user may enter commands and information into the computer through input devices such as a keyboard and pointing device commonly referred to as a mouse trackball or touch pad. Other input devices not shown may include a microphone joystick game pad satellite dish scanner a touch sensitive screen of a handheld PC or other writing tablet or the like. These and other input devices are often connected to the processing unit through a user input interface that is coupled to the system bus but may be connected by other interface and bus structures such as a parallel port game port or a universal serial bus USB . A monitor or other type of display device is also connected to the system bus via an interface such as a video interface . In addition to the monitor computers may also include other peripheral output devices such as speakers and printer which may be connected through an output peripheral interface .

The computer may operate in a networked environment using logical connections to one or more remote computers such as a remote computer . The remote computer may be a personal computer a server a router a network PC a peer device or other common network node and typically includes many or all of the elements described above relative to the computer although only a memory storage device has been illustrated in . The logical connections depicted in include a local area network LAN and a wide area network WAN but may also include other networks. Such networking environments are commonplace in offices enterprise wide computer networks intranets and the Internet.

When used in a LAN networking environment the computer is connected to the LAN through a network interface or adapter . When used in a WAN networking environment the computer typically includes a modem or other means for establishing communications over the WAN such as the Internet. The modem which may be internal or external may be connected to the system bus via the user input interface or other appropriate mechanism. In a networked environment program modules depicted relative to the computer or portions thereof may be stored in the remote memory storage device. By way of example and not limitation illustrates remote application programs as residing on memory device . It will be appreciated that the network connections shown are exemplary and other means of establishing a communications link between the computers may be used.

The application is a user mode or kernel mode process that executes in the environment and that attempts to read from the optical device . The control service is a user mode or kernel mode process that determines the spin rate of the optical device . The control service may register with the optical device driver to be informed when media is inserted into the optical device . The control service may also instruct optical device driver to lock the spin rate of the optical device at a particular speed e.g. 1 2 4 or some other rate depending on what is contained in the media inserted into the optical device. For example if the media contains data in a multimedia format the control service may instruct the optical device driver to lock the spin rate of the optical device at 1 or 2 to reduce noise save battery power and so forth.

Determining whether the media contains data in a multimedia format may involve various heuristics. For example if the media includes data formatted as a picture CD video CD in red book audio DVD audio or some other audio format in DVD movie format or in some other industry defined multimedia format the control service may determine that the media is in multimedia format and may act accordingly.

If a media includes data files and multimedia files hereinafter mixed mode media the percentage of multimedia files to data files may be used to determine whether to lock the optical device at a particular spin rate. For example in a mixed mode media if the percentage of multimedia files exceeds a threshold e.g. 90 the control service may determine that the optical drive should be locked at a particular spin rate. Multimedia files may include files having extensions such as .JPG .AVI .TIFF .BMP .WAV .MP3 .WMA and other extensions that indicate audio or visual data. When a mixed mode media includes files that need different access rates e.g. 150 Kbs 750 Kbs 1500 Kbs etc. the control service may cause the spin rate of the optical device to be locked at a spin rate that allows the file with the highest access rate to be played e.g. 1500 Kbs .

In one embodiment when a mixed mode media is in the optical device the control service causes the spin rate of the optical media to be locked at a particular spin rate until an application accesses data that is not in multimedia format e.g. a word processing document spreadsheet document or the like . After an application accesses data that is not in multimedia format the spin rate may be unlocked and may or may not be locked again even if later a multimedia format file is accessed on the media.

In another embodiment based on its needs the application may instruct the optical device driver to lock the spin rate of the optical device at a particular rate. For example the application may instruct the optical device driver to lock the spin rate of the optical device at a rate selected by the application. When an application instructs the optical device driver to lock or unlock the spin rate of the optical device this may override a spin rate lock or unlock set by the control service .

If more than one application instructs the optical device driver to lock or unlock the spin rate of the optical device the spin rate of the optical device may depend on the last instruction received by the optical device driver . For example if one application instructs the optical device driver to lock the spin rate at one rate and later another application instructs the optical device driver to lock the spin rate at another rate the optical device driver may lock the spin rate of the optical device at the one rate until the second instruction to lock at the other rate is received. Then the optical device driver may lock the spin rate of the optical device at the other rate. The spin rate may remain locked at the other rate until an application requests that the optical device driver lock or unlock the spin rate or until new media is inserted into the optical device .

If an application opens the optical device for exclusive access and instructs the optical device driver to lock the spin rate of the optical device the optical device driver may lock the spin rate of the optical device at the requested rate and may ignore subsequent requests from other applications until the first application releases its exclusive access to the optical device .

If no application has requested that the spin rate of the optical device be locked at a specified rate the control service may determine whether to lock or unlock the spin rate of the optical device depending on the format of data in the media inside the optical device . If the control service determines that the optical device may have its spin rate unlocked the control service instructs the optical device driver to unlock the spin rate of the optical device . The optical device may then spin at its maximum rate until new media is inserted therein or an application subsequently locks the spin rate Locking or unlocking the spin rate of the optical device via the control service typically occurs shortly after media is inserted into the optical device .

The control service and the application may communicate with the optical device driver through an application programming interface API of the optical device driver .

It will be recognized that the control service allows the optical device to be spin rate locked even if no applications are aware of this feature. Thus installing the control service in an existing environment may provide the benefits of spin rate locking and unlocking without requiring that all the applications in the existing environment be updated.

The optical device driver may comprise a kernel mode or user mode process that may be used to access data on the optical device . The optical device driver may inform any applications including the application and the control service that have registered with it when media has been inserted in the optical device . As previously mentioned the optical device driver may also lock or unlock the spin rate of the optical device in accordance with instructions received from other processes.

The optical device includes any device that may be used to access optical or optical magnetic media including a CD CDRW DVD or DVDRW drive for example. It will be recognized that aspects of the invention may also be applicable to other devices that have controllable spin rates and that may need to spin slower to reduce noise or for other reasons.

At block media is inserted into the optical device. For example a DVD or CD is inserted into an optical device.

At block the control service receives notification that media has been inserted into the optical device. The control service may receive this notification from an optical device driver for example.

At block the control service determines the format of the media. If the format is an industry or otherwise defined multimedia format the control service may determine that that the media is in multimedia format. If so at block processing branches to block otherwise processing branches to block . If the media is in mixed mode the control service may determine that the media is not in multimedia format and processing may branch to block .

At block the control service locks the drive at a low speed compatible with the multimedia format e.g. 1 via the optical device driver. At block the control service unlocks the drive to allow maximum speed. At block the actions end. The actions above may be repeated each time media is inserted into the optical device.

At block media is inserted into the optical device. For example a DVD or CD is inserted into an optical device.

At block the control service receives notification that media has been inserted into the optical device. The control service may receive this notification from an optical device driver for example.

At block the control service determines the format of the media. If the format is an industry or otherwise defined multimedia format or mixed mode media format that is significantly multimedia e.g. by percentage of multimedia files the control service may determine that the optical drive should be spin rate locked. If so at block processing branches to block otherwise processing branches to block .

At block the control service calculates a bitrate of the content on the media. If the media contains multimedia files of a single type e.g. MP3 the control service may determine the bitrate needed to play the files. If the media contains non homogenous multimedia files the control service may determine the bitrate by finding the maximum bitrate that any of the multimedia files needs to be played correctly. In some multimedia files the needed bitrates may be found in the headers of the multimedia files. In other multimedia files the type of file as indicated by its extension determines the bitrate the file needs.

If the bitrate needed to play a file is between two bitrates that are supported by the optical device the control service may determine that the higher bitrate of the optical device should be used. For example if an optical device supports 150 Kbps and 300 Kbps bitrates and multimedia files on the media need to be read no slower than 200 Kbps to play correctly the control service may determine that 300 Kbps should be used on the optical device.

At block the control service unlocks the drive to allow maximum speed. At block the actions end. The actions above may be repeated each time media is inserted into the optical device.

At block the application specifies a speed for the optical drive. The application may specify a particular bitrate e.g. 1500 Kbps or a multiple of an industry standard e.g. 1 2 etc. .

At block the optical device driver locks the speed of the optical drive to the requested speed and overrides any previous spin rate. If the optical drive is not capable of playing information at the speed requested by the application e.g. the speed falls between two allowed speeds the optical device driver may lock the spin rate of the optical device at a higher speed e.g. the higher of the two speeds .

In another embodiment of the invention the application locks the speed of the optical device by communicating directly with the optical device driver.

At block the actions end. The actions represented in may occur asynchronously with respect to the actions represented in or . If they occur before the control service has locked or unlocked an optical drive the control service may not perform any other actions it would have performed in or . If the actions represented in occur after the actions represented in or the control service locks the optical device at the speed specified.

It will be readily recognized that various aspects of the invention have various advantages. One advantage relates to noise reduction. Locking the spin rate of an optical device may reduce the noise emitted by the optical device. This may make it more practical and pleasing to consumers to replace a specialized consumer electronic device or devices with a personal computer.

Another advantage relates to power consumed by the optical device. An optical device may consume less power if it is locked at a slower rate. This may be important in portable computers that rely on batteries for power. For example a portable computer may be able to play all of a multimedia DVD or CD or may be able to stay on longer between recharging if the optical device is locked at a slower speed.

Another advantage relates to latency in accessing data on optical media. When a drive is spin rate locked it may not need to accelerate its spin rate to its maximum speed before accessing data on the drive. Accelerating the spin rate to the maximum speed takes some time and may introduce unacceptable or annoying latencies particularly right after media is inserted into the optical drive. By allowing the drive to accelerate to only a fraction of its maximum speed the latency in accessing data on the drive particularly at spin up may be reduced.

Another advantage relates to longevity of the optical device. Spinning an optical device at a speed less than its maximum speed may lengthen the lifetime of the optical device.

Another advantage relates to error correction. Spinning optical media at an accelerated rate may introduce the need for more error correction than spinning the media at a slower rate. By locking the spin rate at a slower speed less error correction may be needed.

Fewer more or other advantages may also be realized by various aspects of the present invention without departing from the spirit or scope of the present invention.

As can be seen from the foregoing detailed description there is provided a method and system for controlling the spin rate of an optical device. While the invention is susceptible to various modifications and alternative constructions certain illustrated embodiments thereof are shown in the drawings and have been described above in detail. It should be understood however that there is no intention to limit the invention to the specific forms disclosed but on the contrary the intention is to cover all modifications alternative constructions and equivalents falling within the spirit and scope of the invention.

