---

title: Tool for selecting ink and other objects in an electronic document
abstract: A note-taking application is provided which includes a free-form selection tool. In certain embodiments, a particular selection may be based in part on the speed or velocity of a user selection. The free-form selection tool is configured to provide more or less precise selections based in part on the speed of a selection. The free-form selection tool is further operable to recognize when a user is attempting to retry a selection.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07454702&OS=07454702&RS=07454702
owner: Microsoft Corporation
number: 07454702
owner_city: Redmond
owner_country: US
publication_date: 20050321
---
Free form document editors can be utilized in electronic tablets and other computing devices. A free form document editor is operable to record handwriting and other free form input such as note taking input for example. Electronic tablets typically include a screen and a handheld device that is similar to a pen also referred to as a stylus . A user can use the pen to write on the electronic tablet in a manner similar to the use of traditional pen and paper. The electronic tablet can read the strokes of the user s handwriting with the handheld device and render the handwriting in electronic form on the tablet s screen and or the computer s display as electronic ink .

Some free form document editors allow the input of digital text and other digital objects pictures images etc. as well. ONENOTE 2003 provides a single place to electronically capture and organize typed and handwritten notes audio recordings graphics and other rich media. However free form document editors are limited as to how electronic ink digital text and other digital objects are selected and manipulated individually or as one or more groups within a file. For example certain free form document editors only allow range space selection or even marquis style selection using a pen. Additionally users would prefer a more natural experience when using a pen to select electronic ink digital text and other digital objects.

It is with respect to these considerations and others that the various embodiments of the present invention have been made.

The present invention provides a method computer readable medium and a system for selecting one or more elements of an electronic document. The elements may include ink text pictures and other objects. According to the invention a note taking application is provided which includes a free form selection tool. In certain embodiments a particular selection using the tool may be based in part on the speed or velocity of a user selection. The free form selection tool is configured to provide more or less precise selections based in part on the speed of a selection. The free form selection tool is further operable to recognize when a user is attempting to retry a particular selection.

The invention may be implemented as a computer process or method a computing apparatus or as an article of manufacture such as a computer program product or computer readable media. The computer program product may be a computer storage media readable by a computer system and encoding a computer program of instructions for executing a computer process. The computer program product may also be a propagated signal on a carrier readable by a computing system and encoding a computer program of instructions for executing a computer process.

These and various other features as well as advantages which characterize the present invention will be apparent from a reading of the following detailed description and a review of the associated drawings.

Exemplary embodiments of the present invention provide a note taking application which includes a free form selection tool. In certain embodiments a particular selection using the tool may be based in part on the speed or velocity of a user selection. The free form selection tool can be configured to provide more or less precise selections based on the speed of a selection. The free form selection tool is also operable to recognize when a user is attempting to retry a particular selection.

Referring now to the drawings in which like numerals represent like elements various aspects of the present invention will be described. In particular and the corresponding discussion are intended to provide a brief general description of a suitable computing environment in which embodiments of the invention may be implemented. While the invention will be described in the general context of program modules that execute in conjunction with program modules that run on an operating system on a personal computer those skilled in the art will recognize that the invention may also be implemented in combination with other types of computer systems and program modules.

Generally program modules include routines programs components data structures and other types of structures that perform particular tasks or implement particular abstract data types. Moreover those skilled in the art will appreciate that the invention may be practiced with other computer system configurations including hand held devices multiprocessor systems microprocessor based or programmable consumer electronics minicomputers mainframe computers and the like. The invention may also be practiced in distributed computing environments where tasks are performed by remote processing devices that are linked through a communications network. In a distributed computing environment program modules may be located in both local and remote memory storage devices.

Referring now to an illustrative operating environment for embodiments of the invention will be described. As shown in computer comprises a general purpose desktop laptop tablet or other type of computer capable of executing one or more application programs. In particular according to the various embodiments of the invention the computer is operative to execute a note taking application . As known to those skilled in the art a note taking application program provides functionality for many features including capturing and organizing notes which may include text handwriting pictures drawings audio or other information.

According to one embodiment of the invention the note taking application comprises the ONENOTE note taking application program from MICROSOFT CORPORATION of Redmond Wash. It should be appreciated however that the various aspects of the invention described herein may be utilized with other note taking applications and other related programs from various manufacturers. Moreover although the inventive aspects described herein are presented in the context of a note taking application program it should be appreciated that other types of application programs may also be utilized to embody the various aspects of the invention.

The mass storage device is connected to the CPU through a mass storage controller not shown connected to the bus . The mass storage device and its associated computer readable media provide non volatile storage for the computer . Although the description of computer readable media contained herein refers to a mass storage device such as a hard disk or CD ROM drive it should be appreciated by those skilled in the art that computer readable media can be any available media that can be accessed by the computer .

By way of example and not limitation computer readable media may comprise computer storage media and communication media. Computer storage media includes volatile and non volatile removable and non removable media implemented in any method or technology for storage of information such as computer readable instructions data structures program modules or other data. Computer storage media includes but is not limited to RAM ROM EPROM EEPROM flash memory or other solid state memory technology CD ROM digital versatile disks DVD or other optical storage magnetic cassettes magnetic tape magnetic disk storage or other magnetic storage devices or any other medium which can be used to store the desired information and which can be accessed by the computer .

According to various embodiments of the invention the computer may operate in a networked environment using logical connections to remote computers through a TCP IP network such as the Internet. The computer may connect to the network through a network interface unit connected to the bus . It should be appreciated that the network interface unit may also be utilized to connect to other types of networks and remote computer systems. The computer may also include an input output controller for receiving and processing input from a number of other devices including a keyboard mouse or electronic stylus or pen not shown in . Similarly an input output controller may provide output to a display screen a printer or other type of output device.

As mentioned briefly above a number of program modules and data files may be stored in the mass storage device and RAM of the computer including an operating system suitable for controlling the operation of a networked personal computer such as the WINDOWS XP operating system from MICROSOFT CORPORATION of Redmond Wash. The mass storage device and RAM may also store one or more program modules. In particular the mass storage device and the RAM may store a note taking application program as described above and other application programs such as a word processing application a spreadsheet application e mail application etc. As briefly described above the note taking application can comprise an application program for capturing and organizing notes which may include text handwriting pictures drawings audio or other information.

Notes may be created modified saved and organized by the note taking application into notebooks folders pages and sections. Within a page notes may be entered anywhere and later repositioned. Moreover emphasis may be added to notes with bullet and list styles as wells as flags and highlighting. A user has full control over fonts styles sizes and colors. When a user exits the note taking application the contents of the notebook may be saved in a note taking document on the mass storage device . Additional details regarding the operation of the ONENOTE note taking application program are publicly available from MICROSOFT CORPORATION of Redmond Wash.

Referring now to an embodiment of a note taking application is shown. The note taking application includes a user interface including various tools organized within the user interface . According to embodiments of the invention the note taking application preferably includes a lasso tool . The lasso tool can be implemented as part of a drop down menu soft key or as a button selectable by a mouse pen or other pointing or selecting device. It will be appreciated that the particular interface for availing the lasso tool may be designed and or implemented according in many ways and the invention is not intended to limited to any particular embodiments or examples discussed herein.

The lasso tool allows a user to select ink text drawings images and or other objects hereinafter referred to collectively as elements of the note taking application . The lasso tool enables a user to naturally select and manipulate one or elements of a document using a pen for example. As shown in the lasso tool has been used to lasso or select This is a and test portions of the ink . The lasso tool automatically completed the linear connector the lasso based on the user s lasso selection start point and end point selecting the lassoed elements . It will be appreciated that depending on one or more user selections there may be multiple user starting and ending selections.

The lasso tool of note taking application preferably includes a lasso selecting algorithm which tends to improve a user experience when selecting elements using the lasso tool . For example as shown in a user used the lasso tool to form lasso . Points represent select portions or points of elements in the document or file .

With additional reference to an embodiment of a lasso selecting algorithm is described. The lasso selecting algorithm starts at . At a user uses the lasso tool to select one or more elements of a document . The lasso selecting algorithm operates to test select points of elements that are inside of a lasso such as lasso shown in to determine if the tested points and or objects satisfy certain criteria. For example each ink stroke contains a number if such points and the lasso selecting algorithm preferably operates on one or more points independently or collectively in the analysis. Non ink objects are preferably represented by a grid of points some or all of which are measured against the lasso selecting algorithm based on a particular implementation.

At the lasso selecting algorithm determines whether an element has been selected by creating one or more imaginary horizontal rays where n is an integer number from a point or points inside of the particular element . For this embodiment the lasso selecting algorithm uses horizontal left to right presented rays as part of its analysis. However it will be appreciated that right to left vertical diagonal and other ray orientations and manipulations may be used as part of a lasso selecting algorithm . At if the ray crosses the lasso an odd number of times one or more elements are considered selected.

If the ray crosses the lasso an even number of times including zero times the one or more elements are not considered selected. A point on the lasso is preferably considered inside of the lasso . Accordingly the lasso tool may be used to unselect an element by making a lasso more complicated. Additionally the lasso selecting algorithm tends to prevent random and unwanted selection of elements . The lasso selecting algorithm also tends to provide the capability for a user to reselect an element even if it was previously unselected. According to the invention the lasso tool provides the flexibility for a user to lasso elements one or more times or re lasso parts of an element already lassoed. Thus a user can be very precise about what to select and what not to select when using the lasso tool .

Referring now to other features of the lasso tool are described. depicts a document which includes a picture ink and and text . A user using the lasso tool formed a lasso around elements of the document . A user begins using the lasso tool by clicking on the representative button in the toolbar for example. Once selected the note taking application provides an audible or visual indicator such as a lasso symbol for example which informs the user that the lasso tool is enabled and ready to make selections.

The user begins a lasso selection by clicking a selection point in the document such as document . The user continues the selection by using the pen to partially or fully circumnavigate select elements of a document . The user completes the selection by releasing the lasso using a barrel click for example to define an end point of the selection. Based on the selection the lasso tool module uses one or more thresholds such as those represented in Tables 1 and 2 below for example to lasso select elements of a document .

As described briefly above it is also possible to make multiple selections using the lasso tool . As shown in a user has used the lasso tool to form lasso . The dotted line represents a selection container which encompasses selected elements based on the user s lasso . Based on the selection container the user can operate on the selected elements as a unit. For example the user can re size or move the selected elements within the selection container as a group. As shown in container includes as selected elements text and ink . According to a preferred embodiment the selected elements are highlighted to thereby inform the user of the current selection based on the lasso .

According to the invention the lasso tool provides a means for a user to ignore ink handles and other structure to particularly select and grab ink and other objects. Additionally when using a tablet users feel more natural making selections with the lasso tool a pen friendly tool. Chunk out or chunk up as used herein refers to the expansion of a selection from a smallest selectable unit a stroke for example to a larger unit such as a word paragraph etc.

Referring to another embodiment of the invention is described. According to this embodiment element selection can be based on the velocity or speed of a selection as a user uses the pen to select one or more elements of a document . The lasso tool includes a velocity based selection algorithm which operates to select one or more elements based on the velocity of the user s selection. At the velocity based selection algorithm first determines whether the user is making a selection at either a slow or fast velocity.

The velocity based selection algorithm provides the user with real time feedback and control when making a selection. Preferably the velocity based selection algorithm bases the selection velocity on an initial distance as the user makes a selection with the lasso tool . Most preferably the initial selection distance threshold is at least about 1.5 inches. That is the selection velocity remains unknown until the user has traversed at least about 1.5 inches from a start point with the lasso tool while making a selection.

The note taking application is operable to monitor operations using the pen or other input device. At velocity based selection algorithm preferably uses a monitored distance and time of a selection to determine whether the user has selected one or more elements with a fast or slow selection velocity. Most preferably a fast selection velocity is equal to or greater than about 0.02 inches per millisecond and a slow selection velocity is equal to or less than about 0.003 inches per millisecond. The velocity calculation may be made over any distance but is preferable made over a distance of about three inches to about six inches. It will be appreciated that a particular application programming interface API may include functionality to calculate a selection velocity based on different factors and or inputs.

Tables 1 and 2 below include exemplary selection criteria for selecting one or more elements of a document based on slow and fast selection velocities respectively according to an embodiment of the velocity based selection algorithm . It will be appreciated that slower selection velocities may be associated with more precise selections. Whereas faster selection velocities may be associated with a less precise selection when the user is not as interested in finer details of a particular selection for example. However it will be appreciated that the precision of the velocity based selection algorithm may be implemented according to a particular application and preference.

Thus if the velocity based selection algorithm determines that the user s selection of interest is based on a slow selection velocity at it is determined how much of a particular element has been lassoed by the user. Preferably at a selection is based upon a percentage that a particular element has been surrounded by the user s lasso. The percentage can be determined based on the user s selection start and end points when using a pen to select one or more elements of a document for example. As shown in Table 1 above a basic ink stroke handwritten word handwritten line of text handwritten paragraph or an outline is selected when a user has surrounded about ninety percent of the particular element . A picture is selected when a user has surrounded about ninety percent of the picture. Text content of a paragraph or line is selected when a user has surrounded about seventy five percent of the element . Text content of a word is selected when a user has surrounded about ninety five percent of the element .

In similar fashion if the velocity based selection algorithm determines that the user s selection is based on a fast selection velocity at it is determined how much of a particular element has been lassoed by the user. At a selection is based upon a percentage of how much of a particular element has been surrounded by the user s lasso. As shown in Table 2 above a basic ink stroke handwritten word text content of a paragraph line or word is selected when a user has surrounded about seventy five percent of the element . A handwritten line of text handwritten paragraph or an outline is selected when a user has surrounded about ninety percent of the element . A picture is selected when a user has surrounded about fifty percent of the picture.

On occasion a situation may arise when a user s attempt to select one or elements of a document does not result in what the user intended to select. According to an embodiment of the invention the lasso tool module includes optimization features that operate to recognize and provide a user with accurate selections based on the user s actions using the lasso tool . As described above thresholds selection percentages velocities etc. may be used to determine whether or not to chunk out a selection. For example if a user s selection resulted in an unwanted chunk out the user may attempt a retry to make the selection they want. The lasso tool module is configured to recognize user reselects or retries. Once the lasso tool module determines that the user is attempting a reselect thresholds are ignored and only stroke level selections are used for ink. Slow velocity thresholds are preferably used for the selection of pictures and text upon a reselect attempt.

Referring to a preferred embodiment of a reselect algorithm of the lasso tool module is described. At the reselect algorithm first determines if a user has attempted to make a selection with the lasso tool . If a user has not attempted to make a selection the reselect algorithm proceeds back to the start of the reselect algorithm . In case of a retry attempt at the reselect algorithm determines whether the user has attempted a subsequent lasso or has tapped the pen to clear the selection and is attempting another lasso. At if the start point of the subsequent lasso is within about two seconds from stop point of the previous lasso attempt and about one cm from the start point of the previous lasso attempt then the selection is not chunked out. It will be appreciated that the invention is not intended to be limited by any particular examples or embodiments described herein but is to be measured by the appended claims.

Alternatively the reselect algorithm can operate to compare a previous lasso path to a subsequent lasso path. If the overlap or common selection area between the paths is greater than about seventy five percent the reselect algorithm classifies the subsequent path as a retry. At once the algorithm has classified the lasso as a retry the reselect algorithm selects out to the stroke level preferably using the slow velocity surrounded values of Table 3 above. Otherwise at the previous selection is chunked out and the reselect algorithm adds the subsequent lasso selection to the first selection.

The lasso tool may also be used in conjunction with the CTRL keys to make multiple selections. For example a user can make two lasso selections by holding the CTRL key making a first lasso selection and holding down the a CTRL key again to make a second lasso selection etc. Analogous to using the CTRL key in conjunction with the lasso tool if a user starts another lasso within one second of the previous lasso ending the application preferably interprets it is as if the CTRL key were being held down. In certain embodiments multiple selections are resized individually. For example if there were 3 different selections as the result of a lasso ctrl lasso and another ctrl lasso only one of the selections may be resized.

Referring now to a pen is shown. The pen includes a barrel button . The barrel button of the pen can be used for various operations when using the note taking application . For example a user can hold down the barrel button and tap the screen to bring up a context menu. A user may also depress the barrel button while inking a document to switch it into lasso mode to make a lasso selection. The note taking application preferably returns to the ink mode when the barrel button is released. If the user is using the lasso after by selecting the toolbar button depressing the barrel button preferably toggles to marquis selection rectangle box selection . The user can re invoke the lasso mode by releasing and depressing the barrel button .

It should be appreciated that the logical operations of various embodiments of the present invention are implemented 1 as a sequence of computer implemented acts or program modules running on a computing system and or 2 as interconnected machine logic circuits or circuit modules within the computing system. The implementation is a matter of choice dependent on the performance requirements of the computing system implementing the invention. Accordingly logical operations including related algorithms making up the embodiments of the present invention described herein are referred to variously as operations structural devices acts or modules. It will be recognized by one skilled in the art that these operations structural devices acts and modules may be implemented in software firmware special purpose digital logic and any combination thereof without deviating from the spirit and scope of the present invention as recited within the claims set forth herein.

Although the invention has been described in connection with various exemplary embodiments those of ordinary skill in the art will understand that many modifications can be made thereto within the scope of the claims that follow. Accordingly it is not intended that the scope of the invention in any way be limited by the above description but instead be determined entirely by reference to the claims that follow.

