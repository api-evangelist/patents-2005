---

title: Reducing read data strobe latency in a memory system
abstract: A read activity detector circuit for use in a random access memory array includes a plurality of synchronizer circuits operative to receive a plurality of respective reference clock signals having a frequency that is substantially the same as a core reference clock and having different phases relative to one another. Each of the synchronizer circuits, in response to a first control signal presented thereto, generates an output signal having a rising edge or a falling edge which is substantially aligned to a rising edge or a falling edge of the reference clock signal corresponding thereto. The activity detector circuit further includes a controller operative to receive the respective output signals from the plurality of synchronizer circuits and to generate an output signal as a function thereof which is indicative of data to be read from the random access memory array.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07292500&OS=07292500&RS=07292500
owner: Agere Systems Inc.
number: 07292500
owner_city: Allentown
owner_country: US
publication_date: 20050729
---
The present invention relates generally to memory systems and more particularly relates to techniques for reducing read data strobe latency in a memory system.

Over the past several years memory systems particularly in the personal computer PC sector have seen a dramatic increase in data bandwidth requirements. One industry segment that has experienced significant growth as a result of this increase in data bandwidth requirements is dynamic random access memory DRAM particularly double data rate DDR synchronous DRAM SDRAM . DDR memory architectures use both the rising and falling edges of a clock signal to access memory which facilitates data transmission at twice the standard clock rate. DDR SDRAM also consumes less power than conventional SDRAM with an operational supply voltage of about 2.5 volts instead of 3.3 volts for SDRAM.

DDR memory s ability to transfer data at double the standard SDRAM data rate often imposes significant challenges on memory system designers. The speeds at which a memory controller must reliably operate e.g. 400 megahertz MHz across traces on a typical woven glass reinforced epoxy resin printed circuit board PCB make PCB layout particularly challenging. Moreover incorporating a DDR memory interface into a flexible field programmable gate array FPGA fabric presents the designer with the related complexity of meeting very critical and tight timing constraints in an inherently non deterministic routing fabric. The difficulties often encountered arise predominantly from the physical realities of working with data windows that are well within the magnitude of signal propagation delays in PCB and FPGA routing e.g. about 2.5 nanoseconds ns or less for a 400 MHz clock . These timing requirements are further complicated by the variation in logic speed over process voltage and or temperature PVT conditions to which the memory system may be subjected. The memory system designer can no longer simply connect data lines and address lines and expect to have a robust high speed memory interface.

Depending on the layout of the memory system on a PCB and on the number of banks of memory employed if a memory controller must fetch data from a large number of banks concurrently the difference in board delays between the various memory banks and the controller can often exceed one clock cycle thereby increasing latency in the memory system. One known approach which attempts to address this issue is to compute a round trip RT delay value for each memory bank in the system and to store the various RT delay values in a register. A programmable delay line is then utilized in the memory system for selectively delaying a read strobe signal based on the computed RT delay value s corresponding to the memory bank s being read. This approach however requires an initialization procedure for determining the RT delay value of each memory bank and additionally requires a programmable delay line which significantly increases the cost of the memory system. Moreover this approach does not adjust for variations in certain operating characteristics of the memory system such as for example supply voltage and or temperature which may occur after the RT delay values have been determined.

Accordingly there exists a need for techniques for reducing read strobe latency in a memory system that does not suffer from one or more of the problems exhibited by conventional memory systems.

The present invention meets the above noted need by providing in an illustrative embodiment an activity detector circuit for reducing read strobe latency in a DDR SDRAM memory system. The activity detector circuit is operative to detect read activity across multiple phases of a core reference clock and to convert the activity into a synchronous output signal indicative of data to be read from a DDR SDRAM array external to the activity detector.

In accordance with one aspect of the invention a read activity detector circuit for use in a random access memory array includes a plurality of synchronizer circuits operative to receive a plurality of respective reference clock signals each having a frequency that is substantially the same as a frequency of a core reference clock and having different phases relative to one another. Each of the synchronizer circuits in response to a first control signal presented thereto generates an output signal having a rising edge or a falling edge which is substantially aligned to a rising edge or a falling edge of the reference clock signal corresponding thereto. The activity detector circuit further includes a controller operative to receive the respective output signals from the plurality of synchronizer circuits and to generate an output signal as a function thereof which is indicative of data to be read from the random access memory array.

In accordance with another aspect of the invention a memory system includes a random access memory array and a memory controller circuit connected to the memory array. The memory controller circuit includes at least one read activity detector circuit comprising a plurality of synchronizer circuits operative to receive a plurality of respective reference clock signals having a frequency that is substantially the same as a core reference clock and having different phases relative to one another. Each of the synchronizer circuits in response to a first control signal presented thereto generates an output signal having a rising edge or a falling edge which is substantially aligned to a rising edge or a falling edge of the reference clock signal corresponding thereto. The at least one read activity detector circuit further includes a controller operative to receive the respective output signals from the plurality of synchronizer circuits and to generate an output signal as a function thereof which is indicative of data to be read from the random access memory array.

These and other features and advantages of the present invention will become apparent from the following detailed description of illustrative embodiments thereof which is to be read in connection with the accompanying drawings.

The present invention will be described herein in the context of illustrative activity detector circuits as may be used for example in a DDR SDRAM memory system. It should be understood however that the present invention is not limited to these or any particular circuit arrangements. Rather the invention is more generally applicable to techniques for reducing read data strobe latency in a memory system. Although implementations of the present invention are described herein with specific reference to DDR SDRAM it is to be understood that the invention is not limited to such memory and that other suitable memory such as for example fast cycle random access memory FCRAM quad data rate QDR SDRAM reduced latency DRAM RLDRAM etc. may be similarly employed as will become apparent to those skilled in the art.

The first and second multiplexers are preferably configured for accessing odd and even data bits respectively in an external DDR SDRAM array not shown . Each of the data registers is preferably operative to store odd or even data bits respectively read from the DDR SDRAM array. For example register preferably receives data from odd memory locations and generates odd data signals QD QD QD and QD . Likewise register preferably receives data from even memory locations and generates even data signals QD QD QD and QD . Each multiplexer preferably generates a corresponding output signal namely DRODD and DREVEN respectively. Multiplexer selection circuitry is operative to generate control signals namely MUXSEL and MUXSEL for selecting which one of the four data signals from each multiplexer is to produce the corresponding output signal DRODD DREVEN. It is to be understood that the exemplary memory interface circuit is not limited to the number of data bits shown.

Demultiplexer selection circuitry is preferably operative to generate output control signals EN EN EN and EN for enabling one of individual flip flops in each of the data registers at any given time. The output control signals EN through EN are generated as a function of input control signals namely CLK S DLY which may be a delayed version of a read data strobe signal SR received by the memory interface circuit from the external DDR SDRAM array and RESTART N which is a reset signal generated by count start circuit . The flip flops in data registers are preferably clocked by a clock signal CLK S which is essentially a ninety degree phased shifted version of the read data strobe signal SR. Clock signal CLK S may be generated by the 90 degree slave delay circuit or alternative delay control circuitry.

Activity detector is preferably operative to generate a control signal ACTIVE for enabling the multiplexer selection circuitry . Additionally a READY signal generated by the multiplexer selection circuitry as an output of the memory interface circuit is a function of the ACTIVE signal. The READY signal is preferably indicative that data is available to be read from the memory interface circuit . In accordance with one aspect of the invention in order to reduce read data strobe latency the activity detector is preferably operative to sample the read data strobe signal at multiple phases of a reference clock and to select which of the phases of the reference clock is most closely aligned with a change in state of the strobe signal. By sampling the read data strobe signal at multiple phases of the reference clock rather than just a single phase as is conventionally done the activity detector functions at least in part to more accurately frame a window for reading data thereby reducing latency in the memory system by one or more clock cycles.

The clock signals clk clk clk and clk preferably are of substantially the same frequency as a core reference clock signal which may be generated externally to the activity detector circuit and have different phases relative to one another. For example clock signal clk may be considered a zero phase clock signal while clock signal clk is shifted in phase by 90 degrees relative to clk clock signal clk is shifted in phase by 180 degrees relative to clk and 90 degrees relative to clk and clock signal clk is shifted in phase by 270 degrees relative to clk 180 degrees relative to clk and 90 degrees relative to clk. Since in a standard DDR SDRAM system it is necessary to generate a double rate 2 clock one skilled in the art will find it relatively easy to generate clock signals of four different phases. It is to be appreciated that the phase difference s between the respective clock signals is not limited to any particular amount s . Furthermore the invention is not limited to any particular number of clock signals. For instance in another embodiment of the invention the synchronization circuitry may be configured to receive eight clock signals each of the clock signals being phase shifted from one another by multiples of 45 degrees.

The synchronization circuitry preferably includes a plurality of flip flops such as for example D type flip flops DFFs and . The DFFs are preferably connected together in pairs with each pair of DFFs being clocked by a respective one of the clock signals. Specifically for a first pair of DFFs a data input D of DFF receives input signal SOR an output Q of DFF is connected to a data input of DFF an output of DFF generates the output control signal B which is supplied to the controller and clock inputs of DFFS and receive clock signal clk. For a second pair of DFFs a data input of DFF receives input signal SOR an output of DFF is connected to a data input of DFF an output of DFF generates the output control signal B which is supplied to the controller and clock inputs of DFFs and receive clock signal clk. For a third pair of DFFs a data input of DFF receives input signal SOR an output of DFF is connected to a data input of DFF an output of DFF generates the output control signal B which is supplied to the controller and clock inputs of DFFs and receive clock signal clk. Likewise for a fourth pair of DFFs a data input of DFF receives input signal SOR an output of DFF is connected to a data input of DFF an output of DFF generates the output control signal B which is supplied to the controller and clock inputs of DFFs and receive clock signal clk.

Since the input signal SOR arrives asynchronously as a function of the read data strobe signal DQS generated by a particular DDR SDRAM array external to the activity detector once a change in state of the input signal SOR is detected the output control signal whose corresponding clock signal has a phase that is most closely synchronized to the change in state of the input control signal SOR will be latched first by the corresponding pair of DFFs followed by the output control signal whose corresponding clock signal is next closest in phase to the change in state of SOR and so on. By way of example only assume that a rising edge of clock signal clk occurs just after input SOR transitions from a logic low level to a logic high level. Output control signal B corresponding to clock signal clk will therefore be the first of the output control signals to change state after a latency of up to two clock cycles. Output control signal B will be the next signal to change state followed by output control signal B and then output control signal B.

Controller is preferably operative to receive the plurality of control signals generated by the synchronization circuitry and to select which one of the output control signals is the first to transition thereby selecting the clock phase which is most closely aligned to the asynchronous input signal SOR. The controller preferably includes a 4 input AND gate connected to a flip flop e.g. a DFF for each of the corresponding control signals B through B. Specifically a first input of a first 4 input AND gate receives control signal B an output of AND gate is connected to a data input D of a first DFF a clock input CP of the first DFF receives clock signal clk and an output Q of first DFF generates output control signal F. A first input of a second 4 input AND gate receives control signal B an output of AND gate is connected to a data input of a second DFF a clock input of second DFF receives clock signal clk and an output of second DFF generates output control signal F. A first input of a third 4 input AND gate receives control signal B an output of AND gate is connected to a data input of a third DFF a clock input of third DFF receives clock signal clk and an output of third DFF generates output control signal F. Likewise a first input of a fourth 4 input AND gate receives control signal B an output of AND gate is connected to a data input of a fourth DFF a clock input of fourth DFF receives clock signal clk and an output of fourth DFF generates output control signal F.

The output control signals F through F generated by controller are preferably inverted and connected to second third and fourth inputs of the respective AND gates in a feedback arrangement. Specifically output signal F is connected to the second input of AND gates and . Output signal F is connected to the second input of AND gate and to the third input of AND gates and . Output signal F is connected to the third input of AND gates and and to the fourth input of AND gate . Output signal F is connected to the fourth input of AND gates and . In this manner once a change in state of one of the output signals F F F F is detected the controller is operative to latch the output signal that changed state and to lock out the remaining output signals from changing state. All of the output signals F through F are preferably logically ORed together by 4 input OR gate . The output of OR gate is supplied to a data input of DFF which functions to latch an ACTIVE output signal generated by controller indicating the presence of data to be read and framing a window for reading the data.

The activity detector circuit functions reasonably well as long as there is sufficient time between consecutive read operations such as for example at least two clock cycles. This is due primarily to the arrangement of the synchronization circuitry . Since each pair of DFFs e.g. is clocked by the same clock signal there is a minimum latency of one clock cycle assuming the read data strobe signal is coincident with a rising edge of the corresponding clock signal e.g. clk . By modifying the synchronization circuitry the activity detector circuit can be configured to beneficially reduce the amount of time required between consecutive read operations.

The clock signals CLK  CLK  CLK  and CLK  are preferably of substantially the same frequency as a core reference clock signal which may be generated externally to the activity detector circuit e.g. by a phase locked loop PLL in the memory system and have different phases relative to one another. For example clock signal CLK  may be considered a zero phase clock signal while clock signal CLK  is shifted in phase by 90 degrees relative to CLK  clock signal CLK  is shifted in phase by 180 degrees relative to CLK  and 90 degrees relative to CLK  and clock signal CLK  is shifted in phase by 270 degrees relative to CLK  180 degrees relative to CLK  and 90 degrees relative to CLK . It is to be appreciated that the phase difference s between the respective clock signals is not limited to any particular amount s . Furthermore the invention is not limited to any particular number of clock signals. For instance in another embodiment of the invention the synchronization circuitry may be configured to receive eight clock signals each of the clock signals being phase shifted from one another by multiples of 45 degrees.

The synchronization circuitry preferably includes a plurality of flip flops such as for example DFFs and . The DFFs are preferably connected together in pairs. Specifically for a first pair of DFFs a data input of DFF receives input signal SOR an output of DFF is connected to a data input of DFF and an output of DFF generates the output control signal B which is supplied to controller . For a second pair of DFFs a data input of DFF receives input signal SOR an output of DFF is connected to a data input of DFF and an output of DFF generates the output control signal B which is supplied to the controller . For a third pair of DFFs a data input of DFF receives input signal SOR an output of DFF is connected to a data input of DFF and an output of DFF generates the output control signal B which is supplied to the controller . Likewise for a fourth pair of DFFs a data input of DFF receives input signal SOR an output of DFF is connected to a data input of DFF and an output of DFF generates the output control signal B which is supplied to the controller .

As previously stated the synchronization circuitry in activity detector circuit is preferably modified compared to synchronization circuitry shown in so as to reduce a latency thereof and thereby advantageously minimize the number of clock cycles required between consecutive read operations. This can be accomplished in accordance with one aspect of the invention by clocking each of the DFFs in a given pair of DFFs in synchronization circuitry with clock signals that are shifted in phase from one another such as for example by 270 degrees. Using this circuit configuration the SOR signal propagates through the pairs of DFFs within one clock cycle rather than requiring two clock cycles as in the case of the activity detector circuit of . Thus for the first pair of DFFs a clock input of DFF preferably receives clock signal CLK  and a clock input of DFF preferably receives clock signal CLK . For the second pair of DFFs a clock input of DFF preferably receives clock signal CLK  and a clock input of DFF preferably receives clock signal CLK . For the third pair of DFFs a clock input of DFF preferably receives clock signal CLK  and a clock input of DFF preferably receives clock signal CLK . For the fourth pair of DFFs a clock input of DFF preferably receives clock signal CLK  and a clock input of DFF preferably receives clock signal CLK . It is to be understood that the phase difference between two DFFs in a given pair of DFFs in the synchronization circuitry is not limited to any particular value.

Controller is preferably operative to receive the plurality of control signals B B B B generated by the synchronization circuitry and to select which one of the output control signals is the first to transition thereby selecting the clock phase which is most closely aligned to the read data strobe signal. While controller shown in is suitable for use in the activity detector circuit controller has been modified slightly compared to controller in order to eliminate a metastable condition which can occur when the read data strobe is precisely aligned with a rising edge of one of the reference clock signal CLK . Specifically when the read data strobe is substantially aligned with the reference clock signal CLK  a metastable condition may result wherein the logic state of the first data bit cannot be determined with adequate certainty. In order to avoid this potential condition the controller is preferably configured to select the second closest clock phase which captures the first data bit. The slight penalty in latency which may result by employing this approach is beneficially balanced by the elimination of any metastable conditions that can occur.

Thus in accordance with another aspect of the invention controller preferably comprises for each of the signal paths corresponding to reference clock signals CLK  CLK  CLK  CLK  a combinatorial logic circuit including a 5 input AND gate a 2 input AND gate and a 2 input OR gate. Each of the control signals B B B B generated by the synchronization circuitry is preferably connected to a pair of combinatorial logic circuits associated with a given reference clock signal and a reference clock signal having a next adjacent phase e.g. CLK  and CLK  . Specifically in a first combinatorial logic circuit first inputs of a 5 input AND gate and a 2 input AND gate receive control signal B generated by synchronization circuitry . A second input of AND gate receives control signal B. Output signals C and D generated by AND gates and respectively are supplied to an OR gate which generates an output control signal E. In a second combinatorial logic circuit first inputs of a 5 input AND gate and a 2 input AND gate receive control signal B generated by synchronization circuitry . A second input of AND gate receives control signal B. Output signals C and D generated by AND gates and respectively are supplied to an OR gate which generates an output control signal E. In a third combinatorial logic circuit first inputs of a 5 input AND gate and a 2 input AND gate receive control signal B generated by synchronization circuitry . A second input of AND gate receives control signal B. Output signals C and D generated by AND gates and respectively are supplied to an OR gate which generates an output control signal E. Likewise in a fourth combinatorial logic circuit first inputs of a 5 input AND gate and a 2 input AND gate receive control signal B generated by synchronization circuitry . A second input of AND gate receives control signal B. Output signals C and D generated by AND gates and respectively are supplied to an OR gate which generates an output control signal E.

Output control signals E E E and E are preferably supplied to corresponding latch circuits. For example control signal E is supplied to a data input of a first DFF which generates an output signal F. A clock input of DFF preferably receives reference clock signal CLK . Control signal E is supplied to a data input of a second DFF which generates an output signal F. A clock input of DFF preferably receives reference clock signal CLK . Control signal E is supplied to a data input of a third DFF which generates an output signal F. A clock input of DFF preferably receives reference clock signal CLK . Control signal E is supplied to a data input of a fourth DFF which generates an output signal F. A clock input of DFF preferably receives reference clock signal CLK .

The output signals F F F F generated by the respective latch circuits are preferably fed back to inputs of the combinatorial logic circuits. Specifically output signal F is preferably connected to a second input of AND gate and to third inputs of AND gates and . Output signal F is preferably connected to a second input of AND gate a third input of AND gate and fourth inputs of AND gates and . Output signal F is preferably connected to a second input of AND gate fourth inputs of AND gates and and a fifth input of AND gate . Output signal F is preferably connected to a second input of AND gate and fifth inputs of AND gates and . Using this feedback approach the controller is able to select an appropriate clock signal and lock out the remaining clock signals. Output signals F F F F are preferably corresponding inputs of a 4 input OR gate which generates an output signal ACTIVE that is indicative of data to be read from external DDR SDRAM.

In order to initialize the activity detector circuit to a known logic state a reset signal namely RESTART N is preferably provided to the activity detector circuit. The reset signal may be generated external to the activity detector circuit such as by the count start circuit shown in as previously explained. The reset signal RESTART N is preferably an active low signal that is supplied to a clear input CLR of each of the DFFs in the synchronization circuitry namely DFFs and and each of the DFFs in the controller namely DFFs and .

As previously explained the strobe signal SOR used by the activity detector circuit e.g. or is preferably based on a logical OR of the read data strobe signal CLK S which is a function of the read data strobe DQS and a 90 degree delayed version of the read data strobe signal CLK S. This approach provides certain benefits compared to using the read data strobe signal CLK S alone as will be explained in conjunction with the illustrative cases shown in .

By way of example only and without loss of generality is a logic timing diagram illustrating two exemplary cases namely Case and Case for determining when to sample a burst of data based only on an undelayed read data strobe signal CLK S in accordance with one aspect of the invention. In Case each clock cycle t of the read data strobe signal CLK S contains two logic high samples labeled a and d and two logic low samples labeled b and c. In this case the samples labeled d are the first to go high after the rising edge of the strobe CLK S but the samples labeled a may be the better choice especially as the d samples move near the leading edge of CLK S due for example to PVT variations. Thus the exact phase relationship is important in determining whether the best samples are those that begin with the first or second high sample following the start of a received burst of data. There is a lack of sufficient information in this case to unambiguously make such a determination.

In Case each clock cycle tincludes one logic high sample labeled d one logic low sample labeled b and two samples labeled c and a that are substantially coincident with the rising and falling edges of the read strobe signal CLK S such that these samples may be considered either a logic high or a logic low. In this case the samples labeled d are the best choice but generating a rule to unambiguously select the reference clock phase corresponding to sample d is essentially not possible since samples a and c cannot be resolved with certainty.

Suppose for example that the first sample c in a given burst resolves to a logic high state. The phase corresponding to sample c would therefore be the best to sample the burst. However depending on certain characteristics of the memory system sample c cannot be relied upon to consistently resolve to a logic high state. Alternatively suppose that sample c resolves to a logic low state and thus sample d would be the first sample to go high. As previously stated it is preferred to use the second sample to go high as the proper phase selection which would be sample a. However sample a being coincident with the falling edge of CLK S cannot be resolved to a logic high state with certainty and may in fact change its logic state as a function of PVT variations. If the first sample to go high during each clock cycle of CLK S is used then sometimes the clock phase corresponding to sample c would be selected and other times the clock phase corresponding to sample d would be selected. If a phase corresponding to sample c is selected followed by a phase corresponding to sample d and if CLK  corresponds to sample c then the activity detector will skip one cycle. This means that the read latency would be variable which is generally not desirable from the standpoint of the overall memory system.

In Case each cycle tof the read data strobe signal SOR includes two logic high samples labeled d and a and two samples that are substantially coincident with the rising and falling edges of the SOR signal such that the samples may be considered either a logic high or a logic low labeled c and b. In this case the samples labeled a and d are equally appropriate choices. If the first sample labeled c of the burst of data resolves to a logic high state then sample d will be the second sample to go high and the reference clock phase corresponding to sample d is preferably used thereafter for the duration of the burst. Alternatively if sample c resolves to a logic low state then sample a will be the second sample to go high and therefore the reference clock phase corresponding to sample a is preferably used thereafter for the duration of the burst. The clock phases corresponding to samples b or c are preferably avoided as sampling phases since neither of these samples can be relied upon to be high with any certainty.

By way of example only are exemplary logic timing diagrams illustrating operation of the activity detector depicted in in accordance with aspects of the present invention. depicts an exemplary nominal operation of the activity detector circuit of with a round trip delay of 0.125 T where T is a period of the reference clock CLK . In this scenario there is no metastable condition since the read data strobe DQS is not coincident with any of the rising or falling edges of the reference clocks CLK  CLK  CLK  CLK . An internal read latency of the activity detector circuit in this case is about 2.56 T which is less than an external read latency of 3 T.

At least a portion of the activity detector circuits of the present invention may be implemented in an integrated circuit. In forming integrated circuits a plurality of identical die is typically fabricated in a repeated pattern on a surface of a semiconductor wafer. Each die includes a device described herein and may include other structures and or circuits. The individual die are cut or diced from the wafer then packaged as an integrated circuit. One skilled in the art would know how to dice wafers and package die to produce integrated circuits. Integrated circuits so manufactured are considered part of this invention.

Although illustrative embodiments of the present invention have been described herein with reference to the accompanying drawings it is to be understood that the invention is not limited to those precise embodiments and that various other changes and modifications may be made therein by one skilled in the art without departing from the scope of the appended claims.

