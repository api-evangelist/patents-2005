---

title: Systems and methods for controlling strobe illumination
abstract: Various exemplary embodiments may provide systems and methods for strobe illumination of a workpiece. The systems may include an illumination source, an image acquisition device and a control system. The illumination source may emit visible, UV, or near-IR light as a transient flash to the workpiece, the transient flash occurring in response to a lamp trigger. The illumination source may emit the light at an illumination intensity that rises from a begin threshold to a peak and afterwards diminishes to an end threshold during a flash duration. The image acquisition device may capture the light associated with the workpiece for an exposure duration starting from an exposure trigger. The control system may control the illumination source and the image acquisition device to synchronize the lamp trigger so that the exposure duration ends during the flash duration, such that a remaining portion of the flash does not affect the image exposure.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08045002&OS=08045002&RS=08045002
owner: Mitutoyo Corporation
number: 08045002
owner_city: Kawasaki
owner_country: JP
publication_date: 20050729
---
This invention relates to systems and methods that select light source channels and control light intensity and direction for precision machine vision inspection using a transient light source.

Methods for operating a machine vision inspection system with a camera and a stage that are movable relative to one another to focus on and inspect selected features of a workpiece on the stage are generally known. Precision machine vision inspection systems may be used to obtain precise dimensional measurements of inspected objects and to inspect various other object characteristics.

Such systems may include a computer a camera and or optical system and a precision stage that may be movable in multiple directions to allow the camera to scan the features of a workpiece that is being inspected. One exemplary prior art system of a type that may be characterized as a general purpose off line precision vision system is the commercially available Quick Vision series of vision inspection machines and QVPak software available from Mitutoyo America Corporation MAC located in Aurora Illinois.

Such general purpose off line precision vision systems often include a programmable illumination system and a lens turret with lenses of various magnifications for example to increase versatility of the image systems and provide the ability to rapidly change configuration and imaging parameters for the vision systems to perform a wide variety of inspection tasks. There is a common need to inspect various types of objects or inspection workpieces or various aspects of a single workpiece using various combinations of magnifications and the programmable illumination settings.

General purpose precision machine vision inspection systems such as the Quick Vision system are also generally programmable and operable to provide automated video inspection. Such systems may include features and tools that simplify the programming and operation of such systems such that operation and programming may be performed reliably by non expert operators. For example U.S. Pat. No. 6 542 180 which is incorporated herein by reference in its entirety teaches a vision system that uses automated video inspection. The system performs operations to adjust the lighting used to illuminate a workpiece feature based on a plurality of selected regions of a feature image.

Imaging systems are widely used to inspect workpieces being transported through a manufacturing process. Equipment such as machine vision inspection systems often capture images of the workpieces using a camera for example and process captured images to verify various workpiece dimensions by identifying edges of relevant features in the images.

The precise location and repeatability of where an edge is detected within an image depends on the lighting of the workpiece during image capture. Edge artifacts or edge shifting may be created by lighting specific shadows cast due to sub optimal direction of the illumination of the workpiece. Over or under exposure may reduce the ability to accurately detect an edge and decrease measurement repeatability. To increase productivity workpieces may be kept in motion even during image capture. This places an additional burden on illumination systems to minimize blurring caused by the motion. Such factors frequently limit the accuracy with which the edge of a feature may be located within an image and or the velocity that may be tolerated during image capture. Thus improvements in workpiece illumination control technology would be very desirable.

Various exemplary embodiments provide systems and methods for strobe illumination for imaging a workpiece. Exemplary systems may include an illumination source an image acquisition device and a control system. The illumination source may emit light of one or more visible or invisible wavelengths of radiation that are suitable for imaging the workpiece as a transient flash or pulse to the workpiece. The transient flash or pulse may occur in response to a lamp trigger. The illumination source may emit the light at an illumination intensity that rises from a begin threshold to a peak and afterwards diminishes to an end threshold during a flash duration. The image acquisition device may capture the light associated with the workpiece for an exposure duration started in response to an exposure trigger. The control system may control the illumination source and the image acquisition device to provide a desired overlap between the exposure duration and the flash duration. The beginning of the exposure duration may precede the lamp trigger by a lamp lag period. The lamp trigger may be set to synchronize or adjust a timing relationship between an end of the exposure duration and the illumination intensity profile of the flash.

In various exemplary embodiments exposure triggers may correspond to predetermined positions of the workpiece relative to a coordinate space used by the machine vision inspection system.

In various exemplary embodiments such a system may further include a spatial light modulator SLM that forms an array to control and or distribute the light from one or more illumination sources. The array may include elements that selectively either block partially transmit or transmit the light toward respective lighting channels such as respective optical fiber bundles. Each respective lighting channel may direct the light along a path to project commanded illumination from a respective position and or angle of incidence relative to the workpiece.

The following detailed description refers to multi channel strobe illumination for magnified image acquisition. The strobe illumination source may refer to a Xenon flashlamp for example. However the principles described herein may be equally applied to any known or later developed transient illumination sources beyond the examples specifically discussed herein.

Exemplary systems and methods for machine vision inspection as provided herein may be used in conjunction with systems and methods disclosed in U.S. patent application Ser. No. 10 719 210 filed on Nov. 24 2003 directed to automatic focusing and or U.S. patent application Ser. No. 10 901 355 filed on Jul. 29 2004 directed to strobe illumination and or U.S. patent application Ser. No. 10 435 625 filed on May 7 2003 directed to improved machine vision inspection throughput each of which is incorporated herein by reference in its entirety.

Various methods and GUIs usable for determining an optimum light setting to be used with rapid auto focus systems that determine an estimated best focus position and associated light adjusting systems are disclosed in U.S. Pat. Nos. 6 542 180 and 6 239 554 each incorporated herein by reference in its entirety. In addition techniques for measuring surface contours are disclosed in U.S. Pat. No. 6 690 474 also incorporated herein by reference in its entirety.

The control system portion may be further operably arranged to exchange data and control signals with at least one of a monitor a printer a joystick a keyboard and a mouse . The vision measuring machine may include a moveable workpiece stage and an optical imaging system which may include a zoom lens or a number of interchangeable lenses. The zoom lens or interchangeable lenses may generally provide various magnifications for images produced by the optical imaging system .

The joystick maybe used to control the movement of the movable workpiece stage in both X and Y axes horizontal directions which may be generally parallel to the focal planes and perpendicular to the Z axis movement direction of the optical imaging system . Frequently Z axis movement may be controlled by a rotary deflection component of a handle or knob of the joystick . The joystick may be provided in a form other than that shown such as any visual representation or widget on the monitor that may be intended to function as a virtual motion control device of the machine vision inspection system and is controllable through any computer input device such as the mouse or other analogous devices.

The control system portion may include a controller that may be in communication with or connected to an input output interface a memory a workpiece program generator and executor a computer aided design CAD file feature extractor and a power supply portion . The control system portion may also be arranged to exchange data and control signals with display devices and input devices for example through the input output interface .

The input output interface may comprise an imaging control interface a motion control interface a lighting control interface and a lens control interface . The motion control interface may include a position portion and a speed and acceleration portion . The lighting control interface may include lighting channel exposure and control portion .

The various elements of the control system portion may generally encompass hard wired circuits software circuits subroutines objects operations application programming interfaces managers applications or any other known or later developed hardware or software structure. The display devices may include for example the monitor and the printer . The input devices may include for example the joystick the keyboard and the mouse . In general the various elements of the control system portion may be operably connected to each other and to external devices by any suitable known or later developed power and or signal busses wireless communication signals and or application programming interfaces or the like. Such interconnections are generally indicated by various interconnection lines throughout the control system portion in an arrangement of interconnections that is exemplary only and not limiting.

The light generation system may include one or more light generator and a spatial light modulator SLM to control the distribution of light from the light generator to a plurality of light channels as described further below. The light generator and the SLM may be arranged to exchange data and control signals with the light channel exposure and control portion for example by respective power and signal lines . At least one of the lamps not shown of the light generator maybe used in a strobe illumination mode of operation to provide a combination of a very fast light generator response time in the As or ns range and suitable optical power levels. In various exemplary embodiments the light generator may include a high intensity Xenon Xe flashlamp. However in general any light generator that emits a wavelength within a sensing range of the camera may be used. Various features of the light generation system are described further below.

The vision measuring machine may include an optical assembly light sources including stage light source coaxial light source and programmable ring light PRL source . The workpiece stage may include a central transparent portion through which light from the stage light source passes. The stage may be controllably movable along X and Y axes that lie in a plane substantially parallel to the surface of the stage where a workpiece or target may be positioned.

The stage light source may receive light through a light cable from a respective channel of the SLM to transmit light through the transparent portion . The components that provide the light may be regarded as a first light channel of the machine vision inspection system . The coaxial light source may receive light through a light cable from a respective channel of the SLM to transmit light to a beamsplitter that provides a coaxial mirror that directs the transmitted light through the objective lens . The components that provide the light may be regarded as a second light channel of the machine vision inspection system . The programmable ring light PRL source may form an annular ring above and around the workpiece to transmit light to the workpiece at controllable angles. An exemplary configuration for the PRL source may include four ring light sources . Through arranged in respective quadrants around the ring light. The four sources . Through may receive light through respective light cables . Through from respective channels of the SLM. . The various light cables may comprise optical fiber bundles or the like. The PRL source may be formed as a combination of individually controllable sources. The components that provide respective portions of the light may be regarded as four additional light channels of the machine vision inspection system .

The workpiece may be disposed on the stage at a known or learned position. By detecting macroscopic positions of the stage and or the workpiece the control system portion may accurately determine where to capture workpiece images to perform inspection of various workpiece features.

The memory may comprise an image file memory portion a workpiece program memory portion and a video tool portion . The video tool portion may comprise a region of interest generator and various respective video tools . Through which may include respective GUI interfaces image processing operations and the like which assist a user in performing and or programming various inspection operations. The region of interest generator provides operations that may assist the user in defining desired regions of interest to be analyzed or operated upon be the various video tools as described in the 180 patent for example.

The memory may store data and or tools usable to operate the machine vision inspection system to capture or acquire an image of the workpiece with desired image characteristics. The memory may further store data and or video tools usable to operate the machine vision inspection system to perform various inspection and measurement operations on the acquired images either manually or automatically and to output the results for example through the input output interface through data and or control busses and or the controller . The memory may also contain data defining a GUI operable through the input output interface by way of data and or control busses and or the controller .

The optical assembly may include for example a camera or image acquisition device an interchangeable objective lens a turret lens assembly and the coaxial light source . The objective lens and the camera may be aligned along a camera axis. The optical assembly may be controllably movable along the Z axis that is generally orthogonal to the X and Y axes for example by using a controllable motor . Each of the X Y and Z axes of the machine vision inspection system may be instrumented with respective X Y and Z axis position encoders not shown that provide spatial position information to the control system portion for example over suitable signal and or control lines not shown . The camera may include a charge couple diode CCD array or a CMOS array or any other suitable detector array to provide an image based on the light received from the workpiece .

The turret lens assembly may include two or more respective lenses that may be rotated around a rotation axis to be respectively positioned in the optical path between the camera and the objective lens to provide a respective image magnification in combination with the objection lens . The control system portion may rotate the turret lens assembly to provide a desired image magnification. The input output interface may exchange data and control signals with the camera the turret lens assembly and the motor for example by power and signal lines or busses . Respective signal and or control lines not shown of the respective X Y and Z axes position encoders not shown may also be in communication with the input output interface . In addition to carrying image data the signal line may carry various signals from the controller that set an image acquisition pixel range for the camera initiate an image acquisition camera operation sequence and or similar operations.

The optical assembly of the machine vision inspection system may include in addition to the previously discussed components other lenses and or other optical elements such as apertures beam splitters and other analogous devices such as may be needed for providing desirable machine vision inspection system features.

The workpiece to be imaged and inspected using the machine vision inspection system may be placed on the stage . One or more of the light sources may emit the respective light that may illuminate the workpiece . Light may be reflected from or transmitted through the workpiece as workpiece light which may pass through the interchangeable objective lens and one of the lenses of the turret lens assembly to be received by the camera . The image of the workpiece captured by the camera may be output for example through the signal line to the control system portion .

A distance between the stage and the optical assembly may be adjusted to change the focus of the image of the workpiece captured by the camera . For example the optical assembly may be movable in the vertical Z axis direction perpendicular to the stage for example using the controllable motor that may drive an actuator a connecting cable or other analogous devices to move the optical assembly along the Z axis. The term Z axis as used herein refers to the axis for focusing the image obtained by the optical assembly . The controllable motor when used may be in communication with the control system portion for example through the signal line .

The control system portion may be usable to determine image acquisition settings or parameters and or acquire an image of the workpiece with desired image characteristics in a region of interest that includes a workpiece feature to be inspected by workpiece program instructions. Such workpiece imaging instructions may be encoded by the workpiece part programming generator and executor and transmitted to other components through data and or control busses and or application programming interfaces . The display devices and input devices may be used to view create and or modify part programs to view the images captured by the camera and or to view and or modify various GUI features for monitoring and or controlling the machine vision inspection system . The physical movements may be controlled by the motion control interface .

To achieve control of the physical movements of the camera the motion control interface may receive position information from the X Y and Z axis position encoders and may transmit position altering control signals via data and or control busses and or application programming interfaces . In general such. instructions may cause the machine vision inspection system to manipulate the stage and or the camera such that a particular portion of the workpiece may be within the field of view of the camera and may provide a desired magnification a desired focus state and an appropriate illumination. This process may be repeated for each of multiple images in a set of images that are to be captured for inspecting the workpiece .

The light generator may emit light to illuminate an illumination area on the SLM . The SLM may generally transmit partially transmit or block light. The SLM may include a plurality of respective controllable apertures within the illumination area . The respective apertures may generally provide illumination control for the respective light channels of the machine vision inspection system by transmitting partially transmitting or blocking the light to each of the respective light channels. In the example shown in the apertures include a stage light channel aperture a coaxial light channel aperture and PRL light channel apertures . The respective apertures may individually control the amount of light transmitted to the respective light cables to be output through the respective light sources 

The SLM may include an arrangement of shutters that provide the respective apertures. The shutters may be of any now known or later developed type that can provide controllable light transmitting and light blocking functions in a desired pattern. In various embodiments it may be advantageous if the shutter may also be used to partially transmit light. For example such that the SLM may be used to selectively transmit attenuate and or block light from the light generator . One example of such an SLM may be a micro display graphics array from CRL Opto in Dunfermline Scotland United Kingdom which includes an LCD pixel array that may generally be controlled by conventional video signals if desired and may be used to display an electronically generated 8 bit gray scale pattern that may transmit partially transmit or block the light through any given pixel of the pattern depending on its gray scale value. In such a case the various respective apertures may be implemented as features of the pattern and the pattern may be controlled at conventional video rates. Alternatively a custom LCD including a custom pattern of desired apertures may be used in various embodiments. It should be appreciated that the SLM allows one light generator to provide independently controllable lighting to a plurality of light channels while also allowing the light from a plurality of light channels to be perfectly synchronized for example as one light generator is strobed during an image acquisition. The use of one light generator also allows reduced cost and reduced size relative to the use of an individual light generator for each light channel for example.

Alternatively the SLM may include an arrangement of any now known or later developed type of controllable reflective shutters that can provide controllable light deflection in a desired pattern. In such a case the light generator may be arranged such that the light will not reach the various light channels unless the controllable reflective shutters or pixels transmit the light by reflecting and or deflecting light at a specific angle toward the various light channels. For example in contrast to the reflective SLM may be nominally oriented along a plane at 45 degrees relative to the light and the reflective array elements may be aligned along that plane to transmit the light toward the various respective light channels by reflecting and or deflecting it at a right angle to reach the various respective light channels. To effectively block the light from reaching the various light channels the reflective array elements or pixels may be disabled from reflecting the light at right angles either by altering their individual angles of by blocking their individual reflective light paths for example using individually controllable LCD blocking elements. Examples of controllable reflective shutter arrays that may be used include liquid crystal on silicon LCOS micro display products for example from CRL Opto Dunfermline Scotland and digital light projector DLP micro mirror products for example from Texas Instruments DLP Products Plano Tex. In such a case the various respective apertures may be implemented as features of a reflective pattern and the pattern may be controlled at conventional video rates. Although the micro mirror type of devices may not provide partially transmitting pixels it will be appreciated that a light channel aperture implemented using a micro mirror device may alternatively attenuate the light transmitted to a particular light channel by effective reducing the its aperture size as needed. For example the aperture diameter may be reduced by altering the configuration of the pixels that form the aperture.

As previously outlined it may be advantageous if at least one of the lamps of the light generator may be used in a strobe illumination mode of operation to provide a combination of a very fast light generator response time in the s or ns range at suitable optical power levels. Such illumination is particularly advantageous for allowing imaging of workpieces while continuing to move the stage which increases the throughput of the machine vision system . One example of a light generator may include one or more high intensity light emitting diodes LEDs such as one of the LEDs in the Luxeon product line available from Lumileds Lighting LLC of San Jos Calif. which may be used for both continuous wave CW and strobe illumination as described in U.S. patent application Ser. No. 10 719 210 In various exemplary embodiments a CW light source may include a high intensity discharge HID metal halide lamp and or a quartz halogen lamp.

In various exemplary embodiments the strobe light generator may include a high intensity Xenon Xe flashlamp such as model CX 1500 Xe flashlamp of the CX Strobe series from PerkinElmer Optoelectronics of Fr mont Calif. The CX 1500 Xe flashlamp may illuminate across an electromagnetic spectrum for wavelengths between 250. nm and more than 1100 nm. In various embodiments it may be desirable to filter the light from the flashlamp to reduce heating and or chromatic aberrations. For example the filter may pass the visible wavelength range between 390 nm violet and 750 nm red to the light channels. However in various embodiments other wavelengths ranges may be desired. The CX 1500 Xe flashlamp may cycle at a repeat rate of between 16 Hz and 35 Hz with a pulse duration of between 8 s and 10 s. The CX 1500 Xe flashlamp may produce a radiometric output of 256 mJ and a photometric light output of 205 lumen sec at 600 VDC that may be directed into a 0.9 23 mm diameter fiber optic guide.

It should be appreciated that a general purpose machine vision system may image a wide variety of workpieces some of which may have surfaces with low reflectivity. Furthermore magnified images may be desired. Furthermore fast exposures enabling imaging of moving workpieces may be desired. All of these factors tend to reduce the amount of light accumulated during an image exposure as discussed further below. Thus a very high intensity flashlamp may be advantageous for providing a very versatile machine vision inspection system.

The timing and synchronization portion may provide operations that send and receive control signals that synchronize the SLM the light generator the camera and positioning of the machine vision inspection system . The SLM control portion may provide control for the various light channels by controlling the on off timing contrast and aperture pattern if applicable of the SLM . The light generator control portion may provide control for the power levels the trigger signals and on off timing if applicable of the one or more lamps or LED s or the like of the light generator . The light generator control portion may also provide for light path control for auxiliary light sources if applicable as outlined further below.

For the example shown in the double cross hatched background represents a light blocking region of the SLM . The stage light channel aperture representation shows a similar double cross hatching to represent a significantly light blocking setting of the corresponding control . The coaxial light channel aperture representation shows an unfilled area to represent a significantly light transmitting setting of the corresponding control . The PRL light channel aperture representations show single cross hatching to represent a partially light transmitting setting of the corresponding controls . The layout of the aperture representations and in the SLM image field may correspond directly to a physical layout of the apertures and of the SLM and to a physical layout of the input ends of the light cables and which may be held in a fixture proximate to the SLM such that they are properly aligned to receive transmitted light from the corresponding apertures. The particular layout shown in is exemplary and is not limiting. Other configurations are possible and contemplated. It will be appreciated that the various aspects of aperture control described above with reference to may also generally be provided under manual semi automatic or automatic control as fuctions of the SLM control Accordingly these and other manual semi automatic or automatic control measures over the apertures and of the SLM may be implemented to support various learn mode and or run mode operations of the machine vision inspection system .

The control window may include panels with the slider controls outlined above along with corresponding numerical settings along with other slider controls numerical displays and radio buttons to adjust and display selected parameters which may control the light intensities of the various lighting channels and their representations in the SLM image field . The PRL panel may include a gang PRL radio button that indicates whether the PRL sources . Through are ganged together i.e. adjusted to the same setting rather than separately controlled.

The slider control scales may denote the range from none to full of the intensity to be transmitted by the corresponding aperture. The slider control pointer and the numerical display may indicate the selected value to which the respective light source intensity may have been set. The numerical display may denote a digital quantity across a binary integer grayscale range of 2from full illumination at 255. To no illumination at 0 In the example illustrated the stage control panel shows for example a low level value of the coaxial control panel shows for example a high level value of while all the PRL control panels show for example a mid level value of . The PRL radio button shows for example that the PRL sources are ganged together in this example.

A background radio button may indicate a selection of the display background being either white or black shown in the example as being black double cross hatched. In a set up mode of operation the respective slider controls of Shift scales V and H may be used to adjust the position of the aperture pattern shown in the SLM image field over a limited range along the vertical V and horizontal H directions respectively. The actual location of the aperture pattern of the SLM may be controlled in a corresponding manner. The alignment of the actual aperture pattern of the SLM relative to the physical layout of the input ends of the light cables and . which may be held in a fixture proximate to the SLM may be monitored by direct observation or by monitoring a light transmission signal through the various light channels or the like until the various apertures have been properly aligned to the various light cable using the Shift controls. Then the corresponding calibration settings may be stored in the SLM control for use during ongoing operations of the machine vision inspection system .

In either case a light may pass through the collimator lens and be directed as collimated or approximately collimated light toward the SLM . In the example shown in the light may pass through an aperture which may define the illumination area and may then pass through a filter to block wavelengths that may contribute deleterious effects such as undesirable heating or image blur or the like. For example in some applications wavelengths in the ultraviolet portion of the electromagnetic spectrum may focus differently than a dominant imaging wavelength and degrade images. The light may then pass for example through the previously discussed respective apertures of the SLM and into the respective optical cables of the optical cable arrangement that are aligned with the respective apertures to be transmitted to the respective positions of the illumination sources and for example. The input ends of the optical cables of the optical cable arrangement may be inserted into an alignment and mounting plate not shown that has a plurality of holes that receive the ends of the optical cables and hold them in an alignment that matches the aperture pattern of the SLM . The mounting plate may be mounted proximate to or flush to the SLM and may also act as an optical baffle or barrier between the outputs of the various apertures and the optical cable ends to reduce stray light cross talk between the light channels. An alternative configuration is shown in described below.

As may be observed from the bar chart increases in magnification reduce the amount of gathered light and the photographic exposure and generally would demand greater quantities of light to provide sufficient photographic exposure. Also darker materials such as the floppy disk may require far greater quantities of light than brighter materials such as the white connector or specularly reflective materials such as the mirrors. This difference in the amount of exposure light received for various materials and magnification demonstrates that the light levels that may be required for imaging and inspection of various magnified surfaces in a general purpose machine vision inspection system may vary widely. In fact if the saturation values shown for the low magnification imaging of various materials are to be avoided and if the low illumination values shown for the higher magnification imaging of various materials are to be brought up to acceptable imaging levels the illumination intensity may be required to be adjustable over a range of many orders of magnitude. Thus there is a need for an illumination system that provides an extraordinarily wide dynamic range and precise control of available illumination.

To increase throughput imaging the workpiece disposed on the stage may be performed while the stage remains in motion. Under selected conditions of image magnification and stage speed a strobe light flash of high intensity and short duration may be required to sufficiently illuminate the workpiece in a short enough exposure time to avoid image blur during workpiece motion. To achieve a desirable illumination dynamic range with short illumination and or exposure durations an extremely bright strobe lamp such as a Xe lamp may be advantageous. For many types of lamps which may also include LED s or lasers or the like as the term lamp is used herein after being triggered the strobe flash profile may temporally change in light intensity beginning with a gradual initial rise followed by a rapid increase a leveling off a rapid reduction and a more gradual decay. Providing a reliable and consistent illumination exposure over a wide dynamic range using such a flash profile would be desirable.

The chart includes for example five timelines. The first timeline represents an image acquisition trigger signal beginning at a position trigger time Tbased on positional X Y and Z axis coordinates of the stage which may correspond to a workpiece feature being positioned in the field of view of the camera .

The second timeline represents a camera integration duration that may have a programmable duration T T as short as tens of microseconds and as long as several milliseconds. The controlled duration may be controlled based on a high speed clock such that it is relatively consistent. The camera integration duration may start at integration begin time Tand end at integration end time T. In some implementations the integration begin time Tmay occur a discrete latency period T T after the position trigger time Thas been used to initiate a camera integration period. However the latency period may be relatively consistent.

The third timeline represents the flash initiation signal beginning at a pulse trigger time Tto initiate the strobe flash. In some implementations the pulse trigger time Tmay be based by the same high speed clock that is used to determine the camera integration duration . Therefore a pulse trigger delay period T T may be programmable based on the high speed clock and relatively consistent. The beginning of the pulse trigger time Tmay initiate the strobe pulse flash intensity profile indicated by the fourth timeline . The flash intensity may exhibit a transient profile described further below that rises to a peak before diminishing.

The fifth timeline represents an exposure related coordinate position latch signal beginning at latch time Tthat may coincide with an effective or nominal exposure time. The X Y and Z coordinates for the stage or the workpiece at the latch time Tmay be associated with the acquired image and may be stored in memory . Descriptions of the timeline events listed in order of occurrence during an image acquisition cycle are summarized in Table 1 below.

The strobe pulse flash intensity profile begins at the pulse trigger Twith an initial gradual rise until effective start of the flash at time T. After a rapid rise to a peak value the flash may then diminish rapidly to an effective end point of the flash at a time T and then continue to decay providing little additional illumination energy as shown in . For a particular implementation and an particular lamp a latency period between the pulse trigger time Tand the effective pulse start time Tmay be relatively consistent. Furthermore for a given time period T T the intensity profile and the illumination energy provided at a particular operating voltage for a particular lamp may be relatively consistent.

As previously indicated with a Xe lamp for example the ability to vary the flash duration or profile may be limited and the flash duration may be inherently less than a typical minimum camera integration period. Therefore to reduce the effective exposure illumination provided by a strobe flash by orders of magnitude with consistent control it may be desirable that the camera exposure end at a predictable and consistent time before the effective end time Tof the flash. As previously indicated the pulse trigger delay period T T may be programmable based on the high speed clock and relatively consistent. Similarly the programmable camera integration duration T T may be programmable based on the same high speed clock and relatively consistent. Furthermore the latency period between the pulse trigger time Tand the effective pulse start time Tmay be relatively consistent. Therefore for a given flash time period T T and associated profile the effective exposure illumination may be controlled by selecting and or programming the programmable camera integration duration T T and the pulse trigger delay period T T such that camera integration end time Tends at a predictable time during the flash profile and truncates and determines the effective image exposure illumination. That is to control the effective image illumination over a wide dynamic range the start of the effective image exposure illumination may begin with the flash a short time following the start of the camera integration period and may end with the end of the camera integration period during the strobe flash profile. Of course all of the above latency times may calibrated or determined for particular machines lamps voltage levels etc. by design and or experiment and the results calibrated or stored such that a combination of timing operating voltages and the like that provide a desired or calibrated illumination level may be readily determined.

The light generation system may operate in conjunction with the SLM control portion the timing and synchronization portion and a video splitter . The timing and synchronization portion and the SLM control portion . may be components of the light channel exposure and control portion . The vision measuring machine includes the camera and light sources to illuminate the workpiece . The coaxial mirror directs the light from the coaxial light source toward the workpiece .

The camera may receive signals from the imaging control interface and may transmit image data via the imaging control interface via a video input . The camera may also receive and transmit signals between a serial communicator . A digital monitor and or an analog monitor may display information related to the SLM for example as one means to implement the SLM setup and control GUI described with reference to . The SLM control portion may supply SLM video signals to the video splitter and the digital monitor . The video splitter may supply video signals to the timing and synchronization portion and the SLM interface portion as well as with the analog monitor . For example the video signal supplied to the SLM interface portion may be a conventional video signal and the SLM interface portion may receive and decode the video signal into digital control signals suitable for operating an SLM that may comprise an LCD pixel array to produce a desired aperture configuration and operating state. Generally such SLM interface decoders are commercially available from many vendors of LCD pixel array displays such as the vendor of the LCD array previously described.

The timing and synchronization portion may receive a position trigger output signal for example see from the motion control interface conventional motion controllers may be programmed to provide such position triggers and relay a related signal to the imaging control interface OptoTRIG in to maintain the timing relationships described with reference to . The imaging control interface may supply an exposure trigger signal to the camera to initiate the start of a camera integration period for example see and supply a pulse trigger for example see to the light generator which may provide light to the SLM for distribution to the light sources . The pulse trigger signal may be delayed relative to the exposure trigger signal by a programmable amount based on a high speed clock included in the imaging control interface . This programmable delay in conjunction with the programmed integration period of the camera and possibly various consistent timing latencies may be used to control the effective image exposure illumination as previously described with reference to . The high speed clock and the programmable integration period and pulse trigger signal delay may be implemented in various commercially available frame grabbers.

The timing and synchronization portion may supply a position latch trigger signal for example see to the motion control interface in order to latch the X Y and Z coordinates for the stage or the workpiece at a time that corresponds to the effective image exposure time. For example the timing and synchronization portion may implement a latching time that best corresponds to the effective image exposure time based on the known pulse trigger signal time and the known camera integration period which allows the timing of the effective image exposure period for example see T T to be known. For example for short effective image exposure periods it may be sufficient for the position latch timing to be set at the middle of the period T T . Or for a more accurate effective image exposure time the position latch time may be set at the intensity weighted average time of the period T T based on the known flash intensity profile which may be determined experimentally for example. The pulse trigger signal time that is used to determine the effective image exposure time may be determined internally to the timing and synchronization portion based on a delay related to the signal supplied to the imaging control interface OptoTRIG in or optionally the pulse trigger signal time that is used may be determined based on sending the pulse trigger signal in parallel to the synchronization portion when it is sent to light generator .

Examples of selected components are described herein. The serial communicator may represent an interface control tool. The control system portion may include a personal computer backplane with the SLM control portion provided by a Matrox dual video interface DVI daughter board and the imaging control interface including a Corona II frame grabber both available from Matrox Electronic Systems Ltd St R gis Dorval Quebec Canada. The vision measuring machine may use Quick Vision controls for controlling the various light sources. The SLM interface portion and the SLM may be provided by a micro display graphics array and associated electronics from CRL Opto in Dunfermline Scotland United Kingdom. The motion control interface may include a motion controller for example one of the DMC XXXX series of motion control cards commercially available from Galil Motion Control Rocklin Calif. or a motion control card such as that supplied as part of the previously described Quick Vision systems.

The light may be channeled for example through a fiber bundle light conduit to then pass as collimated light through the aperture the filter and the SLM which are located in a second portion of the light generation system . The second portion of the light generation system may include a hinged mirror similar to the hinged mirror . In a first position the light may shine directly into the previously described optical cable arrangement to provide all of the previously described illumination functions.

Alternatively the SLM may be a controllable element that may include or be configurable or programmable to form a structured light pattern in addition to the exemplary aperture patterns described above. For example the structured light pattern may include a regular pattern of light light transmitting and dark light blocking stripes at a desired pitch and may be formed using the previously described LCD pixel array. In such a case the collimated light that passes through the SLM will may provide a field of parallel stripes of light. In a second position the hinged mirror may deflect the parallel stripes of light to pass through focusing and or magnifying and or collimating lenses before being emitted to provide a structured light source that may be used to illuminate the workpiece . The structured light source may be mounted at a fixed and or known position to emit the parallel light stripes toward the workpiece along an axis that is arranged at a known angle relative to the optical axis of the machine vision inspection system . Thus an image of the structured light pattern on the surface of the workpiece may be used in conjunction with known structured light triangulation techniques to determine relative dimensions of the profile of the workpiece along the Z axis direction. Various related teachings regarding the use of LCD arrays and structured light techniques are included in U.S. Pat. No. 6 690 474 which is incorporated herein by reference in its entirety.

It should be appreciated that in embodiments where the SLM may be implemented such that the various respective channel apertures may be partially transmitting for example when the previously described LCD pixel array is used the SLM may advantageously be used to increase the dynamic range of the effective image exposure illumination. That is in addition to the dynamic range control provided by the previously described measures of controlling the camera integration period and the strobe flash timing gray level control of an LCD pixel array or a custom LCD element or the like may be used in parallel with any of the foregoing techniques to provide additional illumination dynamic range.

Table 2 shows various factors which may be used in various combinations to provide a desired illumination level including the use of a partially transmitting type of SLM. Row 1 shows that an LCD pixel array may provide a variable illumination attenuation that may be controlled with an 8 bit gray level command. However in practice the actual level of variation observed in the transmitted light is limited to approximately 150 1 Row 2 shows that an LCD pixel array may provide a variable brightness attenuation that affects all pixels at once and may provide an actual level of variation observed in the transmitted light that is approximately 1.2 1 Row 3 shows that a Xe strobe lamp may provide a variable brightness depending on its operating voltage level and may provide an actual level of variation observed in the provided and transmitted light that is approximately 17 1 Row 4 shows that a Xe strobe lamp generally provides an effective exposure time that is shorter than a typical minimum camera integration period therefore for strobe exposures the overall duration of the camera exposure period is not used to affect the exposure. However as previously indicated the pulse duration may be set so as to stop the image exposure to effectively truncate part of the flash profile. Row 5 shows that the pulse trigger delay for example see T T which governs the relative timing between the camera integration period and the flash profile may be adjusted in 40 ns time steps. That is the flash profile may be selectively eliminated from the image exposure in 40 ns time steps. In practice the actual level of variation observed in the transmitted light by using this control measure may be approximately 250 1 Rows 6 and 7 show factors which may vary from machine to machine lamp to lamp etc. Generally it may be desirable to calibrate and or compensate these variations. Overall according to Table 2 all of these techniques may be used in combination to provide an effective image exposure illumination dynamic range of approximately 765 000 1 in a set of relatively precisely controlled and repeatable increments.

The abscissa in may correspond to the light setting power setting during continuous illumination that produces a satisfactory stationary workpiece image that may be acquired throughout a reference or standard exposure time such as the frame rate of conventional cameras. This method of illumination and exposure may be conventional and may be well suited for operation of a vision machine during manual operations and training mode operations that involve a machine operator. The ordinate in may correspond to a strobe duration time necessary for a given strobe light power to achieve an image intensity equivalent to the light setting power setting during continuous illumination that is to achieve the same total exposure illumination energy for that light source.

A particular total exposure illumination energy may be defined as corresponding to a particular continuous illumination level when using the reference or standard exposure time. This energy may be divided by a particular strobe light average power level that may directly determine the corresponding required strobe duration time to a first approximation. Each of the exemplary strobe light power curves may reflect a respective strobe lamp power setting consistent for each point along the respective curves. Thus operation according to any point along the higher power curve may allow a shorter strobe duration time than operation according to corresponding vertically aligned points along either of the lower power curves . When using the light generation system or and the various systems and methods outlined above higher strobe light power curves may correspond to higher strobe lamp operating voltages and or controlling the pixels of an LCD pixel array used for the SLM to be fully transmitting. Lower strobe light power curves may correspond to lower strobe lamp operating voltages and or controlling the pixels of an LCD pixel array used for the SLM to be only partially transmitting.

In order to provide the shortest possible strobe duration and produce images having the least motion related blur and the smallest possible uncertainty in the elevation distance there are advantages to operating at a point toward the lower left end of any strobe light power curve.

Each strobe light source may inherently have a maximum allowable power level and in the absence of other camera response considerations and other analogous devices this factor may determine the fastest allowed strobe duration. The higher power curve generally represents such a maximum power level. For a maximum or selected power level and a desired operating point for example as indicated by the line the corresponding strobe duration period may then be determined.

The strobe duration period may provide the required matching total exposure illumination energy. The lines generally represent alternative settings for providing a desired illumination level by using respective strobe duration times corresponding to respective strobe light power levels. Also for a desired strobe duration time defined along the ordinate the corresponding required strobe light power may be determined at the intersection of the abscissa and ordinate values in the plot .

An operator may input control parameters such as workpiece positions light source intensity mixtures etc. to inspect one or more workpieces manually semi automatically or automatically. An example of types of parameters that may be entered is shown in Table 3 below. Parameters such as workpiece image acquisition positions stage velocity magnification light intensities etc. may be provided.

The parameters in Table 3 are only examples and in particular situations more or fewer or alternate parameters may be necessary for compatibility with different equipment designs.

The control parameters may be determined by an operator who places a sample workpiece onto the stage and determines the best position magnification lighting etc. with which to perform the image capture to obtain optimal results. An operator may image a sample workpiece with various parameter combinations and observe the image captured by the camera and assess whether the edges are properly determined. After obtaining an operable set of parameters the operator may enter those parameter values as programmed control parameters.

The control system portion may process the control parameters established by the operator that may be obtained during the static imaging conditions of a training mode and convert them to appropriate control commands for dynamic image capture during the continuous motion conditions of an automatic inspection mode. For example successive image acquisition locations and the associated total illumination energy to be provided by each light source may be established by the operator during a training mode and the measurement path velocities SLM settings corresponding to the various light sources effective strobe duration period corresponding to the various light sources etc may then be optimized by appropriate processing and or analysis in the control system portion in order to yield the highest throughput or best accuracy etc. during automatic inspection program execution. After the dynamic image capture control commands for the automatic inspection program have been generated the control commands and the control parameters may be stored in the memory for later retrieval and use.

After processing the control parameters and or retrieving control commands from the memory the control system portion downloads image acquisition position parameters the associated light control command information and any other appropriate information to the lighting control interface and or the light channel exposure and control portion and or the light generation system and may control the other system components to execute an inspection process. In various applications it may be desirable to use the dedicated processing and deterministic timing of the light generation system in order to simultaneously control the high speed light pulse patterns of multiple light sources with sufficient accuracy and at the desired position along a high speed motion path. For example the motion controller may receive stage velocity information and command the stage to move the workpiece after receiving position information from the light generation system which may receive control commands from control system portion and processes the control commands into specific data to control an image capture operation.

The captured images may be processed by the video tool portion . The image capture cycles may be repeated until completion of a total number of inspection images for each workpiece and the control system portion issues a next position signal corresponding to a next if any workpiece .

In step S the machine vision inspection system may analyze the light power or intensity settings input in step S and determine timing relationships between the strobe flash profile and the camera integration period and or a strobe lamp operating voltage based on the light power or intensity settings such that the strobe illumination that is integrated during the camera integration period provides an illumination level that is sufficient for all of the respective selected light source channels in comparison to their respective light power or intensity settings. The control parameters corresponding to the determined timing and or voltage level may be stored in memory and or implemented in the appropriate circuits or routines. The corresponding strobe illumination level may exceed the respective light power or intensity settings for some or all of the light source channels if a controllable SLM is available to attenuate the light transmission to the various light source channels. In a decision step S it may be determined whether the timing and or voltage level determined in step S is sufficient to provide the desired light power and or intensity setting for each selected light source. If so then operation mayjump to step S. Otherwise operation proceeds to step S. In step S the respective light channel apertures are adjusted in the SLM to provide respective partial light transmission settings and or respective aperture sizes that provide a level of light transmission attenuation that provides the desired light power and or intensity level for each respective light channel. It should be appreciated that a light channel aperture size can be reduced in the SLM instead of or in addition to adjusting the pixel gray levels or the like in order to attenuate the light transmission through a light source channel aperture. It should be appreciated that in the step S the SLM may be adjusted independently for each light source channel aperture such that one strobe flash can be differently attenuated for each respective light source channel to provide a desired combination of illumination levels for multiple light sources during a single flash.

In an optional step S the light control settings determined in steps S S may be tested by acquiring and evaluating a workpiece image using the settings. For example the user may observe the resulting image on a display of the machine vision inspection system during learn mode and accept or reject the image. If the image is rejected the light control settings may be refined and retested until an acceptable image results. However if the image illumination is not critical for a particular image and or if the various light control settings are adequately accurate and or calibrated such that reliable illumination levels are obtained without confirmation of the determined settings then the step S may be omitted. In step S the final light control settings determined in steps S S may be applied to acquire a workpiece image suitable for learn mode inspection operations and or recorded for example in a part program that may be used later for automatic high speed inspection. The process may then end in step S.

Artisans having skill in the art will recognize and understand that various functions for the systems and methods for controlling strobe illumination may be performed in any manner among any quantity e.g. one or many of hardware and or software modules or units computers or processing systems or circuitry. The control system portions may be integrated within a stand alone system or may be executed separately and be coupled to any number of devices workstation computers server computers or data storage devices via any communications medium e.g. network modem direct connection wireless transmission .

The control system processes may be implemented by any quantity of devices or processing systems e.g. IBM compatible Apple Palm Pilot Blackberry . The computer system may include any commercially available or customized operating system e.g. Windows Macintosh Unix Linux OS 2 DOS to execute any commercially available or custom designed software e.g. Quick Vision and any type of input devices e.g. keyboard mouse microphone I O port wireless receiver . It is to be understood that the software of the strobe illumination control may be implemented in any desired computer language e.g. C C Java Fortran Lisp SQL and could be developed by one of ordinary skill in the computer and or programming arts based on the functional description contained herein. Moreover such software may be available or distributed via any suitable medium e.g. stored on magnetic or optical devices such as CD ROM and diskette downloaded from the internet or other network downloaded from a bulletin board or other conventional distribution mechanisms.

It will be appreciated that various of the above disclosed and other features and functions or alternatives thereof may be desirably combined into many other different systems or applications. Also various presently unforeseen or unanticipated alternatives modifications variations or improvements therein may be subsequently made by those skilled in the art and are also intended to be encompassed by the following claims.

