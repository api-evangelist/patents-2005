---

title: Rights management system for streamed multimedia content
abstract: To communicate requirements for a digital license from a receiver of corresponding digital content to a computing device upon which the digital content is to be rendered, the receiver tunes the content and locates within the content information relating to the requirements for the license, constructs the requirements from the located information, and sends such constructed requirements to the computing device. The computing device upon receiving the sent requirements constructs the license based on such received requirements, stores such constructed license in a license store of such computing device, and thereafter renders the content only in accordance with the license. Thus, the receiver need not communicate the license itself to the computing device.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09507919&OS=09507919&RS=09507919
owner: Microsoft Technology Licensing, LLC
number: 09507919
owner_city: Redmond
owner_country: US
publication_date: 20050422
---
U.S. patent application Ser. No. 11 112 325 and entitled Rights Management System for Streamed Multimedia Content 

U.S. patent application Ser. No. 11 113 215 and entitled Rights Management System for Streamed Multimedia Content and

U.S. patent application Ser. No. 11 113 160 and entitled Rights Management System for Streamed Multimedia Content 

all of which are filed concurrently and all of which are hereby incorporated by reference in their entirety.

The present invention relates to a rights management RM system whereby access to streamed digital content is provided only in accordance with a corresponding digital license. More particularly the invention relates to systems and methods employed by such an RM system for handling the streamed content.

Rights management RM and enforcement is highly desirable in connection with digital content such as digital audio digital video digital text digital data digital multimedia etc. where such digital content is to be distributed to one or more users. Digital content could be static such as a text document for example or it could be streamed such as the streamed audio and video of a multimedia presentation. Typical modes of distribution of such streamed content include tangible and intangible forms such as an optical disk a cable access feed a feed from an electronic network such as the Internet a feed from an over the air broadcast etc. Upon being received by a user at an appropriate computing device thereof such user renders the streamed digital content with the aid of the computing device appropriate rendering software and appropriate output devices such as speakers a video monitor etc.

In one scenario the streamed content is distributed by a distributor as part of a subscription service such as for example a digital television service and the streamed content as distributed is either protected such as for example by being encrypted or is unprotected. If it is the case that the streamed content is indeed distributed in an unprotected form it may be the case that the distributor primarily intends for the streamed content to be immediately consumed and rendered and not stored in any meaningful retrievable form. For example the streamed content may be one of many streams of content in a digital cable television signal that is to be received by a digital cable set top box and immediately rendered thereby and is then to be forwarded to the aforementioned appropriate output devices.

However it is to be appreciated that storage systems exist and or are being developed that can indeed store the streamed content for later rendering and or re distribution to other computing devices. With regard to such storage systems then the distributor of the streamed unprotected content would rather not have such unprotected content stored in the unprotected form and without any ability to restrict such re distribution if so desired. In particular the distributor or the like may wish to prohibit the user from copying such streamed content to another storage system or the like may wish to allow the user to copy with temporal and or count restrictions or the like. As may be appreciated by prohibiting unlimited copying of the streamed content the distributor can avoid the unchecked dispersal of pristine digital copies of the streamed content where such unchecked dispersal would encourage other users from foregoing from subscribing to the subscription service offered by such distributor.

In addition the distributor may wish to provide various users with different rendering rights. For example the distributor may offer different tiers of service where higher level tiers correspondingly command higher subscription fees and where a user subscribing at a particular tier should not be allowed to access streamed content from higher tiers in an unprotected form.

Note though that after the streamed content has been distributed the distributor has very little if any real control over the streamed content. This is especially problematic in view of the fact that most any personal computer includes the software and hardware necessary to make an exact digital copy of such streamed content and to download such exact digital copy to a re distribution medium such as an optical disk or to send such exact digital copy over a network such as the Internet to any destination.

Of course as part of a transaction wherein the streamed content is subscribed to the distributor may require the user recipient of the streamed content to promise not to re distribute such content in an unwelcome manner. However such a promise is easily made and easily broken. The distributor may attempt to prevent such re distribution through any of several known security devices usually involving encryption and decryption. However such security devices if especially simple pose little problem to a mildly determined user who wishes to decrypt encrypted content save such content in an un encrypted form and then re distribute same.

RM and enforcement architectures and methods have thus been provided to allow the controlled rendering of arbitrary forms of digital content including streamed content where such control is flexible and definable by the distributor or the like of such digital content. Such architectures allow and facilitate such controlled rendering in the scenario as set forth above.

In one particular arrangement the streamed content is one of a plurality of streams of such content provided as a combined signal to a receiver. The receiver selects a particular one of the streams upon command from a media system and provides the selected stream to such media system for further processing. Notably the selected stream as provided to the receiver is unprotected but prior to being provided to the media system the selected stream is in fact protected by the receiver according to a particular RM encryption system.

Typically in an RM encryption system the content is protected by being encrypted according to a content key CK . Inasmuch as symmetric encryption and decryption is easier faster and less expensive than asymmetric encryption and decryption such content key CK is typically symmetric. Also typically the content key CK is provided by an encryptor such as the receiver to a decryptor such as the media system in an encrypted form and as part of a digital license or the like that specifies license rules that must be satisfied before such content is allowed to be decrypted and rendered by the decryptor media system.

In the circumstance where the streamed content is one of a plurality of digital television signals that may in effect be tuned by the receiver at the command of the media system it is to be appreciated that the receiver can be expected to receive commands from the media system to tune in different digital signals on a fairly regular basis perhaps on the order of as much as once every one half to one second especially if the user of the media system is in effect skimming through or surfing several signals. However and recognizing that each newly tuned signal requires a new license from the receiver it is to be appreciated that constructing such new license and sending same from the receiver to the media system can be quite burdensome especially if the license is detailed includes encrypted elements includes a digital signature or the like. Thus it likely cannot be expected that the receiver completely creates a new license every time the media system commands such receiver to tune a different digital signal especially if the frequency of such commands is on the order of seconds.

A need exists then for a system and method for the receiver to create a shortened version of requirements that would go into such a new license such that the receiver need not go to the burden of in fact completely creating such new license every time such receiver newly tunes a digital signal. In particular a need exists for such a shortened version of such requirements that can be quickly created and sent to the media system each time the receiver newly tunes a digital signal even if the user is commanding a change on the order of once every second or so. Additionally a need exists for such a shortened version of such requirements that is concise and yet describes all license requirements for the tuned digital signal in a minimal amount of space. Finally a need exists for such a shortened version of such requirements that can be employed in connection with streamed digital content as provided to the media system from sources other than the receiver.

Also recognizing that each newly tuned signal may be encrypted by the receiver according to a different content key CK it is to be appreciated that informing the media system of such content key CK by placing same in a new license and sending same from the receiver to the media system can likewise be quite burdensome. Again it likely cannot be expected that the receiver completely creates a new license with a new content key CK every time the media system commands such receiver to tune a different digital signal especially if the frequency of such commands is on the order of seconds.

A need exists then for a system and method for sharing each new content key CK between the receiver and the media system without the need for creating an actual license with each such content key CK therein. In particular a need exists for a method by which the receiver and media system can exchange an initial content key and then rotate content keys based on the initial content key. Additionally a need exists for such a method whereby the receiver and the media system rotate keys in a coordinated fashion.

Further recognizing that the requirements corresponding to a newly tuned signal may be located within the signal on a periodic basis but that such periodicity may be a relatively long period of time it is to be appreciated that it may be unreasonable to make the media system wait such a relatively long period of time until such requirements are in fact located within such signal. Especially in the situation where the receiver is tuning in different digital signals on a fairly regular basis perhaps on the order of as much as once every one half to one second it likely cannot be expected that the receiver can wait the relatively long period of time to locate the requirements within the newly tuned signal.

A need exists then for a system and method for the receiver to send a default set of requirements on a preliminary basis and then an actual set of requirements when actually located. In particular a need exists for a method by which the receiver can send such default requirements to be employed by the media system until the actual requirements are sent. Additionally a need exists for such a method whereby the media system can distinguish between such default requirements and such corresponding actual requirements and can replace the default requirements with the corresponding actual requirements upon receipt thereof.

Finally recognizing that the media system likely will store a relatively large amount of licenses corresponding to newly tuned signals but that many if not most of such licenses are not needed for very long it is to be appreciated that such licenses should for the most part be stored on only a temporary basis. Once again in the situation where the receiver is tuning in different digital signals on a fairly regular basis perhaps on the order of as much as once every one half to one second it likely cannot be expected that all of the corresponding licenses as created and stored by the media system should or could be made available on a permanent basis.

A need exists then for a system and method for the media system to store at least some licenses corresponding to tuned signals only on a temporary basis. In particular a need exists for a method by which the media system can recognize which licenses need only be stored on a temporary basis. Additionally a need exists for such a method whereby the media system deletes such temporarily stored licenses.

The aforementioned needs are satisfied at least in part by the present invention in which a method is provided for communicating requirements for a digital license from a receiver of corresponding digital content to a computing device upon which the digital content is to be rendered. In the method the receiver tunes the content and locates within the content information relating to the requirements for the license constructs the requirements from the located information and sends such constructed requirements to the computing device.

The computing device upon receiving the sent requirements constructs the license based on such received requirements stores such constructed license in a license store of such computing device and thereafter renders the content only in accordance with the license. Thus the receiver need not communicate the license itself to the computing device.

Although not required the invention can be implemented via an application programming interface API for use by a developer and or included within the network browsing software which will be described in the general context of computer executable instructions such as program modules being executed by one or more computers such as client workstations servers or other devices. Generally program modules include routines programs objects components data structures and the like that perform particular tasks or implement particular abstract data types. Typically the functionality of the program modules may be combined or distributed as desired in various embodiments. Moreover those skilled in the art will appreciate that the invention may be practiced with other computer system configurations. Other well known computing systems environments and or configurations that may be suitable for use with the invention include but are not limited to personal computers PCs automated teller machines server computers hand held or laptop devices multi processor systems microprocessor based systems programmable consumer electronics network PCs minicomputers mainframe computers and the like. The invention may also be practiced in distributed computing environments where tasks are performed by remote processing devices that are linked through a communications network or other data transmission medium. In a distributed computing environment program modules may be located in both local and remote computer storage media including memory storage devices.

With reference to an exemplary system for implementing the invention includes a general purpose computing device in the form of a computer . Components of computer may include but are not limited to a processing unit a system memory and a system bus that couples various system components including the system memory to the processing unit . The system bus may be any of several types of bus structures including a memory bus or memory controller a peripheral bus and a local bus using any of a variety of bus architectures. By way of example and not limitation such architectures include Industry Standard Architecture ISA bus Micro Channel Architecture MCA bus Enhanced ISA EISA bus Video Electronics Standards Association VESA local bus and Peripheral Component Interconnect PCI bus also known as Mezzanine bus .

Computer typically includes a variety of computer readable media. Computer readable media can be any available media that can be accessed by computer and includes both volatile and nonvolatile media removable and non removable media. By way of example and not limitation computer readable media may comprise computer storage media and communication media. Computer storage media includes both volatile and nonvolatile removable and non removable media implemented in any method or technology for storage of information such as computer readable instructions data structures program modules or other data. Computer storage media includes but is not limited to RAM ROM EEPROM flash memory or other memory technology CDROM digital versatile disks DVD or other optical disk storage magnetic cassettes magnetic tape magnetic disk storage or other magnetic storage devices or any other medium which can be used to store the desired information and which can be accessed by computer . Communication media typically embodies computer readable instructions data structures program modules or other data in a modulated data signal such as a carrier wave or other transport mechanism and includes any information delivery media. The term modulated data signal means a signal that has one or more of its characteristics set or changed in such a manner as to encode information in the signal. By way of example and not limitation communication media includes wired media such as a wired network or direct wired connection and wireless media such as acoustic RF infrared and other wireless media. Combinations of any of the above should also be included within the scope of computer readable media.

The system memory includes computer storage media in the form of volatile and or nonvolatile memory such as read only memory ROM and random access memory RAM . A basic input output system BIOS containing the basic routines that help to transfer information between elements within computer such as during start up is typically stored in ROM . RAM typically contains data and or program modules that are immediately accessible to and or presently being operated on by processing unit . By way of example and not limitation illustrates operating system application programs other program modules and program data .

The computer may also include other removable non removable volatile nonvolatile computer storage media. By way of example only illustrates a hard disk drive that reads from or writes to non removable nonvolatile magnetic media a magnetic disk drive that reads from or writes to a removable nonvolatile magnetic disk and an optical disk drive that reads from or writes to a removable nonvolatile optical disk such as a CD ROM or other optical media. Other removable non removable volatile nonvolatile computer storage media that can be used in the exemplary operating environment include but are not limited to magnetic tape cassettes flash memory cards digital versatile disks digital video tape solid state RAM solid state ROM and the like. The hard disk drive is typically connected to the system bus through a non removable memory interface such as interface and magnetic disk drive and optical disk drive are typically connected to the system bus by a removable memory interface such as interface .

The drives and their associated computer storage media discussed above and illustrated in provide storage of computer readable instructions data structures program modules and other data for the computer . In for example hard disk drive is illustrated as storing operating system application programs other program modules and program data . Note that these components can either be the same as or different from operating system application programs other program modules and program data . Operating system application programs other program modules and program data are given different numbers here to illustrate that at a minimum they are different copies. A user may enter commands and information into the computer through input devices such as a keyboard and pointing device commonly referred to as a mouse trackball or touch pad. Other input devices not shown may include a microphone joystick game pad satellite dish scanner or the like. These and other input devices are often connected to the processing unit through a user input interface that is coupled to the system bus but may be connected by other interface and bus structures such as a parallel port game port or a universal serial bus USB .

A monitor or other type of display device is also connected to the system bus via an interface such as a video interface . A graphics interface such as Northbridge may also be connected to the system bus . Northbridge is a chipset that communicates with the CPU or host processing unit and assumes responsibility for accelerated graphics port AGP communications. One or more graphics processing units GPUs may communicate with graphics interface . In this regard GPUs generally include on chip memory storage such as register storage and GPUs communicate with a video memory . GPUs however are but one example of a coprocessor and thus a variety of co processing devices may be included in computer . A monitor or other type of display device is also connected to the system bus via an interface such as a video interface which may in turn communicate with video memory . In addition to monitor computers may also include other peripheral output devices such as speakers and printer which may be connected through an output peripheral interface .

The computer may operate in a networked environment using logical connections to one or more remote computers such as a remote computer . The remote computer may be a personal computer a server a router a network PC a peer device or other common network node and typically includes many or all of the elements described above relative to the computer although only a memory storage device has been illustrated in . The logical connections depicted in include a local area network LAN and a wide area network WAN but may also include other networks. Such networking environments are commonplace in offices enterprise wide computer networks intranets and the Internet.

When used in a LAN networking environment the computer is connected to the LAN through a network interface or adapter . When used in a WAN networking environment the computer typically includes a modem or other means for establishing communications over the WAN such as the Internet. The modem which may be internal or external may be connected to the system bus via the user input interface or other appropriate mechanism. In a networked environment program modules depicted relative to the computer or portions thereof may be stored in the remote memory storage device. By way of example and not limitation illustrates remote application programs as residing on memory device . It will be appreciated that the network connections shown are exemplary and other means of establishing a communications link between the computers may be used.

One of ordinary skill in the art can appreciate that a computer or other client device can be deployed as part of a computer network. In this regard the present invention pertains to any computer system having any number of memory or storage units and any number of applications and processes occurring across any number of storage units or volumes. The present invention may apply to an environment with server computers and client computers deployed in a network environment having remote or local storage. The present invention may also apply to a standalone computing device having programming language functionality interpretation and execution capabilities.

Distributed computing facilitates sharing of computer resources and services by direct exchange between computing devices and systems. These resources and services include the exchange of information cache storage and disk storage for files. Distributed computing takes advantage of network connectivity allowing clients to leverage their collective power to benefit the entire enterprise. In this regard a variety of devices may have applications objects or resources that may interact to implicate authentication techniques of the present invention for trusted graphics pipeline s .

It can also be appreciated that an object such as may be hosted on another computing device or . Thus although the physical environment depicted may show the connected devices as computers such illustration is merely exemplary and the physical environment may alternatively be depicted or described comprising various digital devices such as PDAs televisions MP3 players etc. software objects such as interfaces COM objects and the like.

There are a variety of systems components and network configurations that support distributed computing environments. For example computing systems may be connected together by wireline or wireless systems by local networks or widely distributed networks. Currently many of the networks are coupled to the Internet which provides the infrastructure for widely distributed computing and encompasses many different networks.

In home networking environments there are at least four disparate network transport media that may each support a unique protocol such as Power line data both wireless and wired voice e.g. telephone and entertainment media. Most home control devices such as light switches and appliances may use power line for connectivity. Data Services may enter the home as broadband e.g. either DSL or Cable modem and are accessible within the home using either wireless e.g. HomeRF or 802.11b or wired e.g. Home PNA Cat 5 even power line connectivity. Voice traffic may enter the home either as wired e.g. Cat 3 or wireless e.g. cell phones and may be distributed within the home using Cat 3 wiring. Entertainment media may enter the home either through satellite or cable and is typically distributed in the home using coaxial cable. IEEE 1394 and DVI are also emerging as digital interconnects for clusters of media devices. All of these network environments and others that may emerge as protocol standards may be interconnected to form an intranet that may be connected to the outside world by way of the Internet. In short a variety of disparate sources exist for the storage and transmission of data and consequently moving forward computing devices will require ways of protecting content at all portions of the data processing pipeline.

The Internet commonly refers to the collection of networks and gateways that utilize the TCP IP suite of protocols which are well known in the art of computer networking. TCP IP is an acronym for Transport Control Protocol interface Program. The Internet can be described as a system of geographically distributed remote computer networks interconnected by computers executing networking protocols that allow users to interact and share information over the networks. Because of such wide spread information sharing remote networks such as the Internet have thus far generally evolved into an open system for which developers can design software applications for performing specialized operations or services essentially without restriction.

Thus the network infrastructure enables a host of network topologies such as client server peer to peer or hybrid architectures. The client is a member of a class or group that uses the services of another class or group to which it is not related. Thus in computing a client is a process i.e. roughly a set of instructions or tasks that requests a service provided by another program. The client process utilizes the requested service without having to know any working details about the other program or the service itself. In a client server architecture particularly a networked system a client is usually a computer that accesses shared network resources provided by another computer e.g. a server. In the example of computers etc. can be thought of as clients and computer etc. can be thought of as the server where server etc. maintains the data that is then replicated in the client computers etc.

A server is typically a remote computer system accessible over a remote network such as the Internet. The client process may be active in a first computer system and the server process may be active in a second computer system communicating with one another over a communications medium thus providing distributed functionality and allowing multiple clients to take advantage of the information gathering capabilities of the server.

Client and server communicate with one another utilizing the functionality provided by a protocol layer. For example Hypertext Transfer Protocol HTTP is a common protocol that is used in conjunction with the World Wide Web WWW . Typically a computer network address such as a Universal Resource Locator URL or an Internet Protocol IP address is used to identify the server or client computers to each other. The network address can be referred to as a Universal Resource Locator address. For example communication can be provided over a communications medium. In particular the client and server may be coupled to one another via TCP IP connections for high capacity communication.

Thus illustrates an exemplary networked or distributed environment with a server in communication with client computers via a network bus in which the present invention may be employed. In more detail a number of servers etc. are interconnected via a communications network bus which may be a LAN WAN intranet the Internet etc. with a number of client or remote computing devices etc. such as a portable computer handheld computer thin client networked appliance or other device such as a VCR TV oven light heater and the like in accordance with the present invention. It is thus contemplated that the present invention may apply to any computing device in connection with which it is desirable to process store or render secure content from a trusted source.

In a network environment in which the communications network bus is the Internet for example the servers can be Web servers with which the clients etc. communicate via any of a number of known protocols such as HTTP. Servers may also serve as clients as may be characteristic of a distributed computing environment. Communications may be wired or wireless where appropriate. Client devices may or may not communicate via communications network bus and may have independent communications associated therewith. For example in the case of a TV or VCR there may or may not be a networked aspect to the control thereof. Each client computer and server computer may be equipped with various application program modules or objects and with connections or access to various types of storage elements or objects across which files may be stored or to which portion s of files may be downloaded or migrated. Thus the present invention can be utilized in a computer network environment having client computers etc. that can access and interact with a computer network bus and server computers etc. that may interact with client computers etc. and other devices and databases .

As is known and referring now to rights management RM and enforcement is highly desirable in connection with digital content such as digital audio digital video digital text digital data digital multimedia etc. where such digital content is to be distributed or redistributed to a user. Upon being received by the user such user renders the digital content with the aid of an appropriate rendering device such as a media player text displayer etc. on a personal computer or the like.

Typically a content owner or developer or distributor hereinafter distributor distributing such digital content wishes to restrict what the user can do with such distributed digital content or at least ensure that the content is not redistributed in an unwanted manner. For example the content distributor may wish to restrict the user from copying and re distributing such content to a second user or may wish to allow distributed digital content to be rendered only a limited number of times only for a certain total time only on a certain type of machine only on a certain type of rendering platform only by a certain type of user etc.

However and as was set forth above after distribution has occurred such distributor has very little if any control over the digital content . An RM system then allows the controlled rendering of arbitrary forms of digital content where such control is flexible and definable by the content distributor of such digital content. Typically to protect the content such content is encrypted with a symmetric encryption decryption key KD i.e. KD CONTENT and is packaged with other information relevant to the content in a package .

The trust based RM system allows a distributor of digital content to specify at least some license rules that must be satisfied before such digital content is allowed to be rendered by a computing device of a user. Such license rules can include the aforementioned temporal requirement and may be embodied within a digital license or use document hereinafter license that the user user s computing device hereinafter such terms are interchangeable unless circumstances require otherwise must be possess. Such license also includes the decryption key KD for decrypting the digital content perhaps encrypted according to a key decryptable by the user s computing device . As seen in such encrypting key is a public key of the user s computing device PU C and the user s computing device presumably has the corresponding private key PR C by which PU C KD may be decrypted.

The content distributor for a piece of digital content must trust that the user s computing device will abide by the rules and requirements specified by such content owner in the license i.e. that the digital content will not be rendered unless the rules and requirements within the license are satisfied. Preferably then the user s computing device is provided with a trusted component or mechanism that will not render the digital content except according to the license rules embodied in the license associated with the digital content and obtained by the user.

The trusted component typically has a license evaluator that determines whether the license is valid reviews the license rules and requirements in such valid license and determines based on the reviewed license rules and requirements whether the requesting user has the right to render the requested digital content in the manner sought among other things. As should be understood the license evaluator is trusted in the RM system to carry out the wishes of the owner of the digital content according to the rules and requirements in the license and the user should not be able to easily alter such trusted element for any purpose nefarious or otherwise.

As should be understood the rules and requirements in the license might specify whether the user has rights to render the digital content based on any of several factors including who the user is where the user is located what type of computing device the user is using what rendering application is calling the RM system the date the time etc. In addition the rules and requirements of the license may limit the license to a pre determined number of renderings or pre determined rendering time for example. Thus the trusted component may need to refer to a clock on the computing device . If such clock is provided such clock may be a secure clock that cannot be tampered with by a user in an effort to overcome a temporal restriction of a license .

The rules and requirements may be specified in the license according to any appropriate language and syntax. For example the language may simply specify attributes and values that must be satisfied DATE must be later than X e.g. or may require the performance of functions according to a specified script IF DATE greater than X THEN DO . . . e.g. .

Upon the license evaluator determining that the license is valid and that the user satisfies the rules and requirements therein the digital content can then be rendered. In particular to render the content the decryption key KD is obtained from the license and is applied to KD CONTENT from the content package to result in the actual content and the actual content is then in fact rendered. As set forth above the license with PU C KD in effect authorizes an entity in possession of PR C to access KD and thereby access the content encrypted according to such KD presuming of course that the entity abides by all conditions as set forth in the license .

Note that a license typically includes a digital signature for authentication validation purposes. Likewise other forms of digital constructs such as a piece of digital content may also have such a digital signature for authentication validation purposes. As should be known such a digital signature may be constructed based on a first key from a pair of asymmetric keys or from a symmetric integrity key for example by performing some sort of hash on the underlying data to which the signature is attached and then encrypting the hash with the key. Thereafter the signature is validated by applying the second key from the pair of asymmetric keys or the integrity key again for example by decrypting the encrypted hash and comparing the decrypted hash to another hash of the underlying data to which the signature is attached. If the hashes match it can be presumed that the underlying data has not been altered and the underlying construct therefore can be authenticated. Typically an RM system will not honor a license or the like that is not authenticated.

Turning now to a system for receiving and handling multimedia content is shown. As should be evident such system is particularly suited for handling an input signal comprising multiple streams of multimedia content such as for example a television signal from a multi channel distributor. However such will be system may also handle other input signals without departing from the spirit and scope of the present invention.

In the system the aforementioned input signal as provided by the distributor thereof is applied to a receiver which may be any appropriate receiver without departing from the spirit and scope of the present invention presuming of course such receiver can perform the functions set forth herein. For example the receiver may be a Uni Directional Cable Receiver UDCR such as is being developed to receive a digital cable television signal and forward same for further digital processing including rendering of content therein. As may be appreciated the receiver upon being so commanded tunes one of the multiple streams of multimedia content from the input signal and forwards same for further processing. In addition the receiver prior to forwarding the tuned stream of content may if necessary convert such stream from a native format to a format more amenable for such further processing.

As envisioned each of the multiple streams of multimedia content in the input signal may or may not be encrypted. Upon tuning a particular stream of content within the input signal then the receiver decrypts such stream if encrypted and re encrypts same in a manner that will be set forth in more detail below or merely encrypts the stream if not encrypted again in a manner that will be set forth in more detail below. As was alluded to above the receiver encrypts the stream of content as part of ensuring that the stream is RM protected. Thus the stream of content is not available to be redistributed in an unprotected form.

As also shown in a media system is provided to receive the encrypted stream of content from the receiver and further process same. Presumably the media system commanded the receiver to tune the particular stream of content from within the input signal perhaps upon receiving a corresponding command from a user although it maybe appreciated that such a command may be initiated by other sources without departing from the spirit and scope of the present invention. At any rate upon receiving the stream of content from the receiver the media system stores same in an appropriate storage device for retrieval and rendering either immediately or upon some time delay. Upon rendering of the stream the media system forwards appropriate signals to one or more output devices such as one or more monitors speakers other displays and the like.

Inasmuch as the stored stream is in the RM protected form the media system includes RM components such as the trusted component license evaluator and clock of . Thus upon retrieving a particular stream the media system renders same but only in accordance with a corresponding license as will be set forth in more detail below. Accordingly the encrypted stream is decrypted and rendered only if such license so allows and with the content key CK set forth in the license . Note that inasmuch as the encrypted stream is stored at least temporarily on the first media system a user thereof may in theory copy same to another second media system for rendering thereby. However inasmuch as the stream is encrypted and decryptable only according to the license and inasmuch as the license is tied to the first media system such license may not be employed by the second media system .

As should be understood though it may be the case that the first media system can issue a sub license for the copied stream to the second media system presuming the first media system is in fact capable of doing so and the license so allows. If so the sub license as tied to the second media system can in fact be employed by the second media system to render the stream as will be set forth in more detail below.

As was set forth above it is to be appreciated that the receiver can be expected to receive commands from the media system to tune in different digital streams from the input signal on a fairly regular basis perhaps on the order of as much as once every one half to one second especially if a user of the media system is in effect skimming through or surfing several streams . However each newly tuned stream requires a new corresponding license with a new content key CK . Typically such license would be constructed by the receiver and delivered from the receiver to the media system just prior to delivering the tuned stream .

However it is to be appreciated that constructing such new license and sending same from the receiver to the media system can be quite burdensome especially if the license is detailed includes encrypted elements includes a digital signature or the like. Thus it likely cannot be expected that the receiver can completely construct a new license for a newly tuned stream every time the media system commands such receiver to in fact tune such stream . This is especially true if the frequency of such commands is on the order of seconds as is the case for the aforementioned surfing situation. This is also especially true if the receiver is not provided with especially significant computing power as may be necessary to construct such license in an expeditious manner. At any rate a typical user commanding a new stream to be tuned would expect such new stream to be rendered and presented in no more than a second or two after the command has been issued.

Clearly then the receiver likely cannot send a new license each time a stream is newly tuned. Instead and in one embodiment of the present invention the receiver creates and sends an abbreviated or shortened version of requirements that would go into such a new license and the media system upon receiving such requirements is trusted by the receiver to construct such a new license on behalf of the receiver presumably with the aid of computing power greater than that which is available to the receiver .

Presumably the receiver determines the requirements for the stream from information within the stream itself. Determining such requirements from the information in the stream is known or should be apparent to the relevant public and therefore need not be set forth herein in any detail and accordingly any method of determining such requirements from the stream may be employed without departing from the spirit and scope of the present invention. For example it may be the case that the stream as distributed is periodically supplied with the information at a known interval and location.

The requirements as specified for a particular stream by the receiver may of course be any requirements without departing from the spirit and scope of the present invention. Typically though the requirements specify at least in part whether the stream as stored in the storage device of a first media system and as licensed to such first media system may in fact be copied to and sub licensed to a second media system . For example such a copy right may be stated as copy freely CF copy once CO copy never CN and the like.

Thus with the present invention the receiver need not go to the burden of in fact constructing such new license every time such receiver newly tunes a particular stream and the shortened version of the requirements of such license can be quickly created and sent to the media system each time the receiver newly tunes a stream even if the user is commanding a change on the order of once every second or so.

Moreover and as may be appreciated by sending only the requirements and not the license itself the receiver need not be burdened with any particular format of the license itself. Thus if at some point a new format is specified for the license such format need only be communicated to the media system and not the receiver .

Still referring to it is seen that in addition to receiving a stream from the receiver the media system may additionally receive streams from other sources either directly or indirectly. Such other sources may for example comprise an NTSC input signal an ATSC input signal and the like. As seen for each of at least some input signals received directly it may be the case that the media system includes either a hardware or software gateway that acts in the manner of the receiver to both convert a stream within the received input signal to an encrypted format more amenable to the media system and also to create and send an abbreviated or shortened version of requirements for the stream that would go into a new license as created by the media system . Here the gateway could determine the requirements for the stream from the information within the stream itself or could compose default requirements if not available from such stream .

In one embodiment of the present invention the requirements as provided for any particular stream from any particular source are set forth in a common format. Accordingly the media system need not be concerned with multiple formats corresponding to different sources. In one embodiment of the present invention the common format is of a relatively abbreviated nature such that the requirements can be quickly and easily transmitted to or within the media system and the media system can likewise quickly construct a license therefrom.

For example and turning now to it is seen that in one embodiment of the present invention the common format has 32 bits divided into a number of pre defined fields. The fields are defined as follows 

Input Copy Protection Method This field specifies an 8 bit value that corresponds in a predetermined manner to the particular content protection method of the corresponding stream . Such content protection methods may include but are not limited to 

None No copy protection is specified for the stream and no RM based restrictions should be imposed on same.

Input Device Meets Robustness Rules This one bit field is set to 1 if the input device e.g. a tuner card as the receiver meets the robustness rules defined by the input copy protection method.

Copy Default This one bit field is set to 1 if the copy protection requirements are not yet known from the stream and default copy protection is to be applied.

Broadcast Flag Restricted Content This one bit field is unique to ATSC and is set to 1 if the stream is redistribution controlled.

CIT This one bit field is unique to Cable Labs Digital Cable and is set to 1 if the Constrained Image has been triggered.

APS This two bit field represents Analog Protection System requirements unique to certain Macrovision formats.

Copy Control Value This two bit field represents how the stream may be copied sub licensed from the media system to another media system copy freely CF copy once CO copy never CN and the like.

Notably in the one embodiment shown in of the 32 bits are reserved for later use. Accordingly features unique to a new type of copy protection may be implemented within the reserved bits as may be additional features already present in current types of copy protection. Also notably specific bits that currently are reserved for use only in connection with certain types of copy protection and therefore not of use in connection with other types of copy protection may nevertheless be employed in connection with such other types of copy protection for different purposes.

As may now be appreciated by employing a common format to represent the requirements for a license corresponding to a particular stream such requirements can be specified in a common manner that is agnostic to any particular format of such stream as distributed. The requirements are succinctly specified in a manner not specific to any particular source content protection mechanism and a relatively simple device such as the receiver or a gateway hereinafter receiver unless circumstances dictate otherwise can derive the requirements from any specific format and translate same into a common format.

Turning now to it is seen that a method employed by the receiver in response to a command to tune a particular stream is shown. As may be appreciated such command is typically issued initially by a user to the media system step and then from the media system to the receiver step although the media system may alternately issue such tuning command without prompting from the user without departing from the spirit and scope of the present invention. At any rate in response to the tuning command the receiver in fact tunes the stream at issue step . Such tuning is generally known or should be apparent to the relevant public and therefore need not be set forth herein in any detail. Accordingly such tuning may be performed in any appropriate manner without departing from the spirit and scope of the present invention.

Once tuned the receiver decrypts the stream if necessary step and re encrypts same according to a symmetric content key CK that is shared with the media system step . One method of sharing such content key CK with the media system is set forth below although it is to be appreciated that most any such method may be employed without departing from the spirit and scope of the present invention.

In addition from the decrypted stream the receiver may locate the aforementioned information relating to the requirements for a license corresponding to the stream step . As was set forth above such information with such requirements may be periodically supplied within the stream at a known interval and location. For example such known interval may be on the order of once every 20 seconds and the location may be a particular identified packet if the stream is digital or a particular video blanking interval if the stream is analog. As will be set forth below in more detail in the case where the receiver has not as yet encountered such information in the stream and where waiting for such information is not feasible the receiver may proceed by sending requirements based on some default set of information and at a later time when actual information is received send actual requirements .

At any rate with the located information the receiver constructs a set of requirements corresponding to the stream step where such requirements may be expressed in the aforementioned common format and sends such requirements to the media system step and in particular to the trusted component of the media system . Thereafter the media system constructs a license based on the requirements step and stores such constructed license in a license store thereof or the like step .

Constructing such license from such requirements is generally known or should be apparent to the relevant public and therefore need not be set forth herein in any detail. Accordingly such construction of such license may be performed in any appropriate manner without departing from the spirit and scope of the present invention. For example and in the case where the requirements are expressed according to the 32 bit common format set forth above or the like the media system may employ a mapping algorithm that maps each field of bits to a license according to pre defined mapping rules.

Note that in constructing the license the media system presumably stores the content key CK for the stream which may be obtained in a manner set forth below within the license encrypted according to another key such as a public key of such media system PU MS to result in PU MS CK . Thus only that media system may access CK from PU MS CK from the license with the aid of a private key PR MS corresponding to PU MS . As a result such license may be said to be tied to such media system and may not be employed by any other media system or other device. If the license authorizes the media system to issue a sub license for another media system to render the stream by for example stating a copy right such as copy freely CF or copy once CO such media system in creating the sub license must first apply PR MS to PU MS CK to reveal CK and then must encrypt CK according to a PU MS of the another media system and then may insert such a new PU MS CK into the sub license .

Note that the media system is likely in possession of the content key CK for a particular stream prior to constructing a corresponding license for same and therefore may employ such content key CK to decrypt the encrypted stream as sent from the receiver and render such decrypted stream step . One may therefore question the need for the media system to construct and store the license as at steps and . However it should be appreciated that the stored license may be used by the media system if need be to retrieve the content key CK such as for example if the media system somehow loses such CK during a reset or the like. Likewise if the media system is playing back the stream from the storage device on a delayed basis the license may be the only location where such CK is stored. Also the license is necessary to store and retrieve any copy rights associated with the stream as well as the other requirements corresponding to the stream which may need to be referred to at some future point.

Note that for any particular stream it may be the case that the information thereof may change one or more times. If so and as may be appreciated the receiver should issue new requirements to the media system as at steps and and the media system should construct and store a new license as at steps and . Thus the receiver should be aware of each set of information within the stream and should note when such set of information has changed within the stream .

As was set forth above each time the receiver tunes a different stream the receiver sends the newly tuned stream encrypted according to a different content key CK and also sends a set of corresponding requirements . Thus the receiver and the media system must somehow share content keys CK and in particular the media system must know what content key CK the receiver has employed to encrypt a particular stream .

However and significantly it is not presently envisioned that the receiver transmit each content key CK for each particular stream to the media system for example as part of the requirements or within a typical RM license . As was set forth above the receiver cannot be expected to construct and send such a typical RM license for each newly tuned stream because constructing such a license is so labor intensive and because it can be the case that a newly tuned stream can be commanded as often as once every second or so. Thus the receiver and the media system must somehow share such content key CK through a different method of communication.

Accordingly and in one embodiment of the present invention the receiver and the mediasystem as part of an initialization share an initial content key CK by way of a more or less typical RM license and then each of the receiver and the media system derive a new content key CKx from CK either directly or indirectly on an as needed basis and in a coordinated fashion. Significantly the initialization RM license is required only once until another initialization is necessary and accordingly the labor intensive aspects of such RM license are encountered only once until another initialization is necessary. Note that such an initialization may be performed according to any appropriate interval without departing from the spirit and scope of the present invention. For example an initialization may be performed once every few hours or few days or so or may be performed once each time the media system is started or is reset.

In one embodiment of the present invention and turning now to upon an initialization event the media system sends an initialization request to the receiver step where such initialization request includes a machine certificate or the like issued to the media system by an authority or chain of authority trusted by the receiver . Significantly the sent machine certificate includes a public key of the media system PU MS and the media system is in possession of a corresponding private key PR MS .

Thereafter the receiver satisfies itself based on the sent machine certificate that the media system may be trusted constructs the initialization RM license step and sends the initialization license to the media system step . Significantly the initialization license includes an initial content key CK as decided upon by the receiver where such initial content key CK is encrypted according to the public key PU MS from the machine certificate to result in PU MS CK . Thus the media system upon receiving the initialization license and storing same in a license store retrieves such PU MS CK therefrom and applies PR MS thereto to result in CK step and then stores such CK in an appropriate secure location along with a count which here would be set to zero step . As may be appreciated the receiver also stores such CK in an appropriate secure location along with the same zero count.

Note that the initialization license may be signed by the receiver in which case the receiver may employ a symmetric integrity key IK to in effect sign such initialization license based on a symmetric signing protocol such as a MAC. If so and in one embodiment of the invention the initial content key CK and the integrity key IK as an initial integrity key IK are both encrypted according to the public key PU MS from the machine certificate to result in PU MS CK IK . Here then the media system upon receiving the initialization license retrieves such PU MS CK IK therefrom and applies PR MS thereto to result in CK and IK as at step and then stores such CK and IK and zero count in an appropriate secure location as at step . In addition the media system employs such initial integrity key IK to verify the signature of such initialization license .

To summarize thus far then both the receiver and the media system have stored in a secure location an initial content key CK an initial integrity key IK and a count set to zero. However the receiver has not yet begun to send the stream to the media system encrypted according to any content key CK or any corresponding requirements . Presumably though the media system at some point does command a first instance of such a situation as at step of . Accordingly the receiver proceeds with the steps of such to the point where such receiver requires a first new symmetric content key CKx which would be CK to encrypt a first stream as at step .

Here and in one embodiment of the present invention the receiver generates such content key CKx CK by incrementing the count step and deriving CKx CK from the initial content key CK step . Moreover when deriving such a content key CKx from such initial content key CK the receiver also derives a corresponding integrity key IKx IK from the initial integrity key IK step .

In one embodiment of the present invention both the content key CKx and the integrity key IKx are derived from CK and IK respectively by applying the initial value CK or IK a function along with the new count value value function value 0 count For example such function may a one way hash function such as a SHA function perhaps with appropriate truncation or lengthening as need be. Thus with such content key CKx the receiver may encrypt the stream as at step .

In one embodiment of the present invention the receiver communicates the derivation or rotation of such keys CKx IKx and the new count to the media system when the receiver constructs the set of requirements corresponding to the stream and sends such requirements. to the media system as at steps and of . In particular and in one embodiment of the present invention the receiver when performing such steps and in fact constructs a derived message with values therein that are based on the values in the initialization license sent as at step .

In particular for any particular stream corresponding to a particular count x such as for example the first stream corresponding to count 1 the receiver constructs a derived message including the requirements for such stream the count x and a signature based on the integrity key IKx step and sends the constructed derived message to the media system step . Note that inasmuch as the signature is based on a symmetric key constructing such a derived message is not nearly as burdensome to the receiver as compared with a signature based on an asymmetric key.

At any rate upon receiving the stream and the derived message corresponding thereto the media system can itself derive the corresponding content key CKx and integrity key IKx based on knowledge of the count from such received derived message CK IK and the function used at step . In particular and as with the receiver the media system locates each of CK and IK O step derives CKx and IKx by employing the same function as the receiver and the current count x step and stores such derived CKx and IKx along with the corresponding count as may be appropriate step . In addition the media system employs such integrity key IKx to verify the signature of the corresponding derived message step . Most significantly with the content key CKx corresponding to the stream and presuming the corresponding derived message verifies and allows the media system can decrypt the stream for rendering and or further processing step .

It should be noted that the derived message as received from the receiver by the media system is not the license constructed and stored by the media system in a license store as at steps and of . Instead and as should be appreciated the derived message contains the requirements that are employed to construct the license of such steps and .

With the present invention as set forth herein the receiver need not explicitly communicate a content key CKx or integrity key IKx to the media system for every newly tuned stream . Instead the receiver need only establish initial values of such keys CK IK with the media system and then each of the receiver and the media system can independently derive new values CKx IKx for each new stream based on prior knowledge of CK IK and the deriving function. Thus the receiver need not go to the considerable burden of constructing a typical RM license for each new stream with CKx asymmetrically encrypted therein and such RM license being asymmetrically signed. Instead the receiver need only construct such a typical RM license when initializing with the media system and thereafter can construct a less burdensome derived message for each new stream without CKx encrypted therein and being symmetrically signed.

Note that in an alternate embodiment of the present invention rather than deriving CKx and IKx from CK and IK respectively such CKx and IKx may be derived from CK x 1 and IK x 1 respectively. As should be appreciated doing so is similar to deriving CKx and IKx from CK and IK in most respects except that CK x and IK x need to be stored and retrieved for deriving CK x 1 and IK x 1 as may be appreciated.

Note too that in sharing the content keys between the receiver and the media system such elements may communicate with each other using secure methods such as for example authentication and the like. Alternatively if circumstances warrant un secure methods may also be employed.

As was set forth and or alluded to above in constructing a derived message corresponding to a particular newly tuned stream the receiver locates the information relating to the requirements for the derived message from the stream as at step where such information with such requirements may be periodically supplied within the stream at a known interval and location. Such known interval may be on the order of once every 20 seconds or longer and accordingly it is likely very often the case that the receiver will not encounter such information in the stream without having to wait a considerable length of time. However such a wait is not feasible especially if the receiver is expected to send such a derived message with requirements based on such information within the time frame of a second or so after being commanded to tune the stream .

Accordingly in one embodiment of the present invention if the receiver is not in possession of the information from the newly tuned stream in time to construct requirements based thereon place same in a corresponding derived message and send the derived message in a timely manner as at steps and of the receiver instead constructs and sends a default derived message . As may be appreciated such default derived message includes requirements that are most restrictive in nature such as for example copy never CN . Thereafter when the receiver is in fact in possession of the information from the newly tuned stream the receiver then constructs and sends an actual derived message . As may be appreciated here such actual derived message includes requirements that are in fact based on such possessed information and that are meant to replace the requirements from the corresponding default derived message .

In particular and turning now to upon tuning a newly commanded stream step the receiver increments the count and derives a CKx and IKx for the stream as at steps step . However presuming that the aforementioned information pertaining to the requirements has not as yet been encountered in the newly tuned stream in a timely manner the receiver constructs and sends a default derived message that includes default requirements that are most restrictive in nature such as for example copy never CN step . Thereafter the receiver waits until the information from the newly tuned stream is in fact encountered step where such waiting can last as long as 20 seconds or even a manner of minutes in certain circumstances.

Upon in fact encountering the information in the stream the receiver then constructs and sends an actual derived message that includes actual requirements that are in fact based on such encountered information step such actual requirements in the actual derived message are meant to replace the default requirements from the corresponding default derived message . Significantly and in one embodiment of the present invention the receiver in constructing and sending the actual derived message as at step does not increment the count step and thus the default derived message and the corresponding actual derived message have the same count noted therein.

As may now be appreciated upon receiving the default derived message and as before the media system derives the corresponding content key CKx and integrity key IKx as at steps and of employs such integrity key IKx to verify the signature of such default derived message as at step and with the content key CKx the media system can decrypt the stream as at step step . Significantly inasmuch as such default derived message has the default requirements that are most restrictive in nature the media system also constructs and stores a default version license in a license store as at steps and of that is based on such default requirements and that as a result is highly restrictive in a significant respect step .

However upon later receiving the actual derived message and in particular upon noting that the count value in such actual derived message has not changed from the count value of the default derived message the media system in one embodiment of the present invention understands the unchanged count value to mean that the actual derived message includes actual requirements that are to replace the default requirements from the default derived message step . Alternatively the media system may note from copy default field in the requirements in the default derived message that such message is in fact default in nature and then await the corresponding actual derived message .

Accordingly the media system need not derive the corresponding content key CKx and integrity key IKx as at steps and of although such media system does employ the integrity key IKx as derived in connection with the default derived message to verify the signature of the actual derived message as at step and employs the content key CKx as derived in connection with the default derived message to continue to decrypt the stream as at step step . Significantly inasmuch as the actual derived message has the actual requirements that could be less restrictive in nature the media system also constructs and stores an actual version license in a license store as at steps and of that is based on such actual requirements and that is to replace the corresponding default version license based on the default requirements step .

Note that for the amount of time that the stream can be rendered according to the default version license based on the default requirements a user likely cannot do anything with such stream in the nature of copying and the like. However inasmuch as the corresponding actual derived message should be received by the media system at most about 20 seconds to a few minutes after the default derived message and at such time the actual version license based on the actual requirements would replace the default version license based on the default requirements the time frame where such stream is so restrictively controlled is relatively small to the point of being insignificant.

At any rate by providing the default derived message to the media system prior to locating actual requirements from which an actual derived message may be provided the receiver at least allows the media system to render the corresponding stream in an expeditious manner so that the user of such media system can experience the rendered stream promptly and without an undesirable amount of delay. When the actual derived message is eventually provided to the media system such media system can then construct the corresponding actual version license based on the actual requirements and can replace the default version license based on the default requirements without any real loss.

In a typical RM architecture a license created for and corresponding to a piece of content should be available for as long as the content is available. Thus if the content is for example a document that is expected to be present for ten years then the corresponding license should also be present in a license store for the same ten years. Correspondingly if the content is for example an ephemeral signal such as a stream that is expected to be present for a very short period of time then the corresponding license should also be present in a license store for the same very short period of time ideally.

Thus in the scenario of where a receiver can be expected to tune many streams perhaps as fast as once every second or so it is to be appreciated that the corresponding licenses as stored by the media system in a license store are for the most part barely used and once used are never to be used again. Moreover the shear volume of such licenses as stored by the media system in a license store can quickly approach huge quantities. Further by storing so many licenses in such a license store searching for and finding those few licenses that are indeed needed for a relatively long period of time can be cumbersome and slow.

Thus in one embodiment of the present invention licenses as stored by the media system are segregated according to relatively short lived licenses and relatively long lived licenses . Moreover in such embodiment relatively short lived licenses are stored in a more temporary and volatile license store of the media system and relatively long lived licenses are stored in a more permanent and non volatile license store of the media system . For example the temporary license store may be located in RAM memory of the media system while the permanent license store may be located in a fixed drive memory of the media system although other types of such memory may be employed without departing from the spirit and scope of the present invention.

In one embodiment of the present invention the media system places licenses in the permanent license store that correspond to long lived streams that a user or the like has directed to be saved to the storage device for later playback or copying to another media system or the like. Thus all other licenses which presumably would be for short lived more ephemeral streams would be placed by the media system into the temporary license store . As may be appreciated when the permanent license store is non volatile the licenses therein are not deleted whenever the media system is turned off or reset and accordingly can be employed to render the corresponding long lived streams on an indefinite basis. Note though that licenses can and should be deleted from the permanent license store when no longer needed.

When the temporary license store is volatile however the licenses therein are deleted whenever the media system is turned off or reset. However such a deletion is by implication and it is to be appreciated that a more explicit method of deletion is also necessary in the event that the media system runs for a relatively long period of time during which such temporary license store can become filled and or clogged.

Thus in one embodiment of the present invention the media system explicitly commands a deletion of a license in the temporary license store at certain times when such media system deems that such license is no longer needed. Such certain times may be any appropriate times without departing from the spirit and scope of the present invention. For example it may be the case that the media system commands deleting a license when the corresponding stream is no longer tuned by the receiver such as for example when the receiver is commanded by the media system to tune another stream .

However it is to be appreciated that in fact deleting such a license so quickly may be premature. For example it may be that information in such to be deleted license is still needed or that the stream corresponding thereto may be re tuned in a short period of time. Likewise it may be the case that although one process of the media system no longer requires a license and has commanded a deletion of such license another process may still require same.

Accordingly in one embodiment of the present invention and turning now to any process of the media system that wishes to delete a license from the temporary license store does so not by in fact deleting same but instead by marking such license with an appropriate mark such as a flag or the like step . As may be appreciated such flag may be represented by a bit reserved in the license for such use and appropriately set may be a similar bit in a reference table maintained by the temporary license store or the like. Thus as marked such license is not immediately deleted and can be employed by any other process of the media system requiring same.

At a later time after the license has in fact been marked for deletion then and presumably well after any other process of the media system could require use of such marked license the media system in fact deletes such marked license by way of actuating a housekeeping process or the like step . In particular and as may be appreciated such a housekeeping process of the media system would be periodically actuated thereby to examine each license in the temporary license store step determine if the license is in fact marked for deletion step and if so in fact delete such marked license from the temporary license store step .

With the present invention then licenses that are not needed for a relatively long period of time are segregated from other licenses by being stored in a temporary license store that is volatile in nature. Moreover to prevent the temporary license store from becoming congested with too many such licenses such licenses are marked for deletion when no longer needed and a housekeeping process periodically in fact deletes such marked licenses from the temporary license store .

The programming necessary to effectuate the processes performed in connection with the present invention is relatively straight forward and should be apparent to the relevant programming public. Accordingly such programming is not attached hereto. Any particular programming then may be employed to effectuate the present invention without departing from the spirit and scope thereof.

In the present invention a system and method are provided for the receiver to create a shortened version of requirements that are to be employed to construct a license such that the receiver need not go to the burden of in fact completely creating such new license every time such receiver newly tunes a stream . The shortened version of such requirements can be quickly created and sent to the media system each time the receiver newly tunes a stream even if the user is commanding a change on the order of once every second or so. Additionally the shortened version of such requirements is concise and yet describes all license requirements for the tuned stream in a minimal amount of space. The format of such requirements can be employed in connection with streams as provided to the media system from sources other than the receiver .

Also in the present invention a system and method are provided for sharing each new content key CK between the receiver and the media system without the need for creating an actual license with each such content key CK therein. The receiver and media system exchange an initial content key CK and then rotate content keys CKx based on the initial content key CK in a coordinated fashion.

Moreover in the present invention a system and method are provided for the receiver to send a default set of requirements on a preliminary basis and then an actual set of requirements when actually located. Such default requirements are employed by the media system until the actual requirements are sent and the media system can distinguish between such default requirements and such corresponding actual requirements and can replace the default requirements with the corresponding actual requirements upon receipt thereof.

Finally in the present invention a system and method are provided for the media system to store at least some licenses corresponding to tuned streams only on a temporary basis. The media system can recognize which licenses need only be stored on a temporary basis and the media system deletes such temporarily stored licenses when no longer needed.

It should be appreciated that changes could be made to the embodiments described above without departing from the inventive concepts thereof. It should be understood therefore that this invention is not limited to the particular embodiments disclosed but it is intended to cover modifications within the spirit and scope of the present invention as defined by the appended claims.

