---

title: Training wideband acoustic models in the cepstral domain using mixed-bandwidth training data for speech recognition
abstract: A method and apparatus are provided that use narrowband data and wideband data to train a wideband acoustic model.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07707029&OS=07707029&RS=07707029
owner: Microsoft Corporation
number: 07707029
owner_city: Redmond
owner_country: US
publication_date: 20051123
---
The present application is a Continuation In Part of U.S. patent application Ser. No. 11 053 151 filed on Feb. 8 2005 now U.S. Pat. No. 7 454 338 and claims 1 14 and 19 20 of the present application are supported by U.S. patent application Ser. No. 11 053 151.

The present invention relates to speech recognition. In particular the present invention relates to training acoustic models for speech recognition.

In speech recognition speech signals are compared to acoustic models to identify a sequence of phonemes that is represented by the speech signal. In most such systems the comparison between the speech signal and the models is performed in what is known as the cepstral domain. To place a speech signal in the cepstral domain the speech signal is sampled by an analog to digital converter to form frames of digital values. A Discrete Fourier Transform is applied to the frames of digital values to place them in the frequency domain. The power spectrum is computed from the frequency domain values by taking the magnitude squared of the spectrum. Mel weighting is applied to the power spectrum and the logarithm of each of the weighted frequency components is determined. A truncated discrete cosine transform is then applied to form a cepstral vector for each frame. The truncated discrete cosine transform typically converts a forty dimension vector that is present after the log function into a thirteen dimension cepstral vector.

In order for speech decoding to be performed in the cepstral domain the models must be trained on cepstral vectors. One way to obtain such training data is to convert speech signals into cepstral vectors using a high sampling rate such as sixteen kilohertz. When speech is sampled at this high sampling rate it is considered wideband data. This wideband data is desirable because it includes information for a large number of frequency components thereby providing more information for forming models that can discriminate between different phonetic sounds.

Although such wideband speech data is desirable it is expensive to obtain. In particular it requires that a speaker be in the same room as the microphone used to collect the speech data. In other words the speech cannot pass through a narrowband filter before reaching the microphone. This requirement forces either the speaker or the designer of the speech recognition system to travel in order to collect training speech.

A second technique for collecting training speech is to collect the speech through a telephone network. In such systems people are invited to call into a telephone number and provide examples of speech.

In order to limit the amount of data passed through the telephone network it is common for telephone network providers to sample the speech signal at a low sampling rate. As a result the speech received for training is narrowband speech that is missing some of the frequency components that are present in wideband training speech. Because such speech includes less information than wideband speech the models trained from such narrowband telephone speech do not perform as well as models trained from wideband speech.

Although systems have been developed that attempt to decode speech from less than perfect data such systems have operated in the spectral domain and have not provided a way to train models from less than perfect data. Because the Discrete Cosine Transform that places vectors in the cepstral domain mixes frequency components and often involves a truncation of features such systems cannot be applied directly to training cepstral domain acoustic models.

The discussion above is merely provided for general background information and is not intended to be used as an aid in determining the scope of the claimed subject matter.

A method and apparatus are provided that use narrowband data and wideband data to train a wideband acoustic model

This Summary is provided to introduce a selection of concepts in a simplified form that are further described below in the Detailed Description. This Summary is not intended to identify key features or essential features of the claimed subject matter nor is it intended to be used as an aid in determining the scope of the claimed subject matter. The claimed subject matter is not limited to implementations that solve any or all disadvantages noted in the background.

Embodiments are operational with numerous other general purpose or special purpose computing system environments or configurations. Examples of well known computing systems environments and or configurations that may be suitable for use with various embodiments include but are not limited to personal computers server computers hand held or laptop devices multiprocessor systems microprocessor based systems set top boxes programmable consumer electronics network PCs minicomputers mainframe computers telephony systems distributed computing environments that include any of the above systems or devices and the like.

Embodiments may be described in the general context of computer executable instructions such as program modules being executed by a computer. Generally program modules include routines programs objects components data structures etc. that perform particular tasks or implement particular abstract data types. Some embodiments are designed to be practiced in distributed computing environments where tasks are performed by remote processing devices that are linked through a communications network. In a distributed computing environment program modules are located in both local and remote computer storage media including memory storage devices.

With reference to an exemplary system for implementing some embodiments includes a general purpose computing device in the form of a computer . Components of computer may include but are not limited to a processing unit a system memory and a system bus that couples various system components including the system memory to the processing unit . The system bus may be any of several types of bus structures including a memory bus or memory controller a peripheral bus and a local bus using any of a variety of bus architectures. By way of example and not limitation such architectures include Industry Standard Architecture ISA bus Micro Channel Architecture MCA bus Enhanced ISA EISA bus Video Electronics Standards Association VESA local bus and Peripheral Component Interconnect PCI bus also known as Mezzanine bus.

Computer typically includes a variety of computer readable media. Computer readable media can be any available media that can be accessed by computer and includes both volatile and nonvolatile media removable and non removable media. By way of example and not limitation computer readable media may comprise computer storage media and communication media. Computer storage media includes both volatile and nonvolatile removable and non removable media implemented in any method or technology for storage of information such as computer readable instructions data structures program modules or other data. Computer storage media includes but is not limited to RAM ROM EEPROM flash memory or other memory technology CD ROM digital versatile disks DVD or other optical disk storage magnetic cassettes magnetic tape magnetic disk storage or other magnetic storage devices or any other medium which can be used to store the desired information and which can be accessed by computer . Communication media typically embodies computer readable instructions data structures program modules or other data in a modulated data signal such as a carrier wave or other transport mechanism and includes any information delivery media. The term modulated data signal means a signal that has one or more of its characteristics set or changed in such a manner as to encode information in the signal. By way of example and not limitation communication media includes wired media such as a wired network or direct wired connection and wireless media such as acoustic RF infrared and other wireless media. Combinations of any of the above should also be included within the scope of computer readable media.

The system memory includes computer storage media in the form of volatile and or nonvolatile memory such as read only memory ROM and random access memory RAM . A basic input output system BIOS containing the basic routines that help to transfer information between elements within computer such as during start up is typically stored in ROM . RAM typically contains data and or program modules that are immediately accessible to and or presently being operated on by processing unit . By way of example and not limitation illustrates operating system application programs other program modules and program data .

The computer may also include other removable non removable volatile nonvolatile computer storage media. By way of example only illustrates a hard disk drive that reads from or writes to non removable nonvolatile magnetic media a magnetic disk drive that reads from or writes to a removable nonvolatile magnetic disk and an optical disk drive that reads from or writes to a removable nonvolatile optical disk such as a CD ROM or other optical media. Other removable non removable volatile nonvolatile computer storage media that can be used in the exemplary operating environment include but are not limited to magnetic tape cassettes flash memory cards digital versatile disks digital video tape solid state RAM solid state ROM and the like. The hard disk drive is typically connected to the system bus through a non removable memory interface such as interface and magnetic disk drive and optical disk drive are typically connected to the system bus by a removable memory interface such as interface .

The drives and their associated computer storage media discussed above and illustrated in provide storage of computer readable instructions data structures program modules and other data for the computer . In for example hard disk drive is illustrated as storing operating system application programs other program modules and program data . Note that these components can either be the same as or different from operating system application programs other program modules and program data . Operating system application programs other program modules and program data are given different numbers here to illustrate that at a minimum they are different copies.

A user may enter commands and information into the computer through input devices such as a keyboard a microphone and a pointing device such as a mouse trackball or touch pad. Other input devices not shown may include a joystick game pad satellite dish scanner or the like. These and other input devices are often connected to the processing unit through a user input interface that is coupled to the system bus but may be connected by other interface and bus structures such as a parallel port game port or a universal serial bus USB . A monitor or other type of display device is also connected to the system bus via an interface such as a video interface . In addition to the monitor computers may also include other peripheral output devices such as speakers and printer which may be connected through an output peripheral interface .

The computer is operated in a networked environment using logical connections to one or more remote computers such as a remote computer . The remote computer may be a personal computer a hand held device a server a router a network PC a peer device or other common network node and typically includes many or all of the elements described above relative to the computer . The logical connections depicted in include a local area network LAN and a wide area network WAN but may also include other networks. Such networking environments are commonplace in offices enterprise wide computer networks intranets and the Internet.

When used in a LAN networking environment the computer is connected to the LAN through a network interface or adapter . When used in a WAN networking environment the computer typically includes a modem or other means for establishing communications over the WAN such as the Internet. The modem which may be internal or external may be connected to the system bus via the user input interface or other appropriate mechanism. In a networked environment program modules depicted relative to the computer or portions thereof may be stored in the remote memory storage device. By way of example and not limitation illustrates remote application programs as residing on remote computer . It will be appreciated that the network connections shown are exemplary and other means of establishing a communications link between the computers may be used.

Memory is implemented as non volatile electronic memory such as random access memory RAM with a battery back up module not shown such that information stored in memory is not lost when the general power to mobile device is shut down. A portion of memory is preferably allocated as addressable memory for program execution while another portion of memory is preferably used for storage such as to simulate storage on a disk drive.

Memory includes an operating system application programs as well as an object store . During operation operating system is preferably executed by processor from memory . Operating system in one preferred embodiment is a WINDOWS CE brand operating system commercially available from Microsoft Corporation. Operating system is preferably designed for mobile devices and implements database features that can be utilized by applications through a set of exposed application programming interfaces and methods. The objects in object store are maintained by applications and operating system at least partially in response to calls to the exposed application programming interfaces and methods.

Communication interface represents numerous devices and technologies that allow mobile device to send and receive information. The devices include wired and wireless modems satellite receivers and broadcast tuners to name a few. Mobile device can also be directly connected to a computer to exchange data therewith. In such cases communication interface can be an infrared transceiver or a serial or parallel communication connection all of which are capable of transmitting streaming information.

Input output components include a variety of input devices such as a touch sensitive screen buttons rollers and a microphone as well as a variety of output devices including an audio generator a vibrating device and a display. The devices listed above are by way of example and need not all be present on mobile device . In addition other input output devices may be attached to or found with mobile device .

The present invention provides a technique for training wideband acoustic models in the cepstral domain using a mixture of wideband speech data and narrowband speech data. Under one embodiment an iterative algorithm is used in which all of the model parameters in the cepstral domain are converted into the spectral domain during each iteration. In the spectral domain estimates of components missing from the narrowband data are used to update the spectral domain model parameters. The spectral domain model parameters are then converted back into the cepstral domain. In other embodiments the narrowband data is extended by estimating values for missing components in the narrowband data from models generated from wideband data. After the narrowband feature vectors have been extended they are used to train the acoustic model in the cepstral domain.

The present invention provides a technique for training wideband acoustic models in the cepstral domain using a mixture of wideband speech data and narrowband speech data. Under one embodiment an iterative algorithm is used in which all of the model parameters in the cepstral domain are converted into the spectral domain during each iteration. In the spectral domain estimates of components missing from the narrowband data are used to update the spectral domain model parameters. The spectral domain model parameters are then converted back into the cepstral domain. In other embodiments the narrowband data is extended by estimating values for missing components in the narrowband data from models generated from wideband data. After the narrowband feature vectors have been extended they are used to train the acoustic model in the cepstral domain.

The analog signal provided by microphone or telephone network is sampled by analog to digital converter which in one embodiment samples at 16 kilohertz. If the telephone network provides digital samples the signal from the telephone network is not applied to analog to digital converter . Instead the digital signal is up sampled to provide samples at the same rate as those provided by analog to digital converter .

The digital samples are provided to a frame construction unit which groups the digital samples into frames. Typically the frame is windowed by multiplying the frame s samples by a windowing function. Typically a Hamming window is used. The frames of digital samples are provided to a Discrete Fourier Transform DFT which transforms the frames of time domain samples into frames of frequency domain samples.

The magnitudes of the frequency domain values from DFT are squared by a power calculation to form a power spectrum which is weighted by mel scale weighting . The logarithm of each weighted component is then computed by logarithm . The output of log is a set of narrowband log spectral vectors formed from the narrowband speech data and a set of wideband log spectral vectors formed from wideband speech data with one vector per frame.

The wideband spectral vectors and the narrowband spectral vectors are converted into wideband cepstral vectors and narrowband cepstral vectors respectively by a Discrete Cosine Transform . Discrete Cosine Transform is a truncated transform in which the dimensionality of each cepstral vector is less than the dimensionality of the spectral vector applied to the transform.

As noted in the background narrowband speech data is missing certain frequency components because telephone network samples the speech data at a low sampling rate and attenuates the low frequencies those less than Hz. These missing components are readily identifiable in the spectral domain since the narrowband spectral vectors will have rather small values for certain frequency components for which the wideband speech data has significant values. Under the present invention these missing components are treated as missing variables and are estimated through an Expectation Maximization algorithm. This estimation is performed in the spectral domain because in the cepstral domain the observed components of the frequency spectrum and the missing components of the frequency spectrum are combined together and cannot be separated in order to form an estimate of the missing components.

Although the estimates of the missing components are formed in the spectral domain the models that are trained must be trained in the cepstral domain in order to make them useful for speech recognition. Under one embodiment the models comprise a mixture of Gaussians with mean and covariance parameters vand respectively and prior probability p k where k is the index of the mixture component. Thus the probability of a cepstral vector z given a mixture component k is defined as EQ. 1 where in the right hand side of the equation the cepstral vector z has been replaced by Cx which represents the log spectral vector x applied to discrete cosine transform matrix C.

In order to iteratively train the model parameters for the cepstral domain while estimating the missing components from the narrowband data in the spectral domain the cepstral domain model parameters must be converted to log mel spectra model parameters during each iteration of training. If the cepstral vectors have the same dimensionality as the log spectral vectors and thus the discrete cosine transform matrix is a square matrix the conversion between the cepstral model parameters and the log mel spectral model parameters can be performed trivially via an inverse discrete cosine transform. However because most speech recognition systems perform dimensionality reduction when converting from log mel spectral to cepstral the discrete cosine transform matrix is not square. As a result the log mel spectral covariance matrices obtain from cepstral covariance matrices via an inverse discrete cosine transform are rank deficient. Specifically if the discrete cosine transform matrix is M L with M

One possible solution is to simply train an L dimensional cepstral model using a square cosine transform and then truncate the model parameters to M dimensions after training is complete. However this is sub optimal as the best way to maximize the overall likelihood may be optimize the higher dimensions of the model which will be discarded at the expense of the lower dimensions which are the ones of interest.

The present invention provides a solution that ensures that the log mel spectral covariance matrix is full rank but also ensures that the higher dimensions in the cepstral domain do not bias the posterior probability calculations in the iterative algorithm used to train the model. Specifically to avoid biasing the posterior probability calculations the present invention sets the model parameters for the cepstral dimensions that will not form part of the final model to be equal for all of the mixture components. By doing this each of these dimensions will contribute equally to the likelihood of each mixture component and thus not alter the posterior probabilities.

To achieve this the present invention uses a square discrete cosine transform matrix. This results in an inverse discrete cosine transform matrix that can be divided into a set of M columns and a set of R columns. Thus for an inverse discrete cosine transform matrix Cthe following is defined 

Equations 4 and 7 show that the log mel spectral mean vector and covariance matrix can be decomposed into the sum of two terms the first reflecting the contribution of the first M dimensions of the cepstral vector and the second reflecting the contribution of the last R dimensions of the cepstral vector. In order to ensure that any differences in the posterior probabilities of the various mixture components are due only to the first M cepstral coefficients and yet ensure that is full rank the second additive term is set to be identical for all mixture components. Thus equations 4 and 7 become EQ. 8 EQ. 9 where band Aare the same for each mixture component.

At step initial values for the cepstral model parameters for each mixture component are determined. Specifically the cepstral mean vector and cepstral covariance matrix is determined for each mixture component from the wideband cepstral data alone using an EM algorithm. During the EM algorithm the prior probability mean and covariance are updated during each iteration as 

After the cepstral model parameters have been initialized at step they are converted into spectral domain model parameters using equations 8 and 9 above at step . This creates log mel spectral mean and covariance matrix .

Under the present invention the model parameters are updated in the spectral domain using a combination of wideband spectral data and narrowband spectral data . The wideband spectral data contains all of the frequency components found in the mean and covariance matrix . However the narrowband spectral data does not include values for certain frequency components that are present in the wideband spectral data . The components that the narrowband spectral data does possess are referred to as observed components and the frequency components that the narrowband spectral data does not possess are referred to as missing components. Typically the narrowband spectral data is missing certain frequency components because the speech signal has passed through some type of filter or has been sampled at a low sampling rate. The filtering can be performed to reduce the bandwidth of data passed through a channel or to remove frequency components that are likely to be corrupted by noise.

The observed and missing frequency components can be used to divide the spectral mean vector and the covariance matrix into partitions such that 

Using these partitions the following values can be determined at step during the E step of an EM algorithm 

Note that in the computation of p k x of equation 19 more dimensions will be used for the wideband spectral data than for the narrowband spectral data since the wideband spectral data includes more observed components.

In equation 17 only those components that are found in both the wideband spectral data and the narrowband spectral data are used in the difference calculation.

Once these values have been calculated at step they are used in an M step of the EM algorithm shown as step in to compute updated values for and p k . Specifically the update equation for is 

In equation 22 the state dependent conditional covariance is only added to the covariance assigned to the partition of and reflects the uncertainty associated with the absence of the missing components in the narrowband training vectors.

An intuition for update equations 20 24 is that for wideband data the mean will be updated based on the entire wideband feature vector. However for narrowband data only some of the dimensions of the mean are updated from the observed dimensions in the narrowband feature vector. For those dimensions that are not present in the narrowband feature vector an approximation to those missing feature components is used to derive the update for the mean. This approximation is derived in equation 17 by adjusting the mean for the missing components from the previous iteration based on the difference between the observed component and the mean for the observed component as well as the covariance between the missing components and the observed components.

After the mean and covariance have been updated in the spectral domain they are converted to the cepstral domain at step . This is done by applying the mean and covariance to a truncated discrete cosine transform as EQ. 25 C C EQ. 26

This produces a new cepstral mean vector and cepstral covariance for each mixture component k and is stored in cepstral models .

After the mean and covariance for each mixture component has been converted to the cepstral domain the method of determines if the model parameters have converged at step . If the model parameters have not converged the process returns to step and converts the current cepstral model parameters to the spectral domain using equations 8 and 9 above. Steps and are then repeated using the new spectral model parameters.

When the cepstral model parameters converge at step the process ends at step . The cepstral model parameters may then be used by decoding unit to decode input cepstral vectors.

The process of training the cepstral model parameters shown in allows parameters to be trained based on a combination of wideband data and narrowband data. As a result the invention can be practiced with a small amount of wideband data and a large amount of inexpensive narrowband data. This reduces the cost of training speech recognition models in the cepstral domain. In addition the technique for allowing an inversion of the cepstral model parameters to the spectral domain as found above allows the model parameters to be updated in the spectral domain where the observed components and the missing components from the narrowband data can be separated from each other. Such separation of the missing and observed frequency components would not be possible in the cepstral domain.

The invention has been described above with reference to a Gaussian mixture model. This Gaussian mixture model could be extended to a Hidden Markov Model with K states each state having a mixture of Q Gaussians associated with it. During HMM decoding a sequence of HMM states is identified from an observation sequence X x. . . x . shows a graph of HMM states over time with HMM states shown on vertical axis and time shown on horizontal axis . At any state and time the probability of a mixture component in that state is based on the probability of entering that state at that time from all possible state sequences that precede that state the probability of leaving that state at that time through all possible state sequences after that state and the probability of that mixture component in that state given the observed feature vector. For example in the probability of a mixture component of state is based on all of the possible state sequences that enter state at time shown as lines connecting states from time point to state all of the possible state sequences that extend from state shown as lines connecting state to states at time point and the probability of the mixture component given the observed feature vector. In terms of an equation the posterior probability of the qth Gaussian in HMM state k for frame i given an observation sequence of feature vectors is defined as 

where k and q are used to index the model parameters with k representing the HMM state and q representing the mixture component of the state.

The Hidden Markov Model training described above is computationally expensive since it requires an update of the estimate of the missing components for each state at each frame of the input. Under a separate embodiment a wideband cepstral vector zis inferred given an observed narrowband log mel spectral vector x. This inferred wideband cepstral vector is then combined with measured wideband cepstral data to train acoustic models in the cepstral domain. Under one embodiment the inference is performed using a minimum mean squared error estimate MMSE of a wideband cepstral vector z which can be expressed as EQ. 31 where E . represents the expectation operator Crepresents the elements of the discrete cosine transform matrix C that are applied to the frequency components observed in the narrowband data Crepresents the portions of the discrete cosine transform that are applied to the frequency components that are missing in the narrowband data but that are present in the wideband data xrepresents the missing frequency components in the narrowband data and xrepresents the observed frequency components in the narrowband feature vector.

The expected value of the missing frequency components given the observed frequency components E x x can be determined from Gaussian mixture model parameters as 

Equation 35 describes the inference for a Gaussian Mixture Model. For a Hidden Markov Model the summation is performed across all mixture components and all states. Thus Equation 35 becomes 

In step the cepstral domain model parameters are converted to the spectral domain using equations 8 11 described above. Using the model parameters in the spectral domain the posterior probability and the conditional mean vector are determined for each Gaussian. For a Gaussian mixture model this involves computing p k x and using equations 19 and 17 described above. For a Hidden Markov Model this involves computing p k q x and using equations 19 and 17 above and indexing the Gaussian models by their state k and mixture component q. In equations 19 the probability of a mixture component p k or p q k for an HMM can be determined during the training of the cepstral domain model parameters. Using the values of the posterior probability and the conditional mean the vector extensions for the narrowband vector can be determined and the wideband data vector can be inferred using Equation 35 or Equation 36 at step .

After all of the narrowband data has been extended to form extended narrowband vectors the extended narrowband vectors are combined with the wideband data vectors to train the acoustic models in the spectral domain at step .

Under one embodiment the extended narrowband vectors are not as trusted as the wideband vectors since the extended narrowband vectors have their missing components estimated. To reflect this mistrust a weighting factor can be assigned to the posterior probability of each frame of bandwidth extended speech when the Gaussian parameter updates are computed during the EM training of the models in the cepstral domain. Thus for an HMM model the prior model the mean and the variance are updated as 

The value of may be set by using a development set of data and testing different values of to see which value gives the best acoustic models as tested against the development set. Under many embodiments the present inventors have found that a value of at 0.2 performs well.

In a further embodiment the uncertainty about the extended narrowband vectors is captured by calculating a global cepstral posterior distribution for each narrowband vector p z x N z circumflex over z as EQ. 42 EQ. 43 where circumflex over z is the mean of the cepstral posterior distribution is the covariance of the cepstral posterior distribution which in one embodiment is assumed to be diagonal E . represents the expectation operator Crepresents the elements of the discrete cosine transform matrix C that are applied to the frequency components observed in the narrowband data Crepresents the portions of the discrete cosine transform that are applied to the frequency components that are missing in the narrowband data but that are present in the wideband data Cis the transpose of C xrepresents the missing frequency components in the narrowband data xis the transpose of x and xrepresents the observed frequency components in the narrowband feature vector.

The expected value of the missing frequency components given the observed frequency components E xx x and the expected value of the square of the missing frequency components given the observed frequency components E xx x can be determined from Gaussian mixture model parameters as 

Comparing equations 42 and 43 to equation 31 above it can be seen that the posterior distribution embodiment described by equations 42 and 43 is similar to the narrowband vector extension embodiment of equation 31 in that the extended narrowband vector formed in equation 31 is simply the mean of the cepstral posterior distribution.

In step of wideband cepstral data and narrowband spectral and cepstral data are obtained from speech signals. The narrowband cepstral data is formed from the narrowband spectral data.

At step a wideband Hidden Markov Model HMM is trained in the cepstral domain by an initial HMM trainer using only wideband data . In some embodiments the initial wideband HMM is a small model such as a monophone model with a single Gaussian per state. Such training involves an EM algorithm in which state posterior probability statistics are collected during the E step and model parameters for each Gaussian in each state are updated during the M step.

In step wideband data is used by a Gaussian Mixture Model trainer to train a wideband Gaussian mixture model GMM . Such training is described above with reference to equations 13 and 14 in which an EM algorithm is used to train a mean and a covariance for each mixture component as well as a prior probability for each mixture component.

At step wideband GMM and narrowband spectral data are used by a cepstral posterior trainer to train cepstral posterior models for each narrowband feature vector. Step involves converting the cepstral wideband GMM model parameters into the spectral domain using equations 8 and 9 above. The spectral domain model parameters are then used to determine and p k x using equations 17 19 above and the spectral version of narrowband data . These values are then used in equations 44 and 45 above to determine E x x and E xx x which are then applied to equations 42 and 43 to determine the global cepstral posterior parameters circumflex over z and for each narrowband spectral feature vector i of narrowband data .

At step wideband Hidden Markov Model is used to form narrowband Hidden Markov Model through a transform . In one particular embodiment narrowband HMM parameters are formed from wideband HMM parameters by converting wideband HMM parameters to the spectral domain where the observed components of the parameters can be selected using a filter P. The selected components are then converted back to the cepstral domain. In terms of equations EQ. 46 EQ. 47 EQ. 48 where P is an L L matrix where Lis the number of observed components D is a M LDCT matrix p k q is the prior probability of the state and mixture component in the wideband model p k q is the prior probability of the state and mixture component in the narrowband model is the mean vector for the Gaussians of state k and mixture component q in the wideband model is the mean vector for the Gaussians of state k and mixture component q in the narrowband model is the covariance matrix for the Gaussians of state k and mixture component q in the wideband model is the covariance matrix for the Gaussians of state k and mixture component q in the narrowband model and b and A are determined as in equations 10 and 11 above using wideband data.

After the wideband HMM parameters have been used to form narrowband HMM parameters wideband HMM parameters and wideband data are used by a wideband state posterior probability calculator to determine wideband state posterior probabilities at step . In particular the wideband state posterior probabilities are determined using the conventional Baum Welch algorithm as 

At step a narrowband state posterior probability calculator determines narrowband state posterior probabilities using narrowband HMM and narrowband cepstral data in a similar fashion as 

At step the wideband and narrowband state probabilities and wideband data and cepstral posterior models are used by a wideband HMM trainer to update wideband HMM .

As can be seen in equation the variance of the cepstral posterior model influences the variance of the updated wideband HMM. Since the variance is an indication of the uncertainty in the extended vector circumflex over z the inclusion of the variance in the update equation for injects the uncertainty of the extended vector circumflex over z into the uncertainty of the wideband HMM.

At step the method of determines if wideband HMM has converged. If it has not converged the process repeats steps and to generate new statistics and to further update the wideband HMM parameters. When the wideband HMM parameters have converged the process ends at step .

Thus through the present invention acoustic models may be trained in the cepstral domain using a combination of wideband training data and narrowband training data. Under some embodiments the narrowband data is used directly in the EM algorithm with the missing components of the narrowband data estimated in the EM iterations. In other embodiments the narrowband feature vectors are extended by estimating the values of their missing components based on models trained on wideband data only. The extended narrowband feature vectors are then used together with wideband feature vectors to train an acoustic model in the cepstral domain. In further embodiments the extended narrowband feature vectors are the means of cepstral posterior probabilities and the variances of the cepstral posterior probabilities are also used to train the acoustic model. This allows acoustic models to be trained in the cepstral domain using less expensive narrowband acoustic data thereby making it less expensive to train wideband acoustic models in the cepstral domain while not severely impacting the performance of the acoustic models.

Although the present invention has been described with reference to particular embodiments workers skilled in the art will recognize that changes may be made in form and detail without departing from the spirit and scope of the invention.

