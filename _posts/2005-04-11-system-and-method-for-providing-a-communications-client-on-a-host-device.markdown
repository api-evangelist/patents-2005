---

title: System and method for providing a communications client on a host device
abstract: A system and a method () for integrating an uncertified client () with a certified host device () are provided. The integration system () is configured to integrate the uncertified client (), which has a plurality of client applications (), with the certified host device (), and has a client virtual machine (), host applications (), and an abstraction layer (). The client virtual machine () is coupled to the uncertified client () and is configured to execute the plurality of client applications (). The host applications () are coupled to the certified host device () and are configured to control host dependent features on the certified host device (). The abstraction layer () are coupled to the host applications () and to the client virtual machine (), and are configured to translate feature calls from the plurality of client applications () to function calls for the host applications ().
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08180861&OS=08180861&RS=08180861
owner: Research In Motion Limited
number: 08180861
owner_city: Waterloo, ON
owner_country: unknown
publication_date: 20050411
---
The present application claims priority from U.S. provisional application Ser. No. 60 592 131 filed Jul. 30 2004.

The present application relates to an integration of a client into a host device and more specifically to architecture for integrating a client without requiring the client to certify its signalling and for supporting communication between host and client applications.

It is desirable to add a client such as a data communications client onto a host wireless device to perform functions that the host wireless device would not normally include. However the host wireless device could be and typically is already certified with its software and hardware to communicate over a wireless network without the client especially in the case of the client being integrated after market onto the host wireless device. It is desirable for the client to be able to communicate with native applications on the host wireless device and for the host applications to be able to communicate with client applications. Such a communication preferably includes a user interface control on the host wireless device from a client application including registering inputs to the host wireless device for the client application and displaying or outputting from the client application. In some cases it is also desirable to be able to use host settings such as locale information time zones display themes and backgrounds from a host environment in a client setting. An automatic propagation of a change in a host device setting may also be preferable in some situations. It may also be desirable to have symbol inputs to the client correspond with symbol inputs to the host wireless device to simplify the input of symbols and to be able to upgrade or downgrade the provisioning of the client directly from the host wireless device without having to load new software on the host wireless device.

The present application provides a divided architecture for integrating a client into a host wireless device. In the present system the host is recognized as the dominant determinant in a divided architecture because device type certification efforts such as Global Certification Forum GCF and Personal Communication Services PCS Type Certification Review Board PTCRB may occur prior to the client being integrated onto the host wireless device which necessitates the host wireless device and tightly tied applications to the host wireless device to remain unfettered.

The present application provides a virtual machine that is started upon start up of the host wireless device and is used to run client applications. The virtual machine communicates through a client operating system OS that would normally send client application commands and functions to host dependent features such as hardware software firmware and communications networks. However because the host dependent features are certified and controlled by the host wireless device the client OS instead communicates with abstraction layers. The abstraction layers have a native interface for communicating with host applications allowing client applications to use the host dependent features by utilizing host applications.

Device settings such as locale time zone display themes and backgrounds can be set using a binary variable. In one mode the client settings are adapted to automatically adjust when host device settings are changed. This change is propagated by either having a listener at the host wireless device to signal a change in host device settings or polling when a graphical interface of the client is brought to the foreground. In the other mode the client settings can be fixed at the client and changes at the host wireless device are ignored.

The client application accesses the user interface of the host wireless device using a host native application a platform abstraction layer and a host independent engine communicating between the user interface and a client application. The host independent engine is platform independent and relies on the platform abstraction layer to translate and or map function calls. The host native application depends on the user interface and host device and is used to control actions and updates to the user interface. For example in a system for entering symbols to the client where the host wireless device has a native system for entering symbols from a host symbol table by navigating a host cursor to move between adjacent symbols displayed within a host grid and the host further has a keyboard the keyboard can be utilized to map symbols to one keystroke. A client symbol table is created conforming to the host symbol table and a grid is made where the indicia of at least one keyboard key is associated with a symbol such that when a user actuates a key in the keyboard the cursor jumps to the corresponding symbol. Provisioning of the device can also be accomplished from software that is already loaded onto the host wireless device. By following steps from the client application on the host wireless device provisioning of the client can be changed. A host wireless device user is thereby enabled to upgrade or downgrade client service i.e. to provision the data client.

A feature call on the divided architecture from the client applications would normally go through a client OS . The client OS may include a number of primitives for interacting with host OS and host hardware which includes a host user interface . However in the case that the client applications are built onto the certified host communications device and because the certified host communications device has already acquired certification for its host dependent features such as hardware software and firmware it is preferable to have the client OS interact with a host abstraction layer instead of having the client OS directly interacting with the features. The host abstraction layer converts calls from the client applications to host calls through a native interface . The native interface invokes host applications in order to use the host dependent features on the certified host communications device . The host applications may include a variety of applications such as but not limited to a host contacts application including an address book having phone numbers e mail addresses or other contact information for individuals or companies a telephone related application an SMS application a multi media message service MMS application and other certified applications . These individual host applications are started within the host application and a request from the client application is sent through the client OS to the host abstraction layer where the request is converted with the native interface for the host applications .

Because the host applications invoke the features of the certified host communications device rather than the client applications directly utilizing the features the divided architecture enables the client applications to run in a host environment and use the features of the certified host communications device without having to re certify. The divided architecture therefore enables the uncertified client which is the data communications client to be added to the certified host communications device after certification including an after market addition to the certified host communications device .

One example of a client application using the above described method and system includes the making of a telephone call when the certified host communications device is a cellular telephone. In the host environment making of the telephone call simply involves using the host applications to create the telephone call where the host applications use certified hardware firmware and software to connect through a wireless system. However in the client applications the above described divided architecture requires invoking one of the host applications in order to make the telephone call. The invoked client application could be the address book associated with the contacts application which includes phone numbers for individuals. A user may wish to select a telephone number of a particular individual from the address book associated with the contacts application and to have the cellular telephone which is the certified host communications device in this example to make a call to that particular individual. In order to accomplish this task the user may select the telephone number and select an option to dial that phone number. In this case the contacts application indicates through the virtual machine to the client OS that it needs to make a telephone call. Instead of using the host dependent feature directly from the client OS a notification is sent to the host abstraction layer which invokes an appropriate application of the host applications through the native interface to make the telephone call. In this example the invoked host application would be the telephone related application which starts the telephone call and the user proceeds as if the telephone call had been started from the client applications .

The client applications may also provide the user an option to use the SMS application or the MMS application to contact the individual instead of dialling the telephone number. In each of these cases a different application of the host applications is invoked but this task is accomplished similarly through the host abstraction layer and the native interface . Alternatively the messages application which includes a telephone number may be invoked from the client applications .

As one skilled in the art will realize data is supplied between the client applications and the host applications . In the example above the telephone number would be supplied to the host application including the telephone related application the SMS application and the MMS application .

It is further desirable to be able to activate a selected client application of the client applications from one of the host applications . A client application selection application uses a client abstraction layer to activate an application within the client applications . The client application selection application calls a function that is translated in the client abstraction layer . The client abstraction layer then uses the virtual machine to activate the selected client application of the client applications . The client abstraction layer may either inject the client OS event into the virtual machine causing the selected client application of the client applications to become active or alternatively may perform a reverse native call through the client OS or via a client connect to manipulate the native representation of some client object causing the selected client application of the client application to become active. The client connect can be used for network features for the client applications which enables for example the data communications client to communicate using a specific protocol that was not originally supported on the certified host communications device . The client connect involves a protocol stack to perform this communication between the data communications client and the certified host communications device and increases and improves client functionality.

A request for the selected client application to be activated is converted into function calls through the native interface which in turn makes calls on the client applications . The selected client application is then brought into the foreground of a display of the certified host communications device . Alternatively the client application selection application may communicate directly with the virtual machine to activate the selected client application of the client applications . This direct communication may occur for example in the case where the client application selection application knows the code or a hook to start the selected client application. Once the virtual machine receives the request to activate the selected client application either directly from the client application selection application or through the client abstraction layer the selected client application is activated and is required to assume control of the host user interface . To accomplish this task the selected client application makes a call back to the client application selection application indicating that the selected client application requires the host user interface . The client application selection application then uses host code to take over the host user interface and thus becomes a portal between the selected client application of the client applications and the certified host communications device . The client application selection application adapts all of the host inputs to events for the data communications client and takes over control of the host user interface . If the certified host communications device requires control of the host user interface back the data communications client is notified through the client application selection application of this requirement.

It is further desirable when using the certified host communications device and the data communications client to be able to synchronize device settings in certain situations. The device settings may include locale settings time zone settings or theme settings. The locale settings may include various settings such as the language of the interface for example English or French or Spanish and may also include the keyboard configuration e.g. QWERTY AZERTY QWERTZ or DVORAK. The theme settings may include color patterns and background images.

In the setup application shown in the user can choose between a mode that allows the user to use host settings for the device settings or custom settings. As one skilled in the art will appreciate a different mode setting could be used for theme locale and time zone or these could be all included in one mode setting. If the mode is set to the host settings the device settings for the data communications client are synchronized with the device settings of the certified host communications device . Any changes in the device settings of the certified host communications device are propagated to the data communications client and the device settings of the data communications client are therefore also changed. For example if the user changes the language from French to English in the host applications this change is propagated to the data communications client and the client applications would use English. If the client display is set to mimic the host display then propagation of changes in the host display is accomplished by having a listener application monitor the host device settings. Upon a change in the host device settings the host listener notifies the setup application that a change has been made to the host device settings and this change will be reflected in the client device settings.

Alternatively propagation of a change in the device settings may include polling every time a graphical user interface from the client takes over. This polling involves comparing the host device settings with the client device settings and determining if a change has been made. If a change has been made the client device settings are updated. Thus if the mode is automatic or host settings changes in the certified host communications device settings are pushed to the data communications client either through the host listener or by polling as described above. Conversely if the mode is set to manual or client settings the user can update the device settings in the data communications client and the client applications will use these device setting instead of the host device settings. If the mode is set to client settings then changes to the device settings of the certified host communications device will be ignored by the client applications .

Because the platform abstraction layer contains the host abstraction layer and the client abstraction layer translation between the data communications client and the certified host communications device is performed within the platform abstraction layer which may be a C function interface.

The host independent engine is a platform independent component and includes both the virtual machine and the client OS . The virtual machine and the client OS are used to activate start or call instances of objects in the client applications when the data communications client is object oriented and to call functions in the data communications client when the data communications client is not object oriented.

The host native application resides beyond the platform abstraction layer and thus is able to adapt the host user interface to conform and adapt to the certified host communications device on behalf of the client applications . The client application selection application previously described is an uncertified embodiment of the host native application . As will be appreciated by one skilled in the art other embodiments could be certified. The host native application can take radically different forms depending upon the design of the host application infrastructure and the user interface requirements of the host operating system. The host native application is responsible for creating the framework necessary to receive input and update output when the user brings a particular client application of the client applications to the foreground. In a keyboard display embodiment this process may involve creating windows buttons or graphics widgets of any kind. In a voice only host embodiment this process may involve speech recognition and voice synthesis. The host native application is also responsible for passing a user input to the host independent engine through the platform abstraction layer . The user input is received by the host user interface and may include user actions such as button presses keystrokes stylus inputs roller wheel motions scrollstrip motions touch pad motions d pad motions voice commands accelerometer motions or other inputs that would be known to those skilled in the art. The user input is translated and or mapped as received from the host OS and fed through the input function of the platform abstraction layer .

For an output to the host user interface the host native application may receive screen updates from the host independent engine at any time including when none of the client applications is in the foreground. These updates must be stored and memory is used by the host native application to maintain a complete frame buffer copy separate from the application display area. If the host native application is in the foreground when receiving an update from the host independent engine then the application display area must be updated as well as the frame buffer so that the display on the host device reflects the screen change immediately. Whenever the host native application transitions into the foreground it must update the application display area with the complete contents of the frame buffer. Other types of the output to the host user interface may include audio tones voice and signals to actuate host specific features such as an offset motor or LED for discrete notification or indication.

In accordance with at least one of the preferred embodiments the host native application uses a framework that updates the user by simply displaying a graphic image provided by the platform abstraction layer and processes the user actions by adapting them to be sent down as events to the platform abstraction layer . This process greatly reduces the complexity of host native application thus enhancing the portability of the data communications client to other host devices.

Note that in each case of the indicia used in the client graphical user interface element conforms to the layout of the particular host keyboard such as the keyboard an illustrated in and that the input actions taken by the user are adapted to select the corresponding symbol. In sum the host native application adapts keystrokes by mapping each grid location on the 9 3 grid onto a key on the client graphical user interface element shown as QWERTY AZERTY and QWERTZ variants in and for output the host native application enhances the display by showing the indicia of a corresponding alphabetic key directly below each symbol. Note that the examples of deliberately do not use the right most key of the top row of a standard keyboard. In the examples of an the key marked by the P indicia in right keyboard portion is not used because the top most rows of the three standard keyboards shown herein contains 10 keys. This intentional omission has been shown above to provide advantages and thus should not be considered a limitation. Nonetheless it is envisaged that the techniques taught herein could be adapted to other keyboard layouts and grid sizes on a per host basis by those of skill in the art and thus those adaptations are also within the scope of this application. Alternatively the unused keys can remain unutilized or can be assigned a function to further enhance symbolic input such as toggling between the various symbol pages. It is also envisaged that toggling between symbol pages can be accomplished by use of any one of the many other keys available on the particular keyboard available on the host keyboard.

Where the host mobile station is enabled for two way communication it will incorporate a communication subsystem including both a receiver and a transmitter as well as associated components such as one or more preferably embedded or internal a receiver antenna and a transmitter antenna local oscillators LO s and a processing module such as a digital signal processor DSP . As will be apparent to those skilled in the field of communications the particular design of the communication subsystem will be dependent upon the communication network in which the device is intended to operate. For example host mobile station may include the communication subsystem designed to operate within the Mobitex mobile communication system the DataTAC mobile communication system General Packet Radio Service GPRS network Universal Mobile Telecommunications System UMTS network Enhanced Data for Global System for Mobile Communications GSM Evolution EDGE network or Code Division Multiple Access CDMA network.

Network access requirements will also vary depending upon the type of network . For example in the Mobitex and DataTAC networks the host mobile station is registered on the communication network using a unique identification number associated with each mobile station. In UMTS and GPRS networks and in some CDMA networks however network access is associated with a subscriber or user of the host mobile station . A GPRS mobile station therefore requires a subscriber identity module SIM card in order to operate on a GPRS network and a Removable User Identity Module RUIM in order to operate on some CDMA networks. Although the host mobile station would not fully function without a valid SIM RUIM card if it is a GPRS UMTS CDMA mobile station local or non network communication functions as well as legally required functions if any such as 911 emergency calling may still be available. However the host mobile station will be unable to carry out any other functions involving communications over the communication network . A SIM RUIM interface which is configured to accept a SIM RUIM card is normally similar to a card slot into which the SIM RUIM card can be inserted and ejected like a diskette or a Personal Computer Memory Card International Association PCMCIA card. The SIM RUIM card can have approximately 64K of memory and hold many key configuration and other information such as identification and subscriber related information.

When required network registration or activation procedures have been completed the host mobile station may send and receive communication signals over the communication network . Signals received by the receiver antenna from the communication network are input to the receiver which may perform such common receiver functions as signal amplification frequency down conversion filtering channel selection and the like and in the example system shown in analog to digital A D conversion. A D conversion of a received signal allows more complex communication functions such as demodulation and decoding to be performed in the DSP . In a similar manner signals to be transmitted are processed including modulation and encoding for example by the DSP and input to the transmitter for digital to analog D A conversion frequency up conversion filtering amplification and transmission over the communication network via the transmit antenna . The DSP in addition to processing receive and transmit communication signals and provides for receiver and transmitter controls and . For example the gains applied to communication signals in the receiver and the transmitter may be adaptively controlled through automatic gain control algorithms implemented in the DSP .

The communication network may further communicate with multiple systems not shown . For example the communication network may communicate with both an enterprise system and a web client system in order to accommodate various clients with various service levels.

The host mobile station preferably includes a microprocessor which controls the overall operation of the host mobile station . Communication functions including at least data and voice communications are performed through the communication subsystem . The microprocessor also interacts with further device subsystems such as flash memory a display random access memory RAM auxiliary input output I O subsystems a serial port a keyboard a speaker a microphone other communications subsystem and any other compatible device subsystems which is generally designated as . Some of the subsystems shown in perform communication related functions whereas other subsystems may provide resident or on device functions. Notably some subsystems such as the keyboard and the display for example may be used for both communication related functions such as entering a text message for transmission over a communication network and device resident functions such as a calculator or task list.

Operating system software used by the microprocessor is preferably stored in a persistent store such as the flash memory which may instead be a read only memory ROM or similar storage element not shown . Those skilled in the art will appreciate that the operating system specific device applications or parts thereof may be temporarily loaded into a volatile memory such as the RAM . Received communication signals may also be stored in the RAM .

As shown in the flash memory can be segregated into different areas for both computer programs and program data storage such as device state an address book personal information manager PIM and other programs . These different storage types indicate that each program can allocate a portion of the flash memory for their own data storage requirements. The microprocessor in addition to its operating system functions preferably enables execution of software applications on the host mobile station . A predetermined set of applications that control basic operations including at least data and voice communication applications for example will normally be installed on the host mobile station during manufacturing. A preferred software application may be a PIM application having the ability to organize and manage data items relating to the user of the host mobile station such as but not limited to e mail calendar events voice mails appointments and task items. Naturally one or more memory stores would be available on the host mobile station to facilitate storage of PIM data items. Such PIM application would preferably have the ability to send and receive data items via the communication network . In a preferred embodiment the PIM data items are seamlessly integrated synchronized and updated via the communication network with the host mobile station user s corresponding data items stored or associated with a host computer system. Additional applications may also be loaded onto the host mobile station through the communication network the auxiliary I O subsystem the serial port other communications subsystem or any other compatible device subsystem and be installed by the user in the RAM or preferably a non volatile store not shown for execution by the microprocessor . Such flexibility in application installation increases the functionality of the host mobile station and may provide enhanced on device functions communication related functions or both. For example secure communication applications may enable electronic commerce functions and other such financial transactions to be performed using the host mobile station .

In a data communication mode a received signal such as a text message or web page download will be processed by the communication subsystem and input to the microprocessor which preferably further processes the received signal for output to the display or alternatively to the auxiliary I O subsystems . The user of the host mobile station may also compose data items such as e mail messages for example using the keyboard which is preferably a complete alphanumeric keyboard or telephone type keypad in conjunction with the display and possibly with the auxiliary I O subsystems . Such composed items may then be transmitted over the communication network through the communication subsystem .

For voice communications overall operation of the host mobile station is similar except that the received signals would preferably be output to the speaker and signals for transmission would be generated by the microphone . Alternative voice or audio I O subsystems such as a voice message recording subsystem may also be implemented on the host mobile station . Although voice or audio signal output is preferably accomplished primarily through the speaker the display may also be used to provide an indication of the identity of a calling party the duration of a voice call or other voice call related information for example.

The serial port such as Universal Serial Bus USB in would normally be implemented in a personal digital assistant PDA type host mobile station for which synchronization with a user s desktop computer not shown may be desirable but is an optional device component. The serial port would enable the user to set preferences through an external device or software application and would extend the capabilities of the host mobile station by providing for information or software downloads to host mobile station other than through a wireless communication network. An alternate download path may for example be used to load an encryption key onto the device through a direct and thus reliable and trusted connection to thereby enable secure device communication. Other communications subsystems such as a short range communications subsystem is a further optional component which may provide for communication between the host mobile station and different systems or devices which need not necessarily be similar devices. For example the other communications subsystem may include an infrared device and associated circuits and components or a Bluetooth communication module to provide for communication with similarly enabled systems and devices.

A mobile communications device such as a cellular telephone is typically formed of software firmware and hardware adapted to provide communications services over a compatible wireless communications network. This process of forming the relationship between the mobile communications device and the service is known in the art as provisioning. Typically a network operator provisions the mobile communications device via a subscription to a service contract. Thus once the mobile communications device has been provisioned the user of the mobile communications device is often referred to as a subscriber. In a voice and data network such as GSM GPRS CDMA or various other third generation networks such as EDGE or UMTS both voice and data services may be available to mobile communications devices. Such voice services include voice calling and SMS and such data services include Internet browsing email and MMS.

Although many services may be available on a given network only those subscribers who use mobile communications devices that have been provisioned for those services will be able to benefit from them. This limitation may present problems for both the subscriber and the network operator. On one hand the subscriber may desire an existing service he does not have i.e. an upgrade or desire disabling a service i.e. a downgrade. On the other hand the operator may want to offer a new service but may hesitate if subscribers cannot benefit from them. One known solution is to provide an out of band communications link such as a Universal Serial Bus USB on the mobile communications device and enable the subscriber to load new software onto the mobile communications device via the out of band communication link using a personal computer thus re provisioning the mobile communications device. This solution may be an unacceptable solution to both the subscriber and the operator as there is a significant risk that the mobile communications device by error receives a wrong or incomplete load and may require servicing. Furthermore this solution may be unacceptable to the subscriber who does not have access to a personal computer. However because the host mobile station is a host communications device that hosts the data communications client the data communications client may be provisioned directly by the user of host mobile station .

The embodiments described herein are examples of structures e systems or methods having elements corresponding to elements of the techniques of this application. This written description may enable those skilled in the art to make and use embodiments having alternative elements that likewise correspond to the elements of the techniques of this application. The intended scope of the techniques of this application thus includes other structures systems or methods that do not differ from the techniques of this application as described herein and further includes other structures systems or methods with insubstantial differences from the techniques of this application as described herein.

