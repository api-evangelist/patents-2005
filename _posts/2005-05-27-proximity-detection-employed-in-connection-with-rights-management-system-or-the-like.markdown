---

title: Proximity detection employed in connection with rights management system or the like
abstract: A sink sends a registration request to a source and the source validates same, and the source sends a registration response including a secret to the sink. The source then sends a proximity message including a nonce to the sink and concurrently notes a start time. The sink employs the secret and the nonce to generate a proximity value and sends same to the sources. The source receives the proximity value and concurrently notes an end time, verifies the proximity value based on the secret and the nonce, calculates from the noted start and end times an elapsed time, compares the elapsed time to a predetermined threshold value, decides from the comparison whether the sink satisfies the proximity requirement, and registers the sink as being able to access content from such source if the sink satisfies the proximity requirement.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07574747&OS=07574747&RS=07574747
owner: Microsoft Corporation
number: 07574747
owner_city: Redmond
owner_country: US
publication_date: 20050527
---
The present application is a continuation in part of U.S. patent application Ser. No. 10 827 167 filed Apr. 19 2004 entitled Rendering Protected Digital Content Within A Network Of Computing Devices Or The Like and hereby incorporated by reference in its entirety.

The present invention relates to a rights management RM system whereby access to digital content is provided only in accordance with a corresponding digital license. More particularly the invention relates to such an RM system that ensures that content licensed to a first computing device is not sub licensed to a second computing device unless the second computing device is deemed to be proximate the first computing device.

Rights management RM and enforcement is highly desirable in connection with digital content such as digital audio digital video digital text digital data digital multimedia etc. where such digital content is to be distributed to one or more users. Digital content could be static such as a text document for example or it could be streamed such as the streamed audio and video of a multimedia presentation. Typical modes of distribution of such content include tangible and intangible forms such as an optical disk a cable access feed a feed from an electronic network such as the Internet a feed from an over the air broadcast etc. Upon being received by a user at an appropriate computing device thereof such user renders the digital content with the aid of the computing device appropriate rendering software and appropriate output devices such as speakers a video monitor etc.

In one scenario the content is distributed as a stream by a distributor as part of a subscription service such as for example a digital television service and the streamed content as distributed is either protected such as for example by being encrypted or is unprotected. If it is the case that the streamed content is indeed distributed in an unprotected form it may be the case that the distributor primarily intends for the streamed content to be immediately consumed and rendered and not stored in any meaningful retrievable form. For example the streamed content may be one of many streams of content in a digital cable television signal that is to be received by a digital cable set top box and immediately rendered thereby and is then to be forwarded to the aforementioned appropriate output devices.

However it is to be appreciated that storage systems exist and or are being developed that can indeed store the streamed content for later rendering and or re distribution to other computing devices. With regard to such storage systems then the distributor of the streamed unprotected content would rather not have such unprotected content stored in the unprotected form and without any ability to restrict such re distribution if so desired. In particular the distributor or the like may wish to prohibit the user from copying such streamed content to another storage system or the like may wish to allow the user to copy with temporal and or count restrictions or the like. As may be appreciated by prohibiting unlimited copying of the streamed content the distributor can avoid the unchecked dispersal of pristine digital copies of the streamed content where such unchecked dispersal would encourage other users from foregoing from subscribing to the subscription service offered by such distributor.

In addition the distributor may wish to provide various users with different rendering rights. For example the distributor may offer different tiers of service where higher level tiers correspondingly command higher subscription fees and where a user subscribing at a particular tier should not be allowed to access streamed content from higher tiers in an unprotected form.

Note though that after the streamed content has been distributed the distributor has very little if any real control over the streamed content. This is especially problematic in view of the fact that most any personal computer includes the software and hardware necessary to make an exact digital copy of such streamed content and to download such exact digital copy to a re distribution medium such as an optical disk or to send such exact digital copy over a network such as the Internet to any destination.

Of course as part of a transaction wherein the streamed content is subscribed to the distributor may require the user recipient of the streamed content to promise not to re distribute such content in an unwelcome manner. However such a promise is easily made and easily broken. The distributor may attempt to prevent such re distribution through any of several known security devices usually involving encryption and decryption. However such security devices if especially simple pose little problem to a mildly determined user who wishes to decrypt encrypted content save such content in an un encrypted form and then re distribute same.

RM and enforcement architectures and methods have thus been provided to allow the controlled rendering of arbitrary forms of digital content including streamed content where such control is flexible and definable by the distributor or the like of such digital content. Such architectures allow and facilitate such controlled rendering in the scenario as set forth above.

In one particular arrangement the streamed content is one of a plurality of streams of such content provided as a combined signal to a receiver. The receiver selects a particular one of the streams upon command from a media system and provides the selected stream to such media system for further processing. Notably the selected stream as provided to the receiver is unprotected but prior to being provided to the media system the selected stream is in fact protected by the receiver according to a particular RM encryption system.

Typically in an RM encryption system the content is protected by being encrypted according to a content key CK . Inasmuch as symmetric encryption and decryption is easier faster and less expensive than asymmetric encryption and decryption such content key CK is typically symmetric. Also typically the content key CK is provided by an encryptor such as the receiver to a decryptor such as the media system in an encrypted form and as part of a digital license or the like that specifies license rules that must be satisfied before such content is allowed to be decrypted and rendered by the decryptor media system.

It is to be recognized that a computing device having streamed content stored therein may be networked with one or more other computing devices and that a user having saved content on a first computing device of the network may wish to render the content by way of a second computing device in the network. More particularly it is to be appreciated that the first computing device should ensure that the second computing device is within the network or at least is proximate to the first computing device. Accordingly the user cannot render the content in connection with another network or at least by way of a computing device remote from the first computing device.

A need exists then for a system and method for a first computing device to ensure that a second computing device is proximate to the first computing device prior to allowing the second computing device to render content licensed to the first computing device. In particular a need exists for a method by which the first computing device can at least roughly determine how close the second computing device is to the first computing device based on an amount of time to respond to a sent message.

The aforementioned needs are satisfied at least in part by the present invention in which a method is provided for a computing device acting as a sink for rights managed content to register with a computing device acting as a source for the content where the source registers the sink only if the sink satisfies a proximity requirement. In the method the sink sends a registration request to the source and the source validates same and the source sends a registration response to the sink where the registration response includes a random value as a secret.

The source then sends a proximity message to the sink and concurrently notes a start time where the proximity message includes a random value as a nonce. The sink upon receiving the proximity message employs the secret and the nonce to generate a proximity value and sends a proximity response with the proximity value to the sources. The source receives the proximity response with the proximity value from the sink and concurrently notes an end time and also verifies the proximity value based on the secret and the nonce calculates from the noted start and end times an elapsed time compares the elapsed time to a predetermined threshold value decides from the comparison whether the sink satisfies the proximity requirement and registers the sink as being able to access content from such source if the sink satisfies the proximity requirement.

Although not required the invention can be implemented via an application programming interface API for use by a developer and or included within the network browsing software which will be described in the general context of computer executable instructions such as program modules being executed by one or more computers such as client workstations servers or other devices. Generally program modules include routines programs objects components data structures and the like that perform particular tasks or implement particular abstract data types. Typically the functionality of the program modules may be combined or distributed as desired in various embodiments. Moreover those skilled in the art will appreciate that the invention may be practiced with other computer system configurations. Other well known computing systems environments and or configurations that may be suitable for use with the invention include but are not limited to personal computers PCs automated teller machines server computers hand held or laptop devices multi processor systems microprocessor based systems programmable consumer electronics network PCs minicomputers mainframe computers and the like. The invention may also be practiced in distributed computing environments where tasks are performed by remote processing devices that are linked through a communications network or other data transmission medium. In a distributed computing environment program modules may be located in both local and remote computer storage media including memory storage devices.

With reference to an exemplary system for implementing the invention includes a general purpose computing device in the form of a computer . Components of computer may include but are not limited to a processing unit a system memory and a system bus that couples various system components including the system memory to the processing unit . The system bus may be any of several types of bus structures including a memory bus or memory controller a peripheral bus and a local bus using any of a variety of bus architectures. By way of example and not limitation such architectures include Industry Standard Architecture ISA bus Micro Channel Architecture MCA bus Enhanced ISA EISA bus Video Electronics Standards Association VESA local bus and Peripheral Component Interconnect PCI bus also known as Mezzanine bus .

Computer typically includes a variety of computer readable media. Computer readable media can be any available media that can be accessed by computer and includes both volatile and nonvolatile media removable and non removable media. By way of example and not limitation computer readable media may comprise computer storage media and communication media. Computer storage media includes both volatile and nonvolatile removable and non removable media implemented in any method or technology for storage of information such as computer readable instructions data structures program modules or other data. Computer storage media includes but is not limited to RAM ROM EEPROM flash memory or other memory technology CDROM digital versatile disks DVD or other optical disk storage magnetic cassettes magnetic tape magnetic disk storage or other magnetic storage devices or any other medium which can be used to store the desired information and which can be accessed by computer . Communication media typically embodies computer readable instructions data structures program modules or other data in a modulated data signal such as a carrier wave or other transport mechanism and includes any information delivery media. The term modulated data signal means a signal that has one or more of its characteristics set or changed in such a manner as to encode information in the signal. By way of example and not limitation communication media includes wired media such as a wired network or direct wired connection and wireless media such as acoustic RF infrared and other wireless media. Combinations of any of the above should also be included within the scope of computer readable media.

The system memory includes computer storage media in the form of volatile and or nonvolatile memory such as read only memory ROM and random access memory RAM . A basic input output system BIOS containing the basic routines that help to transfer information between elements within computer such as during start up is typically stored in ROM . RAM typically contains data and or program modules that are immediately accessible to and or presently being operated on by processing unit . By way of example and not limitation illustrates operating system application programs other program modules and program data .

The computer may also include other removable non removable volatile nonvolatile computer storage media. By way of example only illustrates a hard disk drive that reads from or writes to non removable nonvolatile magnetic media a magnetic disk drive that reads from or writes to a removable nonvolatile magnetic disk and an optical disk drive that reads from or writes to a removable nonvolatile optical disk such as a CD ROM or other optical media. Other removable non removable volatile nonvolatile computer storage media that can be used in the exemplary operating environment include but are not limited to magnetic tape cassettes flash memory cards digital versatile disks digital video tape solid state RAM solid state ROM and the like. The hard disk drive is typically connected to the system bus through a non removable memory interface such as interface and magnetic disk drive and optical disk drive are typically connected to the system bus by a removable memory interface such as interface .

The drives and their associated computer storage media discussed above and illustrated in provide storage of computer readable instructions data structures program modules and other data for the computer . In for example hard disk drive is illustrated as storing operating system application programs other program modules and program data . Note that these components can either be the same as or different from operating system application programs other program modules and program data . Operating system application programs other program modules and program data are given different numbers here to illustrate that at a minimum they are different copies. A user may enter commands and information into the computer through input devices such as a keyboard and pointing device commonly referred to as a mouse trackball or touch pad. Other input devices not shown may include a microphone joystick game pad satellite dish scanner or the like. These and other input devices are often connected to the processing unit through a user input interface that is coupled to the system bus but may be connected by other interface and bus structures such as a parallel port game port or a universal serial bus USB .

A monitor or other type of display device is also connected to the system bus via an interface such as a video interface . A graphics interface such as Northbridge may also be connected to the system bus . Northbridge is a chipset that communicates with the CPU or host processing unit and assumes responsibility for accelerated graphics port AGP communications. One or more graphics processing units GPUs may communicate with graphics interface . In this regard GPUs generally include on chip memory storage such as register storage and GPUs communicate with a video memory . GPUs however are but one example of a coprocessor and thus a variety of co processing devices may be included in computer . A monitor or other type of display device is also connected to the system bus via an interface such as a video interface which may in turn communicate with video memory . In addition to monitor computers may also include other peripheral output devices such as speakers and printer which may be connected through an output peripheral interface .

The computer may operate in a networked environment using logical connections to one or more remote computers such as a remote computer . The remote computer may be a personal computer a server a router a network PC a peer device or other common network node and typically includes many or all of the elements described above relative to the computer although only a memory storage device has been illustrated in . The logical connections depicted in include a local area network LAN and a wide area network WAN but may also include other networks. Such networking environments are commonplace in offices enterprise wide computer networks intranets and the Internet.

When used in a LAN networking environment the computer is connected to the LAN through a network interface or adapter . When used in a WAN networking environment the computer typically includes a modem or other means for establishing communications over the WAN such as the Internet. The modem which may be internal or external may be connected to the system bus via the user input interface or other appropriate mechanism. In a networked environment program modules depicted relative to the computer or portions thereof may be stored in the remote memory storage device. By way of example and not limitation illustrates remote application programs as residing on memory device . It will be appreciated that the network connections shown are exemplary and other means of establishing a communications link between the computers may be used.

One of ordinary skill in the art can appreciate that a computer or other client device can be deployed as part of a computer network. In this regard the present invention pertains to any computer system having any number of memory or storage units and any number of applications and processes occurring across any number of storage units or volumes. The present invention may apply to an environment with server computers and client computers deployed in a network environment having remote or local storage. The present invention may also apply to a standalone computing device having programming language functionality interpretation and execution capabilities.

Distributed computing facilitates sharing of computer resources and services by direct exchange between computing devices and systems. These resources and services include the exchange of information cache storage and disk storage for files. Distributed computing takes advantage of network connectivity allowing clients to leverage their collective power to benefit the entire enterprise. In this regard a variety of devices may have applications objects or resources that may interact to implicate authentication techniques of the present invention for trusted graphics pipeline s .

It can also be appreciated that an object such as may be hosted on another computing device or . Thus although the physical environment depicted may show the connected devices as computers such illustration is merely exemplary and the physical environment may alternatively be depicted or described comprising various digital devices such as PDAs televisions MP3 players etc. software objects such as interfaces COM objects and the like.

There are a variety of systems components and network configurations that support distributed computing environments. For example computing systems may be connected together by wireline or wireless systems by local networks or widely distributed networks. Currently many of the networks are coupled to the Internet which provides the infrastructure for widely distributed computing and encompasses many different networks.

In home networking environments there are at least four disparate network transport media that may each support a unique protocol such as Power line data both wireless and wired voice e.g. telephone and entertainment media. Most home control devices such as light switches and appliances may use power line for connectivity. Data Services may enter the home as broadband e.g. either DSL or Cable modem and are accessible within the home using either wireless e.g. HomeRF or 802.11b or wired e.g. Home PNA Cat 5 even power line connectivity. Voice traffic may enter the home either as wired e.g. Cat 3 or wireless e.g. cell phones and may be distributed within the home using Cat 3 wiring. Entertainment media may enter the home either through satellite or cable and is typically distributed in the home using coaxial cable. IEEE 1394 and DVI are also emerging as digital interconnects for clusters of media devices. All of these network environments and others that may emerge as protocol standards may be interconnected to form an intranet that may be connected to the outside world by way of the Internet. In short a variety of disparate sources exist for the storage and transmission of data and consequently moving forward computing devices will require ways of protecting content at all portions of the data processing pipeline.

The Internet commonly refers to the collection of networks and gateways that utilize the TCP IP suite of protocols which are well known in the art of computer networking. TCP IP is an acronym for Transport Control Protocol Interface Program. The Internet can be described as a system of geographically distributed remote computer networks interconnected by computers executing networking protocols that allow users to interact and share information over the networks. Because of such wide spread information sharing remote networks such as the Internet have thus far generally evolved into an open system for which developers can design software applications for performing specialized operations or services essentially without restriction.

Thus the network infrastructure enables a host of network topologies such as client server peer to peer or hybrid architectures. The client is a member of a class or group that uses the services of another class or group to which it is not related. Thus in computing a client is a process i.e. roughly a set of instructions or tasks that requests a service provided by another program. The client process utilizes the requested service without having to know any working details about the other program or the service itself. In a client server architecture particularly a networked system a client is usually a computer that accesses shared network resources provided by another computer e.g. a server. In the example of computers etc. can be thought of as clients and computer etc. can be thought of as the server where server etc. maintains the data that is then replicated in the client computers etc.

A server is typically a remote computer system accessible over a remote network such as the Internet. The client process may be active in a first computer system and the server process may be active in a second computer system communicating with one another over a communications medium thus providing distributed functionality and allowing multiple clients to take advantage of the information gathering capabilities of the server.

Client and server communicate with one another utilizing the functionality provided by a protocol layer. For example Hypertext Transfer Protocol HTTP is a common protocol that is used in conjunction with the World Wide Web WWW . Typically a computer network address such as a Universal Resource Locator URL or an Internet Protocol IP address is used to identify the server or client computers to each other. The network address can be referred to as a Universal Resource Locator address. For example communication can be provided over a communications medium. In particular the client and server may be coupled to one another via TCP IP connections for high capacity communication.

Thus illustrates an exemplary networked or distributed environment with a server in communication with client computers via a network bus in which the present invention may be employed. In more detail a number of servers etc. are interconnected via a communications network bus which may be a LAN WAN intranet the Internet etc. with a number of client or remote computing devices etc. such as a portable computer handheld computer thin client networked appliance or other device such as a VCR TV oven light heater and the like in accordance with the present invention. It is thus contemplated that the present invention may apply to any computing device in connection with which it is desirable to process store or render secure content from a trusted source.

In a network environment in which the communications network bus is the Internet for example the servers can be Web servers with which the clients etc. communicate via any of a number of known protocols such as HTTP. Servers may also serve as clients as may be characteristic of a distributed computing environment. Communications may be wired or wireless where appropriate. Client devices may or may not communicate via communications network bus and may have independent communications associated therewith. For example in the case of a TV or VCR there may or may not be a networked aspect to the control thereof. Each client computer and server computer may be equipped with various application program modules or objects and with connections or access to various types of storage elements or objects across which files may be stored or to which portion s of files may be downloaded or migrated. Thus the present invention can be utilized in a computer network environment having client computers etc. that can access and interact with a computer network bus and server computers etc. that may interact with client computers etc. and other devices and databases .

As is known and referring now to rights management RM and enforcement is highly desirable in connection with digital content such as digital audio digital video digital text digital data digital multimedia etc. where such digital content is to be distributed or redistributed to a user. Upon being received by the user such user renders the digital content with the aid of an appropriate rendering device such as a media player text displayer etc. on a personal computer or the like.

Typically a content owner or developer or distributor hereinafter distributor distributing such digital content wishes to restrict what the user can do with such distributed digital content or at least ensure that the content is not redistributed in an unwanted manner. For example the content distributor may wish to restrict the user from copying and re distributing such content to a second user or may wish to allow distributed digital content to be rendered only a limited number of times only for a certain total time only on a certain type of machine only on a certain type of rendering platform only by a certain type of user etc.

However and as was set forth above after distribution has occurred such distributor has very little if any control over the digital content . An RM system then allows the controlled rendering of arbitrary forms of digital content where such control is flexible and definable by the content distributor of such digital content. Typically to protect the content such content is encrypted with a symmetric encryption decryption key KD i.e. KD CONTENT and is packaged with other information relevant to the content in a package .

The trust based RM system allows a distributor of digital content to specify at least some license rules that must be satisfied before such digital content is allowed to be rendered by a computing device of a user. Such license rules can include the aforementioned temporal requirement and may be embodied within a digital license or use document hereinafter license that the user user s computing device hereinafter such terms are interchangeable unless circumstances require otherwise must be possess. Such license also includes the decryption key KD for decrypting the digital content perhaps encrypted according to a key decryptable by the user s computing device . As seen in such encrypting key is a public key of the user s computing device PU C and the user s computing device presumably has the corresponding private key PR C by which PU C KD may be decrypted.

The content distributor for a piece of digital content must trust that the user s computing device will abide by the rules and requirements specified by such content owner in the license i.e. that the digital content will not be rendered unless the rules and requirements within the license are satisfied. Preferably then the user s computing device is provided with a trusted component or mechanism that will not render the digital content except according to the license rules embodied in the license associated with the digital content and obtained by the user.

The trusted component typically has a license evaluator that determines whether the license is valid reviews the license rules and requirements in such valid license and determines based on the reviewed license rules and requirements whether the requesting user has the right to render the requested digital content in the manner sought among other things. As should be understood the license evaluator is trusted in the RM system to carry out the wishes of the owner of the digital content according to the rules and requirements in the license and the user should not be able to easily alter such trusted element for any purpose nefarious or otherwise.

As should be understood the rules and requirements in the license might specify whether the user has rights to render the digital content based on any of several factors including who the user is where the user is located what type of computing device the user is using what rendering application is calling the RM system the date the time etc. In addition the rules and requirements of the license may limit the license to a pre determined number of renderings or pre determined rendering time for example. Thus the trusted component may need to refer to a clock on the computing device . If such clock is provided such clock may be a secure clock that cannot be tampered with by a user in an effort to overcome a temporal restriction of a license .

The rules and requirements may be specified in the license according to any appropriate language and syntax. For example the language may simply specify attributes and values that must be satisfied DATE must be later than X e.g. or may require the performance of functions according to a specified script IF DATE greater than X THEN DO . . . e.g. .

Upon the license evaluator determining that the license is valid and that the user satisfies the rules and requirements therein the digital content can then be rendered. In particular to render the content the decryption key KD is obtained from the license and is applied to KD CONTENT from the content package to result in the actual content and the actual content is then in fact rendered. As set forth above the license with PU C KD in effect authorizes an entity in possession of PR C to access KD and thereby access the content encrypted according to such KD presuming of course that the entity abides by all conditions as set forth in the license .

Note that a license typically includes a digital signature for authentication validation purposes. Likewise other forms of digital constructs such as a piece of digital content may also have such a digital signature for authentication validation purposes. As should be known such a digital signature may be constructed based on a first key from a pair of asymmetric keys or from a symmetric integrity key for example by performing some sort of hash on the underlying data to which the signature is attached and then encrypting the hash with the key. Thereafter the signature is validated by applying the second key from the pair of asymmetric keys or the integrity key again for example by decrypting the encrypted hash and comparing the decrypted hash to another hash of the underlying data to which the signature is attached. If the hashes match it can be presumed that the underlying data has not been altered and the underlying construct therefore can be authenticated. Typically an RM system will not honor a license or the like that is not authenticated.

Turning now to a system for receiving and handling multimedia content is shown. As should be evident such system is particularly suited for handling an input signal comprising multiple streams of multimedia content such as for example a television signal from a multi channel distributor. However such will be system may also handle other input signals without departing from the spirit and scope of the present invention.

In the system the aforementioned input signal as provided by the distributor thereof is applied to a receiver which may be any appropriate receiver without departing from the spirit and scope of the present invention presuming of course such receiver can performs the functions set forth herein. For example the receiver may be a Uni Directional Cable Receiver UDCR such as is being developed to receive a digital cable television signal and forward same for further digital processing including rendering of content therein. As may be appreciated the receiver upon being so commanded tunes one of the multiple streams of multimedia content from the input signal and forwards same for further processing. In addition the receiver prior to forwarding the tuned stream of content may if necessary convert such stream from a native format to a format more amenable for such further processing.

As envisioned each of the multiple streams of multimedia content in the input signal may or may not be encrypted. Upon tuning a particular stream of content within the input signal then the receiver decrypts such stream if encrypted and re encrypts same in a manner that will be set forth in more detail below or merely encrypts the stream if not encrypted again in a manner that will be set forth in more detail below. As was alluded to above the receiver encrypts the stream of content as part of ensuring that the stream is RM protected. Thus the stream of content is not available to be redistributed in an unprotected form.

As also shown in a media system is provided to receive the encrypted stream of content from the receiver and further process same. Presumably the media system commanded the receiver to tune the particular stream of content from within the input signal perhaps upon receiving a corresponding command from a user although it maybe appreciated that such a command may be initiated by other sources without departing from the spirit and scope of the present invention. At any rate upon receiving the stream of content from the receiver the media system stores same in an appropriate storage device for retrieval and rendering either immediately or upon some time delay. Upon rendering of the stream the media system forwards appropriate signals to one or more output devices such as one or more monitors speakers other displays and the like.

Inasmuch as the stored stream is in the RM protected form the media system includes RM components such as the trusted component license evaluator and clock of . Thus upon retrieving a particular stream the media system renders same but only in accordance with a corresponding license as will be set forth in more detail below. Accordingly the encrypted stream is decrypted and rendered only in if such license so allows and with the content key CK set forth in the license . Note that inasmuch as the encrypted stream is stored at least temporarily on the first media system a user thereof may in theory copy same to another second media system for rendering thereby. However inasmuch as the stream is encrypted and decryptable only according to the license and inasmuch as the license is tied to the first media system such license may not be employed by the second media system .

As should be understood though it may be the case that the first media system can issue a sub license for the copied stream to the second media system presuming the first media system is in fact capable of doing so and the license so allows. If so the sub license as tied to the second media system can in fact be employed by the second media system to render the stream .

Turning now to it is seen that in one embodiment of the present invention a first media system or the like acting as a source transmits content such as a stream to a second media system acting as a sink over an interconnecting network where the sink already has such content and a license corresponding thereto and where the source has a public private key pair PU A PR A associated therewith and the sink likewise has a public private key pair PU B PR B associated therewith. As shown the content is in the form of a content package with the content encrypted according to a symmetric content key KD to result in KD content and the license includes a description of rights and conditions hereinafter policy perhaps including whether the sink may access the content by way of the source and the network and also includes the content key KD encrypted according to the public key of the source PU A to result in PU A KD . Note that although the present invention is disclosed primarily in terms of a symmetric content key KD and public private key pairs for the source and the sink other encryption arrangements may also be employed without departing from the spirit and scope of such present invention.

In one embodiment of the present invention the method of delivering the content from the source to the sink is agnostic to the actual protocols used for transporting the content . Thus the particular way in which the source and sink communicate is irrelevant to the method. In addition in one embodiment of the present invention the method of delivering the content from the source to the sink is agnostic to the format of the content . Thus the any particular type of content may be sent from the source to the sink by way of such method.

Turning now to to arrange for the sink to access the content by way of the source and network and in one embodiment of the present invention the sink must first securely establish to the source that such sink is physically close to or proximate to such source . As may be appreciated such proximity as established tends to correlate highly with whether the user of the source is also the user of the sink . Put another way although not conclusive a particular source that has been found to be proximate to a particular sink is likely to be joined to such particular sink by some sort of local network or the like and thus it may be concluded that the source and the sink are under the common control of the user.

From the point of view of the owner of the content then the content as licensed to the source can be sub licensed to the sink if it can be shown that the source and the sink are likely under the common control of the user inasmuch as the point of the sub license is to allow the same user to render the content on either the source or the sink . Correspondingly the content as licensed to the source can not be sub licensed to the sink if it can be shown that the source and the sink are not indeed likely under the common control of the user inasmuch as the point of the sub license would likely be to allow different users to render the content on the source and the sink . In the latter case and as should be understood the user at the sink must obtain its own license if possible.

A perfect and error proof solution to determine commonality as between the user of the source and the user of the sink which can operate on currently existing hardware and software systems is currently unknown. However a mechanism that provides a satisfactory approximation of such commonality lies in determining digital proximity between digital systems as an indication of physical proximity. As may be appreciated such a proximity detection test relies on the presumption that media systems that are physically close typically belong to the same user.

In the present invention then physical proximity between a source and a sink is securely detected based on proximity detection test that relies on the principle that a correlation exists between digital proximity and communication delays. In addition in the present invention such a proximity detection test is performed in such a manner that the test represents a relatively low utilization of resources on the part of the source and the sink . Accordingly such test can be employed even with a relatively simple source and sink

In particular and still referring now to in one embodiment of the present invention the sink registers with the source as part of establishing a source sink relationship therewith and in doing so the sink sends a registration request to the source by way of the interconnecting network step . The registration request may include an identification of the sink and such identification may at least be partially achieved by including with the registration request a digital certificate provided to the sink either directly or indirectly by an appropriate certifying authority. As may also be appreciated the digital certificate includes therein the public key of the sink PU B and is digitally signed either directly or indirectly by the certifying authority and thus the digital signature of the certificate may be verified by the source presuming such source has appropriate knowledge of such certifying authority. For example the certificate may include a chain of certificates leading back to the certifying authority whereby the source with knowledge of a verifying public key corresponding to the certifying authority may verify the chain of certificates to ascertain that the certificate did indeed originate from the certifying authority.

At any rate upon receiving the registration request the source validates the certificate thereof step and in particular verifies that the certificate can be traced back by way of the accompanying chain of certificates to a certifying authority known to and approved by such source and may also verify with reference to an appropriate revocation list thereof that the certificate has not been revoked. Essentially then the source will impart trust to the sink to properly handle received content at least in part if the sink owns a non revoked certificate derived from an approved certifying authority.

Presuming the source finds a non revoked and approved certificate in the registration request and in one embodiment of the present invention the source then also ensures that the sink is within a certain proximity to the source measured either as a function of distance time or otherwise. In particular the source and the sink perform the following proximity detection test.

In particular in response to the request as at step the source sends a registration response to the requesting sink by way of the interconnecting network step . In one embodiment of the present invention the registration response in pertinent part a secret to be employed as will be set forth in more detail below. As should be appreciated the secret is essentially a random cryptographic value and especially if symmetric in nature should thus be encrypted in a manner decryptable by the sink . In particular to prevent any nefarious entity from browsing such secret such secret should be encrypted by way of PU B as obtained from the certificate received in connection with the request although another cryptographic key may be employed without departing from the spirit and scope of the present invention.

Upon receiving the registration response the sink decrypts the encrypted secret therein by way of application of PR B thereto step . At this point and optionally the sink may send an address of a port thereof to the source by way of the interconnecting network step . If in fact sent the port should be an appropriate port of the sink selected primarily based on how quickly the source can access the sink thereby for the reason that the proximity requirement is satisfied primarily based on how quickly the source sends a proximity message to the sink and receives a proximity response therefrom. Of course sending such port can be dispensed with especially if the source should already know same or if the sink does not employ a port architecture.

At any rate and presuming that the source has received a port address from the sink the source performs a proximity detection test by sending a proximity message with a nonce to the sink by way of the network and the received port address of such sink step . The nonce is to be employed as will be set forth in more detail below. The nonce is essentially a random value. Concurrently with step the source notes a start time at which the proximity message with the nonce is sent.

The sink receives the proximity message with the nonce from the source by way of the network and the port address of such sink and thereafter employs the received secret and the received nonce to produce a proximity value step and then sends a proximity response with the proximity value back to the source by way of the network step . Note that the proximity value may be any value based on the secret and the nonce without departing from the spirit and scope of the present invention. For example the proximity value may be the nonce encrypted by the secret or may be a cryptographic hash of the secret and the nonce. Likewise the proximity value may be achieved by employing the first nonce as a cryptographic key to perform a cryptographic hash over the nonce.

Notably and as was alluded to above the computation of the proximity value should require only a relatively low utilization of resources so that the proximity detection test is not excessively taxing and also so that the computation does not represent an especially large period of time. Thus the computation has a low computational cost that does not unduly add a delay that could skew the proximity detection test. Also notably employing the secret in the proximity value shows to the source that the proximity response came from the sink and not some other entity pretending to be the sink . Likewise employing the nonce in the proximity value shows to the source that the proximity response corresponds to the proximity message. As may be appreciated the proximity value must be unpredictable without knowledge of the secret and the nonce.

At any rate the source receives the proximity response with the proximity value from the sink by way of the network step and concurrently therewith notes an end time at which the proximity value is received thus ending the proximity test. Thereafter the source verifies the proximity value based on knowledge of the secret and the nonce step . Presuming the proximity value verifies the source then calculates from the noted start and end times an elapsed time and compares same to a predetermined threshold value step and decides from the comparison whether the sink is close enough to satisfy the proximity requirement step . If so the source registers the sink as being able to access content from such source by way of the interconnecting network step .

If not the source may deny registration and either terminate communication with the sink or else again perform steps as another proximity test based on the same secret. In fact the proximity detection test may be repeated several times until the proximity requirement is satisfied especially if the source and or sink reside in a noisy environment that may adversely affect the result of such proximity test in a manner not relevant to physical distance. Presuming the proximity test and the requirement thereof are satisfied once the source may agree to register the sink

As may be appreciated the elapsed time compared to the predetermined threshold value as at step should at least roughly correspond to how far away the sink is from the source and thus the elapsed time from the proximity test should be less than the threshold value to satisfy the proximity requirement. Such a threshold value may be determined for the source on a case by case basis may be set to a particular value by some external source may be set to a particular value by a requirement of a license or the like. Empirically it has been found that good results have been obtained with a threshold value on the order of 7 milliseconds or so.

Once registered to the source the sink may remain registered indefinitely. Alternatively the source may periodically require the sink to re register in accordance with the method shown in . Among other things periodically re registering the sink ensures that the sink still satisfies the proximity requirement. Such re registration may for example be prudent in the case where the sink is mobile or can be moved with relative ease.

As should now be evident the proximity detection test of the present invention as set forth in connection with may be employed in connection with any source connected to any sink over any network . For example the network may be a home local area network employing IP addressing or may simply comprise the source and the sink connected by a USB bus connection a PCI bus connection etc. In summary the proximity detection test of the present invention may be practiced in connection with any sort of architecture of networked computing devices sharing protected content without departing from the spirit and scope of the present invention.

The programming necessary to effectuate the processes performed in connection with the present invention is relatively straight forward and should be apparent to the relevant programming public. Accordingly such programming is not attached hereto. Any particular programming then may be employed to effectuate the present invention without departing from the spirit and scope thereof.

In the present invention a system and method are provided for a first media system or the like to ensure that a second media system or the like is proximate to the first media system prior to allowing the second media system to render content licensed to the first media system . Te first media system can at least roughly determine how close the second media system is to the first media system based on an amount of time to respond to a sent message.

It should be appreciated that changes could be made to the embodiments described above without departing from the inventive concepts thereof. It should be understood therefore that this invention is not limited to the particular embodiments disclosed but it is intended to cover modifications within the spirit and scope of the present invention as defined by the appended claims.

