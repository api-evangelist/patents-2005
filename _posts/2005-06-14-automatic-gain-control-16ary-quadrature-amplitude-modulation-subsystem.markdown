---

title: Automatic gain control 16-ary quadrature amplitude modulation subsystem
abstract: An improved AGC subsystem for preferred use in quadrature amplitude modulation receivers offers improved automatic gain control of received signals in fading channels by generating an error signal only from constellation signal points having large signal-to-noise ratios for increase the signal-to-noise ratio of the gain control error signal for lowering dispersion of symbol signals in the constellation signal space for improving data detection of symbol signals with the improved performance with as much as one dB in the signal-to-noise ratio.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07450670&OS=07450670&RS=07450670
owner: The Aerospace Corporation
number: 07450670
owner_city: El Segundo
owner_country: US
publication_date: 20050614
---
The invention was made with Government support under contract No. F04701 00 C 0009 by the Department of the Air Force. The Government has certain rights in the invention.

The invention relates to the field of quadrature amplitude modulation communication systems. More particularly the present invention relates to automatic gain control of received signals in quadrature amplitude modulation communication systems.

In a digital data transmission system employing amplitude and phase modulation such as the 16 ary quadrature amplitude modulation 16 QAM the performance of a receiver is an essential receiver function. Automatic gain control AGC provides for uniform amplitude of the received signals across the signal constellation space. The more accurate the control of the amplitudes of the received signals the better the demodulation performance of the demodulation of the received signals into data symbols. A 16 QAM AGC receiver has used a 16 QAM symbol demodulator in combination with an AGC error detector for AGC. Particularly the prior 16 QAM AGC receiver subsystems have used average weights across the entire signal constellation space as constituents of the generated AGC error signal. However power variability of the received signals in the signal constellation space can produce suboptimal AGC when all of the constellation points are averaged. These and other disadvantages are solved or reduced using the invention.

Another object of the invention is to provide a subsystem for automatic gain control of received signals over a constellation signal space.

Yet another object of the invention is to provide a subsystem for automatic gain control of received signals over a constellation signal space using weighted perimeter constellation points in the constellation signal space.

Still another object of the invention is to provide a subsystem for automatic gain control of received signals over a constellation signal space by weighted perimeter constellation points in the constellation signal space for quadrature amplitude modulated signals.

A further object of the invention is to provide a subsystem for automatic gain control of received signals over a constellation signal space by weighted perimeter constellation points in the constellation signal space for 16 ary quadrature amplitude modulated signals.

The invention is directed to a baseband automatic gain control AGC subsystem in a receiver for receiving M ary quadrature amplitude modulated QAM signals such as 16 ary QAM signals. The subsystem provides improved AGC control performance. The subsystem tracks large signal to noise ratio SNR signals as a subset of all of the signals in the constellation space. That is the AGC tracks the amplitude of large SNR signals preferably on the perimeters of points in the constellation space. In the constellation space those received inner symbol signals particularly those proximal to the zero zero volt origin in the constellation space have low SNRs. The low SNR symbol signal are not used in the AGC but those received outer signals distal to the zero zero volt origin and preferably on the perimeter in the constellation space having large SNRs are used for AGC. Those outer signals with large SNRs provide a better indication of the amount of AGC needed to provide uniform automatic amplitude gain control for improved reception of all of the signals in the constellation space. A demodulator in the receiver operating in conjunction with the outer large SNR AGC subsystem can provide improved performance with up to 1.0 dB in SNR over an AGC subsystem averaging all of the amplitudes of all of the received signals in the constellation space. The use of only large SNR signals by the subsystem can be implemented by modest modifications to an AGC error detector in a conventional AGC design. These and other advantages will become more apparent from the following detailed description of the preferred embodiment.

An embodiment of the invention is described with reference to the figures using reference designations as shown in the figures. Referring to a conventional 16 ary quadrature amplitude modulated subsystem receives an r t received baseband signal filtered by a matched filter for phase amplitude modulation filtering of the received signal for providing Y match filter signals that are then sampled by a sampler for providing Y sampled signals to a mixer . The mixer adjusts the Y sampled signals by a gain control signal g from an exponentiator for providing a gain adjusted Z baseband signal. The Z baseband signal is then fed into a quadrature amplitude modulated QAM demodulator that is preferably a 16 QAM demodulator for providing a constellation space S demodulated signals that are then fed into an AGC error detector for providing an error signal. The detector also receives the Z baseband signal for generating the error signal. The error signal is then fed into a G Z gain filter for providing an error filter signal. An initial correction value estimator provides an initial correction value Uthat is summed by a summer for adding the initial correction value Uto the error filter signal for providing a correction signal. The correction signal is fed into the exponentiator for generating the gain control signal g. The matched filter is matched to the impulse response of a data pulse shaping filter employed in a transmitter not shown transmitting the received signal as is all well known. The terms G and c are the AGC subsystem parameters and Uis the initial correction value obtained by an estimation of the received averaged signal power of the matched filter output samples. A parameter Prefers to the average signal power of the reference signal constellation that is used by the data symbol demodulator .

The received r t baseband signal with additive noise is filtered by the matched filter and the output of the matched filter is sampled at symbol times t kT. Each matched filter output Y is multiplied by the gain factor g to compensate for the signal amplitude variation caused by channel disturbances such as fading. The gain factor g is initialized to the initial correction value that can be determined by the average signal power estimate of the matched filter output samples. The complex product Z gy is applied to the symbol demodulator that then makes a data symbol decision S according to the minimum Euclidean distances criterion. The symbol decision of the demodulator is an assignment of a received signal Z to a nearest one of the predetermined S signal points in the constellation space. The demodulator will produce S signals at predetermined points in the constellation space from respective received signals Z. With the Z and S signals the AGC error detector computes the error signal based only on the outer ring perimeter signals having large signal to noise ratios. The error signal is generated using the large signal to noise ratio outer ring S signals within the constellation space. As such the AGC subsystem has an improved AGC error signal detector that produces less noisy error signals using improved error detection. The improvement of the AGC 16 QAM subsystem resides in the AGC error detector .

Referring to and and more particularly to the improvement in the AGC 16 QAM subsystem resides in the AGC error detector for generating error signal based on received signals having large SNRs. The AGC error detector is improved by generating the error signal from the demodulated S signals and the received Z signals preferably using only outer ring signals. The outer ring S signals for a perimeter in the constellation space. The improved AGC error detector in an AGC 16 QAM subsystem relies on maintaining gain control based on the magnitudes of the outer ring received constellation signals. The received signals on or near the outer ring of the 16 QAM signal constellation space have higher signal to noise ratios than received signals on or near the inner ring signals. That is the twelve outer ring signals have larger magnitudes for both the inphase or quadrature components than the four inner ring signals S S S and S. The error detector produces the error signal having high signal to noise ratios for improved gain control. The error signal derived from only signals having high SNRs signal improves the gain control as consequently tracking of the received signals for improved demodulator performance.

In the error detector the received Z baseband signal and the S demodulated symbol signal indexed by an index k are respectively fed into I Q filters and . The I Q filter generates an Re S signal and an Im S signal. The Re S signal is the magnitude of the real part of the complex symbol signal S. The Im S signal is the magnitude of the imaginary part of the complex symbol signal S. The I Q filter generates an Re Z signal and an Im Z signal. The Re Z signal is the magnitude of the real part of the complex received signal Z. The Im S signal is the magnitude of the imaginary part of the complex received signal Z. The magnitudes of the real and imaginary parts of the complex symbol and received signals S and Z provide an indication of SNR of the signals.

A divider divides the Im Z signal by the Im S for producing an imaginary ratio signal Im Z Im S . A divider divides the Re Z signal by the Im Z for producing a real ratio signal Re Z Re s . The Re S signal the Im S signal the Im Z Im S ratio signal and the Re Z Re s are fed into a switch B. The switch B selects one of the two ratio signals Re Z Re s and Im Z Im S based on the magnitudes of either the real part Re S of the symbol signal S or the imaginary part Im S of the symbol signal. When the Re S magnitude of the real part of symbol signal S is greater than the Im S magnitude of the imaginary part of the symbol signal S then the switch B selects the Re Z Re S real ratio signal. When the Re S magnitude of the real part of symbol signal S is lesser than the Im S magnitude of the imaginary part of the symbol signal S then the switch B selects the Im Z Im S imaginary ratio signal. As such the switch B selects a real or imaginary ratio based on the largest quadrature component of the symbol signal S. The selected real or imaginary ratio signal is then normalized by a one value using a summer so as to provide a current error signal . The normalized current error signal is normalized about a zero value using the normalization one value and summer . The normalized one value is subtracted from the selected ratio. The normalized current error signal is a error signal centered at zero. The signal is equal to the ratio of the received signal Z to the symbol signal S minus one. The selected ratio is either the imaginary Im Z Im S ratio or the real Re Z Re s ratio depending on which real or imaginary quadrature component of the S symbol signal is greater so as to provide a current error signal from the largest quadrature component of the symbol S signal.

Using the largest quadrature component of the symbol S signal provides the lowest SNR signal. However the current error signal is based on the currently received Z and S signals. The current S signal may be either proximal or distal to the zero zero origin in the constellation. The signal based on a current S symbol signal proximal to the origin would have a lower SNR than a current S symbol signal proximal to the origin. When the signal is based on a current S symbol signal that is proximal to the origin the current error signal is not used as the selected error signal . When the signal is based on a current S symbol signal that is distal to the origin a previous error signal signal is selected as the selected error signal . The previous error signal is always based on an S symbol signal that is distal to the origin in the constellation space. The distal S symbol signal is preferably an outer ring S signal on the perimeter of the constellation space having large SNRs.

The current S symbol signal is fed into an A switch that is used to select either the current error signal or the previous error signal. A previously selected error signal from the A switch is fed into a time delay for generating the previous error signal . The previous error signal is the selected error signal delayed by one symbol time through delay . The A switch determines when the current S symbol signal is distal or proximal to the origin in the constellation space. This proximal or distal determination can be based on any criteria that segregates the constellation space into at least two sets of points such as inner points and outer points. The proximal or distal determination can be based for example on the distance between the S symbol signal and the origin.

When the S symbol signal is distal to the origin in the constellation space and hence has a large SNR the current error signal is selected as the selected error signal that then becomes the previous error signal at the next symbol time. As long as the current S symbol signal remains distal to the origin with a high SNR the current error signal is selected as the selected error signal. The current error signal is used as the selected error signal that then becomes the previous error signal at the next symbol time. However when the current S symbol signal is proximal to the origin in the constellation space and hence has a small SNR the previous error signal is selected as the selected error signal that then remains the previous error signal for the next symbol time. As long as the current S symbol signal remains proximal to the origin with a low SNR the previous error signal is selected as the selected error signal so that the previous error signal is used as the selected error signal. In so doing the selected error signal is based on S symbol signals having high SNRs such as those in the outer ring on the perimeter of the constellation space. By generating an AGC error signal based only on high SNR S symbol signals distal to the origin in the constellation space the selected error signal has less noise and the gain g is more precise. The selected error signal with less noise results in less noisy received signals fed into the symbol demodulator for generating more accurate S symbol signals for improved data detection performance.

The preferred error detector can be applied to any M ary QAM AGC subsystem. When the decided data symbol S is on the inner ring of the 16 QAM signal constellation that is inner ring signals S SSS the selected error signal is set to the previous error signal which is initialized to zero. That is signals on the inner ring with lower SNRs are expurgated from the error signal generation process in the AGC error detector . When the decided data symbol S is on the outer ring of the signal constellation and has a large SNR of either inphase and quadrature components the outer ring S signal is used to set the selected error signal to the current error signal. The selected error signal is then used to compute the gain factor g for the next matched filter output sample.

Referring to all of the Figures and particularly to the improved 16 QAM AGC subsystem has improved performance over conventional 16 QAM AGC subsystems with and without channel noise respecting data symbol demodulation performance by observation of the resulting signal to noise ratio. The 16 QAM input signal constellation and data symbol demodulator can be produced by conventional means with the improved error detector with the absence of channel noise. The AGC subsystem parameters may be for example G 1000 c 0.1 and U 1n G P c where Pis the averaged signal power estimated over Y matched filter output samples for example twenty four matched filter output samples. The conventional AGC subsystem produces considerable amplitude dispersion in the 16 QAM signal constellation space whereas virtually perfect gain control is achieved by the improved AGC subsystem. The 16 QAM input signal constellations are produced by the respective AGC subsystems for an averaged symbol energy to noise power density ratio of 14 dB. The 16 QAM signal constellation space resulted from the conventional AGC subsystem is more dispersive and noisier than the improved AGC subsystem. The demodulator symbol error probability performance for the respective AGC subsystems can be compared for signal to noise ratios ranges from 10 dB to 17 dB. The improved AGC subsystem performs uniformly better than that of the conventional AGC system. The improved AGC subsystem can have as much as 1.0 dB of demodulation performance advantage over the conventional AGC subsystem.

The invention is directed to an improved error detector in AGC M ary QAM subsystem such as in 16 ary QAM signal receiver. The error signal performs low SNR signal expurgation in a coherent amplitude error detection process to achieve an improved signal amplitude tracking performance over that of a conventional AGC subsystem that employs non coherent error detection without weak signal expurgation. The error detector offers improved performance when using only high SNR S symbol signals for AGC. Various M ary QAM subsystems can use an improved detector setting the AGC based on outer ring S symbols signals. The constellation space is divided into large and small SNR symbol points where only distal S symbol points are used to generate the selected error signal. Those skilled in the art can make enhancements improvements and modifications to the invention and these enhancements improvements and modifications may nonetheless fall within the spirit and scope of the following claims.

