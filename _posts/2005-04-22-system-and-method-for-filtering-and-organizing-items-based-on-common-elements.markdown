---

title: System and method for filtering and organizing items based on common elements
abstract: A system and method for filtering and organizing items in a computer system based on common elements is provided. A graphical user interface includes a plurality of display objects, each display object representing one or more items and a metadata property control corresponding to a metadata property. Selection of the metadata property control causes a list of filter terms to be presented on the display and also may cause a list of check box controls to be presented on the display, each check box control being adjacent to a respective one of the filter terms. The list of filter terms may be presented in a drop down menu. Selection of a check box control causes each item that satisfies the corresponding filter term to be presented on the display. The filters may be dynamically generated based on the properties of the separate items.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07587411&OS=07587411&RS=07587411
owner: Microsoft Corporation
number: 07587411
owner_city: Redmond
owner_country: US
publication_date: 20050422
---
This application is a continuation in part of U.S. patent application Ser. No. 10 440 035 filed May 16 2003 which is a continuation in part of U.S. patent application Ser. No. 10 403 341 filed Mar. 27 2003 priority from the filing dates of which are hereby claimed under 35 U.S.C. 120.

The present invention relates to systems and methods for viewing items that are stored in a computer memory and more particularly to a system and method for filtering and organizing items based on common elements.

Present computer file systems have a number of undesirable limitations. One limitation is that users are generally unable to control the structure that they are shown. In other words when folders are organized a user must choose a structure and that structure is then difficult to change. As a specific example for a music folder a user may choose to organize the music files in an artist album format wherein all of the album folders for each artist are grouped into that particular artist s folder and all of the songs on a particular album are grouped into that album s folder. The artist album format is not conducive to playing a type of music e.g. playing two jazz songs from two different artists or for playing a selection of albums from different artists.

As another issue a user may have a large number of files which are difficult to organize. Some users implement a rigid sense of placement for the files and thus create strict hierarchies for them. The management of such files become increasingly complex and difficult as the number of available documents grows making search and retrieval also difficult. This problem is further exacerbated when additional files are utilized from other locations such as shared files etc.

Users also have to deal with files being in different locations such as on different devices on other PCs or online. For example users can select to listen to their music on the computer as may be accessible to a music program or can go online and listen to music from Web sites however there is a strict division between these two sources. Music coming from different locations is organized differently and not kept in the same fashion or place. As another example files stored on a corporate network may inherently be separated from files a user has on a current machine.

Users also have to keep track not only of what file data is stored but where it is stored. For example for music files users are forced to keep copies on various systems and to try to track which music files are located where. This can make files difficult to locate even when they are locally stored.

It is also sometimes difficult to find and return to files that a user has. A user may find it difficult to recall where and how they stored certain files. Given a set of folders and even a group of similar files users often find it difficult to quickly find the one that they are looking for. For files stored in a difficult place to find it is that much more complex to locate. In addition once users have enough files in a folder it becomes more difficult to parse the folder quickly especially if the contents are similar.

It is also sometimes difficult for users to find or return to files on a network. Sharing and publishing files is often hard to do and it may often be even more difficult to retrieve such a file from someone who makes it available. Users typically have to memorize or map the various sites and names that they need for finding files on a network.

Name spaces may vary which can cause confusion to the user as to what is correct. This is particularly true on a network where there are different naming conventions limitations and so on. For example certain operating systems may require short names with no spaces in order for them to be visible.

Programs also often save files to their own directory or other name spaces which can make it difficult for users to find their way back to the files. Programs often have default directories and places they save documents. A user often has to search through their hard disk and make guesses about where a file is stored.

Related items are also often stored in separate places. Related files that a user has may be stored on different parts of the hard disk etc. This problem becomes more common with the developments of digital media services that have multiple content types e.g. pictures music video .

The present invention is directed to providing a system and method that overcome the foregoing and other disadvantages. More specifically the present invention is directed to a system and method for filtering and organizing items based on common elements.

A system and method for filtering and organizing items from computer memories based on common elements is provided. In accordance with one aspect of the invention filters are provided for manipulating the items. The filters are essentially tools for narrowing down a set of items. In one embodiment the filters are dynamically generated based on the properties of the separate items. For example for a set of items the filter mechanism may review the properties and if the items generally have authors as a property the filter can provide a list of the authors. Then by clicking on a particular author the items that don t have the author disappear. This allows the user to narrow the contents.

In accordance with another aspect of the invention a method for filtering items is provided in a computer system having a display and a memory for storing items with metadata properties. Display objects are provided on the display that each represent one or more items. The metadata properties of the items that are represented by the display objects are evaluated. A filter term is provided on the display that corresponds to a metadata property that is shared by a plurality of the items wherein the selection of the filter term causes the items that are represented on the display to be reduced to those items that share the specified metadata property.

In accordance with another aspect of the invention a plurality of items is represented on the display and a filter term is dynamically generated based on the metadata properties of the items. When the filter term is selected it reduces the items that are represented on the display to those that have the metadata property that corresponds to the filter term.

In accordance with another aspect of the invention a plurality of items is represented on the display and a filter area is provided in which a user can select a filter term by selecting a checkbox control. When a checkbox control is selected by the user the items that are represented on the display are reduced to those that contain the filter term. As the user types the filter term additional items may be filtered as each new character is added to the filter term.

In accordance with another aspect a graphical user interface is provided including a plurality of display objects each display object representing one or more items and a property control corresponding to a property that is shared by a plurality of the items. Selection of the property control causes a list of filter terms to be presented on the display. In one aspect the filter terms may be presented in a drop down menu in which each filter has a corresponding checkbox control.

In another aspect of the invention selection of a first check box control may cause the items that are represented on the display to only include items that satisfy the filter term corresponding to the first check box control. Selection of a second check box control when the first check box control is currently selected causes the items that are represented on the display to include items that satisfy either the first respective filter term corresponding to the first check box control or a second respective filter term corresponding to the second check box control. In other words the filter terms cause a logical OR operation to be performed on the items in the view.

In still another aspect the second check box control may be deselected causing the items represented on the display to include only items that satisfy at least one respective filter term corresponding to a currently selected check box control.

In another aspect selection of a property control may cause a list of arrangement commands to be presented on the display separated from the list of filter terms. The selection of an arrangement command may cause the items to be rearranged on the display. Illustrative arrangement commands including sorting stacking or group by the property associated with the selected property control.

In yet another aspect the property control may be a split button. According to this aspect selection of a first button portion may cause the list of filter terms to be presented on the display and selection of the second button portion may cause the display objects to be sorted by the property.

The present invention is directed to folders including virtual or physical folders. Virtual folders utilize the same or similar user interfaces that are currently used for file systems. The virtual folders expose regular files and folders also known as directories to users in different views based on their metadata instead of the actual physical underlying file system structure on the disk. Location independent views are created which allow users to manipulate their files and folders utilizing similar controls as those presently used for managing file systems. In general this means that users can organize and rearrange their files based on inherent properties in the files themselves instead of the managing and organization being done as a separate part of the system. The virtual folders may represent files or items from different virtual or physical locations such as from multiple disk drives within the same computer between multiple computers or different network locations such that one view of files or items can expose files or items sitting at different physical locations. In one embodiment the different items or files need only be connected via an IP network in order to be included.

The virtual folder modeling is also able to be used for traditionally non file entities. An application of this is to have a set of user interfaces similar to files and folders that is objects and containers to show traditionally non file entities. One example of such non file entities would be e mails while another would be contact information from a contact database. In this manner virtual folders provide for a location independent metadata based view system that works regardless of whether the data being shown is from files or non file entities. In general these aspects allow more flexibility in terms of letting users manipulate their files and data using both common user interface techniques drag and drop double click etc. as well as leveraging the rich integration of various data types.

With reference to an exemplary system for implementing the invention includes a general purpose computing device in the form of a conventional personal computer including a processing unit system memory and a system bus that couples various system components including the system memory to the processing unit . The system bus may be any of several types of bus structures including a memory bus or memory controller a peripheral bus and a local bus using any of a variety of bus architectures. The system memory includes read only memory ROM and random access memory RAM . A basic input output system BIOS containing the basic routines that help to transfer information between elements within the personal computer such as during start up is stored in ROM . The personal computer further includes a hard disk drive for reading from or writing to a hard disk a magnetic disk drive for reading from or writing to a removable magnetic disk and an optical disk drive for reading from or writing to a removable optical disk such as a CD ROM or other optical media. The hard disk drive magnetic disk drive and optical disk drive are connected to the system bus by a hard disk drive interface a magnetic disk drive interface and an optical drive interface respectively. The drives and their associated computer readable media provide non volatile storage of computer readable instructions data structures program modules and other data for the personal computer . Although the exemplary environment described herein employs a hard disk a removable magnetic disk and a removable optical disk it should be appreciated by those skilled in the art that other types of computer readable media which can store data that is accessible by a computer such as magnetic cassettes flash memory cards digital video disks Bernoulli cartridges random access memories RAMs read only memories ROMs and the like may also be used in the exemplary operating environment.

A number of program modules may be stored on the hard disk magnetic disk optical disk ROM or RAM including an operating system one or more application programs other program modules and program data . A user may enter commands and information into the personal computer through input devices such as a keyboard and pointing device . Other input devices not shown may include a microphone joystick game pad satellite dish scanner or the like. These and other input devices are often connected to the processing unit through a serial port interface that is coupled to the system bus but may also be connected by other interfaces such as a parallel port game port or a universal serial bus USB . A display in the form of a monitor is also connected to the system bus via an interface such as a video card or adapter . One or more speakers may also be connected to the system bus via an interface such as an audio adapter . In addition to the display and speakers personal computers typically include other peripheral output devices not shown such as printers.

The personal computer may operate in a networked environment using logical connections to one or more personal computers such as a remote computer . The remote computer may be another personal computer a server a router a network PC a peer device or other common network node and typically includes many or all of the elements described above relative to the personal computer . The logical connections depicted in include a local area network LAN and a wide area network WAN . Such networking environments are commonplace in offices enterprise wide computer networks intranets and the Internet.

When used in a LAN networking environment the personal computer is connected to the local area network through a network interface or adapter . When used in a WAN networking environment the personal computer typically includes a modem or other means for establishing communications over the wide area network such as the Internet. The modem which may be internal or external is connected to the system bus via the serial port interface . In a networked environment program modules depicted relative to the personal computer or portions thereof may be stored in the remote memory storage device. It will be appreciated that the network connections shown are exemplary and other means of establishing a communications link between the computers may be used.

As implemented on a system of the type illustrated in the present invention utilizes virtual folders which make it easier for users to perform basic tasks around file manipulation and folder navigation browsing and to provide higher level storage capabilities which can be leveraged in new features. The virtual folders expose files and items to users in different views based on their metadata instead of the actual physical underlying file system structure on the disk.

As illustrated in the virtual folder system includes a folder processor a relational database a virtual folder descriptions database an other shell folders component a folder handler s component and a shell browser and view component . The folder processor includes a native handling code component a handler factory component a property writer component a rowset parser component a query builder component an enumerator component and a property factory component .

The relational database stores properties about all files in the system. It also stores some items like contacts i.e. non file items entirely. In general it stores metadata about the types of files and items that it contains. The relational database receives SQL queries from the query builder . The relational database also sends SQL rowsets to the rowset parser component with one row per item column columns being the item properties.

The virtual folder descriptions database includes the virtual folder descriptions. The virtual folder descriptions database sends data to the query builder component including a list of types to display in the folder the initial filter and the physical locations to show results from the scopes .

With regard to the other shell folders component the folder processor delegates to existing shell folders from many types of items including all files for handlers or properties. The other shell folders component sends properties from other folders to the property factory . The other shell folders component also sends handlers to the handler factory .

The folder handlers component provides code behavior for the items that exist only in the database like contacts. This is what allows non file items to behave akin to files. The folder handlers component sends handlers to the handler factory .

For the native handling code component the folder processor directly implements certain handlers based on the properties of the items. The native handling code component sends handlers to the handler factory . For the native handling code component and the folder handlers component like all namespaces virtual folders have to provide a set of handlers context menu icon thumbnail infotip . . . for their items. For most of these infotip data object drag drop handler background context menu . . . the virtual folder provides a common native handler for all the types it holds. However there are others which the author of the type has to provide context menu on the item itself writable property store . . . . The default handler can also be overridden. Virtual folders reuse this for files and allow non file items do the same.

The handler factory takes ID lists and produces code behaviors that provide context menus icons etc. In general the folder processor may use native handlers external handlers or delegate to other shell folders to get handlers as described above with respect to the native handling code component the other shell folders component and the folder handlers component . The handler factory component sends handlers to the shell browser in view as requested by the view. The handler factory component sends a property handler to the property writer .

The property writer converts user intentions such as cut copy and paste into property rights to the file or item. A shell browser and view component sends data to the property writer including direct manipulation cut copy paste or editing of metadata. In general since virtual folders present an organization based on the properties of an item operations such as move and copy drag drop become an edit on those properties. For example moving a document in a view stacked by author from Author 1 to Author 2 means changing the author. The property writer component implements this function.

The rowset parser takes database rowsets and stores all item properties into a shell ID list structure. A rowset takes the piecewise definition of the virtual folder and builds a SQL string which can then be issued to the database. The rowset parser component sends ID lists to the enumerator component . As described above the rowset parser component also receives data from the relational database including SQL rowsets with one row per item the columns being item properties.

The query builder component builds SQL queries. The query builder component receives data from the enumerator component including new filters from the navigation. The query builder component also receives data from the virtual folder descriptions database including a list of the types to display in the folder the initial filter and the physical location to show results from the scopes . The query builder component sends the SQL queries to the relational database .

In general the query builder component includes a set of rows in other words a table . This is what running the query yields. The rowset parser component takes each row and using the column names transforms the row into an ID list. An ID list is a well known shell structure which is used to reference items in a namespace. Doing this allows virtual folders to be just like any other namespace to the rest of the shell. Also caching this data helps keep database access which can be costly to a minimum.

The enumerator component operates in response to navigation to a virtual folder. As described above the enumerator component receives ID lists from the rowset parser component and sends new filters from the navigation to the query builder component . The enumerator also sends data to the shell browser and view component including ID lists that are returned to be inserted into the view after a navigation.

The property factory component takes ID lists and property identifiers and returns values for those properties. The property factory component receives data from the handler factory component including the property handler. As described above the property factory component also receives data from the other shell folders component including properties from other folders. The property factory component also sends data to the shell browser and view component including item properties as requested by the view.

The shell browser and view component displays the contents of a folder in a window and handles all the user interaction with the displayed files or items such as clicking dragging and navigating. Thus the shell browser and view component receives the user actions. The shell browser and view component also gets the data regarding the code behaviors that it needs from the folder in this case the folder processor .

As described above the virtual folders expose regular files and folders also known as directories to users in different views based on their metadata instead of the actual physical underlying file system structure on the disk. Thus the system is able to take a property that is stored in the database and represent it as a container that is like a folder. Since users are already familiar with working with folders by presenting the virtual folders in a similar manner users can adapt to the new system more quickly.

At a block the folder processor takes these results and converts them from the rows and columns of data into an enumerator structure which is used by the folder view to populate the screen with the resulting virtual folders and items for the user to interact upon. At a decision block a user decides whether to change the view by issuing a different query or pivot . For example a user could issue a show all artists pivot. If the user does want to change the view then the routine returns to block where the folder processor passes this new query to the relational database and receives back new rows and columns of results and constructs a new enumerator structure. The process then continues as described above as the folder view clears and updates using the enumerator to draw the artist objects to the screen.

In one example album objects are provided that represent containers that users can navigate into. For example double clicking the Beatles albums will navigate the view to see all of the Beatles songs. The folder processor issues the show all Beatles songs query to the relational database which hands back the rows and columns of data for those songs. The folder processor creates an enumerator of all these songs which then get drawn to the screen.

The user can also choose the view at any point while browsing virtual folders. From the above example after narrowing down to just show Beatles songs a user can change the view to only show the songs as albums. The process of changing the view of items into another representation is called stacking . This is because the items are conceptually arranged into stacks based on that representation. In this case the songs are rearranged into stacks for each of the various albums. Users can then navigate into one of these stacks only seeing the songs from that particular album. Again the user can rearrange the view of these remaining songs into stacks based on a property e.g. a rating for example . If the rating property were selected the songs from that Beatles album would be shown in stacks for a one two or a three star rating.

The results of each query depend on which physical or virtual locations are included in the scope. For example the scope may be made to include only the folders in the user s my documents folder. Alternatively the scope could include all folders on the computer or even all folders on multiple network connected computers. The user is able to view and change the scope through a scope property sheet. In one example the scope property sheet could be exposed by right clicking on the virtual folder and choosing properties. The user could add new folders to the scope or remove folders that were previously added.

One group of users for which virtual folders will provide particular utility is knowledge workers. Virtual folders allow knowledge workers to easily switch between viewing documents by file type project case number author etc. Since knowledge workers each tend to have a different method for organizing documents virtual folders can be used to accommodate these different preferences.

As illustrated in a folder is a my documents folder. At a first level the folder includes folders and corresponding to Clients 1 2 and 3 respectively. At a second level each of the folders and contain a folder and respectively which each correspond to the contracts for the selected client. At a third level each of the folders and contains a folder and respectively each corresponding to the year 2001. At the third level each of the folders and also contains a folder and respectively each corresponding to the year 2002.

It will be appreciated that a number of obstacles are presented to a user who wishes to navigate a physical folder file structure such as that illustrated in . For example if the user wishes to work with all of the contracts that the user has produced the user will first need to navigate to the folder to work with the contracts for Client 1 and then will have to renavigate to the folder to reach the contracts for Client 2 and will again have to renavigate to the folder for the contracts for Client 3. This arrangement makes it difficult for the user to access all of the contracts and in general prevents simultaneous viewing and manipulation of all of the contracts. Similarly if the user wishes to view all of the contracts produced in the year 2001 the user will have to navigate and renavigate to the folders and respectively. As will be described in more detail below the virtual folders of the present invention provide an improved file system structure.

The quick link elements include an all categories quick link on all authors quick link a January work quick link and a selection for displaying additional quick links . As will be described in more detail below quick links can be selected by a user to perform desired navigations of the virtual folders. Quick links may be provided by the system and some quick links may be created and saved by a user.

The filter elements include a filter by indicator an entry blank a by date indicator a year selector a pick an author selector a pick a category selector and a more filters selector . The filter by indicator directs a user to the fact that the items below can be used to filter the virtual folders or items. The entry blank provides an area in which a user can type a desired new filter term. The by date indicator directs a user to the fact that by selecting a date from the year selector the virtual folders or items can be filtered by the selected year. The pick an author selector allows a user to filter according to a specific author. The pick a category selector allows a user to filter according to a selected category. The more filters selector allows a user to pull up additional filters on the display.

The activity selectors include a create a new category selector activity selectors and and a more activities selector . As will be described in more detail below the activities that are presented may be for generally desirable functions or may more specifically be directed to activities useful for the type of virtual folders that are currently being displayed. For example the create a new category selector can be selected by the user to create a new category which will be represented by a new stack.

As noted above the activity selectors and may be more specifically directed to the type of folders or items that are being displayed. For example the present display is of a document library for which the activity selectors and may be directed to activities specifically tailored for documents such as editing or creating attachments. If the present library had been a photo library the activity selector and could be for activities specifically directed to photos such as forming photo albums or sharing photos with other users.

The information and control elements include information line and information line address bar a control line a backspace control and information lines and . The information line and address bar provide information as to the current navigation of the virtual folders or items. In the present example the information line indicates that the current navigation is to a document library while the address bar indicates the more complete navigation showing that the document library is within the storage area. The control line provides a number of standard controls and the backspace button allows a user to back up through a navigation. The information line provides numerical information about the contents of the present navigation. In the present example the information line indicates that there are 41 items which take up 100 MB in the stacks of the document library. The information line is available to provide additional information such as additional information about a file that is selected.

The stacks of the document library include an ABC Corp. stack a backups stack a business plans stack an XYZ Corp. stack and a marketing reports stack . The numbers on top of each of the stacks indicate how many items are in each stack. For example the ABC Corp. stack is shown to include 8 items. The total number of items of the stacks adds up to the number of items indicated in the information line which as described above is 41 in the present example. A selection box SB is provided which can be utilized by a user to select a desired item. The selection of the ABC Corp. stack yields a view of the items of that stack as will be described below with respect to .

As shown in a user is able to switch from the virtual files representation of to the physical file representation of . This allows a user to toggle between virtual file representations and physical file representations depending on which is desired for a current task. The different locations of the physical folders also illustrate that the scope of the virtual file system may be relatively broad as will be described in more detail below.

Another example of direct manipulation is right clicking an item and selecting delete. In one embodiment when a deleting function is selected by a user the user is queried whether the item should be deleted all together or simply removed from the present virtual folder. If the item is just to be removed from a present virtual folder category stack as noted above this can be accomplished by removing the desired category from the metadata for the item. In other words if one of the items that had been copied from the ABC Corp. stack to the West Coast stack was then to be removed from the West Coast stack this could be accomplished by modifying the category data for the particular file to no longer include the West Coast category.

The back button may be utilized by a user to back through the filtering process. As described above with respect to the back button allows a user to back up through a navigation. With regard to the examples of after filtering by the term ABC in a user could select the back button so as to back up one step of the filtering process which would return to the state of . Alternatively in another embodiment the back button may clear out the entire filter term and may thus return to the state before that filtering occurred. In this case by pressing the back button in a user would return to the state of .

In one embodiment in addition to the back button an additional means is provided for a user to back up in or otherwise modify the filtering navigation. This additional means involves allowing the user to directly access and modify the address bar which correspondingly changes the filter navigation. In other words by directly accessing and modifying the address bar the user can remove one or more of the applied filters or modify the values for any of the applied filters. This feature is described in greater detail in U.S. patent application Ser. No. 10 420 040 filed Apr. 17 2003 which is commonly assigned and hereby incorporated by reference in its entirety.

A timer may also be utilized in conjunction with a user typing in filter terms such as those shown in . The timer is used to monitor for a pause in the typing by the user. After a selected interval of no typing the filter is applied. For example in the state of a user has typed the filter term AB with no significant time lag between the A and the B. After typing the term AB the user pauses thus producing the state shown in where the filter term AB is applied. Sometime later the user adds the letter C to complete the filter term ABC and then pauses again at which point the filter term ABC is applied as illustrated in .

In one embodiment after a user has typed a filter term in the filter area and then chooses another filter or navigation the navigation state is updated and the filter term in the filter area is made to be empty again. In addition as will be described in more detail below with reference to other filter controls may be updated based on the selection of certain filter terms.

As described above with respect to filter terms may be presented by the system or typed by a user. Once a filter term is selected the remaining filter terms that are presented may be updated e.g. after the year 2002 is selected in in the options for selecting a year are no longer presented and instead a pick a month option is provided . As noted above the back button may be selected by a user to back through the filtering process. For example after the month of January has been selected in the user may select the back button to back up the filtering process to the year 2002 as illustrated in . The filter menu may also include a stack by function which would work similarly to the stack by function described above with respect to . For example a file type filter could have choices for Excel PowerPoint Word and also Stack by file type . Choosing the stack by function changes the view to show stacks for the various file types.

In general the filters may be configured to apply to different properties of the files or items. In one embodiment the filters may be classified according to different types such as alphabet index discrete values dates and numerical ranges. Example properties for the alphabet index may include file name author artist contact friendly name owner document author document title document subject and description. Example properties for the discrete values may include location file type application name genre track decade for music rating for music bit rate protected document category document page count document comments camera model dimensions product name product version image X image Y and document created time. Example properties for the dates may include last accessed last modified created on taken on for pictures . An example property for the numerical range may be file size.

It will be appreciated that the filters described above with respect to allow users to reduce a list of items to find a particular item that is of interest. As a specific example according to the processes described above a user could narrow a current list of documents to only show Microsoft Word files authored by a particular person and edited in the last week. This functionality allows a user to find a particular item in a list of many and helps the user avoid having to manually scan each item in the list.

As shown in at a block a user makes a selection on the display to indicate that a new quick link should be formed from the present filter term or navigation. At a block the user provides a new name for the new quick link. At a block the new quick link is saved and the new quick link name is provided in the quick link section on the display.

As shown in at a block a scope is defined for the physical locations from which items are to be drawn. At a block in response to a query the items are drawn from the physical locations as defined in the scope. At a block all of the items drawn by the query are presented on a single display.

In another aspect of the invention a graphical user interface is provided where a different type of filter control is implemented. According to this aspect metadata property controls corresponding to properties that are shared by a plurality of the items are provided in the listview mode. It will be appreciated that the description above applies to the following discussion where applicable and without specific reference thereto.

In the Microsoft Windows XP brand operating system by Microsoft Corporation of Redmond Wash. users are provided with different views for viewing a list of folders and files that are currently identified in the tree structure. The views include a details view icon view thumbnail view list view and tiles view. The objects identified in these views can be sorted or grouped by a number of different metadata properties. provides an illustrative screen shot of details view in the Windows XP brand operating system. In details view each row corresponds to a particular object and each column corresponds to a particular property of the object. The properties may be listed in any desired order. In this example the properties identified from left to right include Name Size Date Modified Date Created Date Accessed Author and Type. The objects and their associated information have been divided into two separate groups according to Type HTML Document and Microsoft Word Document. The Show in Groups command is accessible by drilling down to the Arrange Icons By drop down menu via the View drop down menu at the top of the screen. Selection of a property such as author would causes the objects to be regrouped according to author. If grouping was not activated selection of a property causes the objects to be sorted by the selected property.

Aspects of the present invention build upon some of the core functionality of the user interface in the Windows XP brand operating system. Certain aspects of the invention provide and arrange and filter control that enables a user to filter a view using properties shared by a plurality of items. The filter control in some aspects allows a user to easily add change or remove a filter term from an address bar such as address bar shown previously in for example . In one implementation applying the filter control a user may filter a view of display objects by a disjunction ORing multiple values of a single property e.g. author Bill or Bob . In other aspects applying the filter control a user can sort group or stack a view of display objects by a property.

According to aspects of the invention a property header appears as a set of labels along the top of the listview in each of the view modes. The view modes may include any view of the physical or virtual files including the icons view details view list view tiles view and thumbnail view. Each of the properties in the property header functions as a property control and may be invoked by user selection such as by clicking on the property control to access associated control functionality. There will likely be numerous properties that may be available to the user. As such it may be practical to display a relevant subset of properties that is most useful to the user. In this regard the set of properties displayed in the display header may be customizable by the user may be part of a default template or may be a function of the query on the address bar. One way to select a set of properties to be displayed is on an individual shell folder i.e. page basis so that for each virtual folder autolist list file folder etc. where the set of properties may be customized by default. For example for a virtual folder called Recent Documents that shows all documents viewed recently the Date Last Accessed property would be useful whereas in other virtual folders it may not be useful. Also properties may be reordered within the property header or removed by for example dragging and dropping.

Each property control in the respective header may include a split button divided into a main portion and a split portion as shown in details view in and the other listview modes in . The split button state may be revealed to the user when she positions the cursor over a portion of the property control or in the property header or may be revealed when the property control is initially displayed.

Positioning the cursor over the main portion of the property control and selecting e.g. clicking causes the display objects to be sorted in accordance with the property associated with property control. In the example shown in the property is Type selection of the main portion of the property control would cause the display objects to be sorted alphabetically. Alternatively all physical folders may be displayed followed by all Microsoft Excel documents followed by all Microsoft PowerPoint documents followed by all Microsoft Word documents followed by all virtual folders autolists etc. When the display objects are sorted by a property the property control may provide a visual indication that the display objects have been sorted by the property. For example the property control may take on a visual appearance as being a depressed button or other appearance differentiating it from the other property controls. If prior to sorting by Type the display objects were sorted by another property such as Date that property would become the secondary sort term such that within the document type the display objects would be secondarily sorted by date.

As shown in positioning the cursor over the split portion of the property control and selecting causes an arrange and filter dropdown menu for the property corresponding to the property control to be presented. The arrange and filter drop down menu provides various controls which allow a user to group stack or filter the view of display objects by the property corresponding to the property control. The arrange and filter drop down menu includes an arrangement portion including a list of arrangement commands and a filter portion including a list of filter terms. The two lists may be separated by a visual divider as shown in .

In the example of the filter terms correspond to various Type properties of the items. The set of specific filters provided in the filter portion is the subset of possible filter terms for which at least one item in the view satisfies the filter term. For example if one of the display objects in the view were a photo with vacation as a keyword then vacation would appear in the arrange and filter drop down menu for the keyword property control corresponding to the keyword property. It will be appreciated that all filter terms may not fit into the arrange and filter drop down menu. As shown in a scroll bar control is provided to allow the user to view other available filter terms. It will be appreciated that items may be moved into or out of the view by operations such as dragging and dropping. Each time an item is added or removed from the view the set of specific filters provided in the filter portion is updated to account for the added or removed item.

The filter terms may be preset or dynamically generated based on evaluation of the property corresponding to the property control and the items displayed in the view. described above and its accompanying description provides an illustrative routine for dynamically generating new filter terms. The set of possible filters and their display order may depend on how the particular property categorizes the items. With a multi valued property such as keywords each individual value may have its own bucket. Thus if an item has keywords vacation Hawaii beach three separate buckets will be created one for vacation one for Hawaii and one for beach for filtering. The same process applies to the operations of grouping and stacking which will be discussed further below.

For the property date assuming today s date is Friday Nov. 19 2004 dates may be categorized in the following categories Long Time Ago Two Years Ago Last Year 2004 January 2004 February . . . 2004 August 2004 September Last Month Three Weeks Ago Two Weeks Ago Last Week Sunday Monday Tuesday Wednesday Yesterday Today Tomorrow Two Days From Now Later This Week Later This Month Next Year Some Future Date. Other properties such as Size and Type may have the same bucketization as found in the Windows XP Brand Operating System.

According to one aspect the list of filter terms in the filter portion for properties relating to dates e.g. date created date modified etc. includes an additional filtering option which may be at the top of the list of filter terms referred to as Pick a Date . Selecting this filter term causes a calendar picker control to be displayed from which a user can select a specific date or date range. provides an example of such a control where the date April 20 has been selected.

Certain properties may not be divided or bucketized such as Filename Comment Description. For these properties there may be no useful breakdown of the property into discrete buckets for grouping stacking and filtering purposes. In this instance the only option presented in the arrange and filter drop down menu may be sort.

Each filter term in the arrange and filter drop down menu may include a corresponding indicator that provides an indication as to the number of items which satisfy the respective filter term. As shown in icon is provided adjacent to the filter term PowerPoint and represents a stack of paper. Inspection of the other icons positioned adjacent to the other filter terms indicates that they also represent stacks of papers. However the stack of paper icons vary in appearance and are dynamically generated where the number of papers stacked in the icon represent relatively the number of items which satisfy the corresponding filter term. For example icon shows more papers stacked then the icon corresponding to the filter term Email Message which shows more papers stacked then the icon corresponding to the filter term Outlook Document. Thus more items satisfy the filter term PowerPoint then the filter term Email Message and more items satisfy the filter term Email Message then the filter term Outlook Document. 

The filter portion also may include a checkbox control corresponding to each filter term in the list of filter terms. For example the checkbox control corresponds to the filter term Illlustrator Artwork. Selecting the checkbox control next to a filter term causes that filter term to be added to the current selection by placing a check in the selected checkbox control and leaves the checkbox controls corresponding to the other filter terms in the filter portion of the arrange and filter drop down menu in their previous state selected or unselected. Also selection of the checkbox control may show a live preview of the filter operation in the area containing the display objects. Thus selection of the checkbox control causes the items that are represented on the display to include items that satisfy the filter term corresponding to the check box control. If no other checkbox control is selected then only display objects which satisfy the selected checkbox control will be represented on the display. It will be appreciated that selection or de selection of a check box control may occur in any number of ways including using a pointing device a keyboard input voice input and combinations of the same. For example if a user holds down the key she can select a range of filter terms similar to how the Windows XP brand operating system allows multiple selections.

Referring to each display object in the display area not shown will satisfy the current query in the address bar not shown in a manner similar to described above for example with respect to . Selection of the checkbox control causes the checkbox control to be presented as a checked checkbox control A as shown in and causes only those items which satisfy the filter term Illustrator Artwork to be presented on the display. A routine similar to the routine described in may be employed for selection of a checkbox control when no other checkbox control is selected where step in this scenario would correspond to a user selection of a checkbox control corresponding to one of the filter terms.

After selecting a checkbox control selecting an command or otherwise issuing a command outside the arrange and filter drop down menu e.g. clicking elsewhere on the graphical user interface causes the arrange and filter drop down menu to close and applies the currently selected filter s . Also selecting a filter term or an icon associated with a filter term deselects any other checkbox controls closes the arrange and filter drop down menu and applies the filter term. In these instances the address bar similar to address bar shown in other figures such as is updated to include the filter term in the query.

While a checkbox control is selected checked selection of another checkbox control corresponding to a second filter term adds that filter term to the current selection. Selection of the additional checkbox control causes the additional checkbox control to be presented as a checked checkbox control and causes only those items which satisfy each of the filter terms corresponding to checked checkbox controls to be presented on the display. Referring to selection of the checkbox control corresponding to the filter term Excel Worksheet when the checkbox control corresponding to the filter term PDF document has already been selected causes the display to be updated to include those items that satisfy the query in the address bar and which satisfy either the filter term Excel Worksheet or PDF document. Thus according to this aspect of the invention when multiple checkbox controls each corresponding to a respective filter term are selected from a single arrange and filter drop down menu then a logical OR operation is performed. As discussed selecting an command or otherwise issuing a command outside the arrange and filter drop down menu causes the arrange and filter drop down menu to close and applies the currently selected filters. In these instances the query shown in the address bar is updated to include a single filter including the logical OR combination of the filter terms. For the example discussed the filter added to the next segment in the address bar may be Excel Worksheet PDF document .

De selection of a checkbox control causes the checkbox control to be presented as unchecked and causes those items which satisfy filter terms corresponding to the remaining checked checkbox controls to be presented on the display. When checkbox controls are selected checked in the arrange and filter drop down menu each selected check box may be unchecked by selecting the command Don t filter by in the arrangement portion of the arrange and filter drop down menu. Referring to the arrangement portion of the arrange and filter drop down menu includes the command Don t filter by Type selection of which will cause the selected checkbox controls in the filter portion to be deselected and unchecked. When there are no selected checked checkbox controls in the filter portion the Don t filter by command is disabled and appears grayed out or faded as represented in the arrangement portion in .

When a user closes the arrange and filter drop down menu corresponding to a first property when at least one checkbox control is selected the first property control may provide an indicator that the view of display objects on the display has been filtered. Referring to a symbol appears in the property control corresponding to the property Type to indicate that the view of display objects has been filtered by the property Type .

When a user closes the arrange and filter drop down menu corresponding to a first property when at least one checkbox control is selected corresponding to a respective filter term by selecting a second property control from the property header an arrange and filter drop down menu corresponding to the second property control is provided. In this instance the set of filter terms in the arrange and filter drop down menu is the subset of possible filter terms for which at least one item in the view satsifies the filter term for the second property control as well as the filter for the first property control. Also the set of filter terms may include any filter that was already selected from the arrange and filter drop down menu associated with the first property control. For example if a user were to select the checkbox control for the filter term PowerPoint from the arrange and filter drop down menu associated with the first property control Type and then select the second property control for the second property Author causing the arrange and filter drop down menu for Author to appear the filter terms Hamlet and Horatio would both appear if Hamlet and Horatio each were an author on one or more PowerPoint files. However if Horatio did not author any PowerPoint files then Horatio would not appear in the arrange and filter drop down menu. If both Horatio and Hamlet were proper filter terms the if the checkbox control for each were then selected the view would be updated with items that satisfied the logical operation Type PowerPoint AND Author Hamlet OR Author Horatio . If the command were selected the aforesaid logical operation would be applied and the address bar would be modified to include the segment PowerPoint followed by the segment Hamlet Horatio and the view would be updated to reflect the items which satisfy the query. Generally speaking values from different properties are combined with a logical AND operation when added to the query in the address bar.

According to another aspect if all the property columns in the property header cannot be seen then the columns that do not fit on the property header are truncated and may be accessed through an overflow control such as a chevron as is common with toolbars. Selecting the chevron button displays a menu providing the truncated property controls. provides an example of an arrange and filter drop down menu being activated from an overflow property control. Specifically depicts the right edge of the property header where a chevron represents that additional properties are accessible. Selection of the chevron results in the presentation of two additional property controls corresponding to the properties Author and Type . The cursor is positioned over the Type property control and the control corresponding to the arrange and filter drop down menu is selected presenting the arrange and filter drop down menu including an arrangment portion and a filter portion .

The arrangement commands present in the arrange and filter drop down menu include Stack by and Group by as well as the Don t Filter by command discussed above. In the examples of the arrange and filter drop menus shown in B and the property is Type. Hence the arrangement commands includes Stack by Type and Group by Type. 

When items in view are not stacked by the property associated with arrange and filter drop down menu the Stack by command is enabled. Selection of the Stack by command causes stacks of items to be created in the view according to the categorization applied to generate the filter terms. Thus with respect to the property Type stacks may include Microsoft Word Documents PowerPoint Excel Worksheet and other filter terms included in the list of filter terms in the filter portion of the arrange and filter drop down menu. Illustrative stacks may take on an appearance similar to for example items shown and described above in .

Also a Stop Stacking by command may be available when items are stacked by the property of the currently activated property control. Selection of this command causes stacking by the current property to be stopped.

When items in view are not grouped by the property associated with arrange and filter drop down menu the Group by command is enabled. Selection of the Group by command causes groups of items to be created in the view according to the categorization applied to generate the filter terms. The appearance of items grouped may be similar to grouping in the Windows XP Brand operating system. Also a Stop Grouping by command may be available when items are grouped by the property of the currently activated property control. Selection of this command causes grouping by the current property to be stopped.

While illustrative systems and methods as described herein embodying various aspects of the present invention are shown it will be understood by those skilled in the art that the invention is not limited to these embodiments. Modifications may be made by those skilled in the art particularly in light of the foregoing teachings. For example each of the elements of the aforementioned embodiments may be utilized alone or in combination or subcombination with elements of the other embodiments. It will also be appreciated and understood that modifications may be made without departing from the true spirit and scope of the present invention. The description is thus to be regarded as illustrative instead of restrictive on the present invention.

